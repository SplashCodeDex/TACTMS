import{c as D,u as P,r as d,R as q,f as g,j as e,m,U as T,S as Q,a as Z,b as J,d as K,A as X,e as _,B as C,g as L,h as z}from"./index-EaXXfzzi.js";import{S as b,A as N,D as ee,T as F}from"./AnimatedNumber-Bx6nHDgv.js";import{B as te}from"./BarChart-DOCaH9cw.js";import{A as se}from"./activity-ChunUS8K.js";/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=D("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=D("CloudUpload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=D("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]),oe=()=>{const{transactionLog:h=[],memberDatabase:i={},onStartNewWeek:W,onUploadFile:u,userProfile:k}=P(),[v,Y]=d.useState(""),w=q.useRef(null),[f,j]=d.useState(!1),E=t=>{t.preventDefault(),j(!0)},U=t=>{t.preventDefault(),j(!1)},H=t=>{var a;t.preventDefault(),j(!1);const s=((a=t.dataTransfer.files)==null?void 0:a[0])||null;u&&u(s,!1)},p=d.useMemo(()=>{const t=new Date().getFullYear(),s=h.filter(r=>new Date(r.selectedDate).getFullYear()===t).reduce((r,n)=>r+n.totalTitheAmount,0);let a=0;Object.values(i).forEach(r=>{r&&Array.isArray(r.data)&&r.data.forEach(n=>{if(n.firstSeenDate)try{new Date(n.firstSeenDate).getFullYear()===t&&a++}catch{}})});const l=Object.values(i).reduce((r,n)=>{var o;return r+(((o=n==null?void 0:n.data)==null?void 0:o.length)||0)},0),c=[...h].sort((r,n)=>n.timestamp-r.timestamp).slice(0,20);return{ytdTithe:s,ytdSouls:a,totalMembers:l,recentActivities:c}},[h,i]),I=d.useMemo(()=>{const s=new Date,a={};for(let l=0;l<6;l++){const c=new Date(s);c.setDate(c.getDate()-l*7);const r=`Week of ${g(c)}`;a[r]=0}return h.forEach(l=>{const c=new Date(l.selectedDate);for(let r=0;r<6;r++){const n=new Date(s);n.setDate(n.getDate()-r*7);const o=new Date(n);o.setDate(o.getDate()-o.getDay());const y=new Date(o);if(y.setDate(y.getDate()+6),c>=o&&c<=y){const V=`Week of ${g(n)}`;a[V]+=l.totalTitheAmount;break}}}),Object.entries(a).map(([l,c])=>({label:l,count:c})).reverse()},[h]),S=d.useMemo(()=>new Set(Object.keys(i).filter(t=>{var s,a;return((a=(s=i[t])==null?void 0:s.data)==null?void 0:a.length)>0})),[i]),R=()=>{v&&W(v)},M=()=>{var t;(t=w.current)==null||t.click()},B=t=>{var a;const s=((a=t.target.files)==null?void 0:a[0])||null;u&&u(s,!1),t.target&&(t.target.value="")},$={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},x={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},A=d.useMemo(()=>Object.values(i).flatMap(s=>(s==null?void 0:s.data)||[]).filter(s=>s.firstSeenDate).sort((s,a)=>{try{return new Date(a.firstSeenDate).getTime()-new Date(s.firstSeenDate).getTime()}catch{return 0}}).slice(0,20),[i]),G=d.useMemo(()=>{const t=new Date().getHours();return t<12?"Good morning":t<18?"Good afternoon":"Good evening"},[]);return e.jsxs(m.div,{className:"space-y-8",variants:$,initial:"hidden",animate:"visible",children:[e.jsxs(m.div,{variants:x,children:[e.jsxs("h1",{className:"text-3xl font-bold text-[var(--text-primary)]",children:[G,k?`, ${k.name.split(" ")[0]}`:"","."]}),e.jsx("p",{className:"text-lg text-[var(--text-secondary)]",children:"Here's your district's overview for today."})]}),e.jsxs(m.div,{variants:x,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(b,{icon:e.jsx(ee,{}),label:`Year-to-Date Tithe (${new Date().getFullYear()})`,value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(N,{n:p.ytdTithe,formatter:t=>t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})}),e.jsx(b,{icon:e.jsx(F,{}),label:"Year-to-Date Souls Won",value:e.jsx(N,{n:p.ytdSouls})}),e.jsx(b,{icon:e.jsx(T,{}),label:"Total Members on Record",value:e.jsx(N,{n:p.totalMembers})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(m.section,{variants:x,className:"lg:col-span-2 content-card space-y-6",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(re,{size:22,className:"mr-3 icon-primary"}),"Quick Actions"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-6 bg-[var(--bg-elevated)] rounded-xl border border-[var(--border-color)] text-left space-y-4",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-primary)]",children:"Start New Weekly List"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Load the latest tithe list for an assembly."}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{htmlFor:"assembly-start-select-dash",className:"form-label",children:"Select Assembly"}),e.jsxs(Q,{value:v,onValueChange:Y,disabled:Object.keys(i).length===0,children:[e.jsx(Z,{id:"assembly-start-select-dash",className:"w-full",children:e.jsx(J,{placeholder:"-- Select Assembly --"})}),e.jsx(K,{className:"glassmorphism-bg border border-[var(--border-color)] rounded-xl",children:X.map(t=>e.jsxs(_,{value:t,disabled:!S.has(t),children:[t," ",S.has(t)?"":"(No member data)"]},t))})]})]}),e.jsx(C,{onClick:R,disabled:!v,leftIcon:e.jsx(ae,{size:16}),children:"Start"})]})]}),e.jsxs("div",{className:"p-6 bg-[var(--bg-elevated)] rounded-xl border border-[var(--border-color)] text-left space-y-4 flex flex-col justify-center",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-primary)]",children:"Upload a New List File"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"If you have a new file to process from an assembly."}),e.jsx(C,{onClick:M,fullWidth:!0,variant:"secondary",size:"lg",leftIcon:e.jsx(O,{size:18}),children:"Upload Excel File"})]})]}),e.jsxs("div",{onDragOver:E,onDragLeave:U,onDrop:H,onClick:M,className:`mt-6 border-2 border-dashed rounded-xl p-12 text-center transition-all duration-300 cursor-pointer group ${f?"border-[var(--primary-accent-start)] bg-[var(--primary-accent-start)]/5":"border-[var(--border-color)] hover:border-[var(--primary-accent-start)] hover:bg-[var(--bg-elevated)]"}`,children:[e.jsxs("div",{className:"flex flex-col items-center justify-center gap-4 pointer-events-none",children:[e.jsx("div",{className:`w-16 h-16 rounded-full flex items-center justify-center transition-colors duration-300 ${f?"bg-[var(--primary-accent-start)]/20":"bg-[var(--bg-secondary)] group-hover:bg-[var(--primary-accent-start)]/10"}`,children:e.jsx(O,{size:32,className:`transition-colors duration-300 ${f?"text-[var(--primary-accent-start)]":"text-[var(--text-secondary)] group-hover:text-[var(--primary-accent-start)]"}`})}),e.jsxs("div",{children:[e.jsx("p",{className:"text-lg font-medium text-[var(--text-primary)]",children:f?"Drop file to upload":"Drag and drop your Excel file here"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)] mt-1",children:"or click anywhere to browse"})]})]}),e.jsx("input",{type:"file",ref:w,className:"hidden",accept:".xlsx,.xls",onChange:B})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(m.section,{variants:x,className:"content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(T,{size:22,className:"mr-3 icon-primary"}),"Recently Added Members"]}),A.length>0?e.jsxs(L,{className:"h-[200px]",children:[" ",e.jsx("ul",{className:"space-y-3 pr-4",children:A.map(t=>e.jsxs("li",{className:"flex items-center gap-4 p-3 rounded-lg hover:bg-[var(--bg-card-subtle-accent)] transition-colors",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 bg-gradient-to-br from-[var(--accent-purple)] to-[var(--accent-blue)] rounded-lg flex items-center justify-center text-white",children:e.jsx(z,{size:20})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("p",{className:"font-semibold text-sm text-[var(--text-primary)] truncate",children:[t["First Name"]," ",t.Surname]}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)]",children:[t.firstSeenSource,e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),g(new Date(t.firstSeenDate))]})]})]},t["No."]))})]}):e.jsx("p",{className:"text-sm text-center py-8 text-[var(--text-muted)]",children:"No new members recorded recently."})]}),e.jsxs(m.section,{variants:x,className:"content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(se,{size:22,className:"mr-3 icon-primary"}),"Recent Activity"]}),p.recentActivities.length>0?e.jsxs(L,{className:"h-[200px]",children:[" ",e.jsx("ul",{className:"space-y-3 pr-4",children:p.recentActivities.map(t=>e.jsxs("li",{className:"flex items-center gap-4 p-3 rounded-lg hover:bg-[var(--bg-card-subtle-accent)] transition-colors",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 bg-gradient-to-br from-[var(--primary-accent-start)] to-[var(--primary-accent-end)] rounded-lg flex items-center justify-center text-white",children:e.jsx(z,{size:20})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("p",{className:"font-semibold text-sm text-[var(--text-primary)] truncate",children:[t.assemblyName," Assembly"]}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)]",children:[g(new Date(t.selectedDate)),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),e.jsxs("span",{className:"font-medium text-[var(--success-text)]",children:["GH₵ ",t.totalTitheAmount.toLocaleString()]}),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),e.jsxs("span",{className:"font-medium text-[var(--text-primary)]",children:[t.titherCount," Tithers"]}),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),e.jsxs("span",{className:"font-medium text-[var(--accent-purple)]",children:[t.soulsWonCount," Souls Won"]})]})]})]},t.id+t.timestamp))})]}):e.jsx("p",{className:"text-sm text-center py-8 text-[var(--text-muted)]",children:"No recent transactions logged."})]})]}),e.jsxs(m.section,{variants:x,className:"lg:col-span-3 content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(F,{size:22,className:"mr-3 icon-primary"}),"Weekly Tithe Trend"]}),e.jsx("p",{className:"text-sm text-center py-4 text-[var(--text-muted)]",children:"Showing data for the last 6 weeks."}),e.jsx(te,{data:I})]})]})]})};export{oe as default};

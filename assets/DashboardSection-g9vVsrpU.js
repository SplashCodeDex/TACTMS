import{c as N,u as $,r as d,R as P,f as v,j as e,m,U as A,S as q,a as Q,b as Z,d as J,A as K,e as X,B as T,g as C,h as L}from"./index-yWNfmXSW.js";import{S as y,A as b,D as _,T as F}from"./AnimatedNumber-DmAFb6Iu.js";import{B as ee}from"./BarChart--OhuH_5c.js";import{A as te}from"./activity-BvpFh8vC.js";/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const se=N("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ae=N("CloudUpload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const re=N("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]),oe=()=>{const{transactionLog:h=[],memberDatabase:i={},onStartNewWeek:z,onUploadFile:u,userProfile:D}=$(),[f,O]=d.useState(""),k=P.useRef(null),[w,j]=d.useState(!1),W=t=>{t.preventDefault(),j(!0)},Y=t=>{t.preventDefault(),j(!1)},U=t=>{var a;t.preventDefault(),j(!1);const s=((a=t.dataTransfer.files)==null?void 0:a[0])||null;u&&u(s,!1)},p=d.useMemo(()=>{const t=new Date().getFullYear(),s=h.filter(r=>new Date(r.selectedDate).getFullYear()===t).reduce((r,n)=>r+n.totalTitheAmount,0);let a=0;Object.values(i).forEach(r=>{r&&Array.isArray(r.data)&&r.data.forEach(n=>{if(n.firstSeenDate)try{new Date(n.firstSeenDate).getFullYear()===t&&a++}catch{}})});const l=Object.values(i).reduce((r,n)=>{var o;return r+(((o=n==null?void 0:n.data)==null?void 0:o.length)||0)},0),c=[...h].sort((r,n)=>n.timestamp-r.timestamp).slice(0,20);return{ytdTithe:s,ytdSouls:a,totalMembers:l,recentActivities:c}},[h,i]),E=d.useMemo(()=>{const s=new Date,a={};for(let l=0;l<6;l++){const c=new Date(s);c.setDate(c.getDate()-l*7);const r=`Week of ${v(c)}`;a[r]=0}return h.forEach(l=>{const c=new Date(l.selectedDate);for(let r=0;r<6;r++){const n=new Date(s);n.setDate(n.getDate()-r*7);const o=new Date(n);o.setDate(o.getDate()-o.getDay());const g=new Date(o);if(g.setDate(g.getDate()+6),c>=o&&c<=g){const V=`Week of ${v(n)}`;a[V]+=l.totalTitheAmount;break}}}),Object.entries(a).map(([l,c])=>({label:l,count:c})).reverse()},[h]),S=d.useMemo(()=>new Set(Object.keys(i).filter(t=>{var s,a;return((a=(s=i[t])==null?void 0:s.data)==null?void 0:a.length)>0})),[i]),H=()=>{f&&z(f)},I=()=>{var t;(t=k.current)==null||t.click()},R=t=>{var a;const s=((a=t.target.files)==null?void 0:a[0])||null;u&&u(s,!1),t.target&&(t.target.value="")},B={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},x={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},M=d.useMemo(()=>Object.values(i).flatMap(s=>(s==null?void 0:s.data)||[]).filter(s=>s.firstSeenDate).sort((s,a)=>{try{return new Date(a.firstSeenDate).getTime()-new Date(s.firstSeenDate).getTime()}catch{return 0}}).slice(0,20),[i]),G=d.useMemo(()=>{const t=new Date().getHours();return t<12?"Good morning":t<18?"Good afternoon":"Good evening"},[]);return e.jsxs(m.div,{className:"space-y-8",variants:B,initial:"hidden",animate:"visible",children:[e.jsxs(m.div,{variants:x,children:[e.jsxs("h1",{className:"text-3xl font-bold text-[var(--text-primary)]",children:[G,D?`, ${D.name.split(" ")[0]}`:"","."]}),e.jsx("p",{className:"text-lg text-[var(--text-secondary)]",children:"Here's your district's overview for today."})]}),e.jsxs(m.div,{variants:x,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(y,{icon:e.jsx(_,{}),label:`Year-to-Date Tithe (${new Date().getFullYear()})`,value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(b,{n:p.ytdTithe,formatter:t=>t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})}),e.jsx(y,{icon:e.jsx(F,{}),label:"Year-to-Date Souls Won",value:e.jsx(b,{n:p.ytdSouls})}),e.jsx(y,{icon:e.jsx(A,{}),label:"Total Members on Record",value:e.jsx(b,{n:p.totalMembers})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(m.section,{variants:x,className:"lg:col-span-2 content-card space-y-6",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(re,{size:22,className:"mr-3 icon-primary"}),"Quick Actions"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-6 bg-[var(--bg-elevated)] rounded-xl border border-[var(--border-color)] text-left space-y-4",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-primary)]",children:"Start New Weekly List"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Load the latest tithe list for an assembly."}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{htmlFor:"assembly-start-select-dash",className:"form-label",children:"Select Assembly"}),e.jsxs(q,{value:f,onValueChange:O,disabled:Object.keys(i).length===0,children:[e.jsx(Q,{id:"assembly-start-select-dash",className:"w-full",children:e.jsx(Z,{placeholder:"-- Select Assembly --"})}),e.jsx(J,{className:"glassmorphism-bg border border-[var(--border-color)] rounded-xl",children:K.map(t=>e.jsxs(X,{value:t,disabled:!S.has(t),children:[t," ",S.has(t)?"":"(No member data)"]},t))})]})]}),e.jsx(T,{onClick:H,disabled:!f,leftIcon:e.jsx(se,{size:16}),children:"Start"})]})]}),e.jsxs("div",{onDragOver:W,onDragLeave:Y,onDrop:U,className:`p-6 bg-[var(--bg-elevated)] rounded-xl border border-[var(--border-color)] text-left space-y-4 flex flex-col justify-center transition-all duration-300 ${w?"border-dashed border-[var(--primary-accent-start)] bg-[var(--primary-accent-start)]/10":""}`,children:[e.jsx("h3",{className:"font-semibold text-[var(--text-primary)]",children:"Upload a New List File"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"If you have a new file to process from an assembly."}),w?e.jsx("div",{className:"text-center py-4",children:e.jsx("p",{className:"text-lg font-semibold text-[var(--primary-accent-start)]",children:"Drop the file to upload"})}):e.jsx(T,{onClick:I,fullWidth:!0,variant:"secondary",size:"lg",leftIcon:e.jsx(ae,{size:18}),children:"Upload Excel File"}),e.jsx("input",{type:"file",ref:k,className:"hidden",accept:".xlsx,.xls",onChange:R})]})]})]}),e.jsxs("div",{className:"space-y-8",children:[e.jsxs(m.section,{variants:x,className:"content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(A,{size:22,className:"mr-3 icon-primary"}),"Recently Added Members"]}),M.length>0?e.jsxs(C,{className:"h-[200px]",children:[" ",e.jsx("ul",{className:"space-y-3 pr-4",children:M.map(t=>e.jsxs("li",{className:"flex items-center gap-4 p-3 rounded-lg hover:bg-[var(--bg-card-subtle-accent)] transition-colors",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 bg-gradient-to-br from-[var(--accent-purple)] to-[var(--accent-blue)] rounded-lg flex items-center justify-center text-white",children:e.jsx(L,{size:20})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("p",{className:"font-semibold text-sm text-[var(--text-primary)] truncate",children:[t["First Name"]," ",t.Surname]}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)]",children:[t.firstSeenSource,e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),v(new Date(t.firstSeenDate))]})]})]},t["No."]))})]}):e.jsx("p",{className:"text-sm text-center py-8 text-[var(--text-muted)]",children:"No new members recorded recently."})]}),e.jsxs(m.section,{variants:x,className:"content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(te,{size:22,className:"mr-3 icon-primary"}),"Recent Activity"]}),p.recentActivities.length>0?e.jsxs(C,{className:"h-[200px]",children:[" ",e.jsx("ul",{className:"space-y-3 pr-4",children:p.recentActivities.map(t=>e.jsxs("li",{className:"flex items-center gap-4 p-3 rounded-lg hover:bg-[var(--bg-card-subtle-accent)] transition-colors",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 bg-gradient-to-br from-[var(--primary-accent-start)] to-[var(--primary-accent-end)] rounded-lg flex items-center justify-center text-white",children:e.jsx(L,{size:20})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("p",{className:"font-semibold text-sm text-[var(--text-primary)] truncate",children:[t.assemblyName," Assembly"]}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)]",children:[v(new Date(t.selectedDate)),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),e.jsxs("span",{className:"font-medium text-[var(--success-text)]",children:["GH₵ ",t.totalTitheAmount.toLocaleString()]}),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),e.jsxs("span",{className:"font-medium text-[var(--text-primary)]",children:[t.titherCount," Tithers"]}),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:" • "}),e.jsxs("span",{className:"font-medium text-[var(--accent-purple)]",children:[t.soulsWonCount," Souls Won"]})]})]})]},t.id+t.timestamp))})]}):e.jsx("p",{className:"text-sm text-center py-8 text-[var(--text-muted)]",children:"No recent transactions logged."})]})]}),e.jsxs(m.section,{variants:x,className:"lg:col-span-3 content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(F,{size:22,className:"mr-3 icon-primary"}),"Weekly Tithe Trend"]}),e.jsx("p",{className:"text-sm text-center py-4 text-[var(--text-muted)]",children:"Showing data for the last 6 weeks."}),e.jsx(ee,{data:E})]})]})]})};export{oe as default};

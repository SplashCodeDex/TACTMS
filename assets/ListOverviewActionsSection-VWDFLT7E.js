import{c as p,j as e,m as E,R as ne,r as k,u as ie,B as N,U as oe,n as le,o as ce,i as me}from"./index-BQ4ypfwp.js";import{D as de,A as y,S as w,T as U}from"./AnimatedNumber-CCXKlarn.js";import{I as he}from"./InfoTooltip-CExBMEJp.js";import{A as xe}from"./activity-Cvl8wd8G.js";import{D as ue}from"./download-D3sm0sbz.js";/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=p("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=p("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=p("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const H=p("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fe=p("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ye=p("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const R=p("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),je=E.circle,Ne=E.span,Me=({percentage:v,size:s=100,strokeWidth:m=10,color:r})=>{const a=(s-m)/2,l=2*Math.PI*a,h=l-v/100*l,g=r||"var(--primary-accent-start)";return e.jsxs("div",{className:"relative",style:{width:s,height:s},children:[e.jsxs("svg",{width:s,height:s,viewBox:`0 0 ${s} ${s}`,className:"-rotate-90",children:[e.jsx("circle",{cx:s/2,cy:s/2,r:a,stroke:"var(--bg-card-subtle-accent)",strokeWidth:m,fill:"transparent"}),e.jsx(je,{cx:s/2,cy:s/2,r:a,stroke:g,strokeWidth:m,fill:"transparent",strokeDasharray:l,strokeDashoffset:l,strokeLinecap:"round",animate:{strokeDashoffset:h},transition:{duration:1.2,ease:"circOut"}})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs(Ne,{className:"text-xl font-bold text-[var(--text-primary)]",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},children:[Math.round(v),"%"]})})]})},be=E.section,P=({title:v,stats:s,defaultIcon:m})=>{const{change:r,current:a,previous:l}=s;if(l==null||l===0)return e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:v}),e.jsx(m,{size:20,className:"text-[var(--text-muted)]"})]}),e.jsx("p",{className:"text-xl font-bold mt-2 text-[var(--text-muted)]",children:"No Data"}),e.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"No past records to compare."})]});const h=r!==null&&r>0,g=r!==null&&r<0,M=h?"text-[var(--success-text)]":g?"text-[var(--danger-text)]":"text-[var(--text-secondary)]",T=h?U:g?R:m,D=()=>r===null?"N/A":r===1/0?"+∞%":`${r>=0?"+":""}${r.toFixed(1)}%`;return e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:v}),e.jsx(T,{size:20,className:M})]}),e.jsx("p",{className:`text-3xl font-bold mt-2 ${M}`,children:D()}),e.jsxs("p",{className:"text-xs text-[var(--text-muted)] mt-1 truncate",children:["GH₵ ",a.toLocaleString(void 0,{minimumFractionDigits:2})," vs GH₵ ",l.toLocaleString(void 0,{minimumFractionDigits:2})]})]})},ke=ne.memo(k.forwardRef((v,s)=>{const{currentAssembly:m,selectedDate:r,currentTotalTithe:a,hasUnsavedChanges:l,titheListData:h=[],tithersCount:g,nonTithersCount:M,tithersPercentage:T,setIsFullPreviewModalOpen:D,setIsDataEntryModalOpen:B,fileNameToSave:z,setFileNameToSave:K,inputErrors:C,setInputErrors:Z,handleDownloadExcel:_,openSaveFavoriteModal:J,onClearWorkspace:Q,transactionLog:O=[],soulsWonCount:X}=ie(),ee=t=>{const n=t.map(o=>({...o,amount:Number(o["Transaction Amount"])||0})).filter(o=>o.amount>0);let d=null,x=null;n.length>0&&(d=n.reduce((o,u)=>o.amount<u.amount?o:u),x=n.reduce((o,u)=>o.amount>u.amount?o:u));const j=d?d.amount:0,A=x?x.amount:0,b=d?d["Membership Number"]:void 0,f=x?x["Membership Number"]:void 0;return{lowestTitheAmount:j,highestTitheAmount:A,lowestTitherName:b,highestTitherName:f}},W=(t,n)=>n===null||n===0?t>0?1/0:0:(t-n)/n*100,te=(t,n,d,x)=>{const j=d instanceof Date&&!isNaN(d.getTime())?d:new Date,A=j.getMonth(),b=j.getFullYear(),f=new Date(j);f.setMonth(f.getMonth()-1);const o=f.getMonth(),u=f.getFullYear();let V=null,$=null,I=0;if(t&&t.length>0&&n){const Y=t.filter(i=>i.assemblyName===n);V=Y.filter(i=>{const c=new Date(i.selectedDate);return c.getMonth()===o&&c.getFullYear()===u}).reduce((i,c)=>i+c.totalTitheAmount,0),$=Y.filter(i=>{const c=new Date(i.selectedDate);return c.getMonth()===A&&c.getFullYear()===b-1}).reduce((i,c)=>i+c.totalTitheAmount,0),I=Y.filter(i=>new Date(i.selectedDate).getFullYear()===b).reduce((i,c)=>i+c.totalTitheAmount,0)}return I+=x,{lastMonthTotal:V,lastYearTotal:$,ytdTotal:I}},{lowestTitheAmount:q,highestTitheAmount:se,lowestTitherName:ae,highestTitherName:re}=k.useMemo(()=>ee(h),[h]),{lastMonthTotal:F,lastYearTotal:S,ytdTotal:G}=k.useMemo(()=>te(O,m,r,a),[O,m,r,a]),L=k.useMemo(()=>({vsLastMonth:{change:W(a,F),current:a,previous:F},vsLastYear:{change:W(a,S),current:a,previous:S},ytdTotal:G}),[a,F,S,G]);return h.length===0?null:e.jsxs(be,{ref:s,className:"space-y-8","aria-labelledby":"overview-actions-heading",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{id:"overview-actions-heading",className:"section-heading !border-b-0 !pb-0 !mb-0",children:[e.jsx(xe,{size:22,className:"mr-3 icon-primary"}),m," Assembly Dashboard"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(N,{onClick:()=>B(!0),variant:"outline",size:"md",leftIcon:e.jsx(fe,{size:16}),children:"Data Entry Mode"}),e.jsx(N,{onClick:()=>D(!0),variant:"secondary",size:"md",leftIcon:e.jsx(ye,{size:16}),children:"Full List View"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Total Amount"}),e.jsx(de,{size:20,className:"text-[var(--success-text)]"})]}),e.jsxs("p",{className:"text-4xl font-bold text-[var(--text-primary)] mt-2",children:["GH₵"," ",e.jsx(y,{n:a,formatter:t=>t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Participation"}),e.jsx(oe,{size:20,className:"text-[var(--primary-accent-start)]"})]}),e.jsxs("div",{className:"flex items-center justify-around mt-2",children:[e.jsx(Me,{percentage:T,size:90,strokeWidth:8}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-2xl text-[var(--text-primary)]",children:e.jsx(y,{n:g})}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Tithers"}),e.jsxs("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:[M," Non-tithers"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(w,{icon:e.jsx(le,{}),label:"Souls Won (New Members)",value:e.jsx(y,{n:X??0})}),e.jsx(w,{icon:e.jsx(U,{}),label:"Highest Tithe Amount",value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(y,{n:se,formatter:t=>t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),subValue:re}),e.jsx(w,{icon:e.jsx(R,{}),label:"Lowest Tithe Amount",value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(y,{n:q>0?q:0,formatter:t=>t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),subValue:ae})]})]}),e.jsxs("div",{className:"lg:col-span-2 content-card card-glow-on-hover flex flex-col",children:[e.jsxs("h3",{className:"text-lg font-semibold text-[var(--text-primary)] mb-4 flex items-center gap-2",children:[e.jsx(ue,{size:20})," Export & Save"]}),e.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fileNameToSave",className:"form-label",children:"File Name for Download"}),e.jsx("input",{type:"text",id:"fileNameToSave",value:z,onChange:t=>{K(t.target.value),Z(n=>({...n,fileName:""}))},className:`form-input-light ${C.fileName?"input-error":""}`,placeholder:"Enter file name"}),C.fileName&&e.jsx("p",{className:"form-error-text",children:C.fileName})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(N,{onClick:_,leftIcon:e.jsx(ge,{size:18}),disabled:!z.trim(),variant:"primary",fullWidth:!0,children:"Download Excel"}),e.jsx(N,{onClick:J,leftIcon:e.jsx(ce,{size:18}),variant:"outline",fullWidth:!0,children:"Save to Favorites"})]}),e.jsx(N,{onClick:Q,leftIcon:e.jsx(ve,{size:18}),variant:"subtle",className:"!text-[var(--danger-text)] hover:!bg-[var(--danger-start)]/10",fullWidth:!0,children:"Clear Workspace"})]}),l&&e.jsxs("p",{className:"text-xs text-[var(--warning-text)] mt-4 flex items-center gap-1.5",children:[e.jsx(me,{size:14})," List has been modified. Apply changes in 'Full List View' before saving or exporting for accuracy."]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"section-heading",children:[e.jsx(H,{size:22,className:"mr-3 icon-primary"}),"Historical Comparison",e.jsx(he,{text:"Compares the current list's total amount against data from your transaction log for the same assembly.",className:"ml-2"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(P,{title:"vs. Last Month",stats:L.vsLastMonth,defaultIcon:H}),e.jsx(P,{title:"vs. Last Year (Same Month)",stats:L.vsLastYear,defaultIcon:H}),e.jsx(w,{icon:e.jsx(pe,{}),label:"YTD Total (Live)",value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(y,{n:L.ytdTotal,formatter:t=>t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})})]})]})]})}));ke.displayName="ListOverviewActionsSection";export{ke as default};

import{c as v,u as R,r as x,R as B,f,j as e,m as d,U as S,A as O,B as M}from"./index-ryEH5VkR.js";import{S as j,A as g,D as I,T as A}from"./AnimatedNumber-oq8V70rv.js";import{B as G}from"./BarChart-C7yB948o.js";import{A as $}from"./activity-CGsZBJZ_.js";/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const P=v("Building2",[["path",{d:"M6 22V4a2 2 0 0 1 2-2h8a2 2 0 0 1 2 2v18Z",key:"1b4qmf"}],["path",{d:"M6 12H4a2 2 0 0 0-2 2v6a2 2 0 0 0 2 2h2",key:"i71pzd"}],["path",{d:"M18 9h2a2 2 0 0 1 2 2v9a2 2 0 0 1-2 2h-2",key:"10jefs"}],["path",{d:"M10 6h4",key:"1itunk"}],["path",{d:"M10 10h4",key:"tcdvrf"}],["path",{d:"M10 14h4",key:"kelpxr"}],["path",{d:"M10 18h4",key:"1ulq68"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const V=v("CloudUpload",[["path",{d:"M4 14.899A7 7 0 1 1 15.71 8h1.79a4.5 4.5 0 0 1 2.5 8.242",key:"1pljnt"}],["path",{d:"M12 12v9",key:"192myk"}],["path",{d:"m16 16-4-4-4 4",key:"119tzi"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const q=v("ListPlus",[["path",{d:"M11 12H3",key:"51ecnj"}],["path",{d:"M16 6H3",key:"1wxfjs"}],["path",{d:"M16 18H3",key:"12xzn7"}],["path",{d:"M18 9v6",key:"1twb98"}],["path",{d:"M21 12h-6",key:"bt1uis"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const T=v("User",[["path",{d:"M19 21v-2a4 4 0 0 0-4-4H9a4 4 0 0 0-4 4v2",key:"975kel"}],["circle",{cx:"12",cy:"7",r:"4",key:"17ys0d"}]]),X=()=>{const{transactionLog:h=[],memberDatabase:l={},onStartNewWeek:C,onUploadFile:b,userProfile:N}=R(),[p,F]=x.useState(""),k=B.useRef(null),u=x.useMemo(()=>{const t=new Date().getFullYear(),s=h.filter(a=>new Date(a.selectedDate).getFullYear()===t).reduce((a,r)=>a+r.totalTitheAmount,0);let n=0;Object.values(l).forEach(a=>{a&&Array.isArray(a.data)&&a.data.forEach(r=>{if(r.firstSeenDate)try{new Date(r.firstSeenDate).getFullYear()===t&&n++}catch{}})});const i=Object.values(l).reduce((a,r)=>{var o;return a+(((o=r==null?void 0:r.data)==null?void 0:o.length)||0)},0),c=[...h].sort((a,r)=>r.timestamp-a.timestamp).slice(0,10);return{ytdTithe:s,ytdSouls:n,totalMembers:i,recentActivities:c}},[h,l]),z=x.useMemo(()=>{const s=new Date,n={};for(let i=0;i<6;i++){const c=new Date(s);c.setDate(c.getDate()-i*7);const a=`Week of ${f(c)}`;n[a]=0}return h.forEach(i=>{const c=new Date(i.selectedDate);for(let a=0;a<6;a++){const r=new Date(s);r.setDate(r.getDate()-a*7);const o=new Date(r);o.setDate(o.getDate()-o.getDay());const y=new Date(o);if(y.setDate(y.getDate()+6),c>=o&&c<=y){const H=`Week of ${f(r)}`;n[H]+=i.totalTitheAmount;break}}}),Object.entries(n).map(([i,c])=>({label:i,count:c})).reverse()},[h]),w=x.useMemo(()=>new Set(Object.keys(l).filter(t=>{var s,n;return((n=(s=l[t])==null?void 0:s.data)==null?void 0:n.length)>0})),[l]),L=()=>{p&&C(p)},U=()=>{var t;(t=k.current)==null||t.click()},W=t=>{var n;const s=((n=t.target.files)==null?void 0:n[0])||null;b&&b(s,!1),t.target&&(t.target.value="")},Y={hidden:{opacity:0},visible:{opacity:1,transition:{staggerChildren:.1}}},m={hidden:{opacity:0,y:20},visible:{opacity:1,y:0}},D=x.useMemo(()=>Object.values(l).flatMap(s=>(s==null?void 0:s.data)||[]).filter(s=>s.firstSeenDate).sort((s,n)=>{try{return new Date(n.firstSeenDate).getTime()-new Date(s.firstSeenDate).getTime()}catch{return 0}}).slice(0,10),[l]),E=x.useMemo(()=>{const t=new Date().getHours();return t<12?"Good morning":t<18?"Good afternoon":"Good evening"},[]);return e.jsxs(d.div,{className:"space-y-8",variants:Y,initial:"hidden",animate:"visible",children:[e.jsxs(d.div,{variants:m,children:[e.jsxs("h1",{className:"text-3xl font-bold text-[var(--text-primary)]",children:[E,N?`, ${N.name.split(" ")[0]}`:"","."]}),e.jsx("p",{className:"text-lg text-[var(--text-secondary)]",children:"Here's your district's overview for today."})]}),e.jsxs(d.div,{variants:m,className:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6",children:[e.jsx(j,{icon:e.jsx(I,{}),label:`Year-to-Date Tithe (${new Date().getFullYear()})`,value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(g,{n:u.ytdTithe,formatter:t=>t.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})}),e.jsx(j,{icon:e.jsx(A,{}),label:"Year-to-Date Souls Won",value:e.jsx(g,{n:u.ytdSouls})}),e.jsx(j,{icon:e.jsx(S,{}),label:"Total Members on Record",value:e.jsx(g,{n:u.totalMembers})})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-3 gap-8",children:[e.jsxs(d.section,{variants:m,className:"lg:col-span-2 content-card space-y-6",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(q,{size:22,className:"mr-3 icon-primary"}),"Quick Actions"]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-8",children:[e.jsxs("div",{className:"p-6 bg-[var(--bg-elevated)] rounded-xl border border-[var(--border-color)] text-left space-y-4",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-primary)]",children:"Start New Weekly List"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Load the latest tithe list for an assembly."}),e.jsxs("div",{className:"flex items-end gap-3",children:[e.jsxs("div",{className:"flex-grow",children:[e.jsx("label",{htmlFor:"assembly-start-select-dash",className:"form-label",children:"Select Assembly"}),e.jsxs("select",{id:"assembly-start-select-dash",value:p,onChange:t=>F(t.target.value),className:"form-input-light w-full",disabled:Object.keys(l).length===0,children:[e.jsx("option",{value:"",disabled:!0,children:"-- Select Assembly --"}),O.map(t=>e.jsxs("option",{value:t,disabled:!w.has(t),children:[t," ",w.has(t)?"":"(No member data)"]},t))]})]}),e.jsx(M,{onClick:L,disabled:!p,leftIcon:e.jsx(P,{size:16}),children:"Start"})]})]}),e.jsxs("div",{className:"p-6 bg-[var(--bg-elevated)] rounded-xl border border-[var(--border-color)] text-left space-y-4 flex flex-col justify-center",children:[e.jsx("h3",{className:"font-semibold text-[var(--text-primary)]",children:"Upload a New List File"}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"If you have a new file to process from an assembly."}),e.jsx(M,{onClick:U,fullWidth:!0,variant:"secondary",size:"lg",leftIcon:e.jsx(V,{size:18}),children:"Upload Excel File"}),e.jsx("input",{type:"file",ref:k,className:"hidden",accept:".xlsx,.xls",onChange:W})]})]})]}),e.jsxs(d.section,{variants:m,className:"content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(S,{size:22,className:"mr-3 icon-primary"}),"Recently Added Members"]}),D.length>0?e.jsx("ul",{className:"space-y-3",children:D.map(t=>e.jsxs("li",{className:"flex items-center gap-4 p-3 rounded-lg hover:bg-[var(--bg-card-subtle-accent)] transition-colors",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 bg-gradient-to-br from-[var(--accent-purple)] to-[var(--accent-blue)] rounded-lg flex items-center justify-center text-white",children:e.jsx(T,{size:20})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("p",{className:"font-semibold text-sm text-[var(--text-primary)] truncate",children:[t["First Name"]," ",t.Surname]}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)]",children:[t.firstSeenSource,e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:"•"}),f(new Date(t.firstSeenDate))]})]})]},t["No."]))}):e.jsx("p",{className:"text-sm text-center py-8 text-[var(--text-muted)]",children:"No new members recorded recently."})]}),e.jsxs(d.section,{variants:m,className:"content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx($,{size:22,className:"mr-3 icon-primary"}),"Recent Activity"]}),u.recentActivities.length>0?e.jsx("ul",{className:"space-y-3",children:u.recentActivities.map(t=>e.jsxs("li",{className:"flex items-center gap-4 p-3 rounded-lg hover:bg-[var(--bg-card-subtle-accent)] transition-colors",children:[e.jsx("div",{className:"w-10 h-10 flex-shrink-0 bg-gradient-to-br from-[var(--primary-accent-start)] to-[var(--primary-accent-end)] rounded-lg flex items-center justify-center text-white",children:e.jsx(T,{size:20})}),e.jsxs("div",{className:"overflow-hidden",children:[e.jsxs("p",{className:"font-semibold text-sm text-[var(--text-primary)] truncate",children:[t.assemblyName," Assembly"]}),e.jsxs("p",{className:"text-xs text-[var(--text-secondary)]",children:[f(new Date(t.selectedDate)),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:"•"}),e.jsxs("span",{className:"font-medium text-[var(--success-text)]",children:["GH₵ ",t.totalTitheAmount.toLocaleString()]}),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:"•"}),e.jsxs("span",{className:"font-medium text-[var(--text-primary)]",children:[t.titherCount," Tithers"]}),e.jsx("span",{className:"text-[var(--text-muted)] mx-1",children:"•"}),e.jsxs("span",{className:"font-medium text-[var(--accent-purple)]",children:[t.soulsWonCount," Souls Won"]})]})]})]},t.id+t.timestamp))}):e.jsx("p",{className:"text-sm text-center py-8 text-[var(--text-muted)]",children:"No recent transactions logged."})]})]}),e.jsxs(d.section,{variants:m,className:"content-card",children:[e.jsxs("h2",{className:"section-heading",children:[e.jsx(A,{size:22,className:"mr-3 icon-primary"}),"Weekly Tithe Trend"]}),e.jsx("p",{className:"text-sm text-center py-4 text-[var(--text-muted)]",children:"Showing data for the last 6 weeks."}),e.jsx(G,{data:z})]})]})};export{X as default};

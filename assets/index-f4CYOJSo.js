const __vite__mapDeps=(i,m=__vite__mapDeps,d=(m.f||(m.f=["assets/DashboardSection-BA_92nEJ.js","assets/AnimatedNumber-CWg5w3ls.js","assets/activity-C2dPr1H2.js","assets/ReportsSection-D9ZTl2Uj.js","assets/ListOverviewActionsSection-DkyMiZDI.js","assets/InfoTooltip-D9bdJ1Vs.js","assets/ConfigurationSection-BlhjtupV.js"])))=>i.map(i=>d[i]);
var By=e=>{throw TypeError(e)};var pp=(e,t,n)=>t.has(e)||By("Cannot "+n);var K=(e,t,n)=>(pp(e,t,"read from private field"),n?n.call(e):t.get(e)),Ye=(e,t,n)=>t.has(e)?By("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Be=(e,t,n,r)=>(pp(e,t,"write to private field"),r?r.call(e,n):t.set(e,n),n),ct=(e,t,n)=>(pp(e,t,"access private method"),n);var ld=(e,t,n,r)=>({set _(i){Be(e,t,i,n)},get _(){return K(e,t,r)}});(function(){const t=document.createElement("link").relList;if(t&&t.supports&&t.supports("modulepreload"))return;for(const i of document.querySelectorAll('link[rel="modulepreload"]'))r(i);new MutationObserver(i=>{for(const s of i)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&r(a)}).observe(document,{childList:!0,subtree:!0});function n(i){const s={};return i.integrity&&(s.integrity=i.integrity),i.referrerPolicy&&(s.referrerPolicy=i.referrerPolicy),i.crossOrigin==="use-credentials"?s.credentials="include":i.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function r(i){if(i.ep)return;i.ep=!0;const s=n(i);fetch(i.href,s)}})();function u2(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e.default:e}var c2={exports:{}},Ch={},f2={exports:{}},vt={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var If=Symbol.for("react.element"),JI=Symbol.for("react.portal"),QI=Symbol.for("react.fragment"),jI=Symbol.for("react.strict_mode"),ZI=Symbol.for("react.profiler"),eN=Symbol.for("react.provider"),tN=Symbol.for("react.context"),nN=Symbol.for("react.forward_ref"),rN=Symbol.for("react.suspense"),iN=Symbol.for("react.memo"),sN=Symbol.for("react.lazy"),Uy=Symbol.iterator;function aN(e){return e===null||typeof e!="object"?null:(e=Uy&&e[Uy]||e["@@iterator"],typeof e=="function"?e:null)}var d2={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},h2=Object.assign,p2={};function Tu(e,t,n){this.props=e,this.context=t,this.refs=p2,this.updater=n||d2}Tu.prototype.isReactComponent={};Tu.prototype.setState=function(e,t){if(typeof e!="object"&&typeof e!="function"&&e!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,e,t,"setState")};Tu.prototype.forceUpdate=function(e){this.updater.enqueueForceUpdate(this,e,"forceUpdate")};function m2(){}m2.prototype=Tu.prototype;function Iv(e,t,n){this.props=e,this.context=t,this.refs=p2,this.updater=n||d2}var Nv=Iv.prototype=new m2;Nv.constructor=Iv;h2(Nv,Tu.prototype);Nv.isPureReactComponent=!0;var Vy=Array.isArray,g2=Object.prototype.hasOwnProperty,bv={current:null},v2={key:!0,ref:!0,__self:!0,__source:!0};function x2(e,t,n){var r,i={},s=null,a=null;if(t!=null)for(r in t.ref!==void 0&&(a=t.ref),t.key!==void 0&&(s=""+t.key),t)g2.call(t,r)&&!v2.hasOwnProperty(r)&&(i[r]=t[r]);var o=arguments.length-2;if(o===1)i.children=n;else if(1<o){for(var l=Array(o),u=0;u<o;u++)l[u]=arguments[u+2];i.children=l}if(e&&e.defaultProps)for(r in o=e.defaultProps,o)i[r]===void 0&&(i[r]=o[r]);return{$$typeof:If,type:e,key:s,ref:a,props:i,_owner:bv.current}}function oN(e,t){return{$$typeof:If,type:e.type,key:t,ref:e.ref,props:e.props,_owner:e._owner}}function Lv(e){return typeof e=="object"&&e!==null&&e.$$typeof===If}function lN(e){var t={"=":"=0",":":"=2"};return"$"+e.replace(/[=:]/g,function(n){return t[n]})}var Hy=/\/+/g;function mp(e,t){return typeof e=="object"&&e!==null&&e.key!=null?lN(""+e.key):t.toString(36)}function Xd(e,t,n,r,i){var s=typeof e;(s==="undefined"||s==="boolean")&&(e=null);var a=!1;if(e===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(e.$$typeof){case If:case JI:a=!0}}if(a)return a=e,i=i(a),e=r===""?"."+mp(a,0):r,Vy(i)?(n="",e!=null&&(n=e.replace(Hy,"$&/")+"/"),Xd(i,t,n,"",function(u){return u})):i!=null&&(Lv(i)&&(i=oN(i,n+(!i.key||a&&a.key===i.key?"":(""+i.key).replace(Hy,"$&/")+"/")+e)),t.push(i)),1;if(a=0,r=r===""?".":r+":",Vy(e))for(var o=0;o<e.length;o++){s=e[o];var l=r+mp(s,o);a+=Xd(s,t,n,l,i)}else if(l=aN(e),typeof l=="function")for(e=l.call(e),o=0;!(s=e.next()).done;)s=s.value,l=r+mp(s,o++),a+=Xd(s,t,n,l,i);else if(s==="object")throw t=String(e),Error("Objects are not valid as a React child (found: "+(t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t)+"). If you meant to render a collection of children, use an array instead.");return a}function ud(e,t,n){if(e==null)return e;var r=[],i=0;return Xd(e,r,"","",function(s){return t.call(n,s,i++)}),r}function uN(e){if(e._status===-1){var t=e._result;t=t(),t.then(function(n){(e._status===0||e._status===-1)&&(e._status=1,e._result=n)},function(n){(e._status===0||e._status===-1)&&(e._status=2,e._result=n)}),e._status===-1&&(e._status=0,e._result=t)}if(e._status===1)return e._result.default;throw e._result}var Cr={current:null},Jd={transition:null},cN={ReactCurrentDispatcher:Cr,ReactCurrentBatchConfig:Jd,ReactCurrentOwner:bv};function y2(){throw Error("act(...) is not supported in production builds of React.")}vt.Children={map:ud,forEach:function(e,t,n){ud(e,function(){t.apply(this,arguments)},n)},count:function(e){var t=0;return ud(e,function(){t++}),t},toArray:function(e){return ud(e,function(t){return t})||[]},only:function(e){if(!Lv(e))throw Error("React.Children.only expected to receive a single React element child.");return e}};vt.Component=Tu;vt.Fragment=QI;vt.Profiler=ZI;vt.PureComponent=Iv;vt.StrictMode=jI;vt.Suspense=rN;vt.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=cN;vt.act=y2;vt.cloneElement=function(e,t,n){if(e==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+e+".");var r=h2({},e.props),i=e.key,s=e.ref,a=e._owner;if(t!=null){if(t.ref!==void 0&&(s=t.ref,a=bv.current),t.key!==void 0&&(i=""+t.key),e.type&&e.type.defaultProps)var o=e.type.defaultProps;for(l in t)g2.call(t,l)&&!v2.hasOwnProperty(l)&&(r[l]=t[l]===void 0&&o!==void 0?o[l]:t[l])}var l=arguments.length-2;if(l===1)r.children=n;else if(1<l){o=Array(l);for(var u=0;u<l;u++)o[u]=arguments[u+2];r.children=o}return{$$typeof:If,type:e.type,key:i,ref:s,props:r,_owner:a}};vt.createContext=function(e){return e={$$typeof:tN,_currentValue:e,_currentValue2:e,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},e.Provider={$$typeof:eN,_context:e},e.Consumer=e};vt.createElement=x2;vt.createFactory=function(e){var t=x2.bind(null,e);return t.type=e,t};vt.createRef=function(){return{current:null}};vt.forwardRef=function(e){return{$$typeof:nN,render:e}};vt.isValidElement=Lv;vt.lazy=function(e){return{$$typeof:sN,_payload:{_status:-1,_result:e},_init:uN}};vt.memo=function(e,t){return{$$typeof:iN,type:e,compare:t===void 0?null:t}};vt.startTransition=function(e){var t=Jd.transition;Jd.transition={};try{e()}finally{Jd.transition=t}};vt.unstable_act=y2;vt.useCallback=function(e,t){return Cr.current.useCallback(e,t)};vt.useContext=function(e){return Cr.current.useContext(e)};vt.useDebugValue=function(){};vt.useDeferredValue=function(e){return Cr.current.useDeferredValue(e)};vt.useEffect=function(e,t){return Cr.current.useEffect(e,t)};vt.useId=function(){return Cr.current.useId()};vt.useImperativeHandle=function(e,t,n){return Cr.current.useImperativeHandle(e,t,n)};vt.useInsertionEffect=function(e,t){return Cr.current.useInsertionEffect(e,t)};vt.useLayoutEffect=function(e,t){return Cr.current.useLayoutEffect(e,t)};vt.useMemo=function(e,t){return Cr.current.useMemo(e,t)};vt.useReducer=function(e,t,n){return Cr.current.useReducer(e,t,n)};vt.useRef=function(e){return Cr.current.useRef(e)};vt.useState=function(e){return Cr.current.useState(e)};vt.useSyncExternalStore=function(e,t,n){return Cr.current.useSyncExternalStore(e,t,n)};vt.useTransition=function(){return Cr.current.useTransition()};vt.version="18.3.1";f2.exports=vt;var E=f2.exports;const xt=u2(E);/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var fN=E,dN=Symbol.for("react.element"),hN=Symbol.for("react.fragment"),pN=Object.prototype.hasOwnProperty,mN=fN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,gN={key:!0,ref:!0,__self:!0,__source:!0};function w2(e,t,n){var r,i={},s=null,a=null;n!==void 0&&(s=""+n),t.key!==void 0&&(s=""+t.key),t.ref!==void 0&&(a=t.ref);for(r in t)pN.call(t,r)&&!gN.hasOwnProperty(r)&&(i[r]=t[r]);if(e&&e.defaultProps)for(r in t=e.defaultProps,t)i[r]===void 0&&(i[r]=t[r]);return{$$typeof:dN,type:e,key:s,ref:a,props:i,_owner:mN.current}}Ch.Fragment=hN;Ch.jsx=w2;Ch.jsxs=w2;c2.exports=Ch;var R=c2.exports,km={},T2={exports:{}},ei={},S2={exports:{}},E2={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(e){function t(ne,H){var fe=ne.length;ne.push(H);e:for(;0<fe;){var xe=fe-1>>>1,L=ne[xe];if(0<i(L,H))ne[xe]=H,ne[fe]=L,fe=xe;else break e}}function n(ne){return ne.length===0?null:ne[0]}function r(ne){if(ne.length===0)return null;var H=ne[0],fe=ne.pop();if(fe!==H){ne[0]=fe;e:for(var xe=0,L=ne.length,q=L>>>1;xe<q;){var W=2*(xe+1)-1,G=ne[W],ee=W+1,Se=ne[ee];if(0>i(G,fe))ee<L&&0>i(Se,G)?(ne[xe]=Se,ne[ee]=fe,xe=ee):(ne[xe]=G,ne[W]=fe,xe=W);else if(ee<L&&0>i(Se,fe))ne[xe]=Se,ne[ee]=fe,xe=ee;else break e}}return H}function i(ne,H){var fe=ne.sortIndex-H.sortIndex;return fe!==0?fe:ne.id-H.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;e.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();e.unstable_now=function(){return a.now()-o}}var l=[],u=[],c=1,h=null,p=3,m=!1,v=!1,g=!1,w=typeof setTimeout=="function"?setTimeout:null,x=typeof clearTimeout=="function"?clearTimeout:null,T=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function y(ne){for(var H=n(u);H!==null;){if(H.callback===null)r(u);else if(H.startTime<=ne)r(u),H.sortIndex=H.expirationTime,t(l,H);else break;H=n(u)}}function _(ne){if(g=!1,y(ne),!v)if(n(l)!==null)v=!0,de(k);else{var H=n(u);H!==null&&ae(_,H.startTime-ne)}}function k(ne,H){v=!1,g&&(g=!1,x(M),M=-1),m=!0;var fe=p;try{for(y(H),h=n(l);h!==null&&(!(h.expirationTime>H)||ne&&!V());){var xe=h.callback;if(typeof xe=="function"){h.callback=null,p=h.priorityLevel;var L=xe(h.expirationTime<=H);H=e.unstable_now(),typeof L=="function"?h.callback=L:h===n(l)&&r(l),y(H)}else r(l);h=n(l)}if(h!==null)var q=!0;else{var W=n(u);W!==null&&ae(_,W.startTime-H),q=!1}return q}finally{h=null,p=fe,m=!1}}var S=!1,C=null,M=-1,F=5,b=-1;function V(){return!(e.unstable_now()-b<F)}function z(){if(C!==null){var ne=e.unstable_now();b=ne;var H=!0;try{H=C(!0,ne)}finally{H?ie():(S=!1,C=null)}}else S=!1}var ie;if(typeof T=="function")ie=function(){T(z)};else if(typeof MessageChannel<"u"){var Q=new MessageChannel,se=Q.port2;Q.port1.onmessage=z,ie=function(){se.postMessage(null)}}else ie=function(){w(z,0)};function de(ne){C=ne,S||(S=!0,ie())}function ae(ne,H){M=w(function(){ne(e.unstable_now())},H)}e.unstable_IdlePriority=5,e.unstable_ImmediatePriority=1,e.unstable_LowPriority=4,e.unstable_NormalPriority=3,e.unstable_Profiling=null,e.unstable_UserBlockingPriority=2,e.unstable_cancelCallback=function(ne){ne.callback=null},e.unstable_continueExecution=function(){v||m||(v=!0,de(k))},e.unstable_forceFrameRate=function(ne){0>ne||125<ne?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):F=0<ne?Math.floor(1e3/ne):5},e.unstable_getCurrentPriorityLevel=function(){return p},e.unstable_getFirstCallbackNode=function(){return n(l)},e.unstable_next=function(ne){switch(p){case 1:case 2:case 3:var H=3;break;default:H=p}var fe=p;p=H;try{return ne()}finally{p=fe}},e.unstable_pauseExecution=function(){},e.unstable_requestPaint=function(){},e.unstable_runWithPriority=function(ne,H){switch(ne){case 1:case 2:case 3:case 4:case 5:break;default:ne=3}var fe=p;p=ne;try{return H()}finally{p=fe}},e.unstable_scheduleCallback=function(ne,H,fe){var xe=e.unstable_now();switch(typeof fe=="object"&&fe!==null?(fe=fe.delay,fe=typeof fe=="number"&&0<fe?xe+fe:xe):fe=xe,ne){case 1:var L=-1;break;case 2:L=250;break;case 5:L=1073741823;break;case 4:L=1e4;break;default:L=5e3}return L=fe+L,ne={id:c++,callback:H,priorityLevel:ne,startTime:fe,expirationTime:L,sortIndex:-1},fe>xe?(ne.sortIndex=fe,t(u,ne),n(l)===null&&ne===n(u)&&(g?(x(M),M=-1):g=!0,ae(_,fe-xe))):(ne.sortIndex=L,t(l,ne),v||m||(v=!0,de(k))),ne},e.unstable_shouldYield=V,e.unstable_wrapCallback=function(ne){var H=p;return function(){var fe=p;p=H;try{return ne.apply(this,arguments)}finally{p=fe}}}})(E2);S2.exports=E2;var vN=S2.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var xN=E,Qr=vN;function ke(e){for(var t="https://reactjs.org/docs/error-decoder.html?invariant="+e,n=1;n<arguments.length;n++)t+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+e+"; visit "+t+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var _2=new Set,Bc={};function $o(e,t){au(e,t),au(e+"Capture",t)}function au(e,t){for(Bc[e]=t,e=0;e<t.length;e++)_2.add(t[e])}var Ns=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Am=Object.prototype.hasOwnProperty,yN=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,$y={},zy={};function wN(e){return Am.call(zy,e)?!0:Am.call($y,e)?!1:yN.test(e)?zy[e]=!0:($y[e]=!0,!1)}function TN(e,t,n,r){if(n!==null&&n.type===0)return!1;switch(typeof t){case"function":case"symbol":return!0;case"boolean":return r?!1:n!==null?!n.acceptsBooleans:(e=e.toLowerCase().slice(0,5),e!=="data-"&&e!=="aria-");default:return!1}}function SN(e,t,n,r){if(t===null||typeof t>"u"||TN(e,t,n,r))return!0;if(r)return!1;if(n!==null)switch(n.type){case 3:return!t;case 4:return t===!1;case 5:return isNaN(t);case 6:return isNaN(t)||1>t}return!1}function kr(e,t,n,r,i,s,a){this.acceptsBooleans=t===2||t===3||t===4,this.attributeName=r,this.attributeNamespace=i,this.mustUseProperty=n,this.propertyName=e,this.type=t,this.sanitizeURL=s,this.removeEmptyString=a}var Zn={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(e){Zn[e]=new kr(e,0,!1,e,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(e){var t=e[0];Zn[t]=new kr(t,1,!1,e[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(e){Zn[e]=new kr(e,2,!1,e.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(e){Zn[e]=new kr(e,2,!1,e,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(e){Zn[e]=new kr(e,3,!1,e.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(e){Zn[e]=new kr(e,3,!0,e,null,!1,!1)});["capture","download"].forEach(function(e){Zn[e]=new kr(e,4,!1,e,null,!1,!1)});["cols","rows","size","span"].forEach(function(e){Zn[e]=new kr(e,6,!1,e,null,!1,!1)});["rowSpan","start"].forEach(function(e){Zn[e]=new kr(e,5,!1,e.toLowerCase(),null,!1,!1)});var Ov=/[\-:]([a-z])/g;function Bv(e){return e[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(e){var t=e.replace(Ov,Bv);Zn[t]=new kr(t,1,!1,e,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(e){var t=e.replace(Ov,Bv);Zn[t]=new kr(t,1,!1,e,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(e){var t=e.replace(Ov,Bv);Zn[t]=new kr(t,1,!1,e,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(e){Zn[e]=new kr(e,1,!1,e.toLowerCase(),null,!1,!1)});Zn.xlinkHref=new kr("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(e){Zn[e]=new kr(e,1,!1,e.toLowerCase(),null,!0,!0)});function Uv(e,t,n,r){var i=Zn.hasOwnProperty(t)?Zn[t]:null;(i!==null?i.type!==0:r||!(2<t.length)||t[0]!=="o"&&t[0]!=="O"||t[1]!=="n"&&t[1]!=="N")&&(SN(t,n,i,r)&&(n=null),r||i===null?wN(t)&&(n===null?e.removeAttribute(t):e.setAttribute(t,""+n)):i.mustUseProperty?e[i.propertyName]=n===null?i.type===3?!1:"":n:(t=i.attributeName,r=i.attributeNamespace,n===null?e.removeAttribute(t):(i=i.type,n=i===3||i===4&&n===!0?"":""+n,r?e.setAttributeNS(r,t,n):e.setAttribute(t,n))))}var Vs=xN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,cd=Symbol.for("react.element"),dl=Symbol.for("react.portal"),hl=Symbol.for("react.fragment"),Vv=Symbol.for("react.strict_mode"),Rm=Symbol.for("react.profiler"),C2=Symbol.for("react.provider"),k2=Symbol.for("react.context"),Hv=Symbol.for("react.forward_ref"),Mm=Symbol.for("react.suspense"),Fm=Symbol.for("react.suspense_list"),$v=Symbol.for("react.memo"),Qs=Symbol.for("react.lazy"),A2=Symbol.for("react.offscreen"),Wy=Symbol.iterator;function Hu(e){return e===null||typeof e!="object"?null:(e=Wy&&e[Wy]||e["@@iterator"],typeof e=="function"?e:null)}var cn=Object.assign,gp;function tc(e){if(gp===void 0)try{throw Error()}catch(n){var t=n.stack.trim().match(/\n( *(at )?)/);gp=t&&t[1]||""}return`
`+gp+e}var vp=!1;function xp(e,t){if(!e||vp)return"";vp=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(t)if(t=function(){throw Error()},Object.defineProperty(t.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(t,[])}catch(u){var r=u}Reflect.construct(e,[],t)}else{try{t.call()}catch(u){r=u}e.call(t.prototype)}else{try{throw Error()}catch(u){r=u}e()}}catch(u){if(u&&r&&typeof u.stack=="string"){for(var i=u.stack.split(`
`),s=r.stack.split(`
`),a=i.length-1,o=s.length-1;1<=a&&0<=o&&i[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(i[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||i[a]!==s[o]){var l=`
`+i[a].replace(" at new "," at ");return e.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",e.displayName)),l}while(1<=a&&0<=o);break}}}finally{vp=!1,Error.prepareStackTrace=n}return(e=e?e.displayName||e.name:"")?tc(e):""}function EN(e){switch(e.tag){case 5:return tc(e.type);case 16:return tc("Lazy");case 13:return tc("Suspense");case 19:return tc("SuspenseList");case 0:case 2:case 15:return e=xp(e.type,!1),e;case 11:return e=xp(e.type.render,!1),e;case 1:return e=xp(e.type,!0),e;default:return""}}function Dm(e){if(e==null)return null;if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e;switch(e){case hl:return"Fragment";case dl:return"Portal";case Rm:return"Profiler";case Vv:return"StrictMode";case Mm:return"Suspense";case Fm:return"SuspenseList"}if(typeof e=="object")switch(e.$$typeof){case k2:return(e.displayName||"Context")+".Consumer";case C2:return(e._context.displayName||"Context")+".Provider";case Hv:var t=e.render;return e=e.displayName,e||(e=t.displayName||t.name||"",e=e!==""?"ForwardRef("+e+")":"ForwardRef"),e;case $v:return t=e.displayName||null,t!==null?t:Dm(e.type)||"Memo";case Qs:t=e._payload,e=e._init;try{return Dm(e(t))}catch{}}return null}function _N(e){var t=e.type;switch(e.tag){case 24:return"Cache";case 9:return(t.displayName||"Context")+".Consumer";case 10:return(t._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return e=t.render,e=e.displayName||e.name||"",t.displayName||(e!==""?"ForwardRef("+e+")":"ForwardRef");case 7:return"Fragment";case 5:return t;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return Dm(t);case 8:return t===Vv?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t}return null}function Ma(e){switch(typeof e){case"boolean":case"number":case"string":case"undefined":return e;case"object":return e;default:return""}}function R2(e){var t=e.type;return(e=e.nodeName)&&e.toLowerCase()==="input"&&(t==="checkbox"||t==="radio")}function CN(e){var t=R2(e)?"checked":"value",n=Object.getOwnPropertyDescriptor(e.constructor.prototype,t),r=""+e[t];if(!e.hasOwnProperty(t)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var i=n.get,s=n.set;return Object.defineProperty(e,t,{configurable:!0,get:function(){return i.call(this)},set:function(a){r=""+a,s.call(this,a)}}),Object.defineProperty(e,t,{enumerable:n.enumerable}),{getValue:function(){return r},setValue:function(a){r=""+a},stopTracking:function(){e._valueTracker=null,delete e[t]}}}}function fd(e){e._valueTracker||(e._valueTracker=CN(e))}function M2(e){if(!e)return!1;var t=e._valueTracker;if(!t)return!0;var n=t.getValue(),r="";return e&&(r=R2(e)?e.checked?"true":"false":e.value),e=r,e!==n?(t.setValue(e),!0):!1}function y0(e){if(e=e||(typeof document<"u"?document:void 0),typeof e>"u")return null;try{return e.activeElement||e.body}catch{return e.body}}function Pm(e,t){var n=t.checked;return cn({},t,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??e._wrapperState.initialChecked})}function Gy(e,t){var n=t.defaultValue==null?"":t.defaultValue,r=t.checked!=null?t.checked:t.defaultChecked;n=Ma(t.value!=null?t.value:n),e._wrapperState={initialChecked:r,initialValue:n,controlled:t.type==="checkbox"||t.type==="radio"?t.checked!=null:t.value!=null}}function F2(e,t){t=t.checked,t!=null&&Uv(e,"checked",t,!1)}function Im(e,t){F2(e,t);var n=Ma(t.value),r=t.type;if(n!=null)r==="number"?(n===0&&e.value===""||e.value!=n)&&(e.value=""+n):e.value!==""+n&&(e.value=""+n);else if(r==="submit"||r==="reset"){e.removeAttribute("value");return}t.hasOwnProperty("value")?Nm(e,t.type,n):t.hasOwnProperty("defaultValue")&&Nm(e,t.type,Ma(t.defaultValue)),t.checked==null&&t.defaultChecked!=null&&(e.defaultChecked=!!t.defaultChecked)}function qy(e,t,n){if(t.hasOwnProperty("value")||t.hasOwnProperty("defaultValue")){var r=t.type;if(!(r!=="submit"&&r!=="reset"||t.value!==void 0&&t.value!==null))return;t=""+e._wrapperState.initialValue,n||t===e.value||(e.value=t),e.defaultValue=t}n=e.name,n!==""&&(e.name=""),e.defaultChecked=!!e._wrapperState.initialChecked,n!==""&&(e.name=n)}function Nm(e,t,n){(t!=="number"||y0(e.ownerDocument)!==e)&&(n==null?e.defaultValue=""+e._wrapperState.initialValue:e.defaultValue!==""+n&&(e.defaultValue=""+n))}var nc=Array.isArray;function Dl(e,t,n,r){if(e=e.options,t){t={};for(var i=0;i<n.length;i++)t["$"+n[i]]=!0;for(n=0;n<e.length;n++)i=t.hasOwnProperty("$"+e[n].value),e[n].selected!==i&&(e[n].selected=i),i&&r&&(e[n].defaultSelected=!0)}else{for(n=""+Ma(n),t=null,i=0;i<e.length;i++){if(e[i].value===n){e[i].selected=!0,r&&(e[i].defaultSelected=!0);return}t!==null||e[i].disabled||(t=e[i])}t!==null&&(t.selected=!0)}}function bm(e,t){if(t.dangerouslySetInnerHTML!=null)throw Error(ke(91));return cn({},t,{value:void 0,defaultValue:void 0,children:""+e._wrapperState.initialValue})}function Ky(e,t){var n=t.value;if(n==null){if(n=t.children,t=t.defaultValue,n!=null){if(t!=null)throw Error(ke(92));if(nc(n)){if(1<n.length)throw Error(ke(93));n=n[0]}t=n}t==null&&(t=""),n=t}e._wrapperState={initialValue:Ma(n)}}function D2(e,t){var n=Ma(t.value),r=Ma(t.defaultValue);n!=null&&(n=""+n,n!==e.value&&(e.value=n),t.defaultValue==null&&e.defaultValue!==n&&(e.defaultValue=n)),r!=null&&(e.defaultValue=""+r)}function Yy(e){var t=e.textContent;t===e._wrapperState.initialValue&&t!==""&&t!==null&&(e.value=t)}function P2(e){switch(e){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Lm(e,t){return e==null||e==="http://www.w3.org/1999/xhtml"?P2(t):e==="http://www.w3.org/2000/svg"&&t==="foreignObject"?"http://www.w3.org/1999/xhtml":e}var dd,I2=function(e){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(t,n,r,i){MSApp.execUnsafeLocalFunction(function(){return e(t,n,r,i)})}:e}(function(e,t){if(e.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in e)e.innerHTML=t;else{for(dd=dd||document.createElement("div"),dd.innerHTML="<svg>"+t.valueOf().toString()+"</svg>",t=dd.firstChild;e.firstChild;)e.removeChild(e.firstChild);for(;t.firstChild;)e.appendChild(t.firstChild)}});function Uc(e,t){if(t){var n=e.firstChild;if(n&&n===e.lastChild&&n.nodeType===3){n.nodeValue=t;return}}e.textContent=t}var hc={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},kN=["Webkit","ms","Moz","O"];Object.keys(hc).forEach(function(e){kN.forEach(function(t){t=t+e.charAt(0).toUpperCase()+e.substring(1),hc[t]=hc[e]})});function N2(e,t,n){return t==null||typeof t=="boolean"||t===""?"":n||typeof t!="number"||t===0||hc.hasOwnProperty(e)&&hc[e]?(""+t).trim():t+"px"}function b2(e,t){e=e.style;for(var n in t)if(t.hasOwnProperty(n)){var r=n.indexOf("--")===0,i=N2(n,t[n],r);n==="float"&&(n="cssFloat"),r?e.setProperty(n,i):e[n]=i}}var AN=cn({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Om(e,t){if(t){if(AN[e]&&(t.children!=null||t.dangerouslySetInnerHTML!=null))throw Error(ke(137,e));if(t.dangerouslySetInnerHTML!=null){if(t.children!=null)throw Error(ke(60));if(typeof t.dangerouslySetInnerHTML!="object"||!("__html"in t.dangerouslySetInnerHTML))throw Error(ke(61))}if(t.style!=null&&typeof t.style!="object")throw Error(ke(62))}}function Bm(e,t){if(e.indexOf("-")===-1)return typeof t.is=="string";switch(e){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Um=null;function zv(e){return e=e.target||e.srcElement||window,e.correspondingUseElement&&(e=e.correspondingUseElement),e.nodeType===3?e.parentNode:e}var Vm=null,Pl=null,Il=null;function Xy(e){if(e=Lf(e)){if(typeof Vm!="function")throw Error(ke(280));var t=e.stateNode;t&&(t=Fh(t),Vm(e.stateNode,e.type,t))}}function L2(e){Pl?Il?Il.push(e):Il=[e]:Pl=e}function O2(){if(Pl){var e=Pl,t=Il;if(Il=Pl=null,Xy(e),t)for(e=0;e<t.length;e++)Xy(t[e])}}function B2(e,t){return e(t)}function U2(){}var yp=!1;function V2(e,t,n){if(yp)return e(t,n);yp=!0;try{return B2(e,t,n)}finally{yp=!1,(Pl!==null||Il!==null)&&(U2(),O2())}}function Vc(e,t){var n=e.stateNode;if(n===null)return null;var r=Fh(n);if(r===null)return null;n=r[t];e:switch(t){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(r=!r.disabled)||(e=e.type,r=!(e==="button"||e==="input"||e==="select"||e==="textarea")),e=!r;break e;default:e=!1}if(e)return null;if(n&&typeof n!="function")throw Error(ke(231,t,typeof n));return n}var Hm=!1;if(Ns)try{var $u={};Object.defineProperty($u,"passive",{get:function(){Hm=!0}}),window.addEventListener("test",$u,$u),window.removeEventListener("test",$u,$u)}catch{Hm=!1}function RN(e,t,n,r,i,s,a,o,l){var u=Array.prototype.slice.call(arguments,3);try{t.apply(n,u)}catch(c){this.onError(c)}}var pc=!1,w0=null,T0=!1,$m=null,MN={onError:function(e){pc=!0,w0=e}};function FN(e,t,n,r,i,s,a,o,l){pc=!1,w0=null,RN.apply(MN,arguments)}function DN(e,t,n,r,i,s,a,o,l){if(FN.apply(this,arguments),pc){if(pc){var u=w0;pc=!1,w0=null}else throw Error(ke(198));T0||(T0=!0,$m=u)}}function zo(e){var t=e,n=e;if(e.alternate)for(;t.return;)t=t.return;else{e=t;do t=e,t.flags&4098&&(n=t.return),e=t.return;while(e)}return t.tag===3?n:null}function H2(e){if(e.tag===13){var t=e.memoizedState;if(t===null&&(e=e.alternate,e!==null&&(t=e.memoizedState)),t!==null)return t.dehydrated}return null}function Jy(e){if(zo(e)!==e)throw Error(ke(188))}function PN(e){var t=e.alternate;if(!t){if(t=zo(e),t===null)throw Error(ke(188));return t!==e?null:e}for(var n=e,r=t;;){var i=n.return;if(i===null)break;var s=i.alternate;if(s===null){if(r=i.return,r!==null){n=r;continue}break}if(i.child===s.child){for(s=i.child;s;){if(s===n)return Jy(i),e;if(s===r)return Jy(i),t;s=s.sibling}throw Error(ke(188))}if(n.return!==r.return)n=i,r=s;else{for(var a=!1,o=i.child;o;){if(o===n){a=!0,n=i,r=s;break}if(o===r){a=!0,r=i,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,r=i;break}if(o===r){a=!0,r=s,n=i;break}o=o.sibling}if(!a)throw Error(ke(189))}}if(n.alternate!==r)throw Error(ke(190))}if(n.tag!==3)throw Error(ke(188));return n.stateNode.current===n?e:t}function $2(e){return e=PN(e),e!==null?z2(e):null}function z2(e){if(e.tag===5||e.tag===6)return e;for(e=e.child;e!==null;){var t=z2(e);if(t!==null)return t;e=e.sibling}return null}var W2=Qr.unstable_scheduleCallback,Qy=Qr.unstable_cancelCallback,IN=Qr.unstable_shouldYield,NN=Qr.unstable_requestPaint,Tn=Qr.unstable_now,bN=Qr.unstable_getCurrentPriorityLevel,Wv=Qr.unstable_ImmediatePriority,G2=Qr.unstable_UserBlockingPriority,S0=Qr.unstable_NormalPriority,LN=Qr.unstable_LowPriority,q2=Qr.unstable_IdlePriority,kh=null,rs=null;function ON(e){if(rs&&typeof rs.onCommitFiberRoot=="function")try{rs.onCommitFiberRoot(kh,e,void 0,(e.current.flags&128)===128)}catch{}}var Bi=Math.clz32?Math.clz32:VN,BN=Math.log,UN=Math.LN2;function VN(e){return e>>>=0,e===0?32:31-(BN(e)/UN|0)|0}var hd=64,pd=4194304;function rc(e){switch(e&-e){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return e&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return e}}function E0(e,t){var n=e.pendingLanes;if(n===0)return 0;var r=0,i=e.suspendedLanes,s=e.pingedLanes,a=n&268435455;if(a!==0){var o=a&~i;o!==0?r=rc(o):(s&=a,s!==0&&(r=rc(s)))}else a=n&~i,a!==0?r=rc(a):s!==0&&(r=rc(s));if(r===0)return 0;if(t!==0&&t!==r&&!(t&i)&&(i=r&-r,s=t&-t,i>=s||i===16&&(s&4194240)!==0))return t;if(r&4&&(r|=n&16),t=e.entangledLanes,t!==0)for(e=e.entanglements,t&=r;0<t;)n=31-Bi(t),i=1<<n,r|=e[n],t&=~i;return r}function HN(e,t){switch(e){case 1:case 2:case 4:return t+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function $N(e,t){for(var n=e.suspendedLanes,r=e.pingedLanes,i=e.expirationTimes,s=e.pendingLanes;0<s;){var a=31-Bi(s),o=1<<a,l=i[a];l===-1?(!(o&n)||o&r)&&(i[a]=HN(o,t)):l<=t&&(e.expiredLanes|=o),s&=~o}}function zm(e){return e=e.pendingLanes&-1073741825,e!==0?e:e&1073741824?1073741824:0}function K2(){var e=hd;return hd<<=1,!(hd&4194240)&&(hd=64),e}function wp(e){for(var t=[],n=0;31>n;n++)t.push(e);return t}function Nf(e,t,n){e.pendingLanes|=t,t!==536870912&&(e.suspendedLanes=0,e.pingedLanes=0),e=e.eventTimes,t=31-Bi(t),e[t]=n}function zN(e,t){var n=e.pendingLanes&~t;e.pendingLanes=t,e.suspendedLanes=0,e.pingedLanes=0,e.expiredLanes&=t,e.mutableReadLanes&=t,e.entangledLanes&=t,t=e.entanglements;var r=e.eventTimes;for(e=e.expirationTimes;0<n;){var i=31-Bi(n),s=1<<i;t[i]=0,r[i]=-1,e[i]=-1,n&=~s}}function Gv(e,t){var n=e.entangledLanes|=t;for(e=e.entanglements;n;){var r=31-Bi(n),i=1<<r;i&t|e[r]&t&&(e[r]|=t),n&=~i}}var zt=0;function Y2(e){return e&=-e,1<e?4<e?e&268435455?16:536870912:4:1}var X2,qv,J2,Q2,j2,Wm=!1,md=[],wa=null,Ta=null,Sa=null,Hc=new Map,$c=new Map,ea=[],WN="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function jy(e,t){switch(e){case"focusin":case"focusout":wa=null;break;case"dragenter":case"dragleave":Ta=null;break;case"mouseover":case"mouseout":Sa=null;break;case"pointerover":case"pointerout":Hc.delete(t.pointerId);break;case"gotpointercapture":case"lostpointercapture":$c.delete(t.pointerId)}}function zu(e,t,n,r,i,s){return e===null||e.nativeEvent!==s?(e={blockedOn:t,domEventName:n,eventSystemFlags:r,nativeEvent:s,targetContainers:[i]},t!==null&&(t=Lf(t),t!==null&&qv(t)),e):(e.eventSystemFlags|=r,t=e.targetContainers,i!==null&&t.indexOf(i)===-1&&t.push(i),e)}function GN(e,t,n,r,i){switch(t){case"focusin":return wa=zu(wa,e,t,n,r,i),!0;case"dragenter":return Ta=zu(Ta,e,t,n,r,i),!0;case"mouseover":return Sa=zu(Sa,e,t,n,r,i),!0;case"pointerover":var s=i.pointerId;return Hc.set(s,zu(Hc.get(s)||null,e,t,n,r,i)),!0;case"gotpointercapture":return s=i.pointerId,$c.set(s,zu($c.get(s)||null,e,t,n,r,i)),!0}return!1}function Z2(e){var t=to(e.target);if(t!==null){var n=zo(t);if(n!==null){if(t=n.tag,t===13){if(t=H2(n),t!==null){e.blockedOn=t,j2(e.priority,function(){J2(n)});return}}else if(t===3&&n.stateNode.current.memoizedState.isDehydrated){e.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}e.blockedOn=null}function Qd(e){if(e.blockedOn!==null)return!1;for(var t=e.targetContainers;0<t.length;){var n=Gm(e.domEventName,e.eventSystemFlags,t[0],e.nativeEvent);if(n===null){n=e.nativeEvent;var r=new n.constructor(n.type,n);Um=r,n.target.dispatchEvent(r),Um=null}else return t=Lf(n),t!==null&&qv(t),e.blockedOn=n,!1;t.shift()}return!0}function Zy(e,t,n){Qd(e)&&n.delete(t)}function qN(){Wm=!1,wa!==null&&Qd(wa)&&(wa=null),Ta!==null&&Qd(Ta)&&(Ta=null),Sa!==null&&Qd(Sa)&&(Sa=null),Hc.forEach(Zy),$c.forEach(Zy)}function Wu(e,t){e.blockedOn===t&&(e.blockedOn=null,Wm||(Wm=!0,Qr.unstable_scheduleCallback(Qr.unstable_NormalPriority,qN)))}function zc(e){function t(i){return Wu(i,e)}if(0<md.length){Wu(md[0],e);for(var n=1;n<md.length;n++){var r=md[n];r.blockedOn===e&&(r.blockedOn=null)}}for(wa!==null&&Wu(wa,e),Ta!==null&&Wu(Ta,e),Sa!==null&&Wu(Sa,e),Hc.forEach(t),$c.forEach(t),n=0;n<ea.length;n++)r=ea[n],r.blockedOn===e&&(r.blockedOn=null);for(;0<ea.length&&(n=ea[0],n.blockedOn===null);)Z2(n),n.blockedOn===null&&ea.shift()}var Nl=Vs.ReactCurrentBatchConfig,_0=!0;function KN(e,t,n,r){var i=zt,s=Nl.transition;Nl.transition=null;try{zt=1,Kv(e,t,n,r)}finally{zt=i,Nl.transition=s}}function YN(e,t,n,r){var i=zt,s=Nl.transition;Nl.transition=null;try{zt=4,Kv(e,t,n,r)}finally{zt=i,Nl.transition=s}}function Kv(e,t,n,r){if(_0){var i=Gm(e,t,n,r);if(i===null)Fp(e,t,r,C0,n),jy(e,r);else if(GN(i,e,t,n,r))r.stopPropagation();else if(jy(e,r),t&4&&-1<WN.indexOf(e)){for(;i!==null;){var s=Lf(i);if(s!==null&&X2(s),s=Gm(e,t,n,r),s===null&&Fp(e,t,r,C0,n),s===i)break;i=s}i!==null&&r.stopPropagation()}else Fp(e,t,r,null,n)}}var C0=null;function Gm(e,t,n,r){if(C0=null,e=zv(r),e=to(e),e!==null)if(t=zo(e),t===null)e=null;else if(n=t.tag,n===13){if(e=H2(t),e!==null)return e;e=null}else if(n===3){if(t.stateNode.current.memoizedState.isDehydrated)return t.tag===3?t.stateNode.containerInfo:null;e=null}else t!==e&&(e=null);return C0=e,null}function ek(e){switch(e){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(bN()){case Wv:return 1;case G2:return 4;case S0:case LN:return 16;case q2:return 536870912;default:return 16}default:return 16}}var pa=null,Yv=null,jd=null;function tk(){if(jd)return jd;var e,t=Yv,n=t.length,r,i="value"in pa?pa.value:pa.textContent,s=i.length;for(e=0;e<n&&t[e]===i[e];e++);var a=n-e;for(r=1;r<=a&&t[n-r]===i[s-r];r++);return jd=i.slice(e,1<r?1-r:void 0)}function Zd(e){var t=e.keyCode;return"charCode"in e?(e=e.charCode,e===0&&t===13&&(e=13)):e=t,e===10&&(e=13),32<=e||e===13?e:0}function gd(){return!0}function ew(){return!1}function ti(e){function t(n,r,i,s,a){this._reactName=n,this._targetInst=i,this.type=r,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in e)e.hasOwnProperty(o)&&(n=e[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?gd:ew,this.isPropagationStopped=ew,this}return cn(t.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=gd)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=gd)},persist:function(){},isPersistent:gd}),t}var Su={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(e){return e.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Xv=ti(Su),bf=cn({},Su,{view:0,detail:0}),XN=ti(bf),Tp,Sp,Gu,Ah=cn({},bf,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:Jv,button:0,buttons:0,relatedTarget:function(e){return e.relatedTarget===void 0?e.fromElement===e.srcElement?e.toElement:e.fromElement:e.relatedTarget},movementX:function(e){return"movementX"in e?e.movementX:(e!==Gu&&(Gu&&e.type==="mousemove"?(Tp=e.screenX-Gu.screenX,Sp=e.screenY-Gu.screenY):Sp=Tp=0,Gu=e),Tp)},movementY:function(e){return"movementY"in e?e.movementY:Sp}}),tw=ti(Ah),JN=cn({},Ah,{dataTransfer:0}),QN=ti(JN),jN=cn({},bf,{relatedTarget:0}),Ep=ti(jN),ZN=cn({},Su,{animationName:0,elapsedTime:0,pseudoElement:0}),e4=ti(ZN),t4=cn({},Su,{clipboardData:function(e){return"clipboardData"in e?e.clipboardData:window.clipboardData}}),n4=ti(t4),r4=cn({},Su,{data:0}),nw=ti(r4),i4={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},s4={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},a4={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function o4(e){var t=this.nativeEvent;return t.getModifierState?t.getModifierState(e):(e=a4[e])?!!t[e]:!1}function Jv(){return o4}var l4=cn({},bf,{key:function(e){if(e.key){var t=i4[e.key]||e.key;if(t!=="Unidentified")return t}return e.type==="keypress"?(e=Zd(e),e===13?"Enter":String.fromCharCode(e)):e.type==="keydown"||e.type==="keyup"?s4[e.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:Jv,charCode:function(e){return e.type==="keypress"?Zd(e):0},keyCode:function(e){return e.type==="keydown"||e.type==="keyup"?e.keyCode:0},which:function(e){return e.type==="keypress"?Zd(e):e.type==="keydown"||e.type==="keyup"?e.keyCode:0}}),u4=ti(l4),c4=cn({},Ah,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),rw=ti(c4),f4=cn({},bf,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:Jv}),d4=ti(f4),h4=cn({},Su,{propertyName:0,elapsedTime:0,pseudoElement:0}),p4=ti(h4),m4=cn({},Ah,{deltaX:function(e){return"deltaX"in e?e.deltaX:"wheelDeltaX"in e?-e.wheelDeltaX:0},deltaY:function(e){return"deltaY"in e?e.deltaY:"wheelDeltaY"in e?-e.wheelDeltaY:"wheelDelta"in e?-e.wheelDelta:0},deltaZ:0,deltaMode:0}),g4=ti(m4),v4=[9,13,27,32],Qv=Ns&&"CompositionEvent"in window,mc=null;Ns&&"documentMode"in document&&(mc=document.documentMode);var x4=Ns&&"TextEvent"in window&&!mc,nk=Ns&&(!Qv||mc&&8<mc&&11>=mc),iw=" ",sw=!1;function rk(e,t){switch(e){case"keyup":return v4.indexOf(t.keyCode)!==-1;case"keydown":return t.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function ik(e){return e=e.detail,typeof e=="object"&&"data"in e?e.data:null}var pl=!1;function y4(e,t){switch(e){case"compositionend":return ik(t);case"keypress":return t.which!==32?null:(sw=!0,iw);case"textInput":return e=t.data,e===iw&&sw?null:e;default:return null}}function w4(e,t){if(pl)return e==="compositionend"||!Qv&&rk(e,t)?(e=tk(),jd=Yv=pa=null,pl=!1,e):null;switch(e){case"paste":return null;case"keypress":if(!(t.ctrlKey||t.altKey||t.metaKey)||t.ctrlKey&&t.altKey){if(t.char&&1<t.char.length)return t.char;if(t.which)return String.fromCharCode(t.which)}return null;case"compositionend":return nk&&t.locale!=="ko"?null:t.data;default:return null}}var T4={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function aw(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t==="input"?!!T4[e.type]:t==="textarea"}function sk(e,t,n,r){L2(r),t=k0(t,"onChange"),0<t.length&&(n=new Xv("onChange","change",null,n,r),e.push({event:n,listeners:t}))}var gc=null,Wc=null;function S4(e){gk(e,0)}function Rh(e){var t=vl(e);if(M2(t))return e}function E4(e,t){if(e==="change")return t}var ak=!1;if(Ns){var _p;if(Ns){var Cp="oninput"in document;if(!Cp){var ow=document.createElement("div");ow.setAttribute("oninput","return;"),Cp=typeof ow.oninput=="function"}_p=Cp}else _p=!1;ak=_p&&(!document.documentMode||9<document.documentMode)}function lw(){gc&&(gc.detachEvent("onpropertychange",ok),Wc=gc=null)}function ok(e){if(e.propertyName==="value"&&Rh(Wc)){var t=[];sk(t,Wc,e,zv(e)),V2(S4,t)}}function _4(e,t,n){e==="focusin"?(lw(),gc=t,Wc=n,gc.attachEvent("onpropertychange",ok)):e==="focusout"&&lw()}function C4(e){if(e==="selectionchange"||e==="keyup"||e==="keydown")return Rh(Wc)}function k4(e,t){if(e==="click")return Rh(t)}function A4(e,t){if(e==="input"||e==="change")return Rh(t)}function R4(e,t){return e===t&&(e!==0||1/e===1/t)||e!==e&&t!==t}var $i=typeof Object.is=="function"?Object.is:R4;function Gc(e,t){if($i(e,t))return!0;if(typeof e!="object"||e===null||typeof t!="object"||t===null)return!1;var n=Object.keys(e),r=Object.keys(t);if(n.length!==r.length)return!1;for(r=0;r<n.length;r++){var i=n[r];if(!Am.call(t,i)||!$i(e[i],t[i]))return!1}return!0}function uw(e){for(;e&&e.firstChild;)e=e.firstChild;return e}function cw(e,t){var n=uw(e);e=0;for(var r;n;){if(n.nodeType===3){if(r=e+n.textContent.length,e<=t&&r>=t)return{node:n,offset:t-e};e=r}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=uw(n)}}function lk(e,t){return e&&t?e===t?!0:e&&e.nodeType===3?!1:t&&t.nodeType===3?lk(e,t.parentNode):"contains"in e?e.contains(t):e.compareDocumentPosition?!!(e.compareDocumentPosition(t)&16):!1:!1}function uk(){for(var e=window,t=y0();t instanceof e.HTMLIFrameElement;){try{var n=typeof t.contentWindow.location.href=="string"}catch{n=!1}if(n)e=t.contentWindow;else break;t=y0(e.document)}return t}function jv(e){var t=e&&e.nodeName&&e.nodeName.toLowerCase();return t&&(t==="input"&&(e.type==="text"||e.type==="search"||e.type==="tel"||e.type==="url"||e.type==="password")||t==="textarea"||e.contentEditable==="true")}function M4(e){var t=uk(),n=e.focusedElem,r=e.selectionRange;if(t!==n&&n&&n.ownerDocument&&lk(n.ownerDocument.documentElement,n)){if(r!==null&&jv(n)){if(t=r.start,e=r.end,e===void 0&&(e=t),"selectionStart"in n)n.selectionStart=t,n.selectionEnd=Math.min(e,n.value.length);else if(e=(t=n.ownerDocument||document)&&t.defaultView||window,e.getSelection){e=e.getSelection();var i=n.textContent.length,s=Math.min(r.start,i);r=r.end===void 0?s:Math.min(r.end,i),!e.extend&&s>r&&(i=r,r=s,s=i),i=cw(n,s);var a=cw(n,r);i&&a&&(e.rangeCount!==1||e.anchorNode!==i.node||e.anchorOffset!==i.offset||e.focusNode!==a.node||e.focusOffset!==a.offset)&&(t=t.createRange(),t.setStart(i.node,i.offset),e.removeAllRanges(),s>r?(e.addRange(t),e.extend(a.node,a.offset)):(t.setEnd(a.node,a.offset),e.addRange(t)))}}for(t=[],e=n;e=e.parentNode;)e.nodeType===1&&t.push({element:e,left:e.scrollLeft,top:e.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<t.length;n++)e=t[n],e.element.scrollLeft=e.left,e.element.scrollTop=e.top}}var F4=Ns&&"documentMode"in document&&11>=document.documentMode,ml=null,qm=null,vc=null,Km=!1;function fw(e,t,n){var r=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;Km||ml==null||ml!==y0(r)||(r=ml,"selectionStart"in r&&jv(r)?r={start:r.selectionStart,end:r.selectionEnd}:(r=(r.ownerDocument&&r.ownerDocument.defaultView||window).getSelection(),r={anchorNode:r.anchorNode,anchorOffset:r.anchorOffset,focusNode:r.focusNode,focusOffset:r.focusOffset}),vc&&Gc(vc,r)||(vc=r,r=k0(qm,"onSelect"),0<r.length&&(t=new Xv("onSelect","select",null,t,n),e.push({event:t,listeners:r}),t.target=ml)))}function vd(e,t){var n={};return n[e.toLowerCase()]=t.toLowerCase(),n["Webkit"+e]="webkit"+t,n["Moz"+e]="moz"+t,n}var gl={animationend:vd("Animation","AnimationEnd"),animationiteration:vd("Animation","AnimationIteration"),animationstart:vd("Animation","AnimationStart"),transitionend:vd("Transition","TransitionEnd")},kp={},ck={};Ns&&(ck=document.createElement("div").style,"AnimationEvent"in window||(delete gl.animationend.animation,delete gl.animationiteration.animation,delete gl.animationstart.animation),"TransitionEvent"in window||delete gl.transitionend.transition);function Mh(e){if(kp[e])return kp[e];if(!gl[e])return e;var t=gl[e],n;for(n in t)if(t.hasOwnProperty(n)&&n in ck)return kp[e]=t[n];return e}var fk=Mh("animationend"),dk=Mh("animationiteration"),hk=Mh("animationstart"),pk=Mh("transitionend"),mk=new Map,dw="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function Ua(e,t){mk.set(e,t),$o(t,[e])}for(var Ap=0;Ap<dw.length;Ap++){var Rp=dw[Ap],D4=Rp.toLowerCase(),P4=Rp[0].toUpperCase()+Rp.slice(1);Ua(D4,"on"+P4)}Ua(fk,"onAnimationEnd");Ua(dk,"onAnimationIteration");Ua(hk,"onAnimationStart");Ua("dblclick","onDoubleClick");Ua("focusin","onFocus");Ua("focusout","onBlur");Ua(pk,"onTransitionEnd");au("onMouseEnter",["mouseout","mouseover"]);au("onMouseLeave",["mouseout","mouseover"]);au("onPointerEnter",["pointerout","pointerover"]);au("onPointerLeave",["pointerout","pointerover"]);$o("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));$o("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));$o("onBeforeInput",["compositionend","keypress","textInput","paste"]);$o("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));$o("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));$o("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var ic="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),I4=new Set("cancel close invalid load scroll toggle".split(" ").concat(ic));function hw(e,t,n){var r=e.type||"unknown-event";e.currentTarget=n,DN(r,t,void 0,e),e.currentTarget=null}function gk(e,t){t=(t&4)!==0;for(var n=0;n<e.length;n++){var r=e[n],i=r.event;r=r.listeners;e:{var s=void 0;if(t)for(var a=r.length-1;0<=a;a--){var o=r[a],l=o.instance,u=o.currentTarget;if(o=o.listener,l!==s&&i.isPropagationStopped())break e;hw(i,o,u),s=l}else for(a=0;a<r.length;a++){if(o=r[a],l=o.instance,u=o.currentTarget,o=o.listener,l!==s&&i.isPropagationStopped())break e;hw(i,o,u),s=l}}}if(T0)throw e=$m,T0=!1,$m=null,e}function Jt(e,t){var n=t[jm];n===void 0&&(n=t[jm]=new Set);var r=e+"__bubble";n.has(r)||(vk(t,e,2,!1),n.add(r))}function Mp(e,t,n){var r=0;t&&(r|=4),vk(n,e,r,t)}var xd="_reactListening"+Math.random().toString(36).slice(2);function qc(e){if(!e[xd]){e[xd]=!0,_2.forEach(function(n){n!=="selectionchange"&&(I4.has(n)||Mp(n,!1,e),Mp(n,!0,e))});var t=e.nodeType===9?e:e.ownerDocument;t===null||t[xd]||(t[xd]=!0,Mp("selectionchange",!1,t))}}function vk(e,t,n,r){switch(ek(t)){case 1:var i=KN;break;case 4:i=YN;break;default:i=Kv}n=i.bind(null,t,n,e),i=void 0,!Hm||t!=="touchstart"&&t!=="touchmove"&&t!=="wheel"||(i=!0),r?i!==void 0?e.addEventListener(t,n,{capture:!0,passive:i}):e.addEventListener(t,n,!0):i!==void 0?e.addEventListener(t,n,{passive:i}):e.addEventListener(t,n,!1)}function Fp(e,t,n,r,i){var s=r;if(!(t&1)&&!(t&2)&&r!==null)e:for(;;){if(r===null)return;var a=r.tag;if(a===3||a===4){var o=r.stateNode.containerInfo;if(o===i||o.nodeType===8&&o.parentNode===i)break;if(a===4)for(a=r.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===i||l.nodeType===8&&l.parentNode===i))return;a=a.return}for(;o!==null;){if(a=to(o),a===null)return;if(l=a.tag,l===5||l===6){r=s=a;continue e}o=o.parentNode}}r=r.return}V2(function(){var u=s,c=zv(n),h=[];e:{var p=mk.get(e);if(p!==void 0){var m=Xv,v=e;switch(e){case"keypress":if(Zd(n)===0)break e;case"keydown":case"keyup":m=u4;break;case"focusin":v="focus",m=Ep;break;case"focusout":v="blur",m=Ep;break;case"beforeblur":case"afterblur":m=Ep;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":m=tw;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":m=QN;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":m=d4;break;case fk:case dk:case hk:m=e4;break;case pk:m=p4;break;case"scroll":m=XN;break;case"wheel":m=g4;break;case"copy":case"cut":case"paste":m=n4;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":m=rw}var g=(t&4)!==0,w=!g&&e==="scroll",x=g?p!==null?p+"Capture":null:p;g=[];for(var T=u,y;T!==null;){y=T;var _=y.stateNode;if(y.tag===5&&_!==null&&(y=_,x!==null&&(_=Vc(T,x),_!=null&&g.push(Kc(T,_,y)))),w)break;T=T.return}0<g.length&&(p=new m(p,v,null,n,c),h.push({event:p,listeners:g}))}}if(!(t&7)){e:{if(p=e==="mouseover"||e==="pointerover",m=e==="mouseout"||e==="pointerout",p&&n!==Um&&(v=n.relatedTarget||n.fromElement)&&(to(v)||v[bs]))break e;if((m||p)&&(p=c.window===c?c:(p=c.ownerDocument)?p.defaultView||p.parentWindow:window,m?(v=n.relatedTarget||n.toElement,m=u,v=v?to(v):null,v!==null&&(w=zo(v),v!==w||v.tag!==5&&v.tag!==6)&&(v=null)):(m=null,v=u),m!==v)){if(g=tw,_="onMouseLeave",x="onMouseEnter",T="mouse",(e==="pointerout"||e==="pointerover")&&(g=rw,_="onPointerLeave",x="onPointerEnter",T="pointer"),w=m==null?p:vl(m),y=v==null?p:vl(v),p=new g(_,T+"leave",m,n,c),p.target=w,p.relatedTarget=y,_=null,to(c)===u&&(g=new g(x,T+"enter",v,n,c),g.target=y,g.relatedTarget=w,_=g),w=_,m&&v)t:{for(g=m,x=v,T=0,y=g;y;y=rl(y))T++;for(y=0,_=x;_;_=rl(_))y++;for(;0<T-y;)g=rl(g),T--;for(;0<y-T;)x=rl(x),y--;for(;T--;){if(g===x||x!==null&&g===x.alternate)break t;g=rl(g),x=rl(x)}g=null}else g=null;m!==null&&pw(h,p,m,g,!1),v!==null&&w!==null&&pw(h,w,v,g,!0)}}e:{if(p=u?vl(u):window,m=p.nodeName&&p.nodeName.toLowerCase(),m==="select"||m==="input"&&p.type==="file")var k=E4;else if(aw(p))if(ak)k=A4;else{k=C4;var S=_4}else(m=p.nodeName)&&m.toLowerCase()==="input"&&(p.type==="checkbox"||p.type==="radio")&&(k=k4);if(k&&(k=k(e,u))){sk(h,k,n,c);break e}S&&S(e,p,u),e==="focusout"&&(S=p._wrapperState)&&S.controlled&&p.type==="number"&&Nm(p,"number",p.value)}switch(S=u?vl(u):window,e){case"focusin":(aw(S)||S.contentEditable==="true")&&(ml=S,qm=u,vc=null);break;case"focusout":vc=qm=ml=null;break;case"mousedown":Km=!0;break;case"contextmenu":case"mouseup":case"dragend":Km=!1,fw(h,n,c);break;case"selectionchange":if(F4)break;case"keydown":case"keyup":fw(h,n,c)}var C;if(Qv)e:{switch(e){case"compositionstart":var M="onCompositionStart";break e;case"compositionend":M="onCompositionEnd";break e;case"compositionupdate":M="onCompositionUpdate";break e}M=void 0}else pl?rk(e,n)&&(M="onCompositionEnd"):e==="keydown"&&n.keyCode===229&&(M="onCompositionStart");M&&(nk&&n.locale!=="ko"&&(pl||M!=="onCompositionStart"?M==="onCompositionEnd"&&pl&&(C=tk()):(pa=c,Yv="value"in pa?pa.value:pa.textContent,pl=!0)),S=k0(u,M),0<S.length&&(M=new nw(M,e,null,n,c),h.push({event:M,listeners:S}),C?M.data=C:(C=ik(n),C!==null&&(M.data=C)))),(C=x4?y4(e,n):w4(e,n))&&(u=k0(u,"onBeforeInput"),0<u.length&&(c=new nw("onBeforeInput","beforeinput",null,n,c),h.push({event:c,listeners:u}),c.data=C))}gk(h,t)})}function Kc(e,t,n){return{instance:e,listener:t,currentTarget:n}}function k0(e,t){for(var n=t+"Capture",r=[];e!==null;){var i=e,s=i.stateNode;i.tag===5&&s!==null&&(i=s,s=Vc(e,n),s!=null&&r.unshift(Kc(e,s,i)),s=Vc(e,t),s!=null&&r.push(Kc(e,s,i))),e=e.return}return r}function rl(e){if(e===null)return null;do e=e.return;while(e&&e.tag!==5);return e||null}function pw(e,t,n,r,i){for(var s=t._reactName,a=[];n!==null&&n!==r;){var o=n,l=o.alternate,u=o.stateNode;if(l!==null&&l===r)break;o.tag===5&&u!==null&&(o=u,i?(l=Vc(n,s),l!=null&&a.unshift(Kc(n,l,o))):i||(l=Vc(n,s),l!=null&&a.push(Kc(n,l,o)))),n=n.return}a.length!==0&&e.push({event:t,listeners:a})}var N4=/\r\n?/g,b4=/\u0000|\uFFFD/g;function mw(e){return(typeof e=="string"?e:""+e).replace(N4,`
`).replace(b4,"")}function yd(e,t,n){if(t=mw(t),mw(e)!==t&&n)throw Error(ke(425))}function A0(){}var Ym=null,Xm=null;function Jm(e,t){return e==="textarea"||e==="noscript"||typeof t.children=="string"||typeof t.children=="number"||typeof t.dangerouslySetInnerHTML=="object"&&t.dangerouslySetInnerHTML!==null&&t.dangerouslySetInnerHTML.__html!=null}var Qm=typeof setTimeout=="function"?setTimeout:void 0,L4=typeof clearTimeout=="function"?clearTimeout:void 0,gw=typeof Promise=="function"?Promise:void 0,O4=typeof queueMicrotask=="function"?queueMicrotask:typeof gw<"u"?function(e){return gw.resolve(null).then(e).catch(B4)}:Qm;function B4(e){setTimeout(function(){throw e})}function Dp(e,t){var n=t,r=0;do{var i=n.nextSibling;if(e.removeChild(n),i&&i.nodeType===8)if(n=i.data,n==="/$"){if(r===0){e.removeChild(i),zc(t);return}r--}else n!=="$"&&n!=="$?"&&n!=="$!"||r++;n=i}while(n);zc(t)}function Ea(e){for(;e!=null;e=e.nextSibling){var t=e.nodeType;if(t===1||t===3)break;if(t===8){if(t=e.data,t==="$"||t==="$!"||t==="$?")break;if(t==="/$")return null}}return e}function vw(e){e=e.previousSibling;for(var t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="$"||n==="$!"||n==="$?"){if(t===0)return e;t--}else n==="/$"&&t++}e=e.previousSibling}return null}var Eu=Math.random().toString(36).slice(2),ts="__reactFiber$"+Eu,Yc="__reactProps$"+Eu,bs="__reactContainer$"+Eu,jm="__reactEvents$"+Eu,U4="__reactListeners$"+Eu,V4="__reactHandles$"+Eu;function to(e){var t=e[ts];if(t)return t;for(var n=e.parentNode;n;){if(t=n[bs]||n[ts]){if(n=t.alternate,t.child!==null||n!==null&&n.child!==null)for(e=vw(e);e!==null;){if(n=e[ts])return n;e=vw(e)}return t}e=n,n=e.parentNode}return null}function Lf(e){return e=e[ts]||e[bs],!e||e.tag!==5&&e.tag!==6&&e.tag!==13&&e.tag!==3?null:e}function vl(e){if(e.tag===5||e.tag===6)return e.stateNode;throw Error(ke(33))}function Fh(e){return e[Yc]||null}var Zm=[],xl=-1;function Va(e){return{current:e}}function Zt(e){0>xl||(e.current=Zm[xl],Zm[xl]=null,xl--)}function Yt(e,t){xl++,Zm[xl]=e.current,e.current=t}var Fa={},pr=Va(Fa),Nr=Va(!1),ko=Fa;function ou(e,t){var n=e.type.contextTypes;if(!n)return Fa;var r=e.stateNode;if(r&&r.__reactInternalMemoizedUnmaskedChildContext===t)return r.__reactInternalMemoizedMaskedChildContext;var i={},s;for(s in n)i[s]=t[s];return r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=t,e.__reactInternalMemoizedMaskedChildContext=i),i}function br(e){return e=e.childContextTypes,e!=null}function R0(){Zt(Nr),Zt(pr)}function xw(e,t,n){if(pr.current!==Fa)throw Error(ke(168));Yt(pr,t),Yt(Nr,n)}function xk(e,t,n){var r=e.stateNode;if(t=t.childContextTypes,typeof r.getChildContext!="function")return n;r=r.getChildContext();for(var i in r)if(!(i in t))throw Error(ke(108,_N(e)||"Unknown",i));return cn({},n,r)}function M0(e){return e=(e=e.stateNode)&&e.__reactInternalMemoizedMergedChildContext||Fa,ko=pr.current,Yt(pr,e),Yt(Nr,Nr.current),!0}function yw(e,t,n){var r=e.stateNode;if(!r)throw Error(ke(169));n?(e=xk(e,t,ko),r.__reactInternalMemoizedMergedChildContext=e,Zt(Nr),Zt(pr),Yt(pr,e)):Zt(Nr),Yt(Nr,n)}var ys=null,Dh=!1,Pp=!1;function yk(e){ys===null?ys=[e]:ys.push(e)}function H4(e){Dh=!0,yk(e)}function Ha(){if(!Pp&&ys!==null){Pp=!0;var e=0,t=zt;try{var n=ys;for(zt=1;e<n.length;e++){var r=n[e];do r=r(!0);while(r!==null)}ys=null,Dh=!1}catch(i){throw ys!==null&&(ys=ys.slice(e+1)),W2(Wv,Ha),i}finally{zt=t,Pp=!1}}return null}var yl=[],wl=0,F0=null,D0=0,mi=[],gi=0,Ao=null,Ss=1,Es="";function Xa(e,t){yl[wl++]=D0,yl[wl++]=F0,F0=e,D0=t}function wk(e,t,n){mi[gi++]=Ss,mi[gi++]=Es,mi[gi++]=Ao,Ao=e;var r=Ss;e=Es;var i=32-Bi(r)-1;r&=~(1<<i),n+=1;var s=32-Bi(t)+i;if(30<s){var a=i-i%5;s=(r&(1<<a)-1).toString(32),r>>=a,i-=a,Ss=1<<32-Bi(t)+i|n<<i|r,Es=s+e}else Ss=1<<s|n<<i|r,Es=e}function Zv(e){e.return!==null&&(Xa(e,1),wk(e,1,0))}function ex(e){for(;e===F0;)F0=yl[--wl],yl[wl]=null,D0=yl[--wl],yl[wl]=null;for(;e===Ao;)Ao=mi[--gi],mi[gi]=null,Es=mi[--gi],mi[gi]=null,Ss=mi[--gi],mi[gi]=null}var Yr=null,Kr=null,rn=!1,bi=null;function Tk(e,t){var n=vi(5,null,null,0);n.elementType="DELETED",n.stateNode=t,n.return=e,t=e.deletions,t===null?(e.deletions=[n],e.flags|=16):t.push(n)}function ww(e,t){switch(e.tag){case 5:var n=e.type;return t=t.nodeType!==1||n.toLowerCase()!==t.nodeName.toLowerCase()?null:t,t!==null?(e.stateNode=t,Yr=e,Kr=Ea(t.firstChild),!0):!1;case 6:return t=e.pendingProps===""||t.nodeType!==3?null:t,t!==null?(e.stateNode=t,Yr=e,Kr=null,!0):!1;case 13:return t=t.nodeType!==8?null:t,t!==null?(n=Ao!==null?{id:Ss,overflow:Es}:null,e.memoizedState={dehydrated:t,treeContext:n,retryLane:1073741824},n=vi(18,null,null,0),n.stateNode=t,n.return=e,e.child=n,Yr=e,Kr=null,!0):!1;default:return!1}}function eg(e){return(e.mode&1)!==0&&(e.flags&128)===0}function tg(e){if(rn){var t=Kr;if(t){var n=t;if(!ww(e,t)){if(eg(e))throw Error(ke(418));t=Ea(n.nextSibling);var r=Yr;t&&ww(e,t)?Tk(r,n):(e.flags=e.flags&-4097|2,rn=!1,Yr=e)}}else{if(eg(e))throw Error(ke(418));e.flags=e.flags&-4097|2,rn=!1,Yr=e}}}function Tw(e){for(e=e.return;e!==null&&e.tag!==5&&e.tag!==3&&e.tag!==13;)e=e.return;Yr=e}function wd(e){if(e!==Yr)return!1;if(!rn)return Tw(e),rn=!0,!1;var t;if((t=e.tag!==3)&&!(t=e.tag!==5)&&(t=e.type,t=t!=="head"&&t!=="body"&&!Jm(e.type,e.memoizedProps)),t&&(t=Kr)){if(eg(e))throw Sk(),Error(ke(418));for(;t;)Tk(e,t),t=Ea(t.nextSibling)}if(Tw(e),e.tag===13){if(e=e.memoizedState,e=e!==null?e.dehydrated:null,!e)throw Error(ke(317));e:{for(e=e.nextSibling,t=0;e;){if(e.nodeType===8){var n=e.data;if(n==="/$"){if(t===0){Kr=Ea(e.nextSibling);break e}t--}else n!=="$"&&n!=="$!"&&n!=="$?"||t++}e=e.nextSibling}Kr=null}}else Kr=Yr?Ea(e.stateNode.nextSibling):null;return!0}function Sk(){for(var e=Kr;e;)e=Ea(e.nextSibling)}function lu(){Kr=Yr=null,rn=!1}function tx(e){bi===null?bi=[e]:bi.push(e)}var $4=Vs.ReactCurrentBatchConfig;function qu(e,t,n){if(e=n.ref,e!==null&&typeof e!="function"&&typeof e!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ke(309));var r=n.stateNode}if(!r)throw Error(ke(147,e));var i=r,s=""+e;return t!==null&&t.ref!==null&&typeof t.ref=="function"&&t.ref._stringRef===s?t.ref:(t=function(a){var o=i.refs;a===null?delete o[s]:o[s]=a},t._stringRef=s,t)}if(typeof e!="string")throw Error(ke(284));if(!n._owner)throw Error(ke(290,e))}return e}function Td(e,t){throw e=Object.prototype.toString.call(t),Error(ke(31,e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e))}function Sw(e){var t=e._init;return t(e._payload)}function Ek(e){function t(x,T){if(e){var y=x.deletions;y===null?(x.deletions=[T],x.flags|=16):y.push(T)}}function n(x,T){if(!e)return null;for(;T!==null;)t(x,T),T=T.sibling;return null}function r(x,T){for(x=new Map;T!==null;)T.key!==null?x.set(T.key,T):x.set(T.index,T),T=T.sibling;return x}function i(x,T){return x=Aa(x,T),x.index=0,x.sibling=null,x}function s(x,T,y){return x.index=y,e?(y=x.alternate,y!==null?(y=y.index,y<T?(x.flags|=2,T):y):(x.flags|=2,T)):(x.flags|=1048576,T)}function a(x){return e&&x.alternate===null&&(x.flags|=2),x}function o(x,T,y,_){return T===null||T.tag!==6?(T=Up(y,x.mode,_),T.return=x,T):(T=i(T,y),T.return=x,T)}function l(x,T,y,_){var k=y.type;return k===hl?c(x,T,y.props.children,_,y.key):T!==null&&(T.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Qs&&Sw(k)===T.type)?(_=i(T,y.props),_.ref=qu(x,T,y),_.return=x,_):(_=a0(y.type,y.key,y.props,null,x.mode,_),_.ref=qu(x,T,y),_.return=x,_)}function u(x,T,y,_){return T===null||T.tag!==4||T.stateNode.containerInfo!==y.containerInfo||T.stateNode.implementation!==y.implementation?(T=Vp(y,x.mode,_),T.return=x,T):(T=i(T,y.children||[]),T.return=x,T)}function c(x,T,y,_,k){return T===null||T.tag!==7?(T=xo(y,x.mode,_,k),T.return=x,T):(T=i(T,y),T.return=x,T)}function h(x,T,y){if(typeof T=="string"&&T!==""||typeof T=="number")return T=Up(""+T,x.mode,y),T.return=x,T;if(typeof T=="object"&&T!==null){switch(T.$$typeof){case cd:return y=a0(T.type,T.key,T.props,null,x.mode,y),y.ref=qu(x,null,T),y.return=x,y;case dl:return T=Vp(T,x.mode,y),T.return=x,T;case Qs:var _=T._init;return h(x,_(T._payload),y)}if(nc(T)||Hu(T))return T=xo(T,x.mode,y,null),T.return=x,T;Td(x,T)}return null}function p(x,T,y,_){var k=T!==null?T.key:null;if(typeof y=="string"&&y!==""||typeof y=="number")return k!==null?null:o(x,T,""+y,_);if(typeof y=="object"&&y!==null){switch(y.$$typeof){case cd:return y.key===k?l(x,T,y,_):null;case dl:return y.key===k?u(x,T,y,_):null;case Qs:return k=y._init,p(x,T,k(y._payload),_)}if(nc(y)||Hu(y))return k!==null?null:c(x,T,y,_,null);Td(x,y)}return null}function m(x,T,y,_,k){if(typeof _=="string"&&_!==""||typeof _=="number")return x=x.get(y)||null,o(T,x,""+_,k);if(typeof _=="object"&&_!==null){switch(_.$$typeof){case cd:return x=x.get(_.key===null?y:_.key)||null,l(T,x,_,k);case dl:return x=x.get(_.key===null?y:_.key)||null,u(T,x,_,k);case Qs:var S=_._init;return m(x,T,y,S(_._payload),k)}if(nc(_)||Hu(_))return x=x.get(y)||null,c(T,x,_,k,null);Td(T,_)}return null}function v(x,T,y,_){for(var k=null,S=null,C=T,M=T=0,F=null;C!==null&&M<y.length;M++){C.index>M?(F=C,C=null):F=C.sibling;var b=p(x,C,y[M],_);if(b===null){C===null&&(C=F);break}e&&C&&b.alternate===null&&t(x,C),T=s(b,T,M),S===null?k=b:S.sibling=b,S=b,C=F}if(M===y.length)return n(x,C),rn&&Xa(x,M),k;if(C===null){for(;M<y.length;M++)C=h(x,y[M],_),C!==null&&(T=s(C,T,M),S===null?k=C:S.sibling=C,S=C);return rn&&Xa(x,M),k}for(C=r(x,C);M<y.length;M++)F=m(C,x,M,y[M],_),F!==null&&(e&&F.alternate!==null&&C.delete(F.key===null?M:F.key),T=s(F,T,M),S===null?k=F:S.sibling=F,S=F);return e&&C.forEach(function(V){return t(x,V)}),rn&&Xa(x,M),k}function g(x,T,y,_){var k=Hu(y);if(typeof k!="function")throw Error(ke(150));if(y=k.call(y),y==null)throw Error(ke(151));for(var S=k=null,C=T,M=T=0,F=null,b=y.next();C!==null&&!b.done;M++,b=y.next()){C.index>M?(F=C,C=null):F=C.sibling;var V=p(x,C,b.value,_);if(V===null){C===null&&(C=F);break}e&&C&&V.alternate===null&&t(x,C),T=s(V,T,M),S===null?k=V:S.sibling=V,S=V,C=F}if(b.done)return n(x,C),rn&&Xa(x,M),k;if(C===null){for(;!b.done;M++,b=y.next())b=h(x,b.value,_),b!==null&&(T=s(b,T,M),S===null?k=b:S.sibling=b,S=b);return rn&&Xa(x,M),k}for(C=r(x,C);!b.done;M++,b=y.next())b=m(C,x,M,b.value,_),b!==null&&(e&&b.alternate!==null&&C.delete(b.key===null?M:b.key),T=s(b,T,M),S===null?k=b:S.sibling=b,S=b);return e&&C.forEach(function(z){return t(x,z)}),rn&&Xa(x,M),k}function w(x,T,y,_){if(typeof y=="object"&&y!==null&&y.type===hl&&y.key===null&&(y=y.props.children),typeof y=="object"&&y!==null){switch(y.$$typeof){case cd:e:{for(var k=y.key,S=T;S!==null;){if(S.key===k){if(k=y.type,k===hl){if(S.tag===7){n(x,S.sibling),T=i(S,y.props.children),T.return=x,x=T;break e}}else if(S.elementType===k||typeof k=="object"&&k!==null&&k.$$typeof===Qs&&Sw(k)===S.type){n(x,S.sibling),T=i(S,y.props),T.ref=qu(x,S,y),T.return=x,x=T;break e}n(x,S);break}else t(x,S);S=S.sibling}y.type===hl?(T=xo(y.props.children,x.mode,_,y.key),T.return=x,x=T):(_=a0(y.type,y.key,y.props,null,x.mode,_),_.ref=qu(x,T,y),_.return=x,x=_)}return a(x);case dl:e:{for(S=y.key;T!==null;){if(T.key===S)if(T.tag===4&&T.stateNode.containerInfo===y.containerInfo&&T.stateNode.implementation===y.implementation){n(x,T.sibling),T=i(T,y.children||[]),T.return=x,x=T;break e}else{n(x,T);break}else t(x,T);T=T.sibling}T=Vp(y,x.mode,_),T.return=x,x=T}return a(x);case Qs:return S=y._init,w(x,T,S(y._payload),_)}if(nc(y))return v(x,T,y,_);if(Hu(y))return g(x,T,y,_);Td(x,y)}return typeof y=="string"&&y!==""||typeof y=="number"?(y=""+y,T!==null&&T.tag===6?(n(x,T.sibling),T=i(T,y),T.return=x,x=T):(n(x,T),T=Up(y,x.mode,_),T.return=x,x=T),a(x)):n(x,T)}return w}var uu=Ek(!0),_k=Ek(!1),P0=Va(null),I0=null,Tl=null,nx=null;function rx(){nx=Tl=I0=null}function ix(e){var t=P0.current;Zt(P0),e._currentValue=t}function ng(e,t,n){for(;e!==null;){var r=e.alternate;if((e.childLanes&t)!==t?(e.childLanes|=t,r!==null&&(r.childLanes|=t)):r!==null&&(r.childLanes&t)!==t&&(r.childLanes|=t),e===n)break;e=e.return}}function bl(e,t){I0=e,nx=Tl=null,e=e.dependencies,e!==null&&e.firstContext!==null&&(e.lanes&t&&(Ir=!0),e.firstContext=null)}function Ti(e){var t=e._currentValue;if(nx!==e)if(e={context:e,memoizedValue:t,next:null},Tl===null){if(I0===null)throw Error(ke(308));Tl=e,I0.dependencies={lanes:0,firstContext:e}}else Tl=Tl.next=e;return t}var no=null;function sx(e){no===null?no=[e]:no.push(e)}function Ck(e,t,n,r){var i=t.interleaved;return i===null?(n.next=n,sx(t)):(n.next=i.next,i.next=n),t.interleaved=n,Ls(e,r)}function Ls(e,t){e.lanes|=t;var n=e.alternate;for(n!==null&&(n.lanes|=t),n=e,e=e.return;e!==null;)e.childLanes|=t,n=e.alternate,n!==null&&(n.childLanes|=t),n=e,e=e.return;return n.tag===3?n.stateNode:null}var js=!1;function ax(e){e.updateQueue={baseState:e.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function kk(e,t){e=e.updateQueue,t.updateQueue===e&&(t.updateQueue={baseState:e.baseState,firstBaseUpdate:e.firstBaseUpdate,lastBaseUpdate:e.lastBaseUpdate,shared:e.shared,effects:e.effects})}function Cs(e,t){return{eventTime:e,lane:t,tag:0,payload:null,callback:null,next:null}}function _a(e,t,n){var r=e.updateQueue;if(r===null)return null;if(r=r.shared,Ct&2){var i=r.pending;return i===null?t.next=t:(t.next=i.next,i.next=t),r.pending=t,Ls(e,n)}return i=r.interleaved,i===null?(t.next=t,sx(r)):(t.next=i.next,i.next=t),r.interleaved=t,Ls(e,n)}function e0(e,t,n){if(t=t.updateQueue,t!==null&&(t=t.shared,(n&4194240)!==0)){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gv(e,n)}}function Ew(e,t){var n=e.updateQueue,r=e.alternate;if(r!==null&&(r=r.updateQueue,n===r)){var i=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?i=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?i=s=t:s=s.next=t}else i=s=t;n={baseState:r.baseState,firstBaseUpdate:i,lastBaseUpdate:s,shared:r.shared,effects:r.effects},e.updateQueue=n;return}e=n.lastBaseUpdate,e===null?n.firstBaseUpdate=t:e.next=t,n.lastBaseUpdate=t}function N0(e,t,n,r){var i=e.updateQueue;js=!1;var s=i.firstBaseUpdate,a=i.lastBaseUpdate,o=i.shared.pending;if(o!==null){i.shared.pending=null;var l=o,u=l.next;l.next=null,a===null?s=u:a.next=u,a=l;var c=e.alternate;c!==null&&(c=c.updateQueue,o=c.lastBaseUpdate,o!==a&&(o===null?c.firstBaseUpdate=u:o.next=u,c.lastBaseUpdate=l))}if(s!==null){var h=i.baseState;a=0,c=u=l=null,o=s;do{var p=o.lane,m=o.eventTime;if((r&p)===p){c!==null&&(c=c.next={eventTime:m,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var v=e,g=o;switch(p=t,m=n,g.tag){case 1:if(v=g.payload,typeof v=="function"){h=v.call(m,h,p);break e}h=v;break e;case 3:v.flags=v.flags&-65537|128;case 0:if(v=g.payload,p=typeof v=="function"?v.call(m,h,p):v,p==null)break e;h=cn({},h,p);break e;case 2:js=!0}}o.callback!==null&&o.lane!==0&&(e.flags|=64,p=i.effects,p===null?i.effects=[o]:p.push(o))}else m={eventTime:m,lane:p,tag:o.tag,payload:o.payload,callback:o.callback,next:null},c===null?(u=c=m,l=h):c=c.next=m,a|=p;if(o=o.next,o===null){if(o=i.shared.pending,o===null)break;p=o,o=p.next,p.next=null,i.lastBaseUpdate=p,i.shared.pending=null}}while(!0);if(c===null&&(l=h),i.baseState=l,i.firstBaseUpdate=u,i.lastBaseUpdate=c,t=i.shared.interleaved,t!==null){i=t;do a|=i.lane,i=i.next;while(i!==t)}else s===null&&(i.shared.lanes=0);Mo|=a,e.lanes=a,e.memoizedState=h}}function _w(e,t,n){if(e=t.effects,t.effects=null,e!==null)for(t=0;t<e.length;t++){var r=e[t],i=r.callback;if(i!==null){if(r.callback=null,r=n,typeof i!="function")throw Error(ke(191,i));i.call(r)}}}var Of={},is=Va(Of),Xc=Va(Of),Jc=Va(Of);function ro(e){if(e===Of)throw Error(ke(174));return e}function ox(e,t){switch(Yt(Jc,t),Yt(Xc,e),Yt(is,Of),e=t.nodeType,e){case 9:case 11:t=(t=t.documentElement)?t.namespaceURI:Lm(null,"");break;default:e=e===8?t.parentNode:t,t=e.namespaceURI||null,e=e.tagName,t=Lm(t,e)}Zt(is),Yt(is,t)}function cu(){Zt(is),Zt(Xc),Zt(Jc)}function Ak(e){ro(Jc.current);var t=ro(is.current),n=Lm(t,e.type);t!==n&&(Yt(Xc,e),Yt(is,n))}function lx(e){Xc.current===e&&(Zt(is),Zt(Xc))}var sn=Va(0);function b0(e){for(var t=e;t!==null;){if(t.tag===13){var n=t.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return t}else if(t.tag===19&&t.memoizedProps.revealOrder!==void 0){if(t.flags&128)return t}else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return null;t=t.return}t.sibling.return=t.return,t=t.sibling}return null}var Ip=[];function ux(){for(var e=0;e<Ip.length;e++)Ip[e]._workInProgressVersionPrimary=null;Ip.length=0}var t0=Vs.ReactCurrentDispatcher,Np=Vs.ReactCurrentBatchConfig,Ro=0,un=null,Mn=null,Un=null,L0=!1,xc=!1,Qc=0,z4=0;function tr(){throw Error(ke(321))}function cx(e,t){if(t===null)return!1;for(var n=0;n<t.length&&n<e.length;n++)if(!$i(e[n],t[n]))return!1;return!0}function fx(e,t,n,r,i,s){if(Ro=s,un=t,t.memoizedState=null,t.updateQueue=null,t.lanes=0,t0.current=e===null||e.memoizedState===null?K4:Y4,e=n(r,i),xc){s=0;do{if(xc=!1,Qc=0,25<=s)throw Error(ke(301));s+=1,Un=Mn=null,t.updateQueue=null,t0.current=X4,e=n(r,i)}while(xc)}if(t0.current=O0,t=Mn!==null&&Mn.next!==null,Ro=0,Un=Mn=un=null,L0=!1,t)throw Error(ke(300));return e}function dx(){var e=Qc!==0;return Qc=0,e}function Qi(){var e={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return Un===null?un.memoizedState=Un=e:Un=Un.next=e,Un}function Si(){if(Mn===null){var e=un.alternate;e=e!==null?e.memoizedState:null}else e=Mn.next;var t=Un===null?un.memoizedState:Un.next;if(t!==null)Un=t,Mn=e;else{if(e===null)throw Error(ke(310));Mn=e,e={memoizedState:Mn.memoizedState,baseState:Mn.baseState,baseQueue:Mn.baseQueue,queue:Mn.queue,next:null},Un===null?un.memoizedState=Un=e:Un=Un.next=e}return Un}function jc(e,t){return typeof t=="function"?t(e):t}function bp(e){var t=Si(),n=t.queue;if(n===null)throw Error(ke(311));n.lastRenderedReducer=e;var r=Mn,i=r.baseQueue,s=n.pending;if(s!==null){if(i!==null){var a=i.next;i.next=s.next,s.next=a}r.baseQueue=i=s,n.pending=null}if(i!==null){s=i.next,r=r.baseState;var o=a=null,l=null,u=s;do{var c=u.lane;if((Ro&c)===c)l!==null&&(l=l.next={lane:0,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null}),r=u.hasEagerState?u.eagerState:e(r,u.action);else{var h={lane:c,action:u.action,hasEagerState:u.hasEagerState,eagerState:u.eagerState,next:null};l===null?(o=l=h,a=r):l=l.next=h,un.lanes|=c,Mo|=c}u=u.next}while(u!==null&&u!==s);l===null?a=r:l.next=o,$i(r,t.memoizedState)||(Ir=!0),t.memoizedState=r,t.baseState=a,t.baseQueue=l,n.lastRenderedState=r}if(e=n.interleaved,e!==null){i=e;do s=i.lane,un.lanes|=s,Mo|=s,i=i.next;while(i!==e)}else i===null&&(n.lanes=0);return[t.memoizedState,n.dispatch]}function Lp(e){var t=Si(),n=t.queue;if(n===null)throw Error(ke(311));n.lastRenderedReducer=e;var r=n.dispatch,i=n.pending,s=t.memoizedState;if(i!==null){n.pending=null;var a=i=i.next;do s=e(s,a.action),a=a.next;while(a!==i);$i(s,t.memoizedState)||(Ir=!0),t.memoizedState=s,t.baseQueue===null&&(t.baseState=s),n.lastRenderedState=s}return[s,r]}function Rk(){}function Mk(e,t){var n=un,r=Si(),i=t(),s=!$i(r.memoizedState,i);if(s&&(r.memoizedState=i,Ir=!0),r=r.queue,hx(Pk.bind(null,n,r,e),[e]),r.getSnapshot!==t||s||Un!==null&&Un.memoizedState.tag&1){if(n.flags|=2048,Zc(9,Dk.bind(null,n,r,i,t),void 0,null),zn===null)throw Error(ke(349));Ro&30||Fk(n,t,i)}return i}function Fk(e,t,n){e.flags|=16384,e={getSnapshot:t,value:n},t=un.updateQueue,t===null?(t={lastEffect:null,stores:null},un.updateQueue=t,t.stores=[e]):(n=t.stores,n===null?t.stores=[e]:n.push(e))}function Dk(e,t,n,r){t.value=n,t.getSnapshot=r,Ik(t)&&Nk(e)}function Pk(e,t,n){return n(function(){Ik(t)&&Nk(e)})}function Ik(e){var t=e.getSnapshot;e=e.value;try{var n=t();return!$i(e,n)}catch{return!0}}function Nk(e){var t=Ls(e,1);t!==null&&Ui(t,e,1,-1)}function Cw(e){var t=Qi();return typeof e=="function"&&(e=e()),t.memoizedState=t.baseState=e,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:jc,lastRenderedState:e},t.queue=e,e=e.dispatch=q4.bind(null,un,e),[t.memoizedState,e]}function Zc(e,t,n,r){return e={tag:e,create:t,destroy:n,deps:r,next:null},t=un.updateQueue,t===null?(t={lastEffect:null,stores:null},un.updateQueue=t,t.lastEffect=e.next=e):(n=t.lastEffect,n===null?t.lastEffect=e.next=e:(r=n.next,n.next=e,e.next=r,t.lastEffect=e)),e}function bk(){return Si().memoizedState}function n0(e,t,n,r){var i=Qi();un.flags|=e,i.memoizedState=Zc(1|t,n,void 0,r===void 0?null:r)}function Ph(e,t,n,r){var i=Si();r=r===void 0?null:r;var s=void 0;if(Mn!==null){var a=Mn.memoizedState;if(s=a.destroy,r!==null&&cx(r,a.deps)){i.memoizedState=Zc(t,n,s,r);return}}un.flags|=e,i.memoizedState=Zc(1|t,n,s,r)}function kw(e,t){return n0(8390656,8,e,t)}function hx(e,t){return Ph(2048,8,e,t)}function Lk(e,t){return Ph(4,2,e,t)}function Ok(e,t){return Ph(4,4,e,t)}function Bk(e,t){if(typeof t=="function")return e=e(),t(e),function(){t(null)};if(t!=null)return e=e(),t.current=e,function(){t.current=null}}function Uk(e,t,n){return n=n!=null?n.concat([e]):null,Ph(4,4,Bk.bind(null,t,e),n)}function px(){}function Vk(e,t){var n=Si();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&cx(t,r[1])?r[0]:(n.memoizedState=[e,t],e)}function Hk(e,t){var n=Si();t=t===void 0?null:t;var r=n.memoizedState;return r!==null&&t!==null&&cx(t,r[1])?r[0]:(e=e(),n.memoizedState=[e,t],e)}function $k(e,t,n){return Ro&21?($i(n,t)||(n=K2(),un.lanes|=n,Mo|=n,e.baseState=!0),t):(e.baseState&&(e.baseState=!1,Ir=!0),e.memoizedState=n)}function W4(e,t){var n=zt;zt=n!==0&&4>n?n:4,e(!0);var r=Np.transition;Np.transition={};try{e(!1),t()}finally{zt=n,Np.transition=r}}function zk(){return Si().memoizedState}function G4(e,t,n){var r=ka(e);if(n={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null},Wk(e))Gk(t,n);else if(n=Ck(e,t,n,r),n!==null){var i=Er();Ui(n,e,r,i),qk(n,t,r)}}function q4(e,t,n){var r=ka(e),i={lane:r,action:n,hasEagerState:!1,eagerState:null,next:null};if(Wk(e))Gk(t,i);else{var s=e.alternate;if(e.lanes===0&&(s===null||s.lanes===0)&&(s=t.lastRenderedReducer,s!==null))try{var a=t.lastRenderedState,o=s(a,n);if(i.hasEagerState=!0,i.eagerState=o,$i(o,a)){var l=t.interleaved;l===null?(i.next=i,sx(t)):(i.next=l.next,l.next=i),t.interleaved=i;return}}catch{}finally{}n=Ck(e,t,i,r),n!==null&&(i=Er(),Ui(n,e,r,i),qk(n,t,r))}}function Wk(e){var t=e.alternate;return e===un||t!==null&&t===un}function Gk(e,t){xc=L0=!0;var n=e.pending;n===null?t.next=t:(t.next=n.next,n.next=t),e.pending=t}function qk(e,t,n){if(n&4194240){var r=t.lanes;r&=e.pendingLanes,n|=r,t.lanes=n,Gv(e,n)}}var O0={readContext:Ti,useCallback:tr,useContext:tr,useEffect:tr,useImperativeHandle:tr,useInsertionEffect:tr,useLayoutEffect:tr,useMemo:tr,useReducer:tr,useRef:tr,useState:tr,useDebugValue:tr,useDeferredValue:tr,useTransition:tr,useMutableSource:tr,useSyncExternalStore:tr,useId:tr,unstable_isNewReconciler:!1},K4={readContext:Ti,useCallback:function(e,t){return Qi().memoizedState=[e,t===void 0?null:t],e},useContext:Ti,useEffect:kw,useImperativeHandle:function(e,t,n){return n=n!=null?n.concat([e]):null,n0(4194308,4,Bk.bind(null,t,e),n)},useLayoutEffect:function(e,t){return n0(4194308,4,e,t)},useInsertionEffect:function(e,t){return n0(4,2,e,t)},useMemo:function(e,t){var n=Qi();return t=t===void 0?null:t,e=e(),n.memoizedState=[e,t],e},useReducer:function(e,t,n){var r=Qi();return t=n!==void 0?n(t):t,r.memoizedState=r.baseState=t,e={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:e,lastRenderedState:t},r.queue=e,e=e.dispatch=G4.bind(null,un,e),[r.memoizedState,e]},useRef:function(e){var t=Qi();return e={current:e},t.memoizedState=e},useState:Cw,useDebugValue:px,useDeferredValue:function(e){return Qi().memoizedState=e},useTransition:function(){var e=Cw(!1),t=e[0];return e=W4.bind(null,e[1]),Qi().memoizedState=e,[t,e]},useMutableSource:function(){},useSyncExternalStore:function(e,t,n){var r=un,i=Qi();if(rn){if(n===void 0)throw Error(ke(407));n=n()}else{if(n=t(),zn===null)throw Error(ke(349));Ro&30||Fk(r,t,n)}i.memoizedState=n;var s={value:n,getSnapshot:t};return i.queue=s,kw(Pk.bind(null,r,s,e),[e]),r.flags|=2048,Zc(9,Dk.bind(null,r,s,n,t),void 0,null),n},useId:function(){var e=Qi(),t=zn.identifierPrefix;if(rn){var n=Es,r=Ss;n=(r&~(1<<32-Bi(r)-1)).toString(32)+n,t=":"+t+"R"+n,n=Qc++,0<n&&(t+="H"+n.toString(32)),t+=":"}else n=z4++,t=":"+t+"r"+n.toString(32)+":";return e.memoizedState=t},unstable_isNewReconciler:!1},Y4={readContext:Ti,useCallback:Vk,useContext:Ti,useEffect:hx,useImperativeHandle:Uk,useInsertionEffect:Lk,useLayoutEffect:Ok,useMemo:Hk,useReducer:bp,useRef:bk,useState:function(){return bp(jc)},useDebugValue:px,useDeferredValue:function(e){var t=Si();return $k(t,Mn.memoizedState,e)},useTransition:function(){var e=bp(jc)[0],t=Si().memoizedState;return[e,t]},useMutableSource:Rk,useSyncExternalStore:Mk,useId:zk,unstable_isNewReconciler:!1},X4={readContext:Ti,useCallback:Vk,useContext:Ti,useEffect:hx,useImperativeHandle:Uk,useInsertionEffect:Lk,useLayoutEffect:Ok,useMemo:Hk,useReducer:Lp,useRef:bk,useState:function(){return Lp(jc)},useDebugValue:px,useDeferredValue:function(e){var t=Si();return Mn===null?t.memoizedState=e:$k(t,Mn.memoizedState,e)},useTransition:function(){var e=Lp(jc)[0],t=Si().memoizedState;return[e,t]},useMutableSource:Rk,useSyncExternalStore:Mk,useId:zk,unstable_isNewReconciler:!1};function Di(e,t){if(e&&e.defaultProps){t=cn({},t),e=e.defaultProps;for(var n in e)t[n]===void 0&&(t[n]=e[n]);return t}return t}function rg(e,t,n,r){t=e.memoizedState,n=n(r,t),n=n==null?t:cn({},t,n),e.memoizedState=n,e.lanes===0&&(e.updateQueue.baseState=n)}var Ih={isMounted:function(e){return(e=e._reactInternals)?zo(e)===e:!1},enqueueSetState:function(e,t,n){e=e._reactInternals;var r=Er(),i=ka(e),s=Cs(r,i);s.payload=t,n!=null&&(s.callback=n),t=_a(e,s,i),t!==null&&(Ui(t,e,i,r),e0(t,e,i))},enqueueReplaceState:function(e,t,n){e=e._reactInternals;var r=Er(),i=ka(e),s=Cs(r,i);s.tag=1,s.payload=t,n!=null&&(s.callback=n),t=_a(e,s,i),t!==null&&(Ui(t,e,i,r),e0(t,e,i))},enqueueForceUpdate:function(e,t){e=e._reactInternals;var n=Er(),r=ka(e),i=Cs(n,r);i.tag=2,t!=null&&(i.callback=t),t=_a(e,i,r),t!==null&&(Ui(t,e,r,n),e0(t,e,r))}};function Aw(e,t,n,r,i,s,a){return e=e.stateNode,typeof e.shouldComponentUpdate=="function"?e.shouldComponentUpdate(r,s,a):t.prototype&&t.prototype.isPureReactComponent?!Gc(n,r)||!Gc(i,s):!0}function Kk(e,t,n){var r=!1,i=Fa,s=t.contextType;return typeof s=="object"&&s!==null?s=Ti(s):(i=br(t)?ko:pr.current,r=t.contextTypes,s=(r=r!=null)?ou(e,i):Fa),t=new t(n,s),e.memoizedState=t.state!==null&&t.state!==void 0?t.state:null,t.updater=Ih,e.stateNode=t,t._reactInternals=e,r&&(e=e.stateNode,e.__reactInternalMemoizedUnmaskedChildContext=i,e.__reactInternalMemoizedMaskedChildContext=s),t}function Rw(e,t,n,r){e=t.state,typeof t.componentWillReceiveProps=="function"&&t.componentWillReceiveProps(n,r),typeof t.UNSAFE_componentWillReceiveProps=="function"&&t.UNSAFE_componentWillReceiveProps(n,r),t.state!==e&&Ih.enqueueReplaceState(t,t.state,null)}function ig(e,t,n,r){var i=e.stateNode;i.props=n,i.state=e.memoizedState,i.refs={},ax(e);var s=t.contextType;typeof s=="object"&&s!==null?i.context=Ti(s):(s=br(t)?ko:pr.current,i.context=ou(e,s)),i.state=e.memoizedState,s=t.getDerivedStateFromProps,typeof s=="function"&&(rg(e,t,s,n),i.state=e.memoizedState),typeof t.getDerivedStateFromProps=="function"||typeof i.getSnapshotBeforeUpdate=="function"||typeof i.UNSAFE_componentWillMount!="function"&&typeof i.componentWillMount!="function"||(t=i.state,typeof i.componentWillMount=="function"&&i.componentWillMount(),typeof i.UNSAFE_componentWillMount=="function"&&i.UNSAFE_componentWillMount(),t!==i.state&&Ih.enqueueReplaceState(i,i.state,null),N0(e,n,i,r),i.state=e.memoizedState),typeof i.componentDidMount=="function"&&(e.flags|=4194308)}function fu(e,t){try{var n="",r=t;do n+=EN(r),r=r.return;while(r);var i=n}catch(s){i=`
Error generating stack: `+s.message+`
`+s.stack}return{value:e,source:t,stack:i,digest:null}}function Op(e,t,n){return{value:e,source:null,stack:n??null,digest:t??null}}function sg(e,t){try{console.error(t.value)}catch(n){setTimeout(function(){throw n})}}var J4=typeof WeakMap=="function"?WeakMap:Map;function Yk(e,t,n){n=Cs(-1,n),n.tag=3,n.payload={element:null};var r=t.value;return n.callback=function(){U0||(U0=!0,mg=r),sg(e,t)},n}function Xk(e,t,n){n=Cs(-1,n),n.tag=3;var r=e.type.getDerivedStateFromError;if(typeof r=="function"){var i=t.value;n.payload=function(){return r(i)},n.callback=function(){sg(e,t)}}var s=e.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){sg(e,t),typeof r!="function"&&(Ca===null?Ca=new Set([this]):Ca.add(this));var a=t.stack;this.componentDidCatch(t.value,{componentStack:a!==null?a:""})}),n}function Mw(e,t,n){var r=e.pingCache;if(r===null){r=e.pingCache=new J4;var i=new Set;r.set(t,i)}else i=r.get(t),i===void 0&&(i=new Set,r.set(t,i));i.has(n)||(i.add(n),e=cb.bind(null,e,t,n),t.then(e,e))}function Fw(e){do{var t;if((t=e.tag===13)&&(t=e.memoizedState,t=t!==null?t.dehydrated!==null:!0),t)return e;e=e.return}while(e!==null);return null}function Dw(e,t,n,r,i){return e.mode&1?(e.flags|=65536,e.lanes=i,e):(e===t?e.flags|=65536:(e.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(t=Cs(-1,1),t.tag=2,_a(n,t,1))),n.lanes|=1),e)}var Q4=Vs.ReactCurrentOwner,Ir=!1;function yr(e,t,n,r){t.child=e===null?_k(t,null,n,r):uu(t,e.child,n,r)}function Pw(e,t,n,r,i){n=n.render;var s=t.ref;return bl(t,i),r=fx(e,t,n,r,s,i),n=dx(),e!==null&&!Ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Os(e,t,i)):(rn&&n&&Zv(t),t.flags|=1,yr(e,t,r,i),t.child)}function Iw(e,t,n,r,i){if(e===null){var s=n.type;return typeof s=="function"&&!Sx(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(t.tag=15,t.type=s,Jk(e,t,s,r,i)):(e=a0(n.type,null,r,t,t.mode,i),e.ref=t.ref,e.return=t,t.child=e)}if(s=e.child,!(e.lanes&i)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:Gc,n(a,r)&&e.ref===t.ref)return Os(e,t,i)}return t.flags|=1,e=Aa(s,r),e.ref=t.ref,e.return=t,t.child=e}function Jk(e,t,n,r,i){if(e!==null){var s=e.memoizedProps;if(Gc(s,r)&&e.ref===t.ref)if(Ir=!1,t.pendingProps=r=s,(e.lanes&i)!==0)e.flags&131072&&(Ir=!0);else return t.lanes=e.lanes,Os(e,t,i)}return ag(e,t,n,r,i)}function Qk(e,t,n){var r=t.pendingProps,i=r.children,s=e!==null?e.memoizedState:null;if(r.mode==="hidden")if(!(t.mode&1))t.memoizedState={baseLanes:0,cachePool:null,transitions:null},Yt(El,Hr),Hr|=n;else{if(!(n&1073741824))return e=s!==null?s.baseLanes|n:n,t.lanes=t.childLanes=1073741824,t.memoizedState={baseLanes:e,cachePool:null,transitions:null},t.updateQueue=null,Yt(El,Hr),Hr|=e,null;t.memoizedState={baseLanes:0,cachePool:null,transitions:null},r=s!==null?s.baseLanes:n,Yt(El,Hr),Hr|=r}else s!==null?(r=s.baseLanes|n,t.memoizedState=null):r=n,Yt(El,Hr),Hr|=r;return yr(e,t,i,n),t.child}function jk(e,t){var n=t.ref;(e===null&&n!==null||e!==null&&e.ref!==n)&&(t.flags|=512,t.flags|=2097152)}function ag(e,t,n,r,i){var s=br(n)?ko:pr.current;return s=ou(t,s),bl(t,i),n=fx(e,t,n,r,s,i),r=dx(),e!==null&&!Ir?(t.updateQueue=e.updateQueue,t.flags&=-2053,e.lanes&=~i,Os(e,t,i)):(rn&&r&&Zv(t),t.flags|=1,yr(e,t,n,i),t.child)}function Nw(e,t,n,r,i){if(br(n)){var s=!0;M0(t)}else s=!1;if(bl(t,i),t.stateNode===null)r0(e,t),Kk(t,n,r),ig(t,n,r,i),r=!0;else if(e===null){var a=t.stateNode,o=t.memoizedProps;a.props=o;var l=a.context,u=n.contextType;typeof u=="object"&&u!==null?u=Ti(u):(u=br(n)?ko:pr.current,u=ou(t,u));var c=n.getDerivedStateFromProps,h=typeof c=="function"||typeof a.getSnapshotBeforeUpdate=="function";h||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==r||l!==u)&&Rw(t,a,r,u),js=!1;var p=t.memoizedState;a.state=p,N0(t,r,a,i),l=t.memoizedState,o!==r||p!==l||Nr.current||js?(typeof c=="function"&&(rg(t,n,c,r),l=t.memoizedState),(o=js||Aw(t,n,o,r,p,l,u))?(h||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(t.flags|=4194308)):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),t.memoizedProps=r,t.memoizedState=l),a.props=r,a.state=l,a.context=u,r=o):(typeof a.componentDidMount=="function"&&(t.flags|=4194308),r=!1)}else{a=t.stateNode,kk(e,t),o=t.memoizedProps,u=t.type===t.elementType?o:Di(t.type,o),a.props=u,h=t.pendingProps,p=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=Ti(l):(l=br(n)?ko:pr.current,l=ou(t,l));var m=n.getDerivedStateFromProps;(c=typeof m=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==h||p!==l)&&Rw(t,a,r,l),js=!1,p=t.memoizedState,a.state=p,N0(t,r,a,i);var v=t.memoizedState;o!==h||p!==v||Nr.current||js?(typeof m=="function"&&(rg(t,n,m,r),v=t.memoizedState),(u=js||Aw(t,n,u,r,p,v,l)||!1)?(c||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(r,v,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(r,v,l)),typeof a.componentDidUpdate=="function"&&(t.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(t.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),t.memoizedProps=r,t.memoizedState=v),a.props=r,a.state=v,a.context=l,r=u):(typeof a.componentDidUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===e.memoizedProps&&p===e.memoizedState||(t.flags|=1024),r=!1)}return og(e,t,n,r,s,i)}function og(e,t,n,r,i,s){jk(e,t);var a=(t.flags&128)!==0;if(!r&&!a)return i&&yw(t,n,!1),Os(e,t,s);r=t.stateNode,Q4.current=t;var o=a&&typeof n.getDerivedStateFromError!="function"?null:r.render();return t.flags|=1,e!==null&&a?(t.child=uu(t,e.child,null,s),t.child=uu(t,null,o,s)):yr(e,t,o,s),t.memoizedState=r.state,i&&yw(t,n,!0),t.child}function Zk(e){var t=e.stateNode;t.pendingContext?xw(e,t.pendingContext,t.pendingContext!==t.context):t.context&&xw(e,t.context,!1),ox(e,t.containerInfo)}function bw(e,t,n,r,i){return lu(),tx(i),t.flags|=256,yr(e,t,n,r),t.child}var lg={dehydrated:null,treeContext:null,retryLane:0};function ug(e){return{baseLanes:e,cachePool:null,transitions:null}}function eA(e,t,n){var r=t.pendingProps,i=sn.current,s=!1,a=(t.flags&128)!==0,o;if((o=a)||(o=e!==null&&e.memoizedState===null?!1:(i&2)!==0),o?(s=!0,t.flags&=-129):(e===null||e.memoizedState!==null)&&(i|=1),Yt(sn,i&1),e===null)return tg(t),e=t.memoizedState,e!==null&&(e=e.dehydrated,e!==null)?(t.mode&1?e.data==="$!"?t.lanes=8:t.lanes=1073741824:t.lanes=1,null):(a=r.children,e=r.fallback,s?(r=t.mode,s=t.child,a={mode:"hidden",children:a},!(r&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=Lh(a,r,0,null),e=xo(e,r,n,null),s.return=t,e.return=t,s.sibling=e,t.child=s,t.child.memoizedState=ug(n),t.memoizedState=lg,e):mx(t,a));if(i=e.memoizedState,i!==null&&(o=i.dehydrated,o!==null))return j4(e,t,a,r,o,i,n);if(s){s=r.fallback,a=t.mode,i=e.child,o=i.sibling;var l={mode:"hidden",children:r.children};return!(a&1)&&t.child!==i?(r=t.child,r.childLanes=0,r.pendingProps=l,t.deletions=null):(r=Aa(i,l),r.subtreeFlags=i.subtreeFlags&14680064),o!==null?s=Aa(o,s):(s=xo(s,a,n,null),s.flags|=2),s.return=t,r.return=t,r.sibling=s,t.child=r,r=s,s=t.child,a=e.child.memoizedState,a=a===null?ug(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=e.childLanes&~n,t.memoizedState=lg,r}return s=e.child,e=s.sibling,r=Aa(s,{mode:"visible",children:r.children}),!(t.mode&1)&&(r.lanes=n),r.return=t,r.sibling=null,e!==null&&(n=t.deletions,n===null?(t.deletions=[e],t.flags|=16):n.push(e)),t.child=r,t.memoizedState=null,r}function mx(e,t){return t=Lh({mode:"visible",children:t},e.mode,0,null),t.return=e,e.child=t}function Sd(e,t,n,r){return r!==null&&tx(r),uu(t,e.child,null,n),e=mx(t,t.pendingProps.children),e.flags|=2,t.memoizedState=null,e}function j4(e,t,n,r,i,s,a){if(n)return t.flags&256?(t.flags&=-257,r=Op(Error(ke(422))),Sd(e,t,a,r)):t.memoizedState!==null?(t.child=e.child,t.flags|=128,null):(s=r.fallback,i=t.mode,r=Lh({mode:"visible",children:r.children},i,0,null),s=xo(s,i,a,null),s.flags|=2,r.return=t,s.return=t,r.sibling=s,t.child=r,t.mode&1&&uu(t,e.child,null,a),t.child.memoizedState=ug(a),t.memoizedState=lg,s);if(!(t.mode&1))return Sd(e,t,a,null);if(i.data==="$!"){if(r=i.nextSibling&&i.nextSibling.dataset,r)var o=r.dgst;return r=o,s=Error(ke(419)),r=Op(s,r,void 0),Sd(e,t,a,r)}if(o=(a&e.childLanes)!==0,Ir||o){if(r=zn,r!==null){switch(a&-a){case 4:i=2;break;case 16:i=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:i=32;break;case 536870912:i=268435456;break;default:i=0}i=i&(r.suspendedLanes|a)?0:i,i!==0&&i!==s.retryLane&&(s.retryLane=i,Ls(e,i),Ui(r,e,i,-1))}return Tx(),r=Op(Error(ke(421))),Sd(e,t,a,r)}return i.data==="$?"?(t.flags|=128,t.child=e.child,t=fb.bind(null,e),i._reactRetry=t,null):(e=s.treeContext,Kr=Ea(i.nextSibling),Yr=t,rn=!0,bi=null,e!==null&&(mi[gi++]=Ss,mi[gi++]=Es,mi[gi++]=Ao,Ss=e.id,Es=e.overflow,Ao=t),t=mx(t,r.children),t.flags|=4096,t)}function Lw(e,t,n){e.lanes|=t;var r=e.alternate;r!==null&&(r.lanes|=t),ng(e.return,t,n)}function Bp(e,t,n,r,i){var s=e.memoizedState;s===null?e.memoizedState={isBackwards:t,rendering:null,renderingStartTime:0,last:r,tail:n,tailMode:i}:(s.isBackwards=t,s.rendering=null,s.renderingStartTime=0,s.last=r,s.tail=n,s.tailMode=i)}function tA(e,t,n){var r=t.pendingProps,i=r.revealOrder,s=r.tail;if(yr(e,t,r.children,n),r=sn.current,r&2)r=r&1|2,t.flags|=128;else{if(e!==null&&e.flags&128)e:for(e=t.child;e!==null;){if(e.tag===13)e.memoizedState!==null&&Lw(e,n,t);else if(e.tag===19)Lw(e,n,t);else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break e;for(;e.sibling===null;){if(e.return===null||e.return===t)break e;e=e.return}e.sibling.return=e.return,e=e.sibling}r&=1}if(Yt(sn,r),!(t.mode&1))t.memoizedState=null;else switch(i){case"forwards":for(n=t.child,i=null;n!==null;)e=n.alternate,e!==null&&b0(e)===null&&(i=n),n=n.sibling;n=i,n===null?(i=t.child,t.child=null):(i=n.sibling,n.sibling=null),Bp(t,!1,i,n,s);break;case"backwards":for(n=null,i=t.child,t.child=null;i!==null;){if(e=i.alternate,e!==null&&b0(e)===null){t.child=i;break}e=i.sibling,i.sibling=n,n=i,i=e}Bp(t,!0,n,null,s);break;case"together":Bp(t,!1,null,null,void 0);break;default:t.memoizedState=null}return t.child}function r0(e,t){!(t.mode&1)&&e!==null&&(e.alternate=null,t.alternate=null,t.flags|=2)}function Os(e,t,n){if(e!==null&&(t.dependencies=e.dependencies),Mo|=t.lanes,!(n&t.childLanes))return null;if(e!==null&&t.child!==e.child)throw Error(ke(153));if(t.child!==null){for(e=t.child,n=Aa(e,e.pendingProps),t.child=n,n.return=t;e.sibling!==null;)e=e.sibling,n=n.sibling=Aa(e,e.pendingProps),n.return=t;n.sibling=null}return t.child}function Z4(e,t,n){switch(t.tag){case 3:Zk(t),lu();break;case 5:Ak(t);break;case 1:br(t.type)&&M0(t);break;case 4:ox(t,t.stateNode.containerInfo);break;case 10:var r=t.type._context,i=t.memoizedProps.value;Yt(P0,r._currentValue),r._currentValue=i;break;case 13:if(r=t.memoizedState,r!==null)return r.dehydrated!==null?(Yt(sn,sn.current&1),t.flags|=128,null):n&t.child.childLanes?eA(e,t,n):(Yt(sn,sn.current&1),e=Os(e,t,n),e!==null?e.sibling:null);Yt(sn,sn.current&1);break;case 19:if(r=(n&t.childLanes)!==0,e.flags&128){if(r)return tA(e,t,n);t.flags|=128}if(i=t.memoizedState,i!==null&&(i.rendering=null,i.tail=null,i.lastEffect=null),Yt(sn,sn.current),r)break;return null;case 22:case 23:return t.lanes=0,Qk(e,t,n)}return Os(e,t,n)}var nA,cg,rA,iA;nA=function(e,t){for(var n=t.child;n!==null;){if(n.tag===5||n.tag===6)e.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===t)break;for(;n.sibling===null;){if(n.return===null||n.return===t)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};cg=function(){};rA=function(e,t,n,r){var i=e.memoizedProps;if(i!==r){e=t.stateNode,ro(is.current);var s=null;switch(n){case"input":i=Pm(e,i),r=Pm(e,r),s=[];break;case"select":i=cn({},i,{value:void 0}),r=cn({},r,{value:void 0}),s=[];break;case"textarea":i=bm(e,i),r=bm(e,r),s=[];break;default:typeof i.onClick!="function"&&typeof r.onClick=="function"&&(e.onclick=A0)}Om(n,r);var a;n=null;for(u in i)if(!r.hasOwnProperty(u)&&i.hasOwnProperty(u)&&i[u]!=null)if(u==="style"){var o=i[u];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else u!=="dangerouslySetInnerHTML"&&u!=="children"&&u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&u!=="autoFocus"&&(Bc.hasOwnProperty(u)?s||(s=[]):(s=s||[]).push(u,null));for(u in r){var l=r[u];if(o=i!=null?i[u]:void 0,r.hasOwnProperty(u)&&l!==o&&(l!=null||o!=null))if(u==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(u,n)),n=l;else u==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(u,l)):u==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(u,""+l):u!=="suppressContentEditableWarning"&&u!=="suppressHydrationWarning"&&(Bc.hasOwnProperty(u)?(l!=null&&u==="onScroll"&&Jt("scroll",e),s||o===l||(s=[])):(s=s||[]).push(u,l))}n&&(s=s||[]).push("style",n);var u=s;(t.updateQueue=u)&&(t.flags|=4)}};iA=function(e,t,n,r){n!==r&&(t.flags|=4)};function Ku(e,t){if(!rn)switch(e.tailMode){case"hidden":t=e.tail;for(var n=null;t!==null;)t.alternate!==null&&(n=t),t=t.sibling;n===null?e.tail=null:n.sibling=null;break;case"collapsed":n=e.tail;for(var r=null;n!==null;)n.alternate!==null&&(r=n),n=n.sibling;r===null?t||e.tail===null?e.tail=null:e.tail.sibling=null:r.sibling=null}}function nr(e){var t=e.alternate!==null&&e.alternate.child===e.child,n=0,r=0;if(t)for(var i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags&14680064,r|=i.flags&14680064,i.return=e,i=i.sibling;else for(i=e.child;i!==null;)n|=i.lanes|i.childLanes,r|=i.subtreeFlags,r|=i.flags,i.return=e,i=i.sibling;return e.subtreeFlags|=r,e.childLanes=n,t}function eb(e,t,n){var r=t.pendingProps;switch(ex(t),t.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return nr(t),null;case 1:return br(t.type)&&R0(),nr(t),null;case 3:return r=t.stateNode,cu(),Zt(Nr),Zt(pr),ux(),r.pendingContext&&(r.context=r.pendingContext,r.pendingContext=null),(e===null||e.child===null)&&(wd(t)?t.flags|=4:e===null||e.memoizedState.isDehydrated&&!(t.flags&256)||(t.flags|=1024,bi!==null&&(xg(bi),bi=null))),cg(e,t),nr(t),null;case 5:lx(t);var i=ro(Jc.current);if(n=t.type,e!==null&&t.stateNode!=null)rA(e,t,n,r,i),e.ref!==t.ref&&(t.flags|=512,t.flags|=2097152);else{if(!r){if(t.stateNode===null)throw Error(ke(166));return nr(t),null}if(e=ro(is.current),wd(t)){r=t.stateNode,n=t.type;var s=t.memoizedProps;switch(r[ts]=t,r[Yc]=s,e=(t.mode&1)!==0,n){case"dialog":Jt("cancel",r),Jt("close",r);break;case"iframe":case"object":case"embed":Jt("load",r);break;case"video":case"audio":for(i=0;i<ic.length;i++)Jt(ic[i],r);break;case"source":Jt("error",r);break;case"img":case"image":case"link":Jt("error",r),Jt("load",r);break;case"details":Jt("toggle",r);break;case"input":Gy(r,s),Jt("invalid",r);break;case"select":r._wrapperState={wasMultiple:!!s.multiple},Jt("invalid",r);break;case"textarea":Ky(r,s),Jt("invalid",r)}Om(n,s),i=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?r.textContent!==o&&(s.suppressHydrationWarning!==!0&&yd(r.textContent,o,e),i=["children",o]):typeof o=="number"&&r.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&yd(r.textContent,o,e),i=["children",""+o]):Bc.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Jt("scroll",r)}switch(n){case"input":fd(r),qy(r,s,!0);break;case"textarea":fd(r),Yy(r);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(r.onclick=A0)}r=i,t.updateQueue=r,r!==null&&(t.flags|=4)}else{a=i.nodeType===9?i:i.ownerDocument,e==="http://www.w3.org/1999/xhtml"&&(e=P2(n)),e==="http://www.w3.org/1999/xhtml"?n==="script"?(e=a.createElement("div"),e.innerHTML="<script><\/script>",e=e.removeChild(e.firstChild)):typeof r.is=="string"?e=a.createElement(n,{is:r.is}):(e=a.createElement(n),n==="select"&&(a=e,r.multiple?a.multiple=!0:r.size&&(a.size=r.size))):e=a.createElementNS(e,n),e[ts]=t,e[Yc]=r,nA(e,t,!1,!1),t.stateNode=e;e:{switch(a=Bm(n,r),n){case"dialog":Jt("cancel",e),Jt("close",e),i=r;break;case"iframe":case"object":case"embed":Jt("load",e),i=r;break;case"video":case"audio":for(i=0;i<ic.length;i++)Jt(ic[i],e);i=r;break;case"source":Jt("error",e),i=r;break;case"img":case"image":case"link":Jt("error",e),Jt("load",e),i=r;break;case"details":Jt("toggle",e),i=r;break;case"input":Gy(e,r),i=Pm(e,r),Jt("invalid",e);break;case"option":i=r;break;case"select":e._wrapperState={wasMultiple:!!r.multiple},i=cn({},r,{value:void 0}),Jt("invalid",e);break;case"textarea":Ky(e,r),i=bm(e,r),Jt("invalid",e);break;default:i=r}Om(n,i),o=i;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?b2(e,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&I2(e,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&Uc(e,l):typeof l=="number"&&Uc(e,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(Bc.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Jt("scroll",e):l!=null&&Uv(e,s,l,a))}switch(n){case"input":fd(e),qy(e,r,!1);break;case"textarea":fd(e),Yy(e);break;case"option":r.value!=null&&e.setAttribute("value",""+Ma(r.value));break;case"select":e.multiple=!!r.multiple,s=r.value,s!=null?Dl(e,!!r.multiple,s,!1):r.defaultValue!=null&&Dl(e,!!r.multiple,r.defaultValue,!0);break;default:typeof i.onClick=="function"&&(e.onclick=A0)}switch(n){case"button":case"input":case"select":case"textarea":r=!!r.autoFocus;break e;case"img":r=!0;break e;default:r=!1}}r&&(t.flags|=4)}t.ref!==null&&(t.flags|=512,t.flags|=2097152)}return nr(t),null;case 6:if(e&&t.stateNode!=null)iA(e,t,e.memoizedProps,r);else{if(typeof r!="string"&&t.stateNode===null)throw Error(ke(166));if(n=ro(Jc.current),ro(is.current),wd(t)){if(r=t.stateNode,n=t.memoizedProps,r[ts]=t,(s=r.nodeValue!==n)&&(e=Yr,e!==null))switch(e.tag){case 3:yd(r.nodeValue,n,(e.mode&1)!==0);break;case 5:e.memoizedProps.suppressHydrationWarning!==!0&&yd(r.nodeValue,n,(e.mode&1)!==0)}s&&(t.flags|=4)}else r=(n.nodeType===9?n:n.ownerDocument).createTextNode(r),r[ts]=t,t.stateNode=r}return nr(t),null;case 13:if(Zt(sn),r=t.memoizedState,e===null||e.memoizedState!==null&&e.memoizedState.dehydrated!==null){if(rn&&Kr!==null&&t.mode&1&&!(t.flags&128))Sk(),lu(),t.flags|=98560,s=!1;else if(s=wd(t),r!==null&&r.dehydrated!==null){if(e===null){if(!s)throw Error(ke(318));if(s=t.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ke(317));s[ts]=t}else lu(),!(t.flags&128)&&(t.memoizedState=null),t.flags|=4;nr(t),s=!1}else bi!==null&&(xg(bi),bi=null),s=!0;if(!s)return t.flags&65536?t:null}return t.flags&128?(t.lanes=n,t):(r=r!==null,r!==(e!==null&&e.memoizedState!==null)&&r&&(t.child.flags|=8192,t.mode&1&&(e===null||sn.current&1?In===0&&(In=3):Tx())),t.updateQueue!==null&&(t.flags|=4),nr(t),null);case 4:return cu(),cg(e,t),e===null&&qc(t.stateNode.containerInfo),nr(t),null;case 10:return ix(t.type._context),nr(t),null;case 17:return br(t.type)&&R0(),nr(t),null;case 19:if(Zt(sn),s=t.memoizedState,s===null)return nr(t),null;if(r=(t.flags&128)!==0,a=s.rendering,a===null)if(r)Ku(s,!1);else{if(In!==0||e!==null&&e.flags&128)for(e=t.child;e!==null;){if(a=b0(e),a!==null){for(t.flags|=128,Ku(s,!1),r=a.updateQueue,r!==null&&(t.updateQueue=r,t.flags|=4),t.subtreeFlags=0,r=n,n=t.child;n!==null;)s=n,e=r,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=e,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,e=a.dependencies,s.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext}),n=n.sibling;return Yt(sn,sn.current&1|2),t.child}e=e.sibling}s.tail!==null&&Tn()>du&&(t.flags|=128,r=!0,Ku(s,!1),t.lanes=4194304)}else{if(!r)if(e=b0(a),e!==null){if(t.flags|=128,r=!0,n=e.updateQueue,n!==null&&(t.updateQueue=n,t.flags|=4),Ku(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!rn)return nr(t),null}else 2*Tn()-s.renderingStartTime>du&&n!==1073741824&&(t.flags|=128,r=!0,Ku(s,!1),t.lanes=4194304);s.isBackwards?(a.sibling=t.child,t.child=a):(n=s.last,n!==null?n.sibling=a:t.child=a,s.last=a)}return s.tail!==null?(t=s.tail,s.rendering=t,s.tail=t.sibling,s.renderingStartTime=Tn(),t.sibling=null,n=sn.current,Yt(sn,r?n&1|2:n&1),t):(nr(t),null);case 22:case 23:return wx(),r=t.memoizedState!==null,e!==null&&e.memoizedState!==null!==r&&(t.flags|=8192),r&&t.mode&1?Hr&1073741824&&(nr(t),t.subtreeFlags&6&&(t.flags|=8192)):nr(t),null;case 24:return null;case 25:return null}throw Error(ke(156,t.tag))}function tb(e,t){switch(ex(t),t.tag){case 1:return br(t.type)&&R0(),e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 3:return cu(),Zt(Nr),Zt(pr),ux(),e=t.flags,e&65536&&!(e&128)?(t.flags=e&-65537|128,t):null;case 5:return lx(t),null;case 13:if(Zt(sn),e=t.memoizedState,e!==null&&e.dehydrated!==null){if(t.alternate===null)throw Error(ke(340));lu()}return e=t.flags,e&65536?(t.flags=e&-65537|128,t):null;case 19:return Zt(sn),null;case 4:return cu(),null;case 10:return ix(t.type._context),null;case 22:case 23:return wx(),null;case 24:return null;default:return null}}var Ed=!1,or=!1,nb=typeof WeakSet=="function"?WeakSet:Set,ze=null;function Sl(e,t){var n=e.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(r){pn(e,t,r)}else n.current=null}function fg(e,t,n){try{n()}catch(r){pn(e,t,r)}}var Ow=!1;function rb(e,t){if(Ym=_0,e=uk(),jv(e)){if("selectionStart"in e)var n={start:e.selectionStart,end:e.selectionEnd};else e:{n=(n=e.ownerDocument)&&n.defaultView||window;var r=n.getSelection&&n.getSelection();if(r&&r.rangeCount!==0){n=r.anchorNode;var i=r.anchorOffset,s=r.focusNode;r=r.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,u=0,c=0,h=e,p=null;t:for(;;){for(var m;h!==n||i!==0&&h.nodeType!==3||(o=a+i),h!==s||r!==0&&h.nodeType!==3||(l=a+r),h.nodeType===3&&(a+=h.nodeValue.length),(m=h.firstChild)!==null;)p=h,h=m;for(;;){if(h===e)break t;if(p===n&&++u===i&&(o=a),p===s&&++c===r&&(l=a),(m=h.nextSibling)!==null)break;h=p,p=h.parentNode}h=m}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(Xm={focusedElem:e,selectionRange:n},_0=!1,ze=t;ze!==null;)if(t=ze,e=t.child,(t.subtreeFlags&1028)!==0&&e!==null)e.return=t,ze=e;else for(;ze!==null;){t=ze;try{var v=t.alternate;if(t.flags&1024)switch(t.tag){case 0:case 11:case 15:break;case 1:if(v!==null){var g=v.memoizedProps,w=v.memoizedState,x=t.stateNode,T=x.getSnapshotBeforeUpdate(t.elementType===t.type?g:Di(t.type,g),w);x.__reactInternalSnapshotBeforeUpdate=T}break;case 3:var y=t.stateNode.containerInfo;y.nodeType===1?y.textContent="":y.nodeType===9&&y.documentElement&&y.removeChild(y.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ke(163))}}catch(_){pn(t,t.return,_)}if(e=t.sibling,e!==null){e.return=t.return,ze=e;break}ze=t.return}return v=Ow,Ow=!1,v}function yc(e,t,n){var r=t.updateQueue;if(r=r!==null?r.lastEffect:null,r!==null){var i=r=r.next;do{if((i.tag&e)===e){var s=i.destroy;i.destroy=void 0,s!==void 0&&fg(t,n,s)}i=i.next}while(i!==r)}}function Nh(e,t){if(t=t.updateQueue,t=t!==null?t.lastEffect:null,t!==null){var n=t=t.next;do{if((n.tag&e)===e){var r=n.create;n.destroy=r()}n=n.next}while(n!==t)}}function dg(e){var t=e.ref;if(t!==null){var n=e.stateNode;switch(e.tag){case 5:e=n;break;default:e=n}typeof t=="function"?t(e):t.current=e}}function sA(e){var t=e.alternate;t!==null&&(e.alternate=null,sA(t)),e.child=null,e.deletions=null,e.sibling=null,e.tag===5&&(t=e.stateNode,t!==null&&(delete t[ts],delete t[Yc],delete t[jm],delete t[U4],delete t[V4])),e.stateNode=null,e.return=null,e.dependencies=null,e.memoizedProps=null,e.memoizedState=null,e.pendingProps=null,e.stateNode=null,e.updateQueue=null}function aA(e){return e.tag===5||e.tag===3||e.tag===4}function Bw(e){e:for(;;){for(;e.sibling===null;){if(e.return===null||aA(e.return))return null;e=e.return}for(e.sibling.return=e.return,e=e.sibling;e.tag!==5&&e.tag!==6&&e.tag!==18;){if(e.flags&2||e.child===null||e.tag===4)continue e;e.child.return=e,e=e.child}if(!(e.flags&2))return e.stateNode}}function hg(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.nodeType===8?n.parentNode.insertBefore(e,t):n.insertBefore(e,t):(n.nodeType===8?(t=n.parentNode,t.insertBefore(e,n)):(t=n,t.appendChild(e)),n=n._reactRootContainer,n!=null||t.onclick!==null||(t.onclick=A0));else if(r!==4&&(e=e.child,e!==null))for(hg(e,t,n),e=e.sibling;e!==null;)hg(e,t,n),e=e.sibling}function pg(e,t,n){var r=e.tag;if(r===5||r===6)e=e.stateNode,t?n.insertBefore(e,t):n.appendChild(e);else if(r!==4&&(e=e.child,e!==null))for(pg(e,t,n),e=e.sibling;e!==null;)pg(e,t,n),e=e.sibling}var Yn=null,Ni=!1;function qs(e,t,n){for(n=n.child;n!==null;)oA(e,t,n),n=n.sibling}function oA(e,t,n){if(rs&&typeof rs.onCommitFiberUnmount=="function")try{rs.onCommitFiberUnmount(kh,n)}catch{}switch(n.tag){case 5:or||Sl(n,t);case 6:var r=Yn,i=Ni;Yn=null,qs(e,t,n),Yn=r,Ni=i,Yn!==null&&(Ni?(e=Yn,n=n.stateNode,e.nodeType===8?e.parentNode.removeChild(n):e.removeChild(n)):Yn.removeChild(n.stateNode));break;case 18:Yn!==null&&(Ni?(e=Yn,n=n.stateNode,e.nodeType===8?Dp(e.parentNode,n):e.nodeType===1&&Dp(e,n),zc(e)):Dp(Yn,n.stateNode));break;case 4:r=Yn,i=Ni,Yn=n.stateNode.containerInfo,Ni=!0,qs(e,t,n),Yn=r,Ni=i;break;case 0:case 11:case 14:case 15:if(!or&&(r=n.updateQueue,r!==null&&(r=r.lastEffect,r!==null))){i=r=r.next;do{var s=i,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&fg(n,t,a),i=i.next}while(i!==r)}qs(e,t,n);break;case 1:if(!or&&(Sl(n,t),r=n.stateNode,typeof r.componentWillUnmount=="function"))try{r.props=n.memoizedProps,r.state=n.memoizedState,r.componentWillUnmount()}catch(o){pn(n,t,o)}qs(e,t,n);break;case 21:qs(e,t,n);break;case 22:n.mode&1?(or=(r=or)||n.memoizedState!==null,qs(e,t,n),or=r):qs(e,t,n);break;default:qs(e,t,n)}}function Uw(e){var t=e.updateQueue;if(t!==null){e.updateQueue=null;var n=e.stateNode;n===null&&(n=e.stateNode=new nb),t.forEach(function(r){var i=db.bind(null,e,r);n.has(r)||(n.add(r),r.then(i,i))})}}function Ri(e,t){var n=t.deletions;if(n!==null)for(var r=0;r<n.length;r++){var i=n[r];try{var s=e,a=t,o=a;e:for(;o!==null;){switch(o.tag){case 5:Yn=o.stateNode,Ni=!1;break e;case 3:Yn=o.stateNode.containerInfo,Ni=!0;break e;case 4:Yn=o.stateNode.containerInfo,Ni=!0;break e}o=o.return}if(Yn===null)throw Error(ke(160));oA(s,a,i),Yn=null,Ni=!1;var l=i.alternate;l!==null&&(l.return=null),i.return=null}catch(u){pn(i,t,u)}}if(t.subtreeFlags&12854)for(t=t.child;t!==null;)lA(t,e),t=t.sibling}function lA(e,t){var n=e.alternate,r=e.flags;switch(e.tag){case 0:case 11:case 14:case 15:if(Ri(t,e),Ki(e),r&4){try{yc(3,e,e.return),Nh(3,e)}catch(g){pn(e,e.return,g)}try{yc(5,e,e.return)}catch(g){pn(e,e.return,g)}}break;case 1:Ri(t,e),Ki(e),r&512&&n!==null&&Sl(n,n.return);break;case 5:if(Ri(t,e),Ki(e),r&512&&n!==null&&Sl(n,n.return),e.flags&32){var i=e.stateNode;try{Uc(i,"")}catch(g){pn(e,e.return,g)}}if(r&4&&(i=e.stateNode,i!=null)){var s=e.memoizedProps,a=n!==null?n.memoizedProps:s,o=e.type,l=e.updateQueue;if(e.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&F2(i,s),Bm(o,a);var u=Bm(o,s);for(a=0;a<l.length;a+=2){var c=l[a],h=l[a+1];c==="style"?b2(i,h):c==="dangerouslySetInnerHTML"?I2(i,h):c==="children"?Uc(i,h):Uv(i,c,h,u)}switch(o){case"input":Im(i,s);break;case"textarea":D2(i,s);break;case"select":var p=i._wrapperState.wasMultiple;i._wrapperState.wasMultiple=!!s.multiple;var m=s.value;m!=null?Dl(i,!!s.multiple,m,!1):p!==!!s.multiple&&(s.defaultValue!=null?Dl(i,!!s.multiple,s.defaultValue,!0):Dl(i,!!s.multiple,s.multiple?[]:"",!1))}i[Yc]=s}catch(g){pn(e,e.return,g)}}break;case 6:if(Ri(t,e),Ki(e),r&4){if(e.stateNode===null)throw Error(ke(162));i=e.stateNode,s=e.memoizedProps;try{i.nodeValue=s}catch(g){pn(e,e.return,g)}}break;case 3:if(Ri(t,e),Ki(e),r&4&&n!==null&&n.memoizedState.isDehydrated)try{zc(t.containerInfo)}catch(g){pn(e,e.return,g)}break;case 4:Ri(t,e),Ki(e);break;case 13:Ri(t,e),Ki(e),i=e.child,i.flags&8192&&(s=i.memoizedState!==null,i.stateNode.isHidden=s,!s||i.alternate!==null&&i.alternate.memoizedState!==null||(xx=Tn())),r&4&&Uw(e);break;case 22:if(c=n!==null&&n.memoizedState!==null,e.mode&1?(or=(u=or)||c,Ri(t,e),or=u):Ri(t,e),Ki(e),r&8192){if(u=e.memoizedState!==null,(e.stateNode.isHidden=u)&&!c&&e.mode&1)for(ze=e,c=e.child;c!==null;){for(h=ze=c;ze!==null;){switch(p=ze,m=p.child,p.tag){case 0:case 11:case 14:case 15:yc(4,p,p.return);break;case 1:Sl(p,p.return);var v=p.stateNode;if(typeof v.componentWillUnmount=="function"){r=p,n=p.return;try{t=r,v.props=t.memoizedProps,v.state=t.memoizedState,v.componentWillUnmount()}catch(g){pn(r,n,g)}}break;case 5:Sl(p,p.return);break;case 22:if(p.memoizedState!==null){Hw(h);continue}}m!==null?(m.return=p,ze=m):Hw(h)}c=c.sibling}e:for(c=null,h=e;;){if(h.tag===5){if(c===null){c=h;try{i=h.stateNode,u?(s=i.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=h.stateNode,l=h.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=N2("display",a))}catch(g){pn(e,e.return,g)}}}else if(h.tag===6){if(c===null)try{h.stateNode.nodeValue=u?"":h.memoizedProps}catch(g){pn(e,e.return,g)}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===e)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===e)break e;for(;h.sibling===null;){if(h.return===null||h.return===e)break e;c===h&&(c=null),h=h.return}c===h&&(c=null),h.sibling.return=h.return,h=h.sibling}}break;case 19:Ri(t,e),Ki(e),r&4&&Uw(e);break;case 21:break;default:Ri(t,e),Ki(e)}}function Ki(e){var t=e.flags;if(t&2){try{e:{for(var n=e.return;n!==null;){if(aA(n)){var r=n;break e}n=n.return}throw Error(ke(160))}switch(r.tag){case 5:var i=r.stateNode;r.flags&32&&(Uc(i,""),r.flags&=-33);var s=Bw(e);pg(e,s,i);break;case 3:case 4:var a=r.stateNode.containerInfo,o=Bw(e);hg(e,o,a);break;default:throw Error(ke(161))}}catch(l){pn(e,e.return,l)}e.flags&=-3}t&4096&&(e.flags&=-4097)}function ib(e,t,n){ze=e,uA(e)}function uA(e,t,n){for(var r=(e.mode&1)!==0;ze!==null;){var i=ze,s=i.child;if(i.tag===22&&r){var a=i.memoizedState!==null||Ed;if(!a){var o=i.alternate,l=o!==null&&o.memoizedState!==null||or;o=Ed;var u=or;if(Ed=a,(or=l)&&!u)for(ze=i;ze!==null;)a=ze,l=a.child,a.tag===22&&a.memoizedState!==null?$w(i):l!==null?(l.return=a,ze=l):$w(i);for(;s!==null;)ze=s,uA(s),s=s.sibling;ze=i,Ed=o,or=u}Vw(e)}else i.subtreeFlags&8772&&s!==null?(s.return=i,ze=s):Vw(e)}}function Vw(e){for(;ze!==null;){var t=ze;if(t.flags&8772){var n=t.alternate;try{if(t.flags&8772)switch(t.tag){case 0:case 11:case 15:or||Nh(5,t);break;case 1:var r=t.stateNode;if(t.flags&4&&!or)if(n===null)r.componentDidMount();else{var i=t.elementType===t.type?n.memoizedProps:Di(t.type,n.memoizedProps);r.componentDidUpdate(i,n.memoizedState,r.__reactInternalSnapshotBeforeUpdate)}var s=t.updateQueue;s!==null&&_w(t,s,r);break;case 3:var a=t.updateQueue;if(a!==null){if(n=null,t.child!==null)switch(t.child.tag){case 5:n=t.child.stateNode;break;case 1:n=t.child.stateNode}_w(t,a,n)}break;case 5:var o=t.stateNode;if(n===null&&t.flags&4){n=o;var l=t.memoizedProps;switch(t.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(t.memoizedState===null){var u=t.alternate;if(u!==null){var c=u.memoizedState;if(c!==null){var h=c.dehydrated;h!==null&&zc(h)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ke(163))}or||t.flags&512&&dg(t)}catch(p){pn(t,t.return,p)}}if(t===e){ze=null;break}if(n=t.sibling,n!==null){n.return=t.return,ze=n;break}ze=t.return}}function Hw(e){for(;ze!==null;){var t=ze;if(t===e){ze=null;break}var n=t.sibling;if(n!==null){n.return=t.return,ze=n;break}ze=t.return}}function $w(e){for(;ze!==null;){var t=ze;try{switch(t.tag){case 0:case 11:case 15:var n=t.return;try{Nh(4,t)}catch(l){pn(t,n,l)}break;case 1:var r=t.stateNode;if(typeof r.componentDidMount=="function"){var i=t.return;try{r.componentDidMount()}catch(l){pn(t,i,l)}}var s=t.return;try{dg(t)}catch(l){pn(t,s,l)}break;case 5:var a=t.return;try{dg(t)}catch(l){pn(t,a,l)}}}catch(l){pn(t,t.return,l)}if(t===e){ze=null;break}var o=t.sibling;if(o!==null){o.return=t.return,ze=o;break}ze=t.return}}var sb=Math.ceil,B0=Vs.ReactCurrentDispatcher,gx=Vs.ReactCurrentOwner,xi=Vs.ReactCurrentBatchConfig,Ct=0,zn=null,An=null,jn=0,Hr=0,El=Va(0),In=0,ef=null,Mo=0,bh=0,vx=0,wc=null,Pr=null,xx=0,du=1/0,xs=null,U0=!1,mg=null,Ca=null,_d=!1,ma=null,V0=0,Tc=0,gg=null,i0=-1,s0=0;function Er(){return Ct&6?Tn():i0!==-1?i0:i0=Tn()}function ka(e){return e.mode&1?Ct&2&&jn!==0?jn&-jn:$4.transition!==null?(s0===0&&(s0=K2()),s0):(e=zt,e!==0||(e=window.event,e=e===void 0?16:ek(e.type)),e):1}function Ui(e,t,n,r){if(50<Tc)throw Tc=0,gg=null,Error(ke(185));Nf(e,n,r),(!(Ct&2)||e!==zn)&&(e===zn&&(!(Ct&2)&&(bh|=n),In===4&&ta(e,jn)),Lr(e,r),n===1&&Ct===0&&!(t.mode&1)&&(du=Tn()+500,Dh&&Ha()))}function Lr(e,t){var n=e.callbackNode;$N(e,t);var r=E0(e,e===zn?jn:0);if(r===0)n!==null&&Qy(n),e.callbackNode=null,e.callbackPriority=0;else if(t=r&-r,e.callbackPriority!==t){if(n!=null&&Qy(n),t===1)e.tag===0?H4(zw.bind(null,e)):yk(zw.bind(null,e)),O4(function(){!(Ct&6)&&Ha()}),n=null;else{switch(Y2(r)){case 1:n=Wv;break;case 4:n=G2;break;case 16:n=S0;break;case 536870912:n=q2;break;default:n=S0}n=vA(n,cA.bind(null,e))}e.callbackPriority=t,e.callbackNode=n}}function cA(e,t){if(i0=-1,s0=0,Ct&6)throw Error(ke(327));var n=e.callbackNode;if(Ll()&&e.callbackNode!==n)return null;var r=E0(e,e===zn?jn:0);if(r===0)return null;if(r&30||r&e.expiredLanes||t)t=H0(e,r);else{t=r;var i=Ct;Ct|=2;var s=dA();(zn!==e||jn!==t)&&(xs=null,du=Tn()+500,vo(e,t));do try{lb();break}catch(o){fA(e,o)}while(!0);rx(),B0.current=s,Ct=i,An!==null?t=0:(zn=null,jn=0,t=In)}if(t!==0){if(t===2&&(i=zm(e),i!==0&&(r=i,t=vg(e,i))),t===1)throw n=ef,vo(e,0),ta(e,r),Lr(e,Tn()),n;if(t===6)ta(e,r);else{if(i=e.current.alternate,!(r&30)&&!ab(i)&&(t=H0(e,r),t===2&&(s=zm(e),s!==0&&(r=s,t=vg(e,s))),t===1))throw n=ef,vo(e,0),ta(e,r),Lr(e,Tn()),n;switch(e.finishedWork=i,e.finishedLanes=r,t){case 0:case 1:throw Error(ke(345));case 2:Ja(e,Pr,xs);break;case 3:if(ta(e,r),(r&130023424)===r&&(t=xx+500-Tn(),10<t)){if(E0(e,0)!==0)break;if(i=e.suspendedLanes,(i&r)!==r){Er(),e.pingedLanes|=e.suspendedLanes&i;break}e.timeoutHandle=Qm(Ja.bind(null,e,Pr,xs),t);break}Ja(e,Pr,xs);break;case 4:if(ta(e,r),(r&4194240)===r)break;for(t=e.eventTimes,i=-1;0<r;){var a=31-Bi(r);s=1<<a,a=t[a],a>i&&(i=a),r&=~s}if(r=i,r=Tn()-r,r=(120>r?120:480>r?480:1080>r?1080:1920>r?1920:3e3>r?3e3:4320>r?4320:1960*sb(r/1960))-r,10<r){e.timeoutHandle=Qm(Ja.bind(null,e,Pr,xs),r);break}Ja(e,Pr,xs);break;case 5:Ja(e,Pr,xs);break;default:throw Error(ke(329))}}}return Lr(e,Tn()),e.callbackNode===n?cA.bind(null,e):null}function vg(e,t){var n=wc;return e.current.memoizedState.isDehydrated&&(vo(e,t).flags|=256),e=H0(e,t),e!==2&&(t=Pr,Pr=n,t!==null&&xg(t)),e}function xg(e){Pr===null?Pr=e:Pr.push.apply(Pr,e)}function ab(e){for(var t=e;;){if(t.flags&16384){var n=t.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var r=0;r<n.length;r++){var i=n[r],s=i.getSnapshot;i=i.value;try{if(!$i(s(),i))return!1}catch{return!1}}}if(n=t.child,t.subtreeFlags&16384&&n!==null)n.return=t,t=n;else{if(t===e)break;for(;t.sibling===null;){if(t.return===null||t.return===e)return!0;t=t.return}t.sibling.return=t.return,t=t.sibling}}return!0}function ta(e,t){for(t&=~vx,t&=~bh,e.suspendedLanes|=t,e.pingedLanes&=~t,e=e.expirationTimes;0<t;){var n=31-Bi(t),r=1<<n;e[n]=-1,t&=~r}}function zw(e){if(Ct&6)throw Error(ke(327));Ll();var t=E0(e,0);if(!(t&1))return Lr(e,Tn()),null;var n=H0(e,t);if(e.tag!==0&&n===2){var r=zm(e);r!==0&&(t=r,n=vg(e,r))}if(n===1)throw n=ef,vo(e,0),ta(e,t),Lr(e,Tn()),n;if(n===6)throw Error(ke(345));return e.finishedWork=e.current.alternate,e.finishedLanes=t,Ja(e,Pr,xs),Lr(e,Tn()),null}function yx(e,t){var n=Ct;Ct|=1;try{return e(t)}finally{Ct=n,Ct===0&&(du=Tn()+500,Dh&&Ha())}}function Fo(e){ma!==null&&ma.tag===0&&!(Ct&6)&&Ll();var t=Ct;Ct|=1;var n=xi.transition,r=zt;try{if(xi.transition=null,zt=1,e)return e()}finally{zt=r,xi.transition=n,Ct=t,!(Ct&6)&&Ha()}}function wx(){Hr=El.current,Zt(El)}function vo(e,t){e.finishedWork=null,e.finishedLanes=0;var n=e.timeoutHandle;if(n!==-1&&(e.timeoutHandle=-1,L4(n)),An!==null)for(n=An.return;n!==null;){var r=n;switch(ex(r),r.tag){case 1:r=r.type.childContextTypes,r!=null&&R0();break;case 3:cu(),Zt(Nr),Zt(pr),ux();break;case 5:lx(r);break;case 4:cu();break;case 13:Zt(sn);break;case 19:Zt(sn);break;case 10:ix(r.type._context);break;case 22:case 23:wx()}n=n.return}if(zn=e,An=e=Aa(e.current,null),jn=Hr=t,In=0,ef=null,vx=bh=Mo=0,Pr=wc=null,no!==null){for(t=0;t<no.length;t++)if(n=no[t],r=n.interleaved,r!==null){n.interleaved=null;var i=r.next,s=n.pending;if(s!==null){var a=s.next;s.next=i,r.next=a}n.pending=r}no=null}return e}function fA(e,t){do{var n=An;try{if(rx(),t0.current=O0,L0){for(var r=un.memoizedState;r!==null;){var i=r.queue;i!==null&&(i.pending=null),r=r.next}L0=!1}if(Ro=0,Un=Mn=un=null,xc=!1,Qc=0,gx.current=null,n===null||n.return===null){In=1,ef=t,An=null;break}e:{var s=e,a=n.return,o=n,l=t;if(t=jn,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var u=l,c=o,h=c.tag;if(!(c.mode&1)&&(h===0||h===11||h===15)){var p=c.alternate;p?(c.updateQueue=p.updateQueue,c.memoizedState=p.memoizedState,c.lanes=p.lanes):(c.updateQueue=null,c.memoizedState=null)}var m=Fw(a);if(m!==null){m.flags&=-257,Dw(m,a,o,s,t),m.mode&1&&Mw(s,u,t),t=m,l=u;var v=t.updateQueue;if(v===null){var g=new Set;g.add(l),t.updateQueue=g}else v.add(l);break e}else{if(!(t&1)){Mw(s,u,t),Tx();break e}l=Error(ke(426))}}else if(rn&&o.mode&1){var w=Fw(a);if(w!==null){!(w.flags&65536)&&(w.flags|=256),Dw(w,a,o,s,t),tx(fu(l,o));break e}}s=l=fu(l,o),In!==4&&(In=2),wc===null?wc=[s]:wc.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,t&=-t,s.lanes|=t;var x=Yk(s,l,t);Ew(s,x);break e;case 1:o=l;var T=s.type,y=s.stateNode;if(!(s.flags&128)&&(typeof T.getDerivedStateFromError=="function"||y!==null&&typeof y.componentDidCatch=="function"&&(Ca===null||!Ca.has(y)))){s.flags|=65536,t&=-t,s.lanes|=t;var _=Xk(s,o,t);Ew(s,_);break e}}s=s.return}while(s!==null)}pA(n)}catch(k){t=k,An===n&&n!==null&&(An=n=n.return);continue}break}while(!0)}function dA(){var e=B0.current;return B0.current=O0,e===null?O0:e}function Tx(){(In===0||In===3||In===2)&&(In=4),zn===null||!(Mo&268435455)&&!(bh&268435455)||ta(zn,jn)}function H0(e,t){var n=Ct;Ct|=2;var r=dA();(zn!==e||jn!==t)&&(xs=null,vo(e,t));do try{ob();break}catch(i){fA(e,i)}while(!0);if(rx(),Ct=n,B0.current=r,An!==null)throw Error(ke(261));return zn=null,jn=0,In}function ob(){for(;An!==null;)hA(An)}function lb(){for(;An!==null&&!IN();)hA(An)}function hA(e){var t=gA(e.alternate,e,Hr);e.memoizedProps=e.pendingProps,t===null?pA(e):An=t,gx.current=null}function pA(e){var t=e;do{var n=t.alternate;if(e=t.return,t.flags&32768){if(n=tb(n,t),n!==null){n.flags&=32767,An=n;return}if(e!==null)e.flags|=32768,e.subtreeFlags=0,e.deletions=null;else{In=6,An=null;return}}else if(n=eb(n,t,Hr),n!==null){An=n;return}if(t=t.sibling,t!==null){An=t;return}An=t=e}while(t!==null);In===0&&(In=5)}function Ja(e,t,n){var r=zt,i=xi.transition;try{xi.transition=null,zt=1,ub(e,t,n,r)}finally{xi.transition=i,zt=r}return null}function ub(e,t,n,r){do Ll();while(ma!==null);if(Ct&6)throw Error(ke(327));n=e.finishedWork;var i=e.finishedLanes;if(n===null)return null;if(e.finishedWork=null,e.finishedLanes=0,n===e.current)throw Error(ke(177));e.callbackNode=null,e.callbackPriority=0;var s=n.lanes|n.childLanes;if(zN(e,s),e===zn&&(An=zn=null,jn=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||_d||(_d=!0,vA(S0,function(){return Ll(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=xi.transition,xi.transition=null;var a=zt;zt=1;var o=Ct;Ct|=4,gx.current=null,rb(e,n),lA(n,e),M4(Xm),_0=!!Ym,Xm=Ym=null,e.current=n,ib(n),NN(),Ct=o,zt=a,xi.transition=s}else e.current=n;if(_d&&(_d=!1,ma=e,V0=i),s=e.pendingLanes,s===0&&(Ca=null),ON(n.stateNode),Lr(e,Tn()),t!==null)for(r=e.onRecoverableError,n=0;n<t.length;n++)i=t[n],r(i.value,{componentStack:i.stack,digest:i.digest});if(U0)throw U0=!1,e=mg,mg=null,e;return V0&1&&e.tag!==0&&Ll(),s=e.pendingLanes,s&1?e===gg?Tc++:(Tc=0,gg=e):Tc=0,Ha(),null}function Ll(){if(ma!==null){var e=Y2(V0),t=xi.transition,n=zt;try{if(xi.transition=null,zt=16>e?16:e,ma===null)var r=!1;else{if(e=ma,ma=null,V0=0,Ct&6)throw Error(ke(331));var i=Ct;for(Ct|=4,ze=e.current;ze!==null;){var s=ze,a=s.child;if(ze.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var u=o[l];for(ze=u;ze!==null;){var c=ze;switch(c.tag){case 0:case 11:case 15:yc(8,c,s)}var h=c.child;if(h!==null)h.return=c,ze=h;else for(;ze!==null;){c=ze;var p=c.sibling,m=c.return;if(sA(c),c===u){ze=null;break}if(p!==null){p.return=m,ze=p;break}ze=m}}}var v=s.alternate;if(v!==null){var g=v.child;if(g!==null){v.child=null;do{var w=g.sibling;g.sibling=null,g=w}while(g!==null)}}ze=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,ze=a;else e:for(;ze!==null;){if(s=ze,s.flags&2048)switch(s.tag){case 0:case 11:case 15:yc(9,s,s.return)}var x=s.sibling;if(x!==null){x.return=s.return,ze=x;break e}ze=s.return}}var T=e.current;for(ze=T;ze!==null;){a=ze;var y=a.child;if(a.subtreeFlags&2064&&y!==null)y.return=a,ze=y;else e:for(a=T;ze!==null;){if(o=ze,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Nh(9,o)}}catch(k){pn(o,o.return,k)}if(o===a){ze=null;break e}var _=o.sibling;if(_!==null){_.return=o.return,ze=_;break e}ze=o.return}}if(Ct=i,Ha(),rs&&typeof rs.onPostCommitFiberRoot=="function")try{rs.onPostCommitFiberRoot(kh,e)}catch{}r=!0}return r}finally{zt=n,xi.transition=t}}return!1}function Ww(e,t,n){t=fu(n,t),t=Yk(e,t,1),e=_a(e,t,1),t=Er(),e!==null&&(Nf(e,1,t),Lr(e,t))}function pn(e,t,n){if(e.tag===3)Ww(e,e,n);else for(;t!==null;){if(t.tag===3){Ww(t,e,n);break}else if(t.tag===1){var r=t.stateNode;if(typeof t.type.getDerivedStateFromError=="function"||typeof r.componentDidCatch=="function"&&(Ca===null||!Ca.has(r))){e=fu(n,e),e=Xk(t,e,1),t=_a(t,e,1),e=Er(),t!==null&&(Nf(t,1,e),Lr(t,e));break}}t=t.return}}function cb(e,t,n){var r=e.pingCache;r!==null&&r.delete(t),t=Er(),e.pingedLanes|=e.suspendedLanes&n,zn===e&&(jn&n)===n&&(In===4||In===3&&(jn&130023424)===jn&&500>Tn()-xx?vo(e,0):vx|=n),Lr(e,t)}function mA(e,t){t===0&&(e.mode&1?(t=pd,pd<<=1,!(pd&130023424)&&(pd=4194304)):t=1);var n=Er();e=Ls(e,t),e!==null&&(Nf(e,t,n),Lr(e,n))}function fb(e){var t=e.memoizedState,n=0;t!==null&&(n=t.retryLane),mA(e,n)}function db(e,t){var n=0;switch(e.tag){case 13:var r=e.stateNode,i=e.memoizedState;i!==null&&(n=i.retryLane);break;case 19:r=e.stateNode;break;default:throw Error(ke(314))}r!==null&&r.delete(t),mA(e,n)}var gA;gA=function(e,t,n){if(e!==null)if(e.memoizedProps!==t.pendingProps||Nr.current)Ir=!0;else{if(!(e.lanes&n)&&!(t.flags&128))return Ir=!1,Z4(e,t,n);Ir=!!(e.flags&131072)}else Ir=!1,rn&&t.flags&1048576&&wk(t,D0,t.index);switch(t.lanes=0,t.tag){case 2:var r=t.type;r0(e,t),e=t.pendingProps;var i=ou(t,pr.current);bl(t,n),i=fx(null,t,r,e,i,n);var s=dx();return t.flags|=1,typeof i=="object"&&i!==null&&typeof i.render=="function"&&i.$$typeof===void 0?(t.tag=1,t.memoizedState=null,t.updateQueue=null,br(r)?(s=!0,M0(t)):s=!1,t.memoizedState=i.state!==null&&i.state!==void 0?i.state:null,ax(t),i.updater=Ih,t.stateNode=i,i._reactInternals=t,ig(t,r,e,n),t=og(null,t,r,!0,s,n)):(t.tag=0,rn&&s&&Zv(t),yr(null,t,i,n),t=t.child),t;case 16:r=t.elementType;e:{switch(r0(e,t),e=t.pendingProps,i=r._init,r=i(r._payload),t.type=r,i=t.tag=pb(r),e=Di(r,e),i){case 0:t=ag(null,t,r,e,n);break e;case 1:t=Nw(null,t,r,e,n);break e;case 11:t=Pw(null,t,r,e,n);break e;case 14:t=Iw(null,t,r,Di(r.type,e),n);break e}throw Error(ke(306,r,""))}return t;case 0:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Di(r,i),ag(e,t,r,i,n);case 1:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Di(r,i),Nw(e,t,r,i,n);case 3:e:{if(Zk(t),e===null)throw Error(ke(387));r=t.pendingProps,s=t.memoizedState,i=s.element,kk(e,t),N0(t,r,null,n);var a=t.memoizedState;if(r=a.element,s.isDehydrated)if(s={element:r,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},t.updateQueue.baseState=s,t.memoizedState=s,t.flags&256){i=fu(Error(ke(423)),t),t=bw(e,t,r,n,i);break e}else if(r!==i){i=fu(Error(ke(424)),t),t=bw(e,t,r,n,i);break e}else for(Kr=Ea(t.stateNode.containerInfo.firstChild),Yr=t,rn=!0,bi=null,n=_k(t,null,r,n),t.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if(lu(),r===i){t=Os(e,t,n);break e}yr(e,t,r,n)}t=t.child}return t;case 5:return Ak(t),e===null&&tg(t),r=t.type,i=t.pendingProps,s=e!==null?e.memoizedProps:null,a=i.children,Jm(r,i)?a=null:s!==null&&Jm(r,s)&&(t.flags|=32),jk(e,t),yr(e,t,a,n),t.child;case 6:return e===null&&tg(t),null;case 13:return eA(e,t,n);case 4:return ox(t,t.stateNode.containerInfo),r=t.pendingProps,e===null?t.child=uu(t,null,r,n):yr(e,t,r,n),t.child;case 11:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Di(r,i),Pw(e,t,r,i,n);case 7:return yr(e,t,t.pendingProps,n),t.child;case 8:return yr(e,t,t.pendingProps.children,n),t.child;case 12:return yr(e,t,t.pendingProps.children,n),t.child;case 10:e:{if(r=t.type._context,i=t.pendingProps,s=t.memoizedProps,a=i.value,Yt(P0,r._currentValue),r._currentValue=a,s!==null)if($i(s.value,a)){if(s.children===i.children&&!Nr.current){t=Os(e,t,n);break e}}else for(s=t.child,s!==null&&(s.return=t);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===r){if(s.tag===1){l=Cs(-1,n&-n),l.tag=2;var u=s.updateQueue;if(u!==null){u=u.shared;var c=u.pending;c===null?l.next=l:(l.next=c.next,c.next=l),u.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),ng(s.return,n,t),o.lanes|=n;break}l=l.next}}else if(s.tag===10)a=s.type===t.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ke(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),ng(a,n,t),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===t){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}yr(e,t,i.children,n),t=t.child}return t;case 9:return i=t.type,r=t.pendingProps.children,bl(t,n),i=Ti(i),r=r(i),t.flags|=1,yr(e,t,r,n),t.child;case 14:return r=t.type,i=Di(r,t.pendingProps),i=Di(r.type,i),Iw(e,t,r,i,n);case 15:return Jk(e,t,t.type,t.pendingProps,n);case 17:return r=t.type,i=t.pendingProps,i=t.elementType===r?i:Di(r,i),r0(e,t),t.tag=1,br(r)?(e=!0,M0(t)):e=!1,bl(t,n),Kk(t,r,i),ig(t,r,i,n),og(null,t,r,!0,e,n);case 19:return tA(e,t,n);case 22:return Qk(e,t,n)}throw Error(ke(156,t.tag))};function vA(e,t){return W2(e,t)}function hb(e,t,n,r){this.tag=e,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=t,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=r,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function vi(e,t,n,r){return new hb(e,t,n,r)}function Sx(e){return e=e.prototype,!(!e||!e.isReactComponent)}function pb(e){if(typeof e=="function")return Sx(e)?1:0;if(e!=null){if(e=e.$$typeof,e===Hv)return 11;if(e===$v)return 14}return 2}function Aa(e,t){var n=e.alternate;return n===null?(n=vi(e.tag,t,e.key,e.mode),n.elementType=e.elementType,n.type=e.type,n.stateNode=e.stateNode,n.alternate=e,e.alternate=n):(n.pendingProps=t,n.type=e.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=e.flags&14680064,n.childLanes=e.childLanes,n.lanes=e.lanes,n.child=e.child,n.memoizedProps=e.memoizedProps,n.memoizedState=e.memoizedState,n.updateQueue=e.updateQueue,t=e.dependencies,n.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext},n.sibling=e.sibling,n.index=e.index,n.ref=e.ref,n}function a0(e,t,n,r,i,s){var a=2;if(r=e,typeof e=="function")Sx(e)&&(a=1);else if(typeof e=="string")a=5;else e:switch(e){case hl:return xo(n.children,i,s,t);case Vv:a=8,i|=8;break;case Rm:return e=vi(12,n,t,i|2),e.elementType=Rm,e.lanes=s,e;case Mm:return e=vi(13,n,t,i),e.elementType=Mm,e.lanes=s,e;case Fm:return e=vi(19,n,t,i),e.elementType=Fm,e.lanes=s,e;case A2:return Lh(n,i,s,t);default:if(typeof e=="object"&&e!==null)switch(e.$$typeof){case C2:a=10;break e;case k2:a=9;break e;case Hv:a=11;break e;case $v:a=14;break e;case Qs:a=16,r=null;break e}throw Error(ke(130,e==null?e:typeof e,""))}return t=vi(a,n,t,i),t.elementType=e,t.type=r,t.lanes=s,t}function xo(e,t,n,r){return e=vi(7,e,r,t),e.lanes=n,e}function Lh(e,t,n,r){return e=vi(22,e,r,t),e.elementType=A2,e.lanes=n,e.stateNode={isHidden:!1},e}function Up(e,t,n){return e=vi(6,e,null,t),e.lanes=n,e}function Vp(e,t,n){return t=vi(4,e.children!==null?e.children:[],e.key,t),t.lanes=n,t.stateNode={containerInfo:e.containerInfo,pendingChildren:null,implementation:e.implementation},t}function mb(e,t,n,r,i){this.tag=t,this.containerInfo=e,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=wp(0),this.expirationTimes=wp(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=wp(0),this.identifierPrefix=r,this.onRecoverableError=i,this.mutableSourceEagerHydrationData=null}function Ex(e,t,n,r,i,s,a,o,l){return e=new mb(e,t,n,o,l),t===1?(t=1,s===!0&&(t|=8)):t=0,s=vi(3,null,null,t),e.current=s,s.stateNode=e,s.memoizedState={element:r,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},ax(s),e}function gb(e,t,n){var r=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:dl,key:r==null?null:""+r,children:e,containerInfo:t,implementation:n}}function xA(e){if(!e)return Fa;e=e._reactInternals;e:{if(zo(e)!==e||e.tag!==1)throw Error(ke(170));var t=e;do{switch(t.tag){case 3:t=t.stateNode.context;break e;case 1:if(br(t.type)){t=t.stateNode.__reactInternalMemoizedMergedChildContext;break e}}t=t.return}while(t!==null);throw Error(ke(171))}if(e.tag===1){var n=e.type;if(br(n))return xk(e,n,t)}return t}function yA(e,t,n,r,i,s,a,o,l){return e=Ex(n,r,!0,e,i,s,a,o,l),e.context=xA(null),n=e.current,r=Er(),i=ka(n),s=Cs(r,i),s.callback=t??null,_a(n,s,i),e.current.lanes=i,Nf(e,i,r),Lr(e,r),e}function Oh(e,t,n,r){var i=t.current,s=Er(),a=ka(i);return n=xA(n),t.context===null?t.context=n:t.pendingContext=n,t=Cs(s,a),t.payload={element:e},r=r===void 0?null:r,r!==null&&(t.callback=r),e=_a(i,t,a),e!==null&&(Ui(e,i,a,s),e0(e,i,a)),a}function $0(e){if(e=e.current,!e.child)return null;switch(e.child.tag){case 5:return e.child.stateNode;default:return e.child.stateNode}}function Gw(e,t){if(e=e.memoizedState,e!==null&&e.dehydrated!==null){var n=e.retryLane;e.retryLane=n!==0&&n<t?n:t}}function _x(e,t){Gw(e,t),(e=e.alternate)&&Gw(e,t)}function vb(){return null}var wA=typeof reportError=="function"?reportError:function(e){console.error(e)};function Cx(e){this._internalRoot=e}Bh.prototype.render=Cx.prototype.render=function(e){var t=this._internalRoot;if(t===null)throw Error(ke(409));Oh(e,t,null,null)};Bh.prototype.unmount=Cx.prototype.unmount=function(){var e=this._internalRoot;if(e!==null){this._internalRoot=null;var t=e.containerInfo;Fo(function(){Oh(null,e,null,null)}),t[bs]=null}};function Bh(e){this._internalRoot=e}Bh.prototype.unstable_scheduleHydration=function(e){if(e){var t=Q2();e={blockedOn:null,target:e,priority:t};for(var n=0;n<ea.length&&t!==0&&t<ea[n].priority;n++);ea.splice(n,0,e),n===0&&Z2(e)}};function kx(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11)}function Uh(e){return!(!e||e.nodeType!==1&&e.nodeType!==9&&e.nodeType!==11&&(e.nodeType!==8||e.nodeValue!==" react-mount-point-unstable "))}function qw(){}function xb(e,t,n,r,i){if(i){if(typeof r=="function"){var s=r;r=function(){var u=$0(a);s.call(u)}}var a=yA(t,r,e,0,null,!1,!1,"",qw);return e._reactRootContainer=a,e[bs]=a.current,qc(e.nodeType===8?e.parentNode:e),Fo(),a}for(;i=e.lastChild;)e.removeChild(i);if(typeof r=="function"){var o=r;r=function(){var u=$0(l);o.call(u)}}var l=Ex(e,0,!1,null,null,!1,!1,"",qw);return e._reactRootContainer=l,e[bs]=l.current,qc(e.nodeType===8?e.parentNode:e),Fo(function(){Oh(t,l,n,r)}),l}function Vh(e,t,n,r,i){var s=n._reactRootContainer;if(s){var a=s;if(typeof i=="function"){var o=i;i=function(){var l=$0(a);o.call(l)}}Oh(t,a,e,i)}else a=xb(n,t,e,i,r);return $0(a)}X2=function(e){switch(e.tag){case 3:var t=e.stateNode;if(t.current.memoizedState.isDehydrated){var n=rc(t.pendingLanes);n!==0&&(Gv(t,n|1),Lr(t,Tn()),!(Ct&6)&&(du=Tn()+500,Ha()))}break;case 13:Fo(function(){var r=Ls(e,1);if(r!==null){var i=Er();Ui(r,e,1,i)}}),_x(e,1)}};qv=function(e){if(e.tag===13){var t=Ls(e,134217728);if(t!==null){var n=Er();Ui(t,e,134217728,n)}_x(e,134217728)}};J2=function(e){if(e.tag===13){var t=ka(e),n=Ls(e,t);if(n!==null){var r=Er();Ui(n,e,t,r)}_x(e,t)}};Q2=function(){return zt};j2=function(e,t){var n=zt;try{return zt=e,t()}finally{zt=n}};Vm=function(e,t,n){switch(t){case"input":if(Im(e,n),t=n.name,n.type==="radio"&&t!=null){for(n=e;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+t)+'][type="radio"]'),t=0;t<n.length;t++){var r=n[t];if(r!==e&&r.form===e.form){var i=Fh(r);if(!i)throw Error(ke(90));M2(r),Im(r,i)}}}break;case"textarea":D2(e,n);break;case"select":t=n.value,t!=null&&Dl(e,!!n.multiple,t,!1)}};B2=yx;U2=Fo;var yb={usingClientEntryPoint:!1,Events:[Lf,vl,Fh,L2,O2,yx]},Yu={findFiberByHostInstance:to,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},wb={bundleType:Yu.bundleType,version:Yu.version,rendererPackageName:Yu.rendererPackageName,rendererConfig:Yu.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Vs.ReactCurrentDispatcher,findHostInstanceByFiber:function(e){return e=$2(e),e===null?null:e.stateNode},findFiberByHostInstance:Yu.findFiberByHostInstance||vb,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var Cd=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!Cd.isDisabled&&Cd.supportsFiber)try{kh=Cd.inject(wb),rs=Cd}catch{}}ei.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yb;ei.createPortal=function(e,t){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!kx(t))throw Error(ke(200));return gb(e,t,null,n)};ei.createRoot=function(e,t){if(!kx(e))throw Error(ke(299));var n=!1,r="",i=wA;return t!=null&&(t.unstable_strictMode===!0&&(n=!0),t.identifierPrefix!==void 0&&(r=t.identifierPrefix),t.onRecoverableError!==void 0&&(i=t.onRecoverableError)),t=Ex(e,1,!1,null,null,n,!1,r,i),e[bs]=t.current,qc(e.nodeType===8?e.parentNode:e),new Cx(t)};ei.findDOMNode=function(e){if(e==null)return null;if(e.nodeType===1)return e;var t=e._reactInternals;if(t===void 0)throw typeof e.render=="function"?Error(ke(188)):(e=Object.keys(e).join(","),Error(ke(268,e)));return e=$2(t),e=e===null?null:e.stateNode,e};ei.flushSync=function(e){return Fo(e)};ei.hydrate=function(e,t,n){if(!Uh(t))throw Error(ke(200));return Vh(null,e,t,!0,n)};ei.hydrateRoot=function(e,t,n){if(!kx(e))throw Error(ke(405));var r=n!=null&&n.hydratedSources||null,i=!1,s="",a=wA;if(n!=null&&(n.unstable_strictMode===!0&&(i=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),t=yA(t,null,e,1,n??null,i,!1,s,a),e[bs]=t.current,qc(e),r)for(e=0;e<r.length;e++)n=r[e],i=n._getVersion,i=i(n._source),t.mutableSourceEagerHydrationData==null?t.mutableSourceEagerHydrationData=[n,i]:t.mutableSourceEagerHydrationData.push(n,i);return new Bh(t)};ei.render=function(e,t,n){if(!Uh(t))throw Error(ke(200));return Vh(null,e,t,!1,n)};ei.unmountComponentAtNode=function(e){if(!Uh(e))throw Error(ke(40));return e._reactRootContainer?(Fo(function(){Vh(null,null,e,!1,function(){e._reactRootContainer=null,e[bs]=null})}),!0):!1};ei.unstable_batchedUpdates=yx;ei.unstable_renderSubtreeIntoContainer=function(e,t,n,r){if(!Uh(n))throw Error(ke(200));if(e==null||e._reactInternals===void 0)throw Error(ke(38));return Vh(e,t,n,!1,r)};ei.version="18.3.1-next-f1338f8080-20240426";function TA(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(TA)}catch(e){console.error(e)}}TA(),T2.exports=ei;var io=T2.exports,Kw=io;km.createRoot=Kw.createRoot,km.hydrateRoot=Kw.hydrateRoot;const Tb="modulepreload",Sb=function(e){return"/TACTMS/"+e},Yw={},Wo=function(t,n,r){let i=Promise.resolve();if(n&&n.length>0){document.getElementsByTagName("link");const a=document.querySelector("meta[property=csp-nonce]"),o=(a==null?void 0:a.nonce)||(a==null?void 0:a.getAttribute("nonce"));i=Promise.allSettled(n.map(l=>{if(l=Sb(l),l in Yw)return;Yw[l]=!0;const u=l.endsWith(".css"),c=u?'[rel="stylesheet"]':"";if(document.querySelector(`link[href="${l}"]${c}`))return;const h=document.createElement("link");if(h.rel=u?"stylesheet":Tb,u||(h.as="script"),h.crossOrigin="",h.href=l,o&&h.setAttribute("nonce",o),document.head.appendChild(h),u)return new Promise((p,m)=>{h.addEventListener("load",p),h.addEventListener("error",()=>m(new Error(`Unable to preload CSS for ${l}`)))})}))}function s(a){const o=new Event("vite:preloadError",{cancelable:!0});if(o.payload=a,window.dispatchEvent(o),!o.defaultPrevented)throw a}return i.then(a=>{for(const o of a||[])o.status==="rejected"&&s(o.reason);return t().catch(s)})};/**
 * react-router v7.8.0
 *
 * Copyright (c) Remix Software Inc.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE.md file in the root directory of this source tree.
 *
 * @license MIT
 */var SA=e=>{throw TypeError(e)},Eb=(e,t,n)=>t.has(e)||SA("Cannot "+n),Hp=(e,t,n)=>(Eb(e,t,"read from private field"),n?n.call(e):t.get(e)),_b=(e,t,n)=>t.has(e)?SA("Cannot add the same private member more than once"):t instanceof WeakSet?t.add(e):t.set(e,n),Xw="popstate";function Cb(e={}){function t(r,i){let{pathname:s,search:a,hash:o}=r.location;return tf("",{pathname:s,search:a,hash:o},i.state&&i.state.usr||null,i.state&&i.state.key||"default")}function n(r,i){return typeof i=="string"?i:Da(i)}return Ab(t,n,null,e)}function gt(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function Rn(e,t){if(!e){typeof console<"u"&&console.warn(t);try{throw new Error(t)}catch{}}}function kb(){return Math.random().toString(36).substring(2,10)}function Jw(e,t){return{usr:e.state,key:e.key,idx:t}}function tf(e,t,n=null,r){return{pathname:typeof e=="string"?e:e.pathname,search:"",hash:"",...typeof t=="string"?$a(t):t,state:n,key:t&&t.key||r||kb()}}function Da({pathname:e="/",search:t="",hash:n=""}){return t&&t!=="?"&&(e+=t.charAt(0)==="?"?t:"?"+t),n&&n!=="#"&&(e+=n.charAt(0)==="#"?n:"#"+n),e}function $a(e){let t={};if(e){let n=e.indexOf("#");n>=0&&(t.hash=e.substring(n),e=e.substring(0,n));let r=e.indexOf("?");r>=0&&(t.search=e.substring(r),e=e.substring(0,r)),e&&(t.pathname=e)}return t}function Ab(e,t,n,r={}){let{window:i=document.defaultView,v5Compat:s=!1}=r,a=i.history,o="POP",l=null,u=c();u==null&&(u=0,a.replaceState({...a.state,idx:u},""));function c(){return(a.state||{idx:null}).idx}function h(){o="POP";let w=c(),x=w==null?null:w-u;u=w,l&&l({action:o,location:g.location,delta:x})}function p(w,x){o="PUSH";let T=tf(g.location,w,x);u=c()+1;let y=Jw(T,u),_=g.createHref(T);try{a.pushState(y,"",_)}catch(k){if(k instanceof DOMException&&k.name==="DataCloneError")throw k;i.location.assign(_)}s&&l&&l({action:o,location:g.location,delta:1})}function m(w,x){o="REPLACE";let T=tf(g.location,w,x);u=c();let y=Jw(T,u),_=g.createHref(T);a.replaceState(y,"",_),s&&l&&l({action:o,location:g.location,delta:0})}function v(w){return EA(w)}let g={get action(){return o},get location(){return e(i,a)},listen(w){if(l)throw new Error("A history only accepts one active listener");return i.addEventListener(Xw,h),l=w,()=>{i.removeEventListener(Xw,h),l=null}},createHref(w){return t(i,w)},createURL:v,encodeLocation(w){let x=v(w);return{pathname:x.pathname,search:x.search,hash:x.hash}},push:p,replace:m,go(w){return a.go(w)}};return g}function EA(e,t=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),gt(n,"No window.location.(origin|href) available to create URL");let r=typeof e=="string"?e:Da(e);return r=r.replace(/ $/,"%20"),!t&&r.startsWith("//")&&(r=n+r),new URL(r,n)}var sc,Qw=class{constructor(e){if(_b(this,sc,new Map),e)for(let[t,n]of e)this.set(t,n)}get(e){if(Hp(this,sc).has(e))return Hp(this,sc).get(e);if(e.defaultValue!==void 0)return e.defaultValue;throw new Error("No value found for context")}set(e,t){Hp(this,sc).set(e,t)}};sc=new WeakMap;var Rb=new Set(["lazy","caseSensitive","path","id","index","children"]);function Mb(e){return Rb.has(e)}var Fb=new Set(["lazy","caseSensitive","path","id","index","unstable_middleware","children"]);function Db(e){return Fb.has(e)}function Pb(e){return e.index===!0}function nf(e,t,n=[],r={},i=!1){return e.map((s,a)=>{let o=[...n,String(a)],l=typeof s.id=="string"?s.id:o.join("-");if(gt(s.index!==!0||!s.children,"Cannot specify children on an index route"),gt(i||!r[l],`Found a route id collision on id "${l}".  Route id's must be globally unique within Data Router usages`),Pb(s)){let u={...s,...t(s),id:l};return r[l]=u,u}else{let u={...s,...t(s),id:l,children:void 0};return r[l]=u,s.children&&(u.children=nf(s.children,t,o,r,i)),u}})}function na(e,t,n="/"){return o0(e,t,n,!1)}function o0(e,t,n,r){let i=typeof t=="string"?$a(t):t,s=Ei(i.pathname||"/",n);if(s==null)return null;let a=_A(e);Nb(a);let o=null;for(let l=0;o==null&&l<a.length;++l){let u=Gb(s);o=zb(a[l],u,r)}return o}function Ib(e,t){let{route:n,pathname:r,params:i}=e;return{id:n.id,pathname:r,params:i,data:t[n.id],loaderData:t[n.id],handle:n.handle}}function _A(e,t=[],n=[],r=""){let i=(s,a,o)=>{let l={relativePath:o===void 0?s.path||"":o,caseSensitive:s.caseSensitive===!0,childrenIndex:a,route:s};l.relativePath.startsWith("/")&&(gt(l.relativePath.startsWith(r),`Absolute route path "${l.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),l.relativePath=l.relativePath.slice(r.length));let u=ss([r,l.relativePath]),c=n.concat(l);s.children&&s.children.length>0&&(gt(s.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${u}".`),_A(s.children,t,c,u)),!(s.path==null&&!s.index)&&t.push({path:u,score:Hb(u,s.index),routesMeta:c})};return e.forEach((s,a)=>{var o;if(s.path===""||!((o=s.path)!=null&&o.includes("?")))i(s,a);else for(let l of CA(s.path))i(s,a,l)}),t}function CA(e){let t=e.split("/");if(t.length===0)return[];let[n,...r]=t,i=n.endsWith("?"),s=n.replace(/\?$/,"");if(r.length===0)return i?[s,""]:[s];let a=CA(r.join("/")),o=[];return o.push(...a.map(l=>l===""?s:[s,l].join("/"))),i&&o.push(...a),o.map(l=>e.startsWith("/")&&l===""?"/":l)}function Nb(e){e.sort((t,n)=>t.score!==n.score?n.score-t.score:$b(t.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var bb=/^:[\w-]+$/,Lb=3,Ob=2,Bb=1,Ub=10,Vb=-2,jw=e=>e==="*";function Hb(e,t){let n=e.split("/"),r=n.length;return n.some(jw)&&(r+=Vb),t&&(r+=Ob),n.filter(i=>!jw(i)).reduce((i,s)=>i+(bb.test(s)?Lb:s===""?Bb:Ub),r)}function $b(e,t){return e.length===t.length&&e.slice(0,-1).every((r,i)=>r===t[i])?e[e.length-1]-t[t.length-1]:0}function zb(e,t,n=!1){let{routesMeta:r}=e,i={},s="/",a=[];for(let o=0;o<r.length;++o){let l=r[o],u=o===r.length-1,c=s==="/"?t:t.slice(s.length)||"/",h=z0({path:l.relativePath,caseSensitive:l.caseSensitive,end:u},c),p=l.route;if(!h&&u&&n&&!r[r.length-1].route.index&&(h=z0({path:l.relativePath,caseSensitive:l.caseSensitive,end:!1},c)),!h)return null;Object.assign(i,h.params),a.push({params:i,pathname:ss([s,h.pathname]),pathnameBase:Xb(ss([s,h.pathnameBase])),route:p}),h.pathnameBase!=="/"&&(s=ss([s,h.pathnameBase]))}return a}function z0(e,t){typeof e=="string"&&(e={path:e,caseSensitive:!1,end:!0});let[n,r]=Wb(e.path,e.caseSensitive,e.end),i=t.match(n);if(!i)return null;let s=i[0],a=s.replace(/(.)\/+$/,"$1"),o=i.slice(1);return{params:r.reduce((u,{paramName:c,isOptional:h},p)=>{if(c==="*"){let v=o[p]||"";a=s.slice(0,s.length-v.length).replace(/(.)\/+$/,"$1")}const m=o[p];return h&&!m?u[c]=void 0:u[c]=(m||"").replace(/%2F/g,"/"),u},{}),pathname:s,pathnameBase:a,pattern:e}}function Wb(e,t=!1,n=!0){Rn(e==="*"||!e.endsWith("*")||e.endsWith("/*"),`Route path "${e}" will be treated as if it were "${e.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${e.replace(/\*$/,"/*")}".`);let r=[],i="^"+e.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(a,o,l)=>(r.push({paramName:o,isOptional:l!=null}),l?"/?([^\\/]+)?":"/([^\\/]+)"));return e.endsWith("*")?(r.push({paramName:"*"}),i+=e==="*"||e==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?i+="\\/*$":e!==""&&e!=="/"&&(i+="(?:(?=\\/|$))"),[new RegExp(i,t?void 0:"i"),r]}function Gb(e){try{return e.split("/").map(t=>decodeURIComponent(t).replace(/\//g,"%2F")).join("/")}catch(t){return Rn(!1,`The URL path "${e}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${t}).`),e}}function Ei(e,t){if(t==="/")return e;if(!e.toLowerCase().startsWith(t.toLowerCase()))return null;let n=t.endsWith("/")?t.length-1:t.length,r=e.charAt(n);return r&&r!=="/"?null:e.slice(n)||"/"}function qb({basename:e,pathname:t}){return t==="/"?e:ss([e,t])}function Kb(e,t="/"){let{pathname:n,search:r="",hash:i=""}=typeof e=="string"?$a(e):e;return{pathname:n?n.startsWith("/")?n:Yb(n,t):t,search:Jb(r),hash:Qb(i)}}function Yb(e,t){let n=t.replace(/\/+$/,"").split("/");return e.split("/").forEach(i=>{i===".."?n.length>1&&n.pop():i!=="."&&n.push(i)}),n.length>1?n.join("/"):"/"}function $p(e,t,n,r){return`Cannot include a '${e}' character in a manually specified \`to.${t}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function kA(e){return e.filter((t,n)=>n===0||t.route.path&&t.route.path.length>0)}function Ax(e){let t=kA(e);return t.map((n,r)=>r===t.length-1?n.pathname:n.pathnameBase)}function Rx(e,t,n,r=!1){let i;typeof e=="string"?i=$a(e):(i={...e},gt(!i.pathname||!i.pathname.includes("?"),$p("?","pathname","search",i)),gt(!i.pathname||!i.pathname.includes("#"),$p("#","pathname","hash",i)),gt(!i.search||!i.search.includes("#"),$p("#","search","hash",i)));let s=e===""||i.pathname==="",a=s?"/":i.pathname,o;if(a==null)o=n;else{let h=t.length-1;if(!r&&a.startsWith("..")){let p=a.split("/");for(;p[0]==="..";)p.shift(),h-=1;i.pathname=p.join("/")}o=h>=0?t[h]:"/"}let l=Kb(i,o),u=a&&a!=="/"&&a.endsWith("/"),c=(s||a===".")&&n.endsWith("/");return!l.pathname.endsWith("/")&&(u||c)&&(l.pathname+="/"),l}var ss=e=>e.join("/").replace(/\/\/+/g,"/"),Xb=e=>e.replace(/\/+$/,"").replace(/^\/*/,"/"),Jb=e=>!e||e==="?"?"":e.startsWith("?")?e:"?"+e,Qb=e=>!e||e==="#"?"":e.startsWith("#")?e:"#"+e,W0=class{constructor(e,t,n,r=!1){this.status=e,this.statusText=t||"",this.internal=r,n instanceof Error?(this.data=n.toString(),this.error=n):this.data=n}};function rf(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.internal=="boolean"&&"data"in e}var AA=["POST","PUT","PATCH","DELETE"],jb=new Set(AA),Zb=["GET",...AA],e3=new Set(Zb),t3=new Set([301,302,303,307,308]),n3=new Set([307,308]),zp={state:"idle",location:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},r3={state:"idle",data:void 0,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0},Xu={state:"unblocked",proceed:void 0,reset:void 0,location:void 0},i3=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Mx=e=>i3.test(e),s3=e=>({hasErrorBoundary:!!e.hasErrorBoundary}),RA="remix-router-transitions",MA=Symbol("ResetLoaderData");function a3(e){const t=e.window?e.window:typeof window<"u"?window:void 0,n=typeof t<"u"&&typeof t.document<"u"&&typeof t.document.createElement<"u";gt(e.routes.length>0,"You must provide a non-empty routes array to createRouter");let r=e.hydrationRouteProperties||[],i=e.mapRouteProperties||s3,s={},a=nf(e.routes,i,void 0,s),o,l=e.basename||"/",u=e.dataStrategy||f3,c={unstable_middleware:!1,...e.future},h=null,p=new Set,m=null,v=null,g=null,w=e.hydrationData!=null,x=na(a,e.history.location,l),T=!1,y=null,_;if(x==null&&!e.patchRoutesOnNavigation){let U=fi(404,{pathname:e.history.location.pathname}),{matches:Y,route:te}=cT(a);_=!0,x=Y,y={[te.id]:U}}else if(x&&!e.hydrationData&&Ut(x,a,e.history.location.pathname).active&&(x=null),x)if(x.some(U=>U.route.lazy))_=!1;else if(!x.some(U=>U.route.loader))_=!0;else{let U=e.hydrationData?e.hydrationData.loaderData:null,Y=e.hydrationData?e.hydrationData.errors:null;if(Y){let te=x.findIndex(j=>Y[j.route.id]!==void 0);_=x.slice(0,te+1).every(j=>!wg(j.route,U,Y))}else _=x.every(te=>!wg(te.route,U,Y))}else{_=!1,x=[];let U=Ut(null,a,e.history.location.pathname);U.active&&U.matches&&(T=!0,x=U.matches)}let k,S={historyAction:e.history.action,location:e.history.location,matches:x,initialized:_,navigation:zp,restoreScrollPosition:e.hydrationData!=null?!1:null,preventScrollReset:!1,revalidation:"idle",loaderData:e.hydrationData&&e.hydrationData.loaderData||{},actionData:e.hydrationData&&e.hydrationData.actionData||null,errors:e.hydrationData&&e.hydrationData.errors||y,fetchers:new Map,blockers:new Map},C="POP",M=!1,F,b=!1,V=new Map,z=null,ie=!1,Q=!1,se=new Set,de=new Map,ae=0,ne=-1,H=new Map,fe=new Set,xe=new Map,L=new Map,q=new Set,W=new Map,G,ee=null;function Se(){if(h=e.history.listen(({action:U,location:Y,delta:te})=>{if(G){G(),G=void 0;return}Rn(W.size===0||te!=null,"You are trying to use a blocker on a POP navigation to a location that was not created by @remix-run/router. This will fail silently in production. This can happen if you are navigating outside the router via `window.history.pushState`/`window.location.hash` instead of using router navigation APIs.  This can also happen if you are using createHashRouter and the user manually changes the URL.");let j=xn({currentLocation:S.location,nextLocation:Y,historyAction:U});if(j&&te!=null){let ue=new Promise(ye=>{G=ye});e.history.go(te*-1),Et(j,{state:"blocked",location:Y,proceed(){Et(j,{state:"proceeding",proceed:void 0,reset:void 0,location:Y}),ue.then(()=>e.history.go(te))},reset(){let ye=new Map(S.blockers);ye.set(j,Xu),oe({blockers:ye})}});return}return Ue(U,Y)}),n){S3(t,V);let U=()=>E3(t,V);t.addEventListener("pagehide",U),z=()=>t.removeEventListener("pagehide",U)}return S.initialized||Ue("POP",S.location,{initialHydration:!0}),k}function we(){h&&h(),z&&z(),p.clear(),F&&F.abort(),S.fetchers.forEach((U,Y)=>mt(Y)),S.blockers.forEach((U,Y)=>bn(Y))}function pe(U){return p.add(U),()=>p.delete(U)}function oe(U,Y={}){U.matches&&(U.matches=U.matches.map(ue=>{let ye=s[ue.route.id],Fe=ue.route;return Fe.element!==ye.element||Fe.errorElement!==ye.errorElement||Fe.hydrateFallbackElement!==ye.hydrateFallbackElement?{...ue,route:ye}:ue})),S={...S,...U};let te=[],j=[];S.fetchers.forEach((ue,ye)=>{ue.state==="idle"&&(q.has(ye)?te.push(ye):j.push(ye))}),q.forEach(ue=>{!S.fetchers.has(ue)&&!de.has(ue)&&te.push(ue)}),[...p].forEach(ue=>ue(S,{deletedFetchers:te,viewTransitionOpts:Y.viewTransitionOpts,flushSync:Y.flushSync===!0})),te.forEach(ue=>mt(ue)),j.forEach(ue=>S.fetchers.delete(ue))}function Le(U,Y,{flushSync:te}={}){var D,P;let j=S.actionData!=null&&S.navigation.formMethod!=null&&Dr(S.navigation.formMethod)&&S.navigation.state==="loading"&&((D=U.state)==null?void 0:D._isRedirect)!==!0,ue;Y.actionData?Object.keys(Y.actionData).length>0?ue=Y.actionData:ue=null:j?ue=S.actionData:ue=null;let ye=Y.loaderData?lT(S.loaderData,Y.loaderData,Y.matches||[],Y.errors):S.loaderData,Fe=S.blockers;Fe.size>0&&(Fe=new Map(Fe),Fe.forEach((N,O)=>Fe.set(O,Xu)));let Me=ie?!1:bt(U,Y.matches||S.matches),A=M===!0||S.navigation.formMethod!=null&&Dr(S.navigation.formMethod)&&((P=U.state)==null?void 0:P._isRedirect)!==!0;o&&(a=o,o=void 0),ie||C==="POP"||(C==="PUSH"?e.history.push(U,U.state):C==="REPLACE"&&e.history.replace(U,U.state));let I;if(C==="POP"){let N=V.get(S.location.pathname);N&&N.has(U.pathname)?I={currentLocation:S.location,nextLocation:U}:V.has(U.pathname)&&(I={currentLocation:U,nextLocation:S.location})}else if(b){let N=V.get(S.location.pathname);N?N.add(U.pathname):(N=new Set([U.pathname]),V.set(S.location.pathname,N)),I={currentLocation:S.location,nextLocation:U}}oe({...Y,actionData:ue,loaderData:ye,historyAction:C,location:U,initialized:!0,navigation:zp,revalidation:"idle",restoreScrollPosition:Me,preventScrollReset:A,blockers:Fe},{viewTransitionOpts:I,flushSync:te===!0}),C="POP",M=!1,b=!1,ie=!1,Q=!1,ee==null||ee.resolve(),ee=null}async function B(U,Y){if(typeof U=="number"){e.history.go(U);return}let te=yg(S.location,S.matches,l,U,Y==null?void 0:Y.fromRouteId,Y==null?void 0:Y.relative),{path:j,submission:ue,error:ye}=Zw(!1,te,Y),Fe=S.location,Me=tf(S.location,j,Y&&Y.state);Me={...Me,...e.history.encodeLocation(Me)};let A=Y&&Y.replace!=null?Y.replace:void 0,I="PUSH";A===!0?I="REPLACE":A===!1||ue!=null&&Dr(ue.formMethod)&&ue.formAction===S.location.pathname+S.location.search&&(I="REPLACE");let D=Y&&"preventScrollReset"in Y?Y.preventScrollReset===!0:void 0,P=(Y&&Y.flushSync)===!0,N=xn({currentLocation:Fe,nextLocation:Me,historyAction:I});if(N){Et(N,{state:"blocked",location:Me,proceed(){Et(N,{state:"proceeding",proceed:void 0,reset:void 0,location:Me}),B(U,Y)},reset(){let O=new Map(S.blockers);O.set(N,Xu),oe({blockers:O})}});return}await Ue(I,Me,{submission:ue,pendingError:ye,preventScrollReset:D,replace:Y&&Y.replace,enableViewTransition:Y&&Y.viewTransition,flushSync:P})}function st(){ee||(ee=_3()),Oe(),oe({revalidation:"loading"});let U=ee.promise;return S.navigation.state==="submitting"?U:S.navigation.state==="idle"?(Ue(S.historyAction,S.location,{startUninterruptedRevalidation:!0}),U):(Ue(C||S.historyAction,S.navigation.location,{overrideNavigation:S.navigation,enableViewTransition:b===!0}),U)}async function Ue(U,Y,te){F&&F.abort(),F=null,C=U,ie=(te&&te.startUninterruptedRevalidation)===!0,Nt(S.location,S.matches),M=(te&&te.preventScrollReset)===!0,b=(te&&te.enableViewTransition)===!0;let j=o||a,ue=te&&te.overrideNavigation,ye=te!=null&&te.initialHydration&&S.matches&&S.matches.length>0&&!T?S.matches:na(j,Y,l),Fe=(te&&te.flushSync)===!0;if(ye&&S.initialized&&!Q&&v3(S.location,Y)&&!(te&&te.submission&&Dr(te.submission.formMethod))){Le(Y,{matches:ye},{flushSync:Fe});return}let Me=Ut(ye,j,Y.pathname);if(Me.active&&Me.matches&&(ye=Me.matches),!ye){let{error:ce,notFoundMatches:X,route:J}=Wn(Y.pathname);Le(Y,{matches:X,loaderData:{},errors:{[J.id]:ce}},{flushSync:Fe});return}F=new AbortController;let A=cl(e.history,Y,F.signal,te&&te.submission),I=e.unstable_getContext?await e.unstable_getContext():new Qw,D;if(te&&te.pendingError)D=[ra(ye).route.id,{type:"error",error:te.pendingError}];else if(te&&te.submission&&Dr(te.submission.formMethod)){let ce=await at(A,Y,te.submission,ye,I,Me.active,te&&te.initialHydration===!0,{replace:te.replace,flushSync:Fe});if(ce.shortCircuited)return;if(ce.pendingActionResult){let[X,J]=ce.pendingActionResult;if($r(J)&&rf(J.error)&&J.error.status===404){F=null,Le(Y,{matches:ce.matches,loaderData:{},errors:{[X]:J.error}});return}}ye=ce.matches||ye,D=ce.pendingActionResult,ue=Wp(Y,te.submission),Fe=!1,Me.active=!1,A=cl(e.history,A.url,A.signal)}let{shortCircuited:P,matches:N,loaderData:O,errors:Z}=await $e(A,Y,ye,I,Me.active,ue,te&&te.submission,te&&te.fetcherSubmission,te&&te.replace,te&&te.initialHydration===!0,Fe,D);P||(F=null,Le(Y,{matches:N||ye,...uT(D),loaderData:O,errors:Z}))}async function at(U,Y,te,j,ue,ye,Fe,Me={}){Oe();let A=w3(Y,te);if(oe({navigation:A},{flushSync:Me.flushSync===!0}),ye){let P=await ot(j,Y.pathname,U.signal);if(P.type==="aborted")return{shortCircuited:!0};if(P.type==="error"){let N=ra(P.partialMatches).route.id;return{matches:P.partialMatches,pendingActionResult:[N,{type:"error",error:P.error}]}}else if(P.matches)j=P.matches;else{let{notFoundMatches:N,error:O,route:Z}=Wn(Y.pathname);return{matches:N,pendingActionResult:[Z.id,{type:"error",error:O}]}}}let I,D=l0(j,Y);if(!D.route.action&&!D.route.lazy)I={type:"error",error:fi(405,{method:U.method,pathname:Y.pathname,routeId:D.route.id})};else{let P=Ol(i,s,U,j,D,Fe?[]:r,ue),N=await Ce(U,P,ue,null);if(I=N[D.route.id],!I){for(let O of j)if(N[O.route.id]){I=N[O.route.id];break}}if(U.signal.aborted)return{shortCircuited:!0}}if(so(I)){let P;return Me&&Me.replace!=null?P=Me.replace:P=sT(I.response.headers.get("Location"),new URL(U.url),l)===S.location.pathname+S.location.search,await ve(U,I,!0,{submission:te,replace:P}),{shortCircuited:!0}}if($r(I)){let P=ra(j,D.route.id);return(Me&&Me.replace)!==!0&&(C="PUSH"),{matches:j,pendingActionResult:[P.route.id,I,D.route.id]}}return{matches:j,pendingActionResult:[D.route.id,I]}}async function $e(U,Y,te,j,ue,ye,Fe,Me,A,I,D,P){let N=ye||Wp(Y,Fe),O=Fe||Me||dT(N),Z=!ie&&!I;if(ue){if(Z){let Xt=Re(P);oe({navigation:N,...Xt!==void 0?{actionData:Xt}:{}},{flushSync:D})}let je=await ot(te,Y.pathname,U.signal);if(je.type==="aborted")return{shortCircuited:!0};if(je.type==="error"){let Xt=ra(je.partialMatches).route.id;return{matches:je.partialMatches,loaderData:{},errors:{[Xt]:je.error}}}else if(je.matches)te=je.matches;else{let{error:Xt,notFoundMatches:Vr,route:Ar}=Wn(Y.pathname);return{matches:Vr,loaderData:{},errors:{[Ar.id]:Xt}}}}let ce=o||a,{dsMatches:X,revalidatingFetchers:J}=eT(U,j,i,s,e.history,S,te,O,Y,I?[]:r,I===!0,Q,se,q,xe,fe,ce,l,e.patchRoutesOnNavigation!=null,P);if(ne=++ae,!e.dataStrategy&&!X.some(je=>je.shouldLoad)&&!X.some(je=>je.route.unstable_middleware)&&J.length===0){let je=yt();return Le(Y,{matches:te,loaderData:{},errors:P&&$r(P[1])?{[P[0]]:P[1].error}:null,...uT(P),...je?{fetchers:new Map(S.fetchers)}:{}},{flushSync:D}),{shortCircuited:!0}}if(Z){let je={};if(!ue){je.navigation=N;let Xt=Re(P);Xt!==void 0&&(je.actionData=Xt)}J.length>0&&(je.fetchers=ht(J)),oe(je,{flushSync:D})}J.forEach(je=>{Xe(je.key),je.controller&&de.set(je.key,je.controller)});let re=()=>J.forEach(je=>Xe(je.key));F&&F.signal.addEventListener("abort",re);let{loaderResults:le,fetcherResults:Ae}=await Ne(X,J,U,j);if(U.signal.aborted)return{shortCircuited:!0};F&&F.signal.removeEventListener("abort",re),J.forEach(je=>de.delete(je.key));let Te=kd(le);if(Te)return await ve(U,Te.result,!0,{replace:A}),{shortCircuited:!0};if(Te=kd(Ae),Te)return fe.add(Te.key),await ve(U,Te.result,!0,{replace:A}),{shortCircuited:!0};let{loaderData:Ee,errors:De}=oT(S,te,le,P,J,Ae);I&&S.errors&&(De={...S.errors,...De});let Ge=yt(),_t=It(ne),Tt=Ge||_t||J.length>0;return{matches:te,loaderData:Ee,errors:De,...Tt?{fetchers:new Map(S.fetchers)}:{}}}function Re(U){if(U&&!$r(U[1]))return{[U[0]]:U[1].data};if(S.actionData)return Object.keys(S.actionData).length===0?null:S.actionData}function ht(U){return U.forEach(Y=>{let te=S.fetchers.get(Y.key),j=Ju(void 0,te?te.data:void 0);S.fetchers.set(Y.key,j)}),new Map(S.fetchers)}async function Dt(U,Y,te,j){Xe(U);let ue=(j&&j.flushSync)===!0,ye=o||a,Fe=yg(S.location,S.matches,l,te,Y,j==null?void 0:j.relative),Me=na(ye,Fe,l),A=Ut(Me,ye,Fe);if(A.active&&A.matches&&(Me=A.matches),!Me){Je(U,Y,fi(404,{pathname:Fe}),{flushSync:ue});return}let{path:I,submission:D,error:P}=Zw(!0,Fe,j);if(P){Je(U,Y,P,{flushSync:ue});return}let N=e.unstable_getContext?await e.unstable_getContext():new Qw,O=(j&&j.preventScrollReset)===!0;if(D&&Dr(D.formMethod)){await tt(U,Y,I,Me,N,A.active,ue,O,D);return}xe.set(U,{routeId:Y,path:I}),await Kt(U,Y,I,Me,N,A.active,ue,O,D)}async function tt(U,Y,te,j,ue,ye,Fe,Me,A){Oe(),xe.delete(U);let I=S.fetchers.get(U);He(U,T3(A,I),{flushSync:Fe});let D=new AbortController,P=cl(e.history,te,D.signal,A);if(ye){let Lt=await ot(j,new URL(P.url).pathname,P.signal,U);if(Lt.type==="aborted")return;if(Lt.type==="error"){Je(U,Y,Lt.error,{flushSync:Fe});return}else if(Lt.matches)j=Lt.matches;else{Je(U,Y,fi(404,{pathname:te}),{flushSync:Fe});return}}let N=l0(j,te);if(!N.route.action&&!N.route.lazy){let Lt=fi(405,{method:A.formMethod,pathname:te,routeId:Y});Je(U,Y,Lt,{flushSync:Fe});return}de.set(U,D);let O=ae,Z=Ol(i,s,P,j,N,r,ue),X=(await Ce(P,Z,ue,U))[N.route.id];if(P.signal.aborted){de.get(U)===D&&de.delete(U);return}if(q.has(U)){if(so(X)||$r(X)){He(U,Ys(void 0));return}}else{if(so(X))if(de.delete(U),ne>O){He(U,Ys(void 0));return}else return fe.add(U),He(U,Ju(A)),ve(P,X,!1,{fetcherSubmission:A,preventScrollReset:Me});if($r(X)){Je(U,Y,X.error);return}}let J=S.navigation.location||S.location,re=cl(e.history,J,D.signal),le=o||a,Ae=S.navigation.state!=="idle"?na(le,S.navigation.location,l):S.matches;gt(Ae,"Didn't find any matches after fetcher action");let Te=++ae;H.set(U,Te);let Ee=Ju(A,X.data);S.fetchers.set(U,Ee);let{dsMatches:De,revalidatingFetchers:Ge}=eT(re,ue,i,s,e.history,S,Ae,A,J,r,!1,Q,se,q,xe,fe,le,l,e.patchRoutesOnNavigation!=null,[N.route.id,X]);Ge.filter(Lt=>Lt.key!==U).forEach(Lt=>{let qi=Lt.key,Ln=S.fetchers.get(qi),ki=Ju(void 0,Ln?Ln.data:void 0);S.fetchers.set(qi,ki),Xe(qi),Lt.controller&&de.set(qi,Lt.controller)}),oe({fetchers:new Map(S.fetchers)});let _t=()=>Ge.forEach(Lt=>Xe(Lt.key));D.signal.addEventListener("abort",_t);let{loaderResults:Tt,fetcherResults:je}=await Ne(De,Ge,re,ue);if(D.signal.aborted)return;if(D.signal.removeEventListener("abort",_t),H.delete(U),de.delete(U),Ge.forEach(Lt=>de.delete(Lt.key)),S.fetchers.has(U)){let Lt=Ys(X.data);S.fetchers.set(U,Lt)}let Xt=kd(Tt);if(Xt)return ve(re,Xt.result,!1,{preventScrollReset:Me});if(Xt=kd(je),Xt)return fe.add(Xt.key),ve(re,Xt.result,!1,{preventScrollReset:Me});let{loaderData:Vr,errors:Ar}=oT(S,Ae,Tt,void 0,Ge,je);It(Te),S.navigation.state==="loading"&&Te>ne?(gt(C,"Expected pending action"),F&&F.abort(),Le(S.navigation.location,{matches:Ae,loaderData:Vr,errors:Ar,fetchers:new Map(S.fetchers)})):(oe({errors:Ar,loaderData:lT(S.loaderData,Vr,Ae,Ar),fetchers:new Map(S.fetchers)}),Q=!1)}async function Kt(U,Y,te,j,ue,ye,Fe,Me,A){let I=S.fetchers.get(U);He(U,Ju(A,I?I.data:void 0),{flushSync:Fe});let D=new AbortController,P=cl(e.history,te,D.signal);if(ye){let J=await ot(j,new URL(P.url).pathname,P.signal,U);if(J.type==="aborted")return;if(J.type==="error"){Je(U,Y,J.error,{flushSync:Fe});return}else if(J.matches)j=J.matches;else{Je(U,Y,fi(404,{pathname:te}),{flushSync:Fe});return}}let N=l0(j,te);de.set(U,D);let O=ae,Z=Ol(i,s,P,j,N,r,ue),X=(await Ce(P,Z,ue,U))[N.route.id];if(de.get(U)===D&&de.delete(U),!P.signal.aborted){if(q.has(U)){He(U,Ys(void 0));return}if(so(X))if(ne>O){He(U,Ys(void 0));return}else{fe.add(U),await ve(P,X,!1,{preventScrollReset:Me});return}if($r(X)){Je(U,Y,X.error);return}He(U,Ys(X.data))}}async function ve(U,Y,te,{submission:j,fetcherSubmission:ue,preventScrollReset:ye,replace:Fe}={}){Y.response.headers.has("X-Remix-Revalidate")&&(Q=!0);let Me=Y.response.headers.get("Location");gt(Me,"Expected a Location header on the redirect Response"),Me=sT(Me,new URL(U.url),l);let A=tf(S.location,Me,{_isRedirect:!0});if(n){let Z=!1;if(Y.response.headers.has("X-Remix-Reload-Document"))Z=!0;else if(Mx(Me)){const ce=EA(Me,!0);Z=ce.origin!==t.location.origin||Ei(ce.pathname,l)==null}if(Z){Fe?t.location.replace(Me):t.location.assign(Me);return}}F=null;let I=Fe===!0||Y.response.headers.has("X-Remix-Replace")?"REPLACE":"PUSH",{formMethod:D,formAction:P,formEncType:N}=S.navigation;!j&&!ue&&D&&P&&N&&(j=dT(S.navigation));let O=j||ue;if(n3.has(Y.response.status)&&O&&Dr(O.formMethod))await Ue(I,A,{submission:{...O,formAction:Me},preventScrollReset:ye||M,enableViewTransition:te?b:void 0});else{let Z=Wp(A,j);await Ue(I,A,{overrideNavigation:Z,fetcherSubmission:ue,preventScrollReset:ye||M,enableViewTransition:te?b:void 0})}}async function Ce(U,Y,te,j){let ue,ye={};try{ue=await d3(u,U,Y,j,te,!1)}catch(Fe){return Y.filter(Me=>Me.shouldLoad).forEach(Me=>{ye[Me.route.id]={type:"error",error:Fe}}),ye}if(U.signal.aborted)return ye;for(let[Fe,Me]of Object.entries(ue))if(x3(Me)){let A=Me.result;ye[Fe]={type:"redirect",response:m3(A,U,Fe,Y,l)}}else ye[Fe]=await p3(Me);return ye}async function Ne(U,Y,te,j){let ue=Ce(te,U,j,null),ye=Promise.all(Y.map(async A=>{if(A.matches&&A.match&&A.request&&A.controller){let D=(await Ce(A.request,A.matches,j,A.key))[A.match.route.id];return{[A.key]:D}}else return Promise.resolve({[A.key]:{type:"error",error:fi(404,{pathname:A.path})}})})),Fe=await ue,Me=(await ye).reduce((A,I)=>Object.assign(A,I),{});return{loaderResults:Fe,fetcherResults:Me}}function Oe(){Q=!0,xe.forEach((U,Y)=>{de.has(Y)&&se.add(Y),Xe(Y)})}function He(U,Y,te={}){S.fetchers.set(U,Y),oe({fetchers:new Map(S.fetchers)},{flushSync:(te&&te.flushSync)===!0})}function Je(U,Y,te,j={}){let ue=ra(S.matches,Y);mt(U),oe({errors:{[ue.route.id]:te},fetchers:new Map(S.fetchers)},{flushSync:(j&&j.flushSync)===!0})}function Qe(U){return L.set(U,(L.get(U)||0)+1),q.has(U)&&q.delete(U),S.fetchers.get(U)||r3}function mt(U){let Y=S.fetchers.get(U);de.has(U)&&!(Y&&Y.state==="loading"&&H.has(U))&&Xe(U),xe.delete(U),H.delete(U),fe.delete(U),q.delete(U),se.delete(U),S.fetchers.delete(U)}function We(U){let Y=(L.get(U)||0)-1;Y<=0?(L.delete(U),q.add(U)):L.set(U,Y),oe({fetchers:new Map(S.fetchers)})}function Xe(U){let Y=de.get(U);Y&&(Y.abort(),de.delete(U))}function Rt(U){for(let Y of U){let te=Qe(Y),j=Ys(te.data);S.fetchers.set(Y,j)}}function yt(){let U=[],Y=!1;for(let te of fe){let j=S.fetchers.get(te);gt(j,`Expected fetcher: ${te}`),j.state==="loading"&&(fe.delete(te),U.push(te),Y=!0)}return Rt(U),Y}function It(U){let Y=[];for(let[te,j]of H)if(j<U){let ue=S.fetchers.get(te);gt(ue,`Expected fetcher: ${te}`),ue.state==="loading"&&(Xe(te),H.delete(te),Y.push(te))}return Rt(Y),Y.length>0}function Mt(U,Y){let te=S.blockers.get(U)||Xu;return W.get(U)!==Y&&W.set(U,Y),te}function bn(U){S.blockers.delete(U),W.delete(U)}function Et(U,Y){let te=S.blockers.get(U)||Xu;gt(te.state==="unblocked"&&Y.state==="blocked"||te.state==="blocked"&&Y.state==="blocked"||te.state==="blocked"&&Y.state==="proceeding"||te.state==="blocked"&&Y.state==="unblocked"||te.state==="proceeding"&&Y.state==="unblocked",`Invalid blocker state transition: ${te.state} -> ${Y.state}`);let j=new Map(S.blockers);j.set(U,Y),oe({blockers:j})}function xn({currentLocation:U,nextLocation:Y,historyAction:te}){if(W.size===0)return;W.size>1&&Rn(!1,"A router only supports one blocker at a time");let j=Array.from(W.entries()),[ue,ye]=j[j.length-1],Fe=S.blockers.get(ue);if(!(Fe&&Fe.state==="proceeding")&&ye({currentLocation:U,nextLocation:Y,historyAction:te}))return ue}function Wn(U){let Y=fi(404,{pathname:U}),te=o||a,{matches:j,route:ue}=cT(te);return{notFoundMatches:j,route:ue,error:Y}}function Gn(U,Y,te){if(m=U,g=Y,v=te||null,!w&&S.navigation===zp){w=!0;let j=bt(S.location,S.matches);j!=null&&oe({restoreScrollPosition:j})}return()=>{m=null,g=null,v=null}}function fn(U,Y){return v&&v(U,Y.map(j=>Ib(j,S.loaderData)))||U.key}function Nt(U,Y){if(m&&g){let te=fn(U,Y);m[te]=g()}}function bt(U,Y){if(m){let te=fn(U,Y),j=m[te];if(typeof j=="number")return j}return null}function Ut(U,Y,te){if(e.patchRoutesOnNavigation)if(U){if(Object.keys(U[0].params).length>0)return{active:!0,matches:o0(Y,te,l,!0)}}else return{active:!0,matches:o0(Y,te,l,!0)||[]};return{active:!1,matches:null}}async function ot(U,Y,te,j){if(!e.patchRoutesOnNavigation)return{type:"success",matches:U};let ue=U;for(;;){let ye=o==null,Fe=o||a,Me=s;try{await e.patchRoutesOnNavigation({signal:te,path:Y,matches:ue,fetcherKey:j,patch:(D,P)=>{te.aborted||tT(D,P,Fe,Me,i,!1)}})}catch(D){return{type:"error",error:D,partialMatches:ue}}finally{ye&&!te.aborted&&(a=[...a])}if(te.aborted)return{type:"aborted"};let A=na(Fe,Y,l);if(A)return{type:"success",matches:A};let I=o0(Fe,Y,l,!0);if(!I||ue.length===I.length&&ue.every((D,P)=>D.route.id===I[P].route.id))return{type:"success",matches:null};ue=I}}function wt(U){s={},o=nf(U,i,void 0,s)}function be(U,Y,te=!1){let j=o==null;tT(U,Y,o||a,s,i,te),j&&(a=[...a],oe({}))}return k={get basename(){return l},get future(){return c},get state(){return S},get routes(){return a},get window(){return t},initialize:Se,subscribe:pe,enableScrollRestoration:Gn,navigate:B,fetch:Dt,revalidate:st,createHref:U=>e.history.createHref(U),encodeLocation:U=>e.history.encodeLocation(U),getFetcher:Qe,deleteFetcher:We,dispose:we,getBlocker:Mt,deleteBlocker:bn,patchRoutes:be,_internalFetchControllers:de,_internalSetRoutes:wt,_internalSetStateDoNotUseOrYouWillBreakYourApp(U){oe(U)}},k}function o3(e){return e!=null&&("formData"in e&&e.formData!=null||"body"in e&&e.body!==void 0)}function yg(e,t,n,r,i,s){let a,o;if(i){a=[];for(let u of t)if(a.push(u),u.route.id===i){o=u;break}}else a=t,o=t[t.length-1];let l=Rx(r||".",Ax(a),Ei(e.pathname,n)||e.pathname,s==="path");if(r==null&&(l.search=e.search,l.hash=e.hash),(r==null||r===""||r===".")&&o){let u=Fx(l.search);if(o.route.index&&!u)l.search=l.search?l.search.replace(/^\?/,"?index&"):"?index";else if(!o.route.index&&u){let c=new URLSearchParams(l.search),h=c.getAll("index");c.delete("index"),h.filter(m=>m).forEach(m=>c.append("index",m));let p=c.toString();l.search=p?`?${p}`:""}}return n!=="/"&&(l.pathname=qb({basename:n,pathname:l.pathname})),Da(l)}function Zw(e,t,n){if(!n||!o3(n))return{path:t};if(n.formMethod&&!y3(n.formMethod))return{path:t,error:fi(405,{method:n.formMethod})};let r=()=>({path:t,error:fi(400,{type:"invalid-body"})}),s=(n.formMethod||"get").toUpperCase(),a=LA(t);if(n.body!==void 0){if(n.formEncType==="text/plain"){if(!Dr(s))return r();let h=typeof n.body=="string"?n.body:n.body instanceof FormData||n.body instanceof URLSearchParams?Array.from(n.body.entries()).reduce((p,[m,v])=>`${p}${m}=${v}
`,""):String(n.body);return{path:t,submission:{formMethod:s,formAction:a,formEncType:n.formEncType,formData:void 0,json:void 0,text:h}}}else if(n.formEncType==="application/json"){if(!Dr(s))return r();try{let h=typeof n.body=="string"?JSON.parse(n.body):n.body;return{path:t,submission:{formMethod:s,formAction:a,formEncType:n.formEncType,formData:void 0,json:h,text:void 0}}}catch{return r()}}}gt(typeof FormData=="function","FormData is not available in this environment");let o,l;if(n.formData)o=Sg(n.formData),l=n.formData;else if(n.body instanceof FormData)o=Sg(n.body),l=n.body;else if(n.body instanceof URLSearchParams)o=n.body,l=aT(o);else if(n.body==null)o=new URLSearchParams,l=new FormData;else try{o=new URLSearchParams(n.body),l=aT(o)}catch{return r()}let u={formMethod:s,formAction:a,formEncType:n&&n.formEncType||"application/x-www-form-urlencoded",formData:l,json:void 0,text:void 0};if(Dr(u.formMethod))return{path:t,submission:u};let c=$a(t);return e&&c.search&&Fx(c.search)&&o.append("index",""),c.search=`?${o}`,{path:Da(c),submission:u}}function eT(e,t,n,r,i,s,a,o,l,u,c,h,p,m,v,g,w,x,T,y){var ie;let _=y?$r(y[1])?y[1].error:y[1].data:void 0,k=i.createURL(s.location),S=i.createURL(l),C;if(c&&s.errors){let Q=Object.keys(s.errors)[0];C=a.findIndex(se=>se.route.id===Q)}else if(y&&$r(y[1])){let Q=y[0];C=a.findIndex(se=>se.route.id===Q)-1}let M=y?y[1].statusCode:void 0,F=M&&M>=400,b={currentUrl:k,currentParams:((ie=s.matches[0])==null?void 0:ie.params)||{},nextUrl:S,nextParams:a[0].params,...o,actionResult:_,actionStatus:M},V=a.map((Q,se)=>{let{route:de}=Q,ae=null;if(C!=null&&se>C?ae=!1:de.lazy?ae=!0:de.loader==null?ae=!1:c?ae=wg(de,s.loaderData,s.errors):l3(s.loaderData,s.matches[se],Q)&&(ae=!0),ae!==null)return Tg(n,r,e,Q,u,t,ae);let ne=F?!1:h||k.pathname+k.search===S.pathname+S.search||k.search!==S.search||u3(s.matches[se],Q),H={...b,defaultShouldRevalidate:ne},fe=G0(Q,H);return Tg(n,r,e,Q,u,t,fe,H)}),z=[];return v.forEach((Q,se)=>{if(c||!a.some(q=>q.route.id===Q.routeId)||m.has(se))return;let de=s.fetchers.get(se),ae=de&&de.state!=="idle"&&de.data===void 0,ne=na(w,Q.path,x);if(!ne){if(T&&ae)return;z.push({key:se,routeId:Q.routeId,path:Q.path,matches:null,match:null,request:null,controller:null});return}if(g.has(se))return;let H=l0(ne,Q.path),fe=new AbortController,xe=cl(i,Q.path,fe.signal),L=null;if(p.has(se))p.delete(se),L=Ol(n,r,xe,ne,H,u,t);else if(ae)h&&(L=Ol(n,r,xe,ne,H,u,t));else{let q={...b,defaultShouldRevalidate:F?!1:h};G0(H,q)&&(L=Ol(n,r,xe,ne,H,u,t,q))}L&&z.push({key:se,routeId:Q.routeId,path:Q.path,matches:L,match:H,request:xe,controller:fe})}),{dsMatches:V,revalidatingFetchers:z}}function wg(e,t,n){if(e.lazy)return!0;if(!e.loader)return!1;let r=t!=null&&e.id in t,i=n!=null&&n[e.id]!==void 0;return!r&&i?!1:typeof e.loader=="function"&&e.loader.hydrate===!0?!0:!r&&!i}function l3(e,t,n){let r=!t||n.route.id!==t.route.id,i=!e.hasOwnProperty(n.route.id);return r||i}function u3(e,t){let n=e.route.path;return e.pathname!==t.pathname||n!=null&&n.endsWith("*")&&e.params["*"]!==t.params["*"]}function G0(e,t){if(e.route.shouldRevalidate){let n=e.route.shouldRevalidate(t);if(typeof n=="boolean")return n}return t.defaultShouldRevalidate}function tT(e,t,n,r,i,s){let a;if(e){let u=r[e];gt(u,`No route found to patch children into: routeId = ${e}`),u.children||(u.children=[]),a=u.children}else a=n;let o=[],l=[];if(t.forEach(u=>{let c=a.find(h=>FA(u,h));c?l.push({existingRoute:c,newRoute:u}):o.push(u)}),o.length>0){let u=nf(o,i,[e||"_","patch",String((a==null?void 0:a.length)||"0")],r);a.push(...u)}if(s&&l.length>0)for(let u=0;u<l.length;u++){let{existingRoute:c,newRoute:h}=l[u],p=c,[m]=nf([h],i,[],{},!0);Object.assign(p,{element:m.element?m.element:p.element,errorElement:m.errorElement?m.errorElement:p.errorElement,hydrateFallbackElement:m.hydrateFallbackElement?m.hydrateFallbackElement:p.hydrateFallbackElement})}}function FA(e,t){return"id"in e&&"id"in t&&e.id===t.id?!0:e.index===t.index&&e.path===t.path&&e.caseSensitive===t.caseSensitive?(!e.children||e.children.length===0)&&(!t.children||t.children.length===0)?!0:e.children.every((n,r)=>{var i;return(i=t.children)==null?void 0:i.some(s=>FA(n,s))}):!1}var nT=new WeakMap,DA=({key:e,route:t,manifest:n,mapRouteProperties:r})=>{let i=n[t.id];if(gt(i,"No route found in manifest"),!i.lazy||typeof i.lazy!="object")return;let s=i.lazy[e];if(!s)return;let a=nT.get(i);a||(a={},nT.set(i,a));let o=a[e];if(o)return o;let l=(async()=>{let u=Mb(e),h=i[e]!==void 0&&e!=="hasErrorBoundary";if(u)Rn(!u,"Route property "+e+" is not a supported lazy route property. This property will be ignored."),a[e]=Promise.resolve();else if(h)Rn(!1,`Route "${i.id}" has a static property "${e}" defined. The lazy property will be ignored.`);else{let p=await s();p!=null&&(Object.assign(i,{[e]:p}),Object.assign(i,r(i)))}typeof i.lazy=="object"&&(i.lazy[e]=void 0,Object.values(i.lazy).every(p=>p===void 0)&&(i.lazy=void 0))})();return a[e]=l,l},rT=new WeakMap;function c3(e,t,n,r,i){let s=n[e.id];if(gt(s,"No route found in manifest"),!e.lazy)return{lazyRoutePromise:void 0,lazyHandlerPromise:void 0};if(typeof e.lazy=="function"){let c=rT.get(s);if(c)return{lazyRoutePromise:c,lazyHandlerPromise:c};let h=(async()=>{gt(typeof e.lazy=="function","No lazy route function found");let p=await e.lazy(),m={};for(let v in p){let g=p[v];if(g===void 0)continue;let w=Db(v),T=s[v]!==void 0&&v!=="hasErrorBoundary";w?Rn(!w,"Route property "+v+" is not a supported property to be returned from a lazy route function. This property will be ignored."):T?Rn(!T,`Route "${s.id}" has a static property "${v}" defined but its lazy function is also returning a value for this property. The lazy route property "${v}" will be ignored.`):m[v]=g}Object.assign(s,m),Object.assign(s,{...r(s),lazy:void 0})})();return rT.set(s,h),h.catch(()=>{}),{lazyRoutePromise:h,lazyHandlerPromise:h}}let a=Object.keys(e.lazy),o=[],l;for(let c of a){if(i&&i.includes(c))continue;let h=DA({key:c,route:e,manifest:n,mapRouteProperties:r});h&&(o.push(h),c===t&&(l=h))}let u=o.length>0?Promise.all(o).then(()=>{}):void 0;return u==null||u.catch(()=>{}),l==null||l.catch(()=>{}),{lazyRoutePromise:u,lazyHandlerPromise:l}}async function iT(e){let t=e.matches.filter(i=>i.shouldLoad),n={};return(await Promise.all(t.map(i=>i.resolve()))).forEach((i,s)=>{n[t[s].route.id]=i}),n}async function f3(e){if(!e.matches.some(n=>n.route.unstable_middleware))return iT(e);let t=!1;return IA(e,()=>(t=!0,iT(e)),(n,r)=>PA(n,r,e.matches,t))}function PA(e,t,n,r){var i;return r?{[t]:{type:"error",result:e}}:{[ra(n,((i=n.find(a=>a.route.id===t||a.route.loader))==null?void 0:i.route.id)||t).route.id]:{type:"error",result:e}}}async function IA(e,t,n){let{matches:r,request:i,params:s,context:a}=e,o=r.flatMap(u=>u.route.unstable_middleware?u.route.unstable_middleware.map(c=>[u.route.id,c]):[]),l={};return await NA({request:i,params:s,context:a},o,t,n,l),l}async function NA(e,t,n,r,i={},s=0){let{request:a}=e;if(a.signal.aborted)throw a.signal.reason?a.signal.reason:new Error(`Request aborted without an \`AbortSignal.reason\`: ${a.method} ${a.url}`);let o=t[s];if(!o){let p=await n();Object.assign(i,p);return}let[l,u]=o,c=!1,h=async()=>{if(c)throw new Error("You may only call `next()` once per middleware");c=!0;try{let p=await NA(e,t,n,r,i,s+1);Object.assign(i,p)}catch(p){let m=await r(p,l);Object.assign(i,m)}};try{let p=await u({request:e.request,params:e.params,context:e.context},h);typeof p<"u"&&console.warn("client middlewares are not intended to return values, the value will be ignored",p),c||await h()}catch(p){let m=await r(p,l);Object.assign(i,m)}}function bA(e,t,n,r,i){let s=DA({key:"unstable_middleware",route:r.route,manifest:t,mapRouteProperties:e}),a=c3(r.route,Dr(n.method)?"action":"loader",t,e,i);return{middleware:s,route:a.lazyRoutePromise,handler:a.lazyHandlerPromise}}function Tg(e,t,n,r,i,s,a,o=null){let l=!1,u=bA(e,t,n,r,i);return{...r,_lazyPromises:u,shouldLoad:a,unstable_shouldRevalidateArgs:o,unstable_shouldCallHandler(c){return l=!0,o?typeof c=="boolean"?G0(r,{...o,defaultShouldRevalidate:c}):G0(r,o):a},resolve(c){return l||a||c&&!Dr(n.method)&&(r.route.lazy||r.route.loader)?h3({request:n,match:r,lazyHandlerPromise:u==null?void 0:u.handler,lazyRoutePromise:u==null?void 0:u.route,handlerOverride:c,scopedContext:s}):Promise.resolve({type:"data",result:void 0})}}}function Ol(e,t,n,r,i,s,a,o=null){return r.map(l=>l.route.id!==i.route.id?{...l,shouldLoad:!1,unstable_shouldRevalidateArgs:o,unstable_shouldCallHandler:()=>!1,_lazyPromises:bA(e,t,n,l,s),resolve:()=>Promise.resolve({type:"data",result:void 0})}:Tg(e,t,n,l,s,a,!0,o))}async function d3(e,t,n,r,i,s){n.some(u=>{var c;return(c=u._lazyPromises)==null?void 0:c.middleware})&&await Promise.all(n.map(u=>{var c;return(c=u._lazyPromises)==null?void 0:c.middleware}));let a={request:t,params:n[0].params,context:i,matches:n},l=await e({...a,fetcherKey:r,unstable_runClientMiddleware:u=>{let c=a,h=!1;return IA(c,()=>(h=!0,u({...c,fetcherKey:r,unstable_runClientMiddleware:()=>{throw new Error("Cannot call `unstable_runClientMiddleware()` from within an `unstable_runClientMiddleware` handler")}})),(p,m)=>PA(p,m,n,h))}});try{await Promise.all(n.flatMap(u=>{var c,h;return[(c=u._lazyPromises)==null?void 0:c.handler,(h=u._lazyPromises)==null?void 0:h.route]}))}catch{}return l}async function h3({request:e,match:t,lazyHandlerPromise:n,lazyRoutePromise:r,handlerOverride:i,scopedContext:s}){let a,o,l=Dr(e.method),u=l?"action":"loader",c=h=>{let p,m=new Promise((w,x)=>p=x);o=()=>p(),e.signal.addEventListener("abort",o);let v=w=>typeof h!="function"?Promise.reject(new Error(`You cannot call the handler for a route which defines a boolean "${u}" [routeId: ${t.route.id}]`)):h({request:e,params:t.params,context:s},...w!==void 0?[w]:[]),g=(async()=>{try{return{type:"data",result:await(i?i(x=>v(x)):v())}}catch(w){return{type:"error",result:w}}})();return Promise.race([g,m])};try{let h=l?t.route.action:t.route.loader;if(n||r)if(h){let p,[m]=await Promise.all([c(h).catch(v=>{p=v}),n,r]);if(p!==void 0)throw p;a=m}else{await n;let p=l?t.route.action:t.route.loader;if(p)[a]=await Promise.all([c(p),r]);else if(u==="action"){let m=new URL(e.url),v=m.pathname+m.search;throw fi(405,{method:e.method,pathname:v,routeId:t.route.id})}else return{type:"data",result:void 0}}else if(h)a=await c(h);else{let p=new URL(e.url),m=p.pathname+p.search;throw fi(404,{pathname:m})}}catch(h){return{type:"error",result:h}}finally{o&&e.signal.removeEventListener("abort",o)}return a}async function p3(e){var r,i,s,a,o,l;let{result:t,type:n}=e;if(OA(t)){let u;try{let c=t.headers.get("Content-Type");c&&/\bapplication\/json\b/.test(c)?t.body==null?u=null:u=await t.json():u=await t.text()}catch(c){return{type:"error",error:c}}return n==="error"?{type:"error",error:new W0(t.status,t.statusText,u),statusCode:t.status,headers:t.headers}:{type:"data",data:u,statusCode:t.status,headers:t.headers}}return n==="error"?fT(t)?t.data instanceof Error?{type:"error",error:t.data,statusCode:(r=t.init)==null?void 0:r.status,headers:(i=t.init)!=null&&i.headers?new Headers(t.init.headers):void 0}:{type:"error",error:new W0(((s=t.init)==null?void 0:s.status)||500,void 0,t.data),statusCode:rf(t)?t.status:void 0,headers:(a=t.init)!=null&&a.headers?new Headers(t.init.headers):void 0}:{type:"error",error:t,statusCode:rf(t)?t.status:void 0}:fT(t)?{type:"data",data:t.data,statusCode:(o=t.init)==null?void 0:o.status,headers:(l=t.init)!=null&&l.headers?new Headers(t.init.headers):void 0}:{type:"data",data:t}}function m3(e,t,n,r,i){let s=e.headers.get("Location");if(gt(s,"Redirects returned/thrown from loaders/actions must have a Location header"),!Mx(s)){let a=r.slice(0,r.findIndex(o=>o.route.id===n)+1);s=yg(new URL(t.url),a,i,s),e.headers.set("Location",s)}return e}function sT(e,t,n){if(Mx(e)){let r=e,i=r.startsWith("//")?new URL(t.protocol+r):new URL(r),s=Ei(i.pathname,n)!=null;if(i.origin===t.origin&&s)return i.pathname+i.search+i.hash}return e}function cl(e,t,n,r){let i=e.createURL(LA(t)).toString(),s={signal:n};if(r&&Dr(r.formMethod)){let{formMethod:a,formEncType:o}=r;s.method=a.toUpperCase(),o==="application/json"?(s.headers=new Headers({"Content-Type":o}),s.body=JSON.stringify(r.json)):o==="text/plain"?s.body=r.text:o==="application/x-www-form-urlencoded"&&r.formData?s.body=Sg(r.formData):s.body=r.formData}return new Request(i,s)}function Sg(e){let t=new URLSearchParams;for(let[n,r]of e.entries())t.append(n,typeof r=="string"?r:r.name);return t}function aT(e){let t=new FormData;for(let[n,r]of e.entries())t.append(n,r);return t}function g3(e,t,n,r=!1,i=!1){let s={},a=null,o,l=!1,u={},c=n&&$r(n[1])?n[1].error:void 0;return e.forEach(h=>{if(!(h.route.id in t))return;let p=h.route.id,m=t[p];if(gt(!so(m),"Cannot handle redirect results in processLoaderData"),$r(m)){let v=m.error;if(c!==void 0&&(v=c,c=void 0),a=a||{},i)a[p]=v;else{let g=ra(e,p);a[g.route.id]==null&&(a[g.route.id]=v)}r||(s[p]=MA),l||(l=!0,o=rf(m.error)?m.error.status:500),m.headers&&(u[p]=m.headers)}else s[p]=m.data,m.statusCode&&m.statusCode!==200&&!l&&(o=m.statusCode),m.headers&&(u[p]=m.headers)}),c!==void 0&&n&&(a={[n[0]]:c},n[2]&&(s[n[2]]=void 0)),{loaderData:s,errors:a,statusCode:o||200,loaderHeaders:u}}function oT(e,t,n,r,i,s){let{loaderData:a,errors:o}=g3(t,n,r);return i.filter(l=>!l.matches||l.matches.some(u=>u.shouldLoad)).forEach(l=>{let{key:u,match:c,controller:h}=l;if(h&&h.signal.aborted)return;let p=s[u];if(gt(p,"Did not find corresponding fetcher result"),$r(p)){let m=ra(e.matches,c==null?void 0:c.route.id);o&&o[m.route.id]||(o={...o,[m.route.id]:p.error}),e.fetchers.delete(u)}else if(so(p))gt(!1,"Unhandled fetcher revalidation redirect");else{let m=Ys(p.data);e.fetchers.set(u,m)}}),{loaderData:a,errors:o}}function lT(e,t,n,r){let i=Object.entries(t).filter(([,s])=>s!==MA).reduce((s,[a,o])=>(s[a]=o,s),{});for(let s of n){let a=s.route.id;if(!t.hasOwnProperty(a)&&e.hasOwnProperty(a)&&s.route.loader&&(i[a]=e[a]),r&&r.hasOwnProperty(a))break}return i}function uT(e){return e?$r(e[1])?{actionData:{}}:{actionData:{[e[0]]:e[1].data}}:{}}function ra(e,t){return(t?e.slice(0,e.findIndex(r=>r.route.id===t)+1):[...e]).reverse().find(r=>r.route.hasErrorBoundary===!0)||e[0]}function cT(e){let t=e.length===1?e[0]:e.find(n=>n.index||!n.path||n.path==="/")||{id:"__shim-error-route__"};return{matches:[{params:{},pathname:"",pathnameBase:"",route:t}],route:t}}function fi(e,{pathname:t,routeId:n,method:r,type:i,message:s}={}){let a="Unknown Server Error",o="Unknown @remix-run/router error";return e===400?(a="Bad Request",r&&t&&n?o=`You made a ${r} request to "${t}" but did not provide a \`loader\` for route "${n}", so there is no way to handle the request.`:i==="invalid-body"&&(o="Unable to encode submission body")):e===403?(a="Forbidden",o=`Route "${n}" does not match URL "${t}"`):e===404?(a="Not Found",o=`No route matches URL "${t}"`):e===405&&(a="Method Not Allowed",r&&t&&n?o=`You made a ${r.toUpperCase()} request to "${t}" but did not provide an \`action\` for route "${n}", so there is no way to handle the request.`:r&&(o=`Invalid request method "${r.toUpperCase()}"`)),new W0(e||500,a,new Error(o),!0)}function kd(e){let t=Object.entries(e);for(let n=t.length-1;n>=0;n--){let[r,i]=t[n];if(so(i))return{key:r,result:i}}}function LA(e){let t=typeof e=="string"?$a(e):e;return Da({...t,hash:""})}function v3(e,t){return e.pathname!==t.pathname||e.search!==t.search?!1:e.hash===""?t.hash!=="":e.hash===t.hash?!0:t.hash!==""}function x3(e){return OA(e.result)&&t3.has(e.result.status)}function $r(e){return e.type==="error"}function so(e){return(e&&e.type)==="redirect"}function fT(e){return typeof e=="object"&&e!=null&&"type"in e&&"data"in e&&"init"in e&&e.type==="DataWithResponseInit"}function OA(e){return e!=null&&typeof e.status=="number"&&typeof e.statusText=="string"&&typeof e.headers=="object"&&typeof e.body<"u"}function y3(e){return e3.has(e.toUpperCase())}function Dr(e){return jb.has(e.toUpperCase())}function Fx(e){return new URLSearchParams(e).getAll("index").some(t=>t==="")}function l0(e,t){let n=typeof t=="string"?$a(t).search:t.search;if(e[e.length-1].route.index&&Fx(n||""))return e[e.length-1];let r=kA(e);return r[r.length-1]}function dT(e){let{formMethod:t,formAction:n,formEncType:r,text:i,formData:s,json:a}=e;if(!(!t||!n||!r)){if(i!=null)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:void 0,text:i};if(s!=null)return{formMethod:t,formAction:n,formEncType:r,formData:s,json:void 0,text:void 0};if(a!==void 0)return{formMethod:t,formAction:n,formEncType:r,formData:void 0,json:a,text:void 0}}}function Wp(e,t){return t?{state:"loading",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}:{state:"loading",location:e,formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0}}function w3(e,t){return{state:"submitting",location:e,formMethod:t.formMethod,formAction:t.formAction,formEncType:t.formEncType,formData:t.formData,json:t.json,text:t.text}}function Ju(e,t){return e?{state:"loading",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t}:{state:"loading",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:t}}function T3(e,t){return{state:"submitting",formMethod:e.formMethod,formAction:e.formAction,formEncType:e.formEncType,formData:e.formData,json:e.json,text:e.text,data:t?t.data:void 0}}function Ys(e){return{state:"idle",formMethod:void 0,formAction:void 0,formEncType:void 0,formData:void 0,json:void 0,text:void 0,data:e}}function S3(e,t){try{let n=e.sessionStorage.getItem(RA);if(n){let r=JSON.parse(n);for(let[i,s]of Object.entries(r||{}))s&&Array.isArray(s)&&t.set(i,new Set(s||[]))}}catch{}}function E3(e,t){if(t.size>0){let n={};for(let[r,i]of t)n[r]=[...i];try{e.sessionStorage.setItem(RA,JSON.stringify(n))}catch(r){Rn(!1,`Failed to save applied view transitions in sessionStorage (${r}).`)}}}function _3(){let e,t,n=new Promise((r,i)=>{e=async s=>{r(s);try{await n}catch{}},t=async s=>{i(s);try{await n}catch{}}});return{promise:n,resolve:e,reject:t}}var Go=E.createContext(null);Go.displayName="DataRouter";var Bf=E.createContext(null);Bf.displayName="DataRouterState";E.createContext(!1);var Dx=E.createContext({isTransitioning:!1});Dx.displayName="ViewTransition";var BA=E.createContext(new Map);BA.displayName="Fetchers";var C3=E.createContext(null);C3.displayName="Await";var fs=E.createContext(null);fs.displayName="Navigation";var Hh=E.createContext(null);Hh.displayName="Location";var ds=E.createContext({outlet:null,matches:[],isDataRoute:!1});ds.displayName="Route";var Px=E.createContext(null);Px.displayName="RouteError";function k3(e,{relative:t}={}){gt(Uf(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=E.useContext(fs),{hash:i,pathname:s,search:a}=Vf(e,{relative:t}),o=s;return n!=="/"&&(o=s==="/"?n:ss([n,s])),r.createHref({pathname:o,search:a,hash:i})}function Uf(){return E.useContext(Hh)!=null}function Hs(){return gt(Uf(),"useLocation() may be used only in the context of a <Router> component."),E.useContext(Hh).location}var UA="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function VA(e){E.useContext(fs).static||E.useLayoutEffect(e)}function HA(){let{isDataRoute:e}=E.useContext(ds);return e?V3():A3()}function A3(){gt(Uf(),"useNavigate() may be used only in the context of a <Router> component.");let e=E.useContext(Go),{basename:t,navigator:n}=E.useContext(fs),{matches:r}=E.useContext(ds),{pathname:i}=Hs(),s=JSON.stringify(Ax(r)),a=E.useRef(!1);return VA(()=>{a.current=!0}),E.useCallback((l,u={})=>{if(Rn(a.current,UA),!a.current)return;if(typeof l=="number"){n.go(l);return}let c=Rx(l,JSON.parse(s),i,u.relative==="path");e==null&&t!=="/"&&(c.pathname=c.pathname==="/"?t:ss([t,c.pathname])),(u.replace?n.replace:n.push)(c,u.state,u)},[t,n,s,i,e])}var $A=E.createContext(null);function qo(){return E.useContext($A)}function R3(e){let t=E.useContext(ds).outlet;return t&&E.createElement($A.Provider,{value:e},t)}function Vf(e,{relative:t}={}){let{matches:n}=E.useContext(ds),{pathname:r}=Hs(),i=JSON.stringify(Ax(n));return E.useMemo(()=>Rx(e,JSON.parse(i),r,t==="path"),[e,i,r,t])}function M3(e,t,n,r){gt(Uf(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:i}=E.useContext(fs),{matches:s}=E.useContext(ds),a=s[s.length-1],o=a?a.params:{},l=a?a.pathname:"/",u=a?a.pathnameBase:"/",c=a&&a.route;{let x=c&&c.path||"";zA(l,!c||x.endsWith("*")||x.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${l}" (under <Route path="${x}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${x}"> to <Route path="${x==="/"?"*":`${x}/*`}">.`)}let h=Hs(),p;p=h;let m=p.pathname||"/",v=m;if(u!=="/"){let x=u.replace(/^\//,"").split("/");v="/"+m.replace(/^\//,"").split("/").slice(x.length).join("/")}let g=na(e,{pathname:v});return Rn(c||g!=null,`No routes matched location "${p.pathname}${p.search}${p.hash}" `),Rn(g==null||g[g.length-1].route.element!==void 0||g[g.length-1].route.Component!==void 0||g[g.length-1].route.lazy!==void 0,`Matched leaf route at location "${p.pathname}${p.search}${p.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`),N3(g&&g.map(x=>Object.assign({},x,{params:Object.assign({},o,x.params),pathname:ss([u,i.encodeLocation?i.encodeLocation(x.pathname).pathname:x.pathname]),pathnameBase:x.pathnameBase==="/"?u:ss([u,i.encodeLocation?i.encodeLocation(x.pathnameBase).pathname:x.pathnameBase])})),s,n,r)}function F3(){let e=U3(),t=rf(e)?`${e.status} ${e.statusText}`:e instanceof Error?e.message:JSON.stringify(e),n=e instanceof Error?e.stack:null,r="rgba(200,200,200, 0.5)",i={padding:"0.5rem",backgroundColor:r},s={padding:"2px 4px",backgroundColor:r},a=null;return console.error("Error handled by React Router default ErrorBoundary:",e),a=E.createElement(E.Fragment,null,E.createElement("p",null," Hey developer "),E.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",E.createElement("code",{style:s},"ErrorBoundary")," or"," ",E.createElement("code",{style:s},"errorElement")," prop on your route.")),E.createElement(E.Fragment,null,E.createElement("h2",null,"Unexpected Application Error!"),E.createElement("h3",{style:{fontStyle:"italic"}},t),n?E.createElement("pre",{style:i},n):null,a)}var D3=E.createElement(F3,null),P3=class extends E.Component{constructor(e){super(e),this.state={location:e.location,revalidation:e.revalidation,error:e.error}}static getDerivedStateFromError(e){return{error:e}}static getDerivedStateFromProps(e,t){return t.location!==e.location||t.revalidation!=="idle"&&e.revalidation==="idle"?{error:e.error,location:e.location,revalidation:e.revalidation}:{error:e.error!==void 0?e.error:t.error,location:t.location,revalidation:e.revalidation||t.revalidation}}componentDidCatch(e,t){console.error("React Router caught the following error during render",e,t)}render(){return this.state.error!==void 0?E.createElement(ds.Provider,{value:this.props.routeContext},E.createElement(Px.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function I3({routeContext:e,match:t,children:n}){let r=E.useContext(Go);return r&&r.static&&r.staticContext&&(t.route.errorElement||t.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=t.route.id),E.createElement(ds.Provider,{value:e},n)}function N3(e,t=[],n=null,r=null){if(e==null){if(!n)return null;if(n.errors)e=n.matches;else if(t.length===0&&!n.initialized&&n.matches.length>0)e=n.matches;else return null}let i=e,s=n==null?void 0:n.errors;if(s!=null){let l=i.findIndex(u=>u.route.id&&(s==null?void 0:s[u.route.id])!==void 0);gt(l>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(s).join(",")}`),i=i.slice(0,Math.min(i.length,l+1))}let a=!1,o=-1;if(n)for(let l=0;l<i.length;l++){let u=i[l];if((u.route.HydrateFallback||u.route.hydrateFallbackElement)&&(o=l),u.route.id){let{loaderData:c,errors:h}=n,p=u.route.loader&&!c.hasOwnProperty(u.route.id)&&(!h||h[u.route.id]===void 0);if(u.route.lazy||p){a=!0,o>=0?i=i.slice(0,o+1):i=[i[0]];break}}}return i.reduceRight((l,u,c)=>{let h,p=!1,m=null,v=null;n&&(h=s&&u.route.id?s[u.route.id]:void 0,m=u.route.errorElement||D3,a&&(o<0&&c===0?(zA("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),p=!0,v=null):o===c&&(p=!0,v=u.route.hydrateFallbackElement||null)));let g=t.concat(i.slice(0,c+1)),w=()=>{let x;return h?x=m:p?x=v:u.route.Component?x=E.createElement(u.route.Component,null):u.route.element?x=u.route.element:x=l,E.createElement(I3,{match:u,routeContext:{outlet:l,matches:g,isDataRoute:n!=null},children:x})};return n&&(u.route.ErrorBoundary||u.route.errorElement||c===0)?E.createElement(P3,{location:n.location,revalidation:n.revalidation,component:m,error:h,children:w(),routeContext:{outlet:null,matches:g,isDataRoute:!0}}):w()},null)}function Ix(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function b3(e){let t=E.useContext(Go);return gt(t,Ix(e)),t}function L3(e){let t=E.useContext(Bf);return gt(t,Ix(e)),t}function O3(e){let t=E.useContext(ds);return gt(t,Ix(e)),t}function Nx(e){let t=O3(e),n=t.matches[t.matches.length-1];return gt(n.route.id,`${e} can only be used on routes that contain a unique "id"`),n.route.id}function B3(){return Nx("useRouteId")}function U3(){var r;let e=E.useContext(Px),t=L3("useRouteError"),n=Nx("useRouteError");return e!==void 0?e:(r=t.errors)==null?void 0:r[n]}function V3(){let{router:e}=b3("useNavigate"),t=Nx("useNavigate"),n=E.useRef(!1);return VA(()=>{n.current=!0}),E.useCallback(async(i,s={})=>{Rn(n.current,UA),n.current&&(typeof i=="number"?e.navigate(i):await e.navigate(i,{fromRouteId:t,...s}))},[e,t])}var hT={};function zA(e,t,n){!t&&!hT[e]&&(hT[e]=!0,Rn(!1,n))}var pT={};function mT(e,t){!e&&!pT[t]&&(pT[t]=!0,console.warn(t))}function H3(e){let t={hasErrorBoundary:e.hasErrorBoundary||e.ErrorBoundary!=null||e.errorElement!=null};return e.Component&&(e.element&&Rn(!1,"You should not include both `Component` and `element` on your route - `Component` will be used."),Object.assign(t,{element:E.createElement(e.Component),Component:void 0})),e.HydrateFallback&&(e.hydrateFallbackElement&&Rn(!1,"You should not include both `HydrateFallback` and `hydrateFallbackElement` on your route - `HydrateFallback` will be used."),Object.assign(t,{hydrateFallbackElement:E.createElement(e.HydrateFallback),HydrateFallback:void 0})),e.ErrorBoundary&&(e.errorElement&&Rn(!1,"You should not include both `ErrorBoundary` and `errorElement` on your route - `ErrorBoundary` will be used."),Object.assign(t,{errorElement:E.createElement(e.ErrorBoundary),ErrorBoundary:void 0})),t}var $3=["HydrateFallback","hydrateFallbackElement"],z3=class{constructor(){this.status="pending",this.promise=new Promise((e,t)=>{this.resolve=n=>{this.status==="pending"&&(this.status="resolved",e(n))},this.reject=n=>{this.status==="pending"&&(this.status="rejected",t(n))}})}};function W3({router:e,flushSync:t}){let[n,r]=E.useState(e.state),[i,s]=E.useState(),[a,o]=E.useState({isTransitioning:!1}),[l,u]=E.useState(),[c,h]=E.useState(),[p,m]=E.useState(),v=E.useRef(new Map),g=E.useCallback((y,{deletedFetchers:_,flushSync:k,viewTransitionOpts:S})=>{y.fetchers.forEach((M,F)=>{M.data!==void 0&&v.current.set(F,M.data)}),_.forEach(M=>v.current.delete(M)),mT(k===!1||t!=null,'You provided the `flushSync` option to a router update, but you are not using the `<RouterProvider>` from `react-router/dom` so `ReactDOM.flushSync()` is unavailable.  Please update your app to `import { RouterProvider } from "react-router/dom"` and ensure you have `react-dom` installed as a dependency to use the `flushSync` option.');let C=e.window!=null&&e.window.document!=null&&typeof e.window.document.startViewTransition=="function";if(mT(S==null||C,"You provided the `viewTransition` option to a router update, but you do not appear to be running in a DOM environment as `window.startViewTransition` is not available."),!S||!C){t&&k?t(()=>r(y)):E.startTransition(()=>r(y));return}if(t&&k){t(()=>{c&&(l&&l.resolve(),c.skipTransition()),o({isTransitioning:!0,flushSync:!0,currentLocation:S.currentLocation,nextLocation:S.nextLocation})});let M=e.window.document.startViewTransition(()=>{t(()=>r(y))});M.finished.finally(()=>{t(()=>{u(void 0),h(void 0),s(void 0),o({isTransitioning:!1})})}),t(()=>h(M));return}c?(l&&l.resolve(),c.skipTransition(),m({state:y,currentLocation:S.currentLocation,nextLocation:S.nextLocation})):(s(y),o({isTransitioning:!0,flushSync:!1,currentLocation:S.currentLocation,nextLocation:S.nextLocation}))},[e.window,t,c,l]);E.useLayoutEffect(()=>e.subscribe(g),[e,g]),E.useEffect(()=>{a.isTransitioning&&!a.flushSync&&u(new z3)},[a]),E.useEffect(()=>{if(l&&i&&e.window){let y=i,_=l.promise,k=e.window.document.startViewTransition(async()=>{E.startTransition(()=>r(y)),await _});k.finished.finally(()=>{u(void 0),h(void 0),s(void 0),o({isTransitioning:!1})}),h(k)}},[i,l,e.window]),E.useEffect(()=>{l&&i&&n.location.key===i.location.key&&l.resolve()},[l,c,n.location,i]),E.useEffect(()=>{!a.isTransitioning&&p&&(s(p.state),o({isTransitioning:!0,flushSync:!1,currentLocation:p.currentLocation,nextLocation:p.nextLocation}),m(void 0))},[a.isTransitioning,p]);let w=E.useMemo(()=>({createHref:e.createHref,encodeLocation:e.encodeLocation,go:y=>e.navigate(y),push:(y,_,k)=>e.navigate(y,{state:_,preventScrollReset:k==null?void 0:k.preventScrollReset}),replace:(y,_,k)=>e.navigate(y,{replace:!0,state:_,preventScrollReset:k==null?void 0:k.preventScrollReset})}),[e]),x=e.basename||"/",T=E.useMemo(()=>({router:e,navigator:w,static:!1,basename:x}),[e,w,x]);return E.createElement(E.Fragment,null,E.createElement(Go.Provider,{value:T},E.createElement(Bf.Provider,{value:n},E.createElement(BA.Provider,{value:v.current},E.createElement(Dx.Provider,{value:a},E.createElement(Y3,{basename:x,location:n.location,navigationType:n.historyAction,navigator:w},E.createElement(G3,{routes:e.routes,future:e.future,state:n})))))),null)}var G3=E.memo(q3);function q3({routes:e,future:t,state:n}){return M3(e,void 0,n,t)}function K3(e){return R3(e.context)}function Y3({basename:e="/",children:t=null,location:n,navigationType:r="POP",navigator:i,static:s=!1}){gt(!Uf(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let a=e.replace(/^\/*/,"/"),o=E.useMemo(()=>({basename:a,navigator:i,static:s,future:{}}),[a,i,s]);typeof n=="string"&&(n=$a(n));let{pathname:l="/",search:u="",hash:c="",state:h=null,key:p="default"}=n,m=E.useMemo(()=>{let v=Ei(l,a);return v==null?null:{location:{pathname:v,search:u,hash:c,state:h,key:p},navigationType:r}},[a,l,u,c,h,p,r]);return Rn(m!=null,`<Router basename="${a}"> is not able to match the URL "${l}${u}${c}" because it does not start with the basename, so the <Router> won't render anything.`),m==null?null:E.createElement(fs.Provider,{value:o},E.createElement(Hh.Provider,{children:t,value:m}))}var u0="get",c0="application/x-www-form-urlencoded";function $h(e){return e!=null&&typeof e.tagName=="string"}function X3(e){return $h(e)&&e.tagName.toLowerCase()==="button"}function J3(e){return $h(e)&&e.tagName.toLowerCase()==="form"}function Q3(e){return $h(e)&&e.tagName.toLowerCase()==="input"}function j3(e){return!!(e.metaKey||e.altKey||e.ctrlKey||e.shiftKey)}function Z3(e,t){return e.button===0&&(!t||t==="_self")&&!j3(e)}var Ad=null;function eL(){if(Ad===null)try{new FormData(document.createElement("form"),0),Ad=!1}catch{Ad=!0}return Ad}var tL=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function Gp(e){return e!=null&&!tL.has(e)?(Rn(!1,`"${e}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${c0}"`),null):e}function nL(e,t){let n,r,i,s,a;if(J3(e)){let o=e.getAttribute("action");r=o?Ei(o,t):null,n=e.getAttribute("method")||u0,i=Gp(e.getAttribute("enctype"))||c0,s=new FormData(e)}else if(X3(e)||Q3(e)&&(e.type==="submit"||e.type==="image")){let o=e.form;if(o==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let l=e.getAttribute("formaction")||o.getAttribute("action");if(r=l?Ei(l,t):null,n=e.getAttribute("formmethod")||o.getAttribute("method")||u0,i=Gp(e.getAttribute("formenctype"))||Gp(o.getAttribute("enctype"))||c0,s=new FormData(o,e),!eL()){let{name:u,type:c,value:h}=e;if(c==="image"){let p=u?`${u}.`:"";s.append(`${p}x`,"0"),s.append(`${p}y`,"0")}else u&&s.append(u,h)}}else{if($h(e))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=u0,r=null,i=c0,a=e}return s&&i==="text/plain"&&(a=s,s=void 0),{action:r,method:n.toLowerCase(),encType:i,formData:s,body:a}}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");function bx(e,t){if(e===!1||e===null||typeof e>"u")throw new Error(t)}function rL(e,t,n){let r=typeof e=="string"?new URL(e,typeof window>"u"?"server://singlefetch/":window.location.origin):e;return r.pathname==="/"?r.pathname=`_root.${n}`:t&&Ei(r.pathname,t)==="/"?r.pathname=`${t.replace(/\/$/,"")}/_root.${n}`:r.pathname=`${r.pathname.replace(/\/$/,"")}.${n}`,r}async function iL(e,t){if(e.id in t)return t[e.id];try{let n=await import(e.module);return t[e.id]=n,n}catch(n){return console.error(`Error loading route module \`${e.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function sL(e){return e==null?!1:e.href==null?e.rel==="preload"&&typeof e.imageSrcSet=="string"&&typeof e.imageSizes=="string":typeof e.rel=="string"&&typeof e.href=="string"}async function aL(e,t,n){let r=await Promise.all(e.map(async i=>{let s=t.routes[i.route.id];if(s){let a=await iL(s,n);return a.links?a.links():[]}return[]}));return cL(r.flat(1).filter(sL).filter(i=>i.rel==="stylesheet"||i.rel==="preload").map(i=>i.rel==="stylesheet"?{...i,rel:"prefetch",as:"style"}:{...i,rel:"prefetch"}))}function gT(e,t,n,r,i,s){let a=(l,u)=>n[u]?l.route.id!==n[u].route.id:!0,o=(l,u)=>{var c;return n[u].pathname!==l.pathname||((c=n[u].route.path)==null?void 0:c.endsWith("*"))&&n[u].params["*"]!==l.params["*"]};return s==="assets"?t.filter((l,u)=>a(l,u)||o(l,u)):s==="data"?t.filter((l,u)=>{var h;let c=r.routes[l.route.id];if(!c||!c.hasLoader)return!1;if(a(l,u)||o(l,u))return!0;if(l.route.shouldRevalidate){let p=l.route.shouldRevalidate({currentUrl:new URL(i.pathname+i.search+i.hash,window.origin),currentParams:((h=n[0])==null?void 0:h.params)||{},nextUrl:new URL(e,window.origin),nextParams:l.params,defaultShouldRevalidate:!0});if(typeof p=="boolean")return p}return!0}):[]}function oL(e,t,{includeHydrateFallback:n}={}){return lL(e.map(r=>{let i=t.routes[r.route.id];if(!i)return[];let s=[i.module];return i.clientActionModule&&(s=s.concat(i.clientActionModule)),i.clientLoaderModule&&(s=s.concat(i.clientLoaderModule)),n&&i.hydrateFallbackModule&&(s=s.concat(i.hydrateFallbackModule)),i.imports&&(s=s.concat(i.imports)),s}).flat(1))}function lL(e){return[...new Set(e)]}function uL(e){let t={},n=Object.keys(e).sort();for(let r of n)t[r]=e[r];return t}function cL(e,t){let n=new Set;return new Set(t),e.reduce((r,i)=>{let s=JSON.stringify(uL(i));return n.has(s)||(n.add(s),r.push({key:s,link:i})),r},[])}function WA(){let e=E.useContext(Go);return bx(e,"You must render this element inside a <DataRouterContext.Provider> element"),e}function fL(){let e=E.useContext(Bf);return bx(e,"You must render this element inside a <DataRouterStateContext.Provider> element"),e}var Lx=E.createContext(void 0);Lx.displayName="FrameworkContext";function GA(){let e=E.useContext(Lx);return bx(e,"You must render this element inside a <HydratedRouter> element"),e}function dL(e,t){let n=E.useContext(Lx),[r,i]=E.useState(!1),[s,a]=E.useState(!1),{onFocus:o,onBlur:l,onMouseEnter:u,onMouseLeave:c,onTouchStart:h}=t,p=E.useRef(null);E.useEffect(()=>{if(e==="render"&&a(!0),e==="viewport"){let g=x=>{x.forEach(T=>{a(T.isIntersecting)})},w=new IntersectionObserver(g,{threshold:.5});return p.current&&w.observe(p.current),()=>{w.disconnect()}}},[e]),E.useEffect(()=>{if(r){let g=setTimeout(()=>{a(!0)},100);return()=>{clearTimeout(g)}}},[r]);let m=()=>{i(!0)},v=()=>{i(!1),a(!1)};return n?e!=="intent"?[s,p,{}]:[s,p,{onFocus:Qu(o,m),onBlur:Qu(l,v),onMouseEnter:Qu(u,m),onMouseLeave:Qu(c,v),onTouchStart:Qu(h,m)}]:[!1,p,{}]}function Qu(e,t){return n=>{e&&e(n),n.defaultPrevented||t(n)}}function hL({page:e,...t}){let{router:n}=WA(),r=E.useMemo(()=>na(n.routes,e,n.basename),[n.routes,e,n.basename]);return r?E.createElement(mL,{page:e,matches:r,...t}):null}function pL(e){let{manifest:t,routeModules:n}=GA(),[r,i]=E.useState([]);return E.useEffect(()=>{let s=!1;return aL(e,t,n).then(a=>{s||i(a)}),()=>{s=!0}},[e,t,n]),r}function mL({page:e,matches:t,...n}){let r=Hs(),{manifest:i,routeModules:s}=GA(),{basename:a}=WA(),{loaderData:o,matches:l}=fL(),u=E.useMemo(()=>gT(e,t,l,i,r,"data"),[e,t,l,i,r]),c=E.useMemo(()=>gT(e,t,l,i,r,"assets"),[e,t,l,i,r]),h=E.useMemo(()=>{if(e===r.pathname+r.search+r.hash)return[];let v=new Set,g=!1;if(t.forEach(x=>{var y;let T=i.routes[x.route.id];!T||!T.hasLoader||(!u.some(_=>_.route.id===x.route.id)&&x.route.id in o&&((y=s[x.route.id])!=null&&y.shouldRevalidate)||T.hasClientLoader?g=!0:v.add(x.route.id))}),v.size===0)return[];let w=rL(e,a,"data");return g&&v.size>0&&w.searchParams.set("_routes",t.filter(x=>v.has(x.route.id)).map(x=>x.route.id).join(",")),[w.pathname+w.search]},[a,o,r,i,u,t,e,s]),p=E.useMemo(()=>oL(c,i),[c,i]),m=pL(c);return E.createElement(E.Fragment,null,h.map(v=>E.createElement("link",{key:v,rel:"prefetch",as:"fetch",href:v,...n})),p.map(v=>E.createElement("link",{key:v,rel:"modulepreload",href:v,...n})),m.map(({key:v,link:g})=>E.createElement("link",{key:v,nonce:n.nonce,...g})))}function gL(...e){return t=>{e.forEach(n=>{typeof n=="function"?n(t):n!=null&&(n.current=t)})}}var qA=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{qA&&(window.__reactRouterVersion="7.8.0")}catch{}function vL(e,t){return a3({basename:t==null?void 0:t.basename,unstable_getContext:t==null?void 0:t.unstable_getContext,future:t==null?void 0:t.future,history:Cb({window:t==null?void 0:t.window}),hydrationData:(t==null?void 0:t.hydrationData)||xL(),routes:e,mapRouteProperties:H3,hydrationRouteProperties:$3,dataStrategy:t==null?void 0:t.dataStrategy,patchRoutesOnNavigation:t==null?void 0:t.patchRoutesOnNavigation,window:t==null?void 0:t.window}).initialize()}function xL(){let e=window==null?void 0:window.__staticRouterHydrationData;return e&&e.errors&&(e={...e,errors:yL(e.errors)}),e}function yL(e){if(!e)return null;let t=Object.entries(e),n={};for(let[r,i]of t)if(i&&i.__type==="RouteErrorResponse")n[r]=new W0(i.status,i.statusText,i.data,i.internal===!0);else if(i&&i.__type==="Error"){if(i.__subType){let s=window[i.__subType];if(typeof s=="function")try{let a=new s(i.message);a.stack="",n[r]=a}catch{}}if(n[r]==null){let s=new Error(i.message);s.stack="",n[r]=s}}else n[r]=i;return n}var KA=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,Ox=E.forwardRef(function({onClick:t,discover:n="render",prefetch:r="none",relative:i,reloadDocument:s,replace:a,state:o,target:l,to:u,preventScrollReset:c,viewTransition:h,...p},m){let{basename:v}=E.useContext(fs),g=typeof u=="string"&&KA.test(u),w,x=!1;if(typeof u=="string"&&g&&(w=u,qA))try{let F=new URL(window.location.href),b=u.startsWith("//")?new URL(F.protocol+u):new URL(u),V=Ei(b.pathname,v);b.origin===F.origin&&V!=null?u=V+b.search+b.hash:x=!0}catch{Rn(!1,`<Link to="${u}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let T=k3(u,{relative:i}),[y,_,k]=dL(r,p),S=EL(u,{replace:a,state:o,target:l,preventScrollReset:c,relative:i,viewTransition:h});function C(F){t&&t(F),F.defaultPrevented||S(F)}let M=E.createElement("a",{...p,...k,href:w||T,onClick:x||s?t:C,ref:gL(m,_),target:l,"data-discover":!g&&n==="render"?"true":void 0});return y&&!g?E.createElement(E.Fragment,null,M,E.createElement(hL,{page:T})):M});Ox.displayName="Link";var wL=E.forwardRef(function({"aria-current":t="page",caseSensitive:n=!1,className:r="",end:i=!1,style:s,to:a,viewTransition:o,children:l,...u},c){let h=Vf(a,{relative:u.relative}),p=Hs(),m=E.useContext(Bf),{navigator:v,basename:g}=E.useContext(fs),w=m!=null&&RL(h)&&o===!0,x=v.encodeLocation?v.encodeLocation(h).pathname:h.pathname,T=p.pathname,y=m&&m.navigation&&m.navigation.location?m.navigation.location.pathname:null;n||(T=T.toLowerCase(),y=y?y.toLowerCase():null,x=x.toLowerCase()),y&&g&&(y=Ei(y,g)||y);const _=x!=="/"&&x.endsWith("/")?x.length-1:x.length;let k=T===x||!i&&T.startsWith(x)&&T.charAt(_)==="/",S=y!=null&&(y===x||!i&&y.startsWith(x)&&y.charAt(x.length)==="/"),C={isActive:k,isPending:S,isTransitioning:w},M=k?t:void 0,F;typeof r=="function"?F=r(C):F=[r,k?"active":null,S?"pending":null,w?"transitioning":null].filter(Boolean).join(" ");let b=typeof s=="function"?s(C):s;return E.createElement(Ox,{...u,"aria-current":M,className:F,ref:c,style:b,to:a,viewTransition:o},typeof l=="function"?l(C):l)});wL.displayName="NavLink";var TL=E.forwardRef(({discover:e="render",fetcherKey:t,navigate:n,reloadDocument:r,replace:i,state:s,method:a=u0,action:o,onSubmit:l,relative:u,preventScrollReset:c,viewTransition:h,...p},m)=>{let v=kL(),g=AL(o,{relative:u}),w=a.toLowerCase()==="get"?"get":"post",x=typeof o=="string"&&KA.test(o),T=y=>{if(l&&l(y),y.defaultPrevented)return;y.preventDefault();let _=y.nativeEvent.submitter,k=(_==null?void 0:_.getAttribute("formmethod"))||a;v(_||y.currentTarget,{fetcherKey:t,method:k,navigate:n,replace:i,state:s,relative:u,preventScrollReset:c,viewTransition:h})};return E.createElement("form",{ref:m,method:w,action:g,onSubmit:r?l:T,...p,"data-discover":!x&&e==="render"?"true":void 0})});TL.displayName="Form";function SL(e){return`${e} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function YA(e){let t=E.useContext(Go);return gt(t,SL(e)),t}function EL(e,{target:t,replace:n,state:r,preventScrollReset:i,relative:s,viewTransition:a}={}){let o=HA(),l=Hs(),u=Vf(e,{relative:s});return E.useCallback(c=>{if(Z3(c,t)){c.preventDefault();let h=n!==void 0?n:Da(l)===Da(u);o(e,{replace:h,state:r,preventScrollReset:i,relative:s,viewTransition:a})}},[l,o,u,n,r,t,e,i,s,a])}var _L=0,CL=()=>`__${String(++_L)}__`;function kL(){let{router:e}=YA("useSubmit"),{basename:t}=E.useContext(fs),n=B3();return E.useCallback(async(r,i={})=>{let{action:s,method:a,encType:o,formData:l,body:u}=nL(r,t);if(i.navigate===!1){let c=i.fetcherKey||CL();await e.fetch(c,n,i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||a,formEncType:i.encType||o,flushSync:i.flushSync})}else await e.navigate(i.action||s,{preventScrollReset:i.preventScrollReset,formData:l,body:u,formMethod:i.method||a,formEncType:i.encType||o,replace:i.replace,state:i.state,fromRouteId:n,flushSync:i.flushSync,viewTransition:i.viewTransition})},[e,t,n])}function AL(e,{relative:t}={}){let{basename:n}=E.useContext(fs),r=E.useContext(ds);gt(r,"useFormAction must be used inside a RouteContext");let[i]=r.matches.slice(-1),s={...Vf(e||".",{relative:t})},a=Hs();if(e==null){s.search=a.search;let o=new URLSearchParams(s.search),l=o.getAll("index");if(l.some(c=>c==="")){o.delete("index"),l.filter(h=>h).forEach(h=>o.append("index",h));let c=o.toString();s.search=c?`?${c}`:""}}return(!e||e===".")&&i.route.index&&(s.search=s.search?s.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(s.pathname=s.pathname==="/"?n:ss([n,s.pathname])),Da(s)}function RL(e,{relative:t}={}){let n=E.useContext(Dx);gt(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=YA("useViewTransitionState"),i=Vf(e,{relative:t});if(!n.isTransitioning)return!1;let s=Ei(n.currentLocation.pathname,r)||n.currentLocation.pathname,a=Ei(n.nextLocation.pathname,r)||n.nextLocation.pathname;return z0(i.pathname,a)!=null||z0(i.pathname,s)!=null}function ML(e){return E.createElement(W3,{flushSync:io.flushSync,...e})}const Bx=E.createContext({});function Ux(e){const t=E.useRef(null);return t.current===null&&(t.current=e()),t.current}const zh=E.createContext(null),Vx=E.createContext({transformPagePoint:e=>e,isStatic:!1,reducedMotion:"never"});class FL extends E.Component{getSnapshotBeforeUpdate(t){const n=this.props.childRef.current;if(n&&t.isPresent&&!this.props.isPresent){const r=this.props.sizeRef.current;r.height=n.offsetHeight||0,r.width=n.offsetWidth||0,r.top=n.offsetTop,r.left=n.offsetLeft}return null}componentDidUpdate(){}render(){return this.props.children}}function DL({children:e,isPresent:t}){const n=E.useId(),r=E.useRef(null),i=E.useRef({width:0,height:0,top:0,left:0}),{nonce:s}=E.useContext(Vx);return E.useInsertionEffect(()=>{const{width:a,height:o,top:l,left:u}=i.current;if(t||!r.current||!a||!o)return;r.current.dataset.motionPopId=n;const c=document.createElement("style");return s&&(c.nonce=s),document.head.appendChild(c),c.sheet&&c.sheet.insertRule(`
          [data-motion-pop-id="${n}"] {
            position: absolute !important;
            width: ${a}px !important;
            height: ${o}px !important;
            top: ${l}px !important;
            left: ${u}px !important;
          }
        `),()=>{document.head.removeChild(c)}},[t]),R.jsx(FL,{isPresent:t,childRef:r,sizeRef:i,children:E.cloneElement(e,{ref:r})})}const PL=({children:e,initial:t,isPresent:n,onExitComplete:r,custom:i,presenceAffectsLayout:s,mode:a})=>{const o=Ux(IL),l=E.useId(),u=E.useCallback(h=>{o.set(h,!0);for(const p of o.values())if(!p)return;r&&r()},[o,r]),c=E.useMemo(()=>({id:l,initial:t,isPresent:n,custom:i,onExitComplete:u,register:h=>(o.set(h,!1),()=>o.delete(h))}),s?[Math.random(),u]:[n,u]);return E.useMemo(()=>{o.forEach((h,p)=>o.set(p,!1))},[n]),E.useEffect(()=>{!n&&!o.size&&r&&r()},[n]),a==="popLayout"&&(e=R.jsx(DL,{isPresent:n,children:e})),R.jsx(zh.Provider,{value:c,children:e})};function IL(){return new Map}function XA(e=!0){const t=E.useContext(zh);if(t===null)return[!0,null];const{isPresent:n,onExitComplete:r,register:i}=t,s=E.useId();E.useEffect(()=>{e&&i(s)},[e]);const a=E.useCallback(()=>e&&r&&r(s),[s,r,e]);return!n&&r?[!1,a]:[!0]}const Rd=e=>e.key||"";function vT(e){const t=[];return E.Children.forEach(e,n=>{E.isValidElement(n)&&t.push(n)}),t}const Hx=typeof window<"u",JA=Hx?E.useLayoutEffect:E.useEffect,ks=({children:e,custom:t,initial:n=!0,onExitComplete:r,presenceAffectsLayout:i=!0,mode:s="sync",propagate:a=!1})=>{const[o,l]=XA(a),u=E.useMemo(()=>vT(e),[e]),c=a&&!o?[]:u.map(Rd),h=E.useRef(!0),p=E.useRef(u),m=Ux(()=>new Map),[v,g]=E.useState(u),[w,x]=E.useState(u);JA(()=>{h.current=!1,p.current=u;for(let _=0;_<w.length;_++){const k=Rd(w[_]);c.includes(k)?m.delete(k):m.get(k)!==!0&&m.set(k,!1)}},[w,c.length,c.join("-")]);const T=[];if(u!==v){let _=[...u];for(let k=0;k<w.length;k++){const S=w[k],C=Rd(S);c.includes(C)||(_.splice(k,0,S),T.push(S))}s==="wait"&&T.length&&(_=T),x(vT(_)),g(u);return}const{forceRender:y}=E.useContext(Bx);return R.jsx(R.Fragment,{children:w.map(_=>{const k=Rd(_),S=a&&!o?!1:u===w||c.includes(k),C=()=>{if(m.has(k))m.set(k,!0);else return;let M=!0;m.forEach(F=>{F||(M=!1)}),M&&(y==null||y(),x(p.current),a&&(l==null||l()),r&&r())};return R.jsx(PL,{isPresent:S,initial:!h.current||n?void 0:!1,custom:S?void 0:t,presenceAffectsLayout:i,mode:s,onExitComplete:S?void 0:C,children:_},k)})})},Xr=e=>e;let QA=Xr;function $x(e){let t;return()=>(t===void 0&&(t=e()),t)}const hu=(e,t,n)=>{const r=t-e;return r===0?1:(n-e)/r},As=e=>e*1e3,Rs=e=>e/1e3,NL={useManualTiming:!1};function bL(e){let t=new Set,n=new Set,r=!1,i=!1;const s=new WeakSet;let a={delta:0,timestamp:0,isProcessing:!1};function o(u){s.has(u)&&(l.schedule(u),e()),u(a)}const l={schedule:(u,c=!1,h=!1)=>{const m=h&&r?t:n;return c&&s.add(u),m.has(u)||m.add(u),u},cancel:u=>{n.delete(u),s.delete(u)},process:u=>{if(a=u,r){i=!0;return}r=!0,[t,n]=[n,t],t.forEach(o),t.clear(),r=!1,i&&(i=!1,l.process(u))}};return l}const Md=["read","resolveKeyframes","update","preRender","render","postRender"],LL=40;function jA(e,t){let n=!1,r=!0;const i={delta:0,timestamp:0,isProcessing:!1},s=()=>n=!0,a=Md.reduce((x,T)=>(x[T]=bL(s),x),{}),{read:o,resolveKeyframes:l,update:u,preRender:c,render:h,postRender:p}=a,m=()=>{const x=performance.now();n=!1,i.delta=r?1e3/60:Math.max(Math.min(x-i.timestamp,LL),1),i.timestamp=x,i.isProcessing=!0,o.process(i),l.process(i),u.process(i),c.process(i),h.process(i),p.process(i),i.isProcessing=!1,n&&t&&(r=!1,e(m))},v=()=>{n=!0,r=!0,i.isProcessing||e(m)};return{schedule:Md.reduce((x,T)=>{const y=a[T];return x[T]=(_,k=!1,S=!1)=>(n||v(),y.schedule(_,k,S)),x},{}),cancel:x=>{for(let T=0;T<Md.length;T++)a[Md[T]].cancel(x)},state:i,steps:a}}const{schedule:en,cancel:Pa,state:Xn,steps:qp}=jA(typeof requestAnimationFrame<"u"?requestAnimationFrame:Xr,!0),ZA=E.createContext({strict:!1}),xT={animation:["animate","variants","whileHover","whileTap","exit","whileInView","whileFocus","whileDrag"],exit:["exit"],drag:["drag","dragControls"],focus:["whileFocus"],hover:["whileHover","onHoverStart","onHoverEnd"],tap:["whileTap","onTap","onTapStart","onTapCancel"],pan:["onPan","onPanStart","onPanSessionStart","onPanEnd"],inView:["whileInView","onViewportEnter","onViewportLeave"],layout:["layout","layoutId"]},pu={};for(const e in xT)pu[e]={isEnabled:t=>xT[e].some(n=>!!t[n])};function OL(e){for(const t in e)pu[t]={...pu[t],...e[t]}}const BL=new Set(["animate","exit","variants","initial","style","values","variants","transition","transformTemplate","custom","inherit","onBeforeLayoutMeasure","onAnimationStart","onAnimationComplete","onUpdate","onDragStart","onDrag","onDragEnd","onMeasureDragConstraints","onDirectionLock","onDragTransitionEnd","_dragX","_dragY","onHoverStart","onHoverEnd","onViewportEnter","onViewportLeave","globalTapTarget","ignoreStrict","viewport"]);function q0(e){return e.startsWith("while")||e.startsWith("drag")&&e!=="draggable"||e.startsWith("layout")||e.startsWith("onTap")||e.startsWith("onPan")||e.startsWith("onLayout")||BL.has(e)}let eR=e=>!q0(e);function UL(e){e&&(eR=t=>t.startsWith("on")?!q0(t):e(t))}try{UL(require("@emotion/is-prop-valid").default)}catch{}function VL(e,t,n){const r={};for(const i in e)i==="values"&&typeof e.values=="object"||(eR(i)||n===!0&&q0(i)||!t&&!q0(i)||e.draggable&&i.startsWith("onDrag"))&&(r[i]=e[i]);return r}function HL(e){if(typeof Proxy>"u")return e;const t=new Map,n=(...r)=>e(...r);return new Proxy(n,{get:(r,i)=>i==="create"?e:(t.has(i)||t.set(i,e(i)),t.get(i))})}const Wh=E.createContext({});function sf(e){return typeof e=="string"||Array.isArray(e)}function Gh(e){return e!==null&&typeof e=="object"&&typeof e.start=="function"}const zx=["animate","whileInView","whileFocus","whileHover","whileTap","whileDrag","exit"],Wx=["initial",...zx];function qh(e){return Gh(e.animate)||Wx.some(t=>sf(e[t]))}function tR(e){return!!(qh(e)||e.variants)}function $L(e,t){if(qh(e)){const{initial:n,animate:r}=e;return{initial:n===!1||sf(n)?n:void 0,animate:sf(r)?r:void 0}}return e.inherit!==!1?t:{}}function zL(e){const{initial:t,animate:n}=$L(e,E.useContext(Wh));return E.useMemo(()=>({initial:t,animate:n}),[yT(t),yT(n)])}function yT(e){return Array.isArray(e)?e.join(" "):e}const WL=Symbol.for("motionComponentSymbol");function _l(e){return e&&typeof e=="object"&&Object.prototype.hasOwnProperty.call(e,"current")}function GL(e,t,n){return E.useCallback(r=>{r&&e.onMount&&e.onMount(r),t&&(r?t.mount(r):t.unmount()),n&&(typeof n=="function"?n(r):_l(n)&&(n.current=r))},[t])}const Gx=e=>e.replace(/([a-z])([A-Z])/gu,"$1-$2").toLowerCase(),qL="framerAppearId",nR="data-"+Gx(qL),{schedule:qx}=jA(queueMicrotask,!1),rR=E.createContext({});function KL(e,t,n,r,i){var s,a;const{visualElement:o}=E.useContext(Wh),l=E.useContext(ZA),u=E.useContext(zh),c=E.useContext(Vx).reducedMotion,h=E.useRef(null);r=r||l.renderer,!h.current&&r&&(h.current=r(e,{visualState:t,parent:o,props:n,presenceContext:u,blockInitialAnimation:u?u.initial===!1:!1,reducedMotionConfig:c}));const p=h.current,m=E.useContext(rR);p&&!p.projection&&i&&(p.type==="html"||p.type==="svg")&&YL(h.current,n,i,m);const v=E.useRef(!1);E.useInsertionEffect(()=>{p&&v.current&&p.update(n,u)});const g=n[nR],w=E.useRef(!!g&&!(!((s=window.MotionHandoffIsComplete)===null||s===void 0)&&s.call(window,g))&&((a=window.MotionHasOptimisedAnimation)===null||a===void 0?void 0:a.call(window,g)));return JA(()=>{p&&(v.current=!0,window.MotionIsMounted=!0,p.updateFeatures(),qx.render(p.render),w.current&&p.animationState&&p.animationState.animateChanges())}),E.useEffect(()=>{p&&(!w.current&&p.animationState&&p.animationState.animateChanges(),w.current&&(queueMicrotask(()=>{var x;(x=window.MotionHandoffMarkAsComplete)===null||x===void 0||x.call(window,g)}),w.current=!1))}),p}function YL(e,t,n,r){const{layoutId:i,layout:s,drag:a,dragConstraints:o,layoutScroll:l,layoutRoot:u}=t;e.projection=new n(e.latestValues,t["data-framer-portal-id"]?void 0:iR(e.parent)),e.projection.setOptions({layoutId:i,layout:s,alwaysMeasureLayout:!!a||o&&_l(o),visualElement:e,animationType:typeof s=="string"?s:"both",initialPromotionConfig:r,layoutScroll:l,layoutRoot:u})}function iR(e){if(e)return e.options.allowProjection!==!1?e.projection:iR(e.parent)}function XL({preloadedFeatures:e,createVisualElement:t,useRender:n,useVisualState:r,Component:i}){var s,a;e&&OL(e);function o(u,c){let h;const p={...E.useContext(Vx),...u,layoutId:JL(u)},{isStatic:m}=p,v=zL(u),g=r(u,m);if(!m&&Hx){QL();const w=jL(p);h=w.MeasureLayout,v.visualElement=KL(i,g,p,t,w.ProjectionNode)}return R.jsxs(Wh.Provider,{value:v,children:[h&&v.visualElement?R.jsx(h,{visualElement:v.visualElement,...p}):null,n(i,u,GL(g,v.visualElement,c),g,m,v.visualElement)]})}o.displayName=`motion.${typeof i=="string"?i:`create(${(a=(s=i.displayName)!==null&&s!==void 0?s:i.name)!==null&&a!==void 0?a:""})`}`;const l=E.forwardRef(o);return l[WL]=i,l}function JL({layoutId:e}){const t=E.useContext(Bx).id;return t&&e!==void 0?t+"-"+e:e}function QL(e,t){E.useContext(ZA).strict}function jL(e){const{drag:t,layout:n}=pu;if(!t&&!n)return{};const r={...t,...n};return{MeasureLayout:t!=null&&t.isEnabled(e)||n!=null&&n.isEnabled(e)?r.MeasureLayout:void 0,ProjectionNode:r.ProjectionNode}}const ZL=["animate","circle","defs","desc","ellipse","g","image","line","filter","marker","mask","metadata","path","pattern","polygon","polyline","rect","stop","switch","symbol","svg","text","tspan","use","view"];function Kx(e){return typeof e!="string"||e.includes("-")?!1:!!(ZL.indexOf(e)>-1||/[A-Z]/u.test(e))}function wT(e){const t=[{},{}];return e==null||e.values.forEach((n,r)=>{t[0][r]=n.get(),t[1][r]=n.getVelocity()}),t}function Yx(e,t,n,r){if(typeof t=="function"){const[i,s]=wT(r);t=t(n!==void 0?n:e.custom,i,s)}if(typeof t=="string"&&(t=e.variants&&e.variants[t]),typeof t=="function"){const[i,s]=wT(r);t=t(n!==void 0?n:e.custom,i,s)}return t}const Eg=e=>Array.isArray(e),e8=e=>!!(e&&typeof e=="object"&&e.mix&&e.toValue),t8=e=>Eg(e)?e[e.length-1]||0:e,cr=e=>!!(e&&e.getVelocity);function f0(e){const t=cr(e)?e.get():e;return e8(t)?t.toValue():t}function n8({scrapeMotionValuesFromProps:e,createRenderState:t,onUpdate:n},r,i,s){const a={latestValues:r8(r,i,s,e),renderState:t()};return n&&(a.onMount=o=>n({props:r,current:o,...a}),a.onUpdate=o=>n(o)),a}const sR=e=>(t,n)=>{const r=E.useContext(Wh),i=E.useContext(zh),s=()=>n8(e,t,r,i);return n?s():Ux(s)};function r8(e,t,n,r){const i={},s=r(e,{});for(const p in s)i[p]=f0(s[p]);let{initial:a,animate:o}=e;const l=qh(e),u=tR(e);t&&u&&!l&&e.inherit!==!1&&(a===void 0&&(a=t.initial),o===void 0&&(o=t.animate));let c=n?n.initial===!1:!1;c=c||a===!1;const h=c?o:a;if(h&&typeof h!="boolean"&&!Gh(h)){const p=Array.isArray(h)?h:[h];for(let m=0;m<p.length;m++){const v=Yx(e,p[m]);if(v){const{transitionEnd:g,transition:w,...x}=v;for(const T in x){let y=x[T];if(Array.isArray(y)){const _=c?y.length-1:0;y=y[_]}y!==null&&(i[T]=y)}for(const T in g)i[T]=g[T]}}}return i}const _u=["transformPerspective","x","y","z","translateX","translateY","translateZ","scale","scaleX","scaleY","rotate","rotateX","rotateY","rotateZ","skew","skewX","skewY"],Ko=new Set(_u),aR=e=>t=>typeof t=="string"&&t.startsWith(e),oR=aR("--"),i8=aR("var(--"),Xx=e=>i8(e)?s8.test(e.split("/*")[0].trim()):!1,s8=/var\(--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)$/iu,lR=(e,t)=>t&&typeof e=="number"?t.transform(e):e,Bs=(e,t,n)=>n>t?t:n<e?e:n,Cu={test:e=>typeof e=="number",parse:parseFloat,transform:e=>e},af={...Cu,transform:e=>Bs(0,1,e)},Fd={...Cu,default:1},Hf=e=>({test:t=>typeof t=="string"&&t.endsWith(e)&&t.split(" ").length===1,parse:parseFloat,transform:t=>`${t}${e}`}),Xs=Hf("deg"),as=Hf("%"),Ze=Hf("px"),a8=Hf("vh"),o8=Hf("vw"),TT={...as,parse:e=>as.parse(e)/100,transform:e=>as.transform(e*100)},l8={borderWidth:Ze,borderTopWidth:Ze,borderRightWidth:Ze,borderBottomWidth:Ze,borderLeftWidth:Ze,borderRadius:Ze,radius:Ze,borderTopLeftRadius:Ze,borderTopRightRadius:Ze,borderBottomRightRadius:Ze,borderBottomLeftRadius:Ze,width:Ze,maxWidth:Ze,height:Ze,maxHeight:Ze,top:Ze,right:Ze,bottom:Ze,left:Ze,padding:Ze,paddingTop:Ze,paddingRight:Ze,paddingBottom:Ze,paddingLeft:Ze,margin:Ze,marginTop:Ze,marginRight:Ze,marginBottom:Ze,marginLeft:Ze,backgroundPositionX:Ze,backgroundPositionY:Ze},u8={rotate:Xs,rotateX:Xs,rotateY:Xs,rotateZ:Xs,scale:Fd,scaleX:Fd,scaleY:Fd,scaleZ:Fd,skew:Xs,skewX:Xs,skewY:Xs,distance:Ze,translateX:Ze,translateY:Ze,translateZ:Ze,x:Ze,y:Ze,z:Ze,perspective:Ze,transformPerspective:Ze,opacity:af,originX:TT,originY:TT,originZ:Ze},ST={...Cu,transform:Math.round},Jx={...l8,...u8,zIndex:ST,size:Ze,fillOpacity:af,strokeOpacity:af,numOctaves:ST},c8={x:"translateX",y:"translateY",z:"translateZ",transformPerspective:"perspective"},f8=_u.length;function d8(e,t,n){let r="",i=!0;for(let s=0;s<f8;s++){const a=_u[s],o=e[a];if(o===void 0)continue;let l=!0;if(typeof o=="number"?l=o===(a.startsWith("scale")?1:0):l=parseFloat(o)===0,!l||n){const u=lR(o,Jx[a]);if(!l){i=!1;const c=c8[a]||a;r+=`${c}(${u}) `}n&&(t[a]=u)}}return r=r.trim(),n?r=n(t,i?"":r):i&&(r="none"),r}function Qx(e,t,n){const{style:r,vars:i,transformOrigin:s}=e;let a=!1,o=!1;for(const l in t){const u=t[l];if(Ko.has(l)){a=!0;continue}else if(oR(l)){i[l]=u;continue}else{const c=lR(u,Jx[l]);l.startsWith("origin")?(o=!0,s[l]=c):r[l]=c}}if(t.transform||(a||n?r.transform=d8(t,e.transform,n):r.transform&&(r.transform="none")),o){const{originX:l="50%",originY:u="50%",originZ:c=0}=s;r.transformOrigin=`${l} ${u} ${c}`}}const h8={offset:"stroke-dashoffset",array:"stroke-dasharray"},p8={offset:"strokeDashoffset",array:"strokeDasharray"};function m8(e,t,n=1,r=0,i=!0){e.pathLength=1;const s=i?h8:p8;e[s.offset]=Ze.transform(-r);const a=Ze.transform(t),o=Ze.transform(n);e[s.array]=`${a} ${o}`}function ET(e,t,n){return typeof e=="string"?e:Ze.transform(t+n*e)}function g8(e,t,n){const r=ET(t,e.x,e.width),i=ET(n,e.y,e.height);return`${r} ${i}`}function jx(e,{attrX:t,attrY:n,attrScale:r,originX:i,originY:s,pathLength:a,pathSpacing:o=1,pathOffset:l=0,...u},c,h){if(Qx(e,u,h),c){e.style.viewBox&&(e.attrs.viewBox=e.style.viewBox);return}e.attrs=e.style,e.style={};const{attrs:p,style:m,dimensions:v}=e;p.transform&&(v&&(m.transform=p.transform),delete p.transform),v&&(i!==void 0||s!==void 0||m.transform)&&(m.transformOrigin=g8(v,i!==void 0?i:.5,s!==void 0?s:.5)),t!==void 0&&(p.x=t),n!==void 0&&(p.y=n),r!==void 0&&(p.scale=r),a!==void 0&&m8(p,a,o,l,!1)}const Zx=()=>({style:{},transform:{},transformOrigin:{},vars:{}}),uR=()=>({...Zx(),attrs:{}}),e1=e=>typeof e=="string"&&e.toLowerCase()==="svg";function cR(e,{style:t,vars:n},r,i){Object.assign(e.style,t,i&&i.getProjectionStyles(r));for(const s in n)e.style.setProperty(s,n[s])}const fR=new Set(["baseFrequency","diffuseConstant","kernelMatrix","kernelUnitLength","keySplines","keyTimes","limitingConeAngle","markerHeight","markerWidth","numOctaves","targetX","targetY","surfaceScale","specularConstant","specularExponent","stdDeviation","tableValues","viewBox","gradientTransform","pathLength","startOffset","textLength","lengthAdjust"]);function dR(e,t,n,r){cR(e,t,void 0,r);for(const i in t.attrs)e.setAttribute(fR.has(i)?i:Gx(i),t.attrs[i])}const K0={};function v8(e){Object.assign(K0,e)}function hR(e,{layout:t,layoutId:n}){return Ko.has(e)||e.startsWith("origin")||(t||n!==void 0)&&(!!K0[e]||e==="opacity")}function t1(e,t,n){var r;const{style:i}=e,s={};for(const a in i)(cr(i[a])||t.style&&cr(t.style[a])||hR(a,e)||((r=n==null?void 0:n.getValue(a))===null||r===void 0?void 0:r.liveStyle)!==void 0)&&(s[a]=i[a]);return s}function pR(e,t,n){const r=t1(e,t,n);for(const i in e)if(cr(e[i])||cr(t[i])){const s=_u.indexOf(i)!==-1?"attr"+i.charAt(0).toUpperCase()+i.substring(1):i;r[s]=e[i]}return r}function x8(e,t){try{t.dimensions=typeof e.getBBox=="function"?e.getBBox():e.getBoundingClientRect()}catch{t.dimensions={x:0,y:0,width:0,height:0}}}const _T=["x","y","width","height","cx","cy","r"],y8={useVisualState:sR({scrapeMotionValuesFromProps:pR,createRenderState:uR,onUpdate:({props:e,prevProps:t,current:n,renderState:r,latestValues:i})=>{if(!n)return;let s=!!e.drag;if(!s){for(const o in i)if(Ko.has(o)){s=!0;break}}if(!s)return;let a=!t;if(t)for(let o=0;o<_T.length;o++){const l=_T[o];e[l]!==t[l]&&(a=!0)}a&&en.read(()=>{x8(n,r),en.render(()=>{jx(r,i,e1(n.tagName),e.transformTemplate),dR(n,r)})})}})},w8={useVisualState:sR({scrapeMotionValuesFromProps:t1,createRenderState:Zx})};function mR(e,t,n){for(const r in t)!cr(t[r])&&!hR(r,n)&&(e[r]=t[r])}function T8({transformTemplate:e},t){return E.useMemo(()=>{const n=Zx();return Qx(n,t,e),Object.assign({},n.vars,n.style)},[t])}function S8(e,t){const n=e.style||{},r={};return mR(r,n,e),Object.assign(r,T8(e,t)),r}function E8(e,t){const n={},r=S8(e,t);return e.drag&&e.dragListener!==!1&&(n.draggable=!1,r.userSelect=r.WebkitUserSelect=r.WebkitTouchCallout="none",r.touchAction=e.drag===!0?"none":`pan-${e.drag==="x"?"y":"x"}`),e.tabIndex===void 0&&(e.onTap||e.onTapStart||e.whileTap)&&(n.tabIndex=0),n.style=r,n}function _8(e,t,n,r){const i=E.useMemo(()=>{const s=uR();return jx(s,t,e1(r),e.transformTemplate),{...s.attrs,style:{...s.style}}},[t]);if(e.style){const s={};mR(s,e.style,e),i.style={...s,...i.style}}return i}function C8(e=!1){return(n,r,i,{latestValues:s},a)=>{const l=(Kx(n)?_8:E8)(r,s,a,n),u=VL(r,typeof n=="string",e),c=n!==E.Fragment?{...u,...l,ref:i}:{},{children:h}=r,p=E.useMemo(()=>cr(h)?h.get():h,[h]);return E.createElement(n,{...c,children:p})}}function k8(e,t){return function(r,{forwardMotionProps:i}={forwardMotionProps:!1}){const a={...Kx(r)?y8:w8,preloadedFeatures:e,useRender:C8(i),createVisualElement:t,Component:r};return XL(a)}}function gR(e,t){if(!Array.isArray(t))return!1;const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(t[r]!==e[r])return!1;return!0}function Kh(e,t,n){const r=e.getProps();return Yx(r,t,n!==void 0?n:r.custom,e)}const A8=$x(()=>window.ScrollTimeline!==void 0);class R8{constructor(t){this.stop=()=>this.runAll("stop"),this.animations=t.filter(Boolean)}get finished(){return Promise.all(this.animations.map(t=>"finished"in t?t.finished:t))}getAll(t){return this.animations[0][t]}setAll(t,n){for(let r=0;r<this.animations.length;r++)this.animations[r][t]=n}attachTimeline(t,n){const r=this.animations.map(i=>{if(A8()&&i.attachTimeline)return i.attachTimeline(t);if(typeof n=="function")return n(i)});return()=>{r.forEach((i,s)=>{i&&i(),this.animations[s].stop()})}}get time(){return this.getAll("time")}set time(t){this.setAll("time",t)}get speed(){return this.getAll("speed")}set speed(t){this.setAll("speed",t)}get startTime(){return this.getAll("startTime")}get duration(){let t=0;for(let n=0;n<this.animations.length;n++)t=Math.max(t,this.animations[n].duration);return t}runAll(t){this.animations.forEach(n=>n[t]())}flatten(){this.runAll("flatten")}play(){this.runAll("play")}pause(){this.runAll("pause")}cancel(){this.runAll("cancel")}complete(){this.runAll("complete")}}class M8 extends R8{then(t,n){return Promise.all(this.animations).then(t).catch(n)}}function n1(e,t){return e?e[t]||e.default||e:void 0}const _g=2e4;function vR(e){let t=0;const n=50;let r=e.next(t);for(;!r.done&&t<_g;)t+=n,r=e.next(t);return t>=_g?1/0:t}function r1(e){return typeof e=="function"}function CT(e,t){e.timeline=t,e.onfinish=null}const i1=e=>Array.isArray(e)&&typeof e[0]=="number",F8={linearEasing:void 0};function D8(e,t){const n=$x(e);return()=>{var r;return(r=F8[t])!==null&&r!==void 0?r:n()}}const Y0=D8(()=>{try{document.createElement("div").animate({opacity:0},{easing:"linear(0, 1)"})}catch{return!1}return!0},"linearEasing"),xR=(e,t,n=10)=>{let r="";const i=Math.max(Math.round(t/n),2);for(let s=0;s<i;s++)r+=e(hu(0,i-1,s))+", ";return`linear(${r.substring(0,r.length-2)})`};function yR(e){return!!(typeof e=="function"&&Y0()||!e||typeof e=="string"&&(e in Cg||Y0())||i1(e)||Array.isArray(e)&&e.every(yR))}const ac=([e,t,n,r])=>`cubic-bezier(${e}, ${t}, ${n}, ${r})`,Cg={linear:"linear",ease:"ease",easeIn:"ease-in",easeOut:"ease-out",easeInOut:"ease-in-out",circIn:ac([0,.65,.55,1]),circOut:ac([.55,0,1,.45]),backIn:ac([.31,.01,.66,-.59]),backOut:ac([.33,1.53,.69,.99])};function wR(e,t){if(e)return typeof e=="function"&&Y0()?xR(e,t):i1(e)?ac(e):Array.isArray(e)?e.map(n=>wR(n,t)||Cg.easeOut):Cg[e]}const Fi={x:!1,y:!1};function TR(){return Fi.x||Fi.y}function P8(e,t,n){var r;if(e instanceof Element)return[e];if(typeof e=="string"){let i=document;const s=(r=n==null?void 0:n[e])!==null&&r!==void 0?r:i.querySelectorAll(e);return s?Array.from(s):[]}return Array.from(e)}function SR(e,t){const n=P8(e),r=new AbortController,i={passive:!0,...t,signal:r.signal};return[n,i,()=>r.abort()]}function kT(e){return t=>{t.pointerType==="touch"||TR()||e(t)}}function I8(e,t,n={}){const[r,i,s]=SR(e,n),a=kT(o=>{const{target:l}=o,u=t(o);if(typeof u!="function"||!l)return;const c=kT(h=>{u(h),l.removeEventListener("pointerleave",c)});l.addEventListener("pointerleave",c,i)});return r.forEach(o=>{o.addEventListener("pointerenter",a,i)}),s}const ER=(e,t)=>t?e===t?!0:ER(e,t.parentElement):!1,s1=e=>e.pointerType==="mouse"?typeof e.button!="number"||e.button<=0:e.isPrimary!==!1,N8=new Set(["BUTTON","INPUT","SELECT","TEXTAREA","A"]);function b8(e){return N8.has(e.tagName)||e.tabIndex!==-1}const oc=new WeakSet;function AT(e){return t=>{t.key==="Enter"&&e(t)}}function Kp(e,t){e.dispatchEvent(new PointerEvent("pointer"+t,{isPrimary:!0,bubbles:!0}))}const L8=(e,t)=>{const n=e.currentTarget;if(!n)return;const r=AT(()=>{if(oc.has(n))return;Kp(n,"down");const i=AT(()=>{Kp(n,"up")}),s=()=>Kp(n,"cancel");n.addEventListener("keyup",i,t),n.addEventListener("blur",s,t)});n.addEventListener("keydown",r,t),n.addEventListener("blur",()=>n.removeEventListener("keydown",r),t)};function RT(e){return s1(e)&&!TR()}function O8(e,t,n={}){const[r,i,s]=SR(e,n),a=o=>{const l=o.currentTarget;if(!RT(o)||oc.has(l))return;oc.add(l);const u=t(o),c=(m,v)=>{window.removeEventListener("pointerup",h),window.removeEventListener("pointercancel",p),!(!RT(m)||!oc.has(l))&&(oc.delete(l),typeof u=="function"&&u(m,{success:v}))},h=m=>{c(m,n.useGlobalTarget||ER(l,m.target))},p=m=>{c(m,!1)};window.addEventListener("pointerup",h,i),window.addEventListener("pointercancel",p,i)};return r.forEach(o=>{!b8(o)&&o.getAttribute("tabindex")===null&&(o.tabIndex=0),(n.useGlobalTarget?window:o).addEventListener("pointerdown",a,i),o.addEventListener("focus",u=>L8(u,i),i)}),s}function B8(e){return e==="x"||e==="y"?Fi[e]?null:(Fi[e]=!0,()=>{Fi[e]=!1}):Fi.x||Fi.y?null:(Fi.x=Fi.y=!0,()=>{Fi.x=Fi.y=!1})}const _R=new Set(["width","height","top","left","right","bottom",..._u]);let d0;function U8(){d0=void 0}const os={now:()=>(d0===void 0&&os.set(Xn.isProcessing||NL.useManualTiming?Xn.timestamp:performance.now()),d0),set:e=>{d0=e,queueMicrotask(U8)}};function a1(e,t){e.indexOf(t)===-1&&e.push(t)}function o1(e,t){const n=e.indexOf(t);n>-1&&e.splice(n,1)}class l1{constructor(){this.subscriptions=[]}add(t){return a1(this.subscriptions,t),()=>o1(this.subscriptions,t)}notify(t,n,r){const i=this.subscriptions.length;if(i)if(i===1)this.subscriptions[0](t,n,r);else for(let s=0;s<i;s++){const a=this.subscriptions[s];a&&a(t,n,r)}}getSize(){return this.subscriptions.length}clear(){this.subscriptions.length=0}}function CR(e,t){return t?e*(1e3/t):0}const MT=30,V8=e=>!isNaN(parseFloat(e)),FT={current:void 0};class H8{constructor(t,n={}){this.version="11.18.2",this.canTrackVelocity=null,this.events={},this.updateAndNotify=(r,i=!0)=>{const s=os.now();this.updatedAt!==s&&this.setPrevFrameValue(),this.prev=this.current,this.setCurrent(r),this.current!==this.prev&&this.events.change&&this.events.change.notify(this.current),i&&this.events.renderRequest&&this.events.renderRequest.notify(this.current)},this.hasAnimated=!1,this.setCurrent(t),this.owner=n.owner}setCurrent(t){this.current=t,this.updatedAt=os.now(),this.canTrackVelocity===null&&t!==void 0&&(this.canTrackVelocity=V8(this.current))}setPrevFrameValue(t=this.current){this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt}onChange(t){return this.on("change",t)}on(t,n){this.events[t]||(this.events[t]=new l1);const r=this.events[t].add(n);return t==="change"?()=>{r(),en.read(()=>{this.events.change.getSize()||this.stop()})}:r}clearListeners(){for(const t in this.events)this.events[t].clear()}attach(t,n){this.passiveEffect=t,this.stopPassiveEffect=n}set(t,n=!0){!n||!this.passiveEffect?this.updateAndNotify(t,n):this.passiveEffect(t,this.updateAndNotify)}setWithVelocity(t,n,r){this.set(n),this.prev=void 0,this.prevFrameValue=t,this.prevUpdatedAt=this.updatedAt-r}jump(t,n=!0){this.updateAndNotify(t),this.prev=t,this.prevUpdatedAt=this.prevFrameValue=void 0,n&&this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}get(){return FT.current&&FT.current.push(this),this.current}getPrevious(){return this.prev}getVelocity(){const t=os.now();if(!this.canTrackVelocity||this.prevFrameValue===void 0||t-this.updatedAt>MT)return 0;const n=Math.min(this.updatedAt-this.prevUpdatedAt,MT);return CR(parseFloat(this.current)-parseFloat(this.prevFrameValue),n)}start(t){return this.stop(),new Promise(n=>{this.hasAnimated=!0,this.animation=t(n),this.events.animationStart&&this.events.animationStart.notify()}).then(()=>{this.events.animationComplete&&this.events.animationComplete.notify(),this.clearAnimation()})}stop(){this.animation&&(this.animation.stop(),this.events.animationCancel&&this.events.animationCancel.notify()),this.clearAnimation()}isAnimating(){return!!this.animation}clearAnimation(){delete this.animation}destroy(){this.clearListeners(),this.stop(),this.stopPassiveEffect&&this.stopPassiveEffect()}}function of(e,t){return new H8(e,t)}function $8(e,t,n){e.hasValue(t)?e.getValue(t).set(n):e.addValue(t,of(n))}function z8(e,t){const n=Kh(e,t);let{transitionEnd:r={},transition:i={},...s}=n||{};s={...s,...r};for(const a in s){const o=t8(s[a]);$8(e,a,o)}}function W8(e){return!!(cr(e)&&e.add)}function kg(e,t){const n=e.getValue("willChange");if(W8(n))return n.add(t)}function kR(e){return e.props[nR]}const AR=(e,t,n)=>(((1-3*n+3*t)*e+(3*n-6*t))*e+3*t)*e,G8=1e-7,q8=12;function K8(e,t,n,r,i){let s,a,o=0;do a=t+(n-t)/2,s=AR(a,r,i)-e,s>0?n=a:t=a;while(Math.abs(s)>G8&&++o<q8);return a}function $f(e,t,n,r){if(e===t&&n===r)return Xr;const i=s=>K8(s,0,1,e,n);return s=>s===0||s===1?s:AR(i(s),t,r)}const RR=e=>t=>t<=.5?e(2*t)/2:(2-e(2*(1-t)))/2,MR=e=>t=>1-e(1-t),FR=$f(.33,1.53,.69,.99),u1=MR(FR),DR=RR(u1),PR=e=>(e*=2)<1?.5*u1(e):.5*(2-Math.pow(2,-10*(e-1))),c1=e=>1-Math.sin(Math.acos(e)),IR=MR(c1),NR=RR(c1),bR=e=>/^0[^.\s]+$/u.test(e);function Y8(e){return typeof e=="number"?e===0:e!==null?e==="none"||e==="0"||bR(e):!0}const Sc=e=>Math.round(e*1e5)/1e5,f1=/-?(?:\d+(?:\.\d+)?|\.\d+)/gu;function X8(e){return e==null}const J8=/^(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))$/iu,d1=(e,t)=>n=>!!(typeof n=="string"&&J8.test(n)&&n.startsWith(e)||t&&!X8(n)&&Object.prototype.hasOwnProperty.call(n,t)),LR=(e,t,n)=>r=>{if(typeof r!="string")return r;const[i,s,a,o]=r.match(f1);return{[e]:parseFloat(i),[t]:parseFloat(s),[n]:parseFloat(a),alpha:o!==void 0?parseFloat(o):1}},Q8=e=>Bs(0,255,e),Yp={...Cu,transform:e=>Math.round(Q8(e))},ao={test:d1("rgb","red"),parse:LR("red","green","blue"),transform:({red:e,green:t,blue:n,alpha:r=1})=>"rgba("+Yp.transform(e)+", "+Yp.transform(t)+", "+Yp.transform(n)+", "+Sc(af.transform(r))+")"};function j8(e){let t="",n="",r="",i="";return e.length>5?(t=e.substring(1,3),n=e.substring(3,5),r=e.substring(5,7),i=e.substring(7,9)):(t=e.substring(1,2),n=e.substring(2,3),r=e.substring(3,4),i=e.substring(4,5),t+=t,n+=n,r+=r,i+=i),{red:parseInt(t,16),green:parseInt(n,16),blue:parseInt(r,16),alpha:i?parseInt(i,16)/255:1}}const Ag={test:d1("#"),parse:j8,transform:ao.transform},Cl={test:d1("hsl","hue"),parse:LR("hue","saturation","lightness"),transform:({hue:e,saturation:t,lightness:n,alpha:r=1})=>"hsla("+Math.round(e)+", "+as.transform(Sc(t))+", "+as.transform(Sc(n))+", "+Sc(af.transform(r))+")"},ir={test:e=>ao.test(e)||Ag.test(e)||Cl.test(e),parse:e=>ao.test(e)?ao.parse(e):Cl.test(e)?Cl.parse(e):Ag.parse(e),transform:e=>typeof e=="string"?e:e.hasOwnProperty("red")?ao.transform(e):Cl.transform(e)},Z8=/(?:#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\))/giu;function eO(e){var t,n;return isNaN(e)&&typeof e=="string"&&(((t=e.match(f1))===null||t===void 0?void 0:t.length)||0)+(((n=e.match(Z8))===null||n===void 0?void 0:n.length)||0)>0}const OR="number",BR="color",tO="var",nO="var(",DT="${}",rO=/var\s*\(\s*--(?:[\w-]+\s*|[\w-]+\s*,(?:\s*[^)(\s]|\s*\((?:[^)(]|\([^)(]*\))*\))+\s*)\)|#[\da-f]{3,8}|(?:rgb|hsl)a?\((?:-?[\d.]+%?[,\s]+){2}-?[\d.]+%?\s*(?:[,/]\s*)?(?:\b\d+(?:\.\d+)?|\.\d+)?%?\)|-?(?:\d+(?:\.\d+)?|\.\d+)/giu;function lf(e){const t=e.toString(),n=[],r={color:[],number:[],var:[]},i=[];let s=0;const o=t.replace(rO,l=>(ir.test(l)?(r.color.push(s),i.push(BR),n.push(ir.parse(l))):l.startsWith(nO)?(r.var.push(s),i.push(tO),n.push(l)):(r.number.push(s),i.push(OR),n.push(parseFloat(l))),++s,DT)).split(DT);return{values:n,split:o,indexes:r,types:i}}function UR(e){return lf(e).values}function VR(e){const{split:t,types:n}=lf(e),r=t.length;return i=>{let s="";for(let a=0;a<r;a++)if(s+=t[a],i[a]!==void 0){const o=n[a];o===OR?s+=Sc(i[a]):o===BR?s+=ir.transform(i[a]):s+=i[a]}return s}}const iO=e=>typeof e=="number"?0:e;function sO(e){const t=UR(e);return VR(e)(t.map(iO))}const Ia={test:eO,parse:UR,createTransformer:VR,getAnimatableNone:sO},aO=new Set(["brightness","contrast","saturate","opacity"]);function oO(e){const[t,n]=e.slice(0,-1).split("(");if(t==="drop-shadow")return e;const[r]=n.match(f1)||[];if(!r)return e;const i=n.replace(r,"");let s=aO.has(t)?1:0;return r!==n&&(s*=100),t+"("+s+i+")"}const lO=/\b([a-z-]*)\(.*?\)/gu,Rg={...Ia,getAnimatableNone:e=>{const t=e.match(lO);return t?t.map(oO).join(" "):e}},uO={...Jx,color:ir,backgroundColor:ir,outlineColor:ir,fill:ir,stroke:ir,borderColor:ir,borderTopColor:ir,borderRightColor:ir,borderBottomColor:ir,borderLeftColor:ir,filter:Rg,WebkitFilter:Rg},h1=e=>uO[e];function HR(e,t){let n=h1(e);return n!==Rg&&(n=Ia),n.getAnimatableNone?n.getAnimatableNone(t):void 0}const cO=new Set(["auto","none","0"]);function fO(e,t,n){let r=0,i;for(;r<e.length&&!i;){const s=e[r];typeof s=="string"&&!cO.has(s)&&lf(s).values.length&&(i=e[r]),r++}if(i&&n)for(const s of t)e[s]=HR(n,i)}const PT=e=>e===Cu||e===Ze,IT=(e,t)=>parseFloat(e.split(", ")[t]),NT=(e,t)=>(n,{transform:r})=>{if(r==="none"||!r)return 0;const i=r.match(/^matrix3d\((.+)\)$/u);if(i)return IT(i[1],t);{const s=r.match(/^matrix\((.+)\)$/u);return s?IT(s[1],e):0}},dO=new Set(["x","y","z"]),hO=_u.filter(e=>!dO.has(e));function pO(e){const t=[];return hO.forEach(n=>{const r=e.getValue(n);r!==void 0&&(t.push([n,r.get()]),r.set(n.startsWith("scale")?1:0))}),t}const mu={width:({x:e},{paddingLeft:t="0",paddingRight:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),height:({y:e},{paddingTop:t="0",paddingBottom:n="0"})=>e.max-e.min-parseFloat(t)-parseFloat(n),top:(e,{top:t})=>parseFloat(t),left:(e,{left:t})=>parseFloat(t),bottom:({y:e},{top:t})=>parseFloat(t)+(e.max-e.min),right:({x:e},{left:t})=>parseFloat(t)+(e.max-e.min),x:NT(4,13),y:NT(5,14)};mu.translateX=mu.x;mu.translateY=mu.y;const yo=new Set;let Mg=!1,Fg=!1;function $R(){if(Fg){const e=Array.from(yo).filter(r=>r.needsMeasurement),t=new Set(e.map(r=>r.element)),n=new Map;t.forEach(r=>{const i=pO(r);i.length&&(n.set(r,i),r.render())}),e.forEach(r=>r.measureInitialState()),t.forEach(r=>{r.render();const i=n.get(r);i&&i.forEach(([s,a])=>{var o;(o=r.getValue(s))===null||o===void 0||o.set(a)})}),e.forEach(r=>r.measureEndState()),e.forEach(r=>{r.suspendedScrollY!==void 0&&window.scrollTo(0,r.suspendedScrollY)})}Fg=!1,Mg=!1,yo.forEach(e=>e.complete()),yo.clear()}function zR(){yo.forEach(e=>{e.readKeyframes(),e.needsMeasurement&&(Fg=!0)})}function mO(){zR(),$R()}class p1{constructor(t,n,r,i,s,a=!1){this.isComplete=!1,this.isAsync=!1,this.needsMeasurement=!1,this.isScheduled=!1,this.unresolvedKeyframes=[...t],this.onComplete=n,this.name=r,this.motionValue=i,this.element=s,this.isAsync=a}scheduleResolve(){this.isScheduled=!0,this.isAsync?(yo.add(this),Mg||(Mg=!0,en.read(zR),en.resolveKeyframes($R))):(this.readKeyframes(),this.complete())}readKeyframes(){const{unresolvedKeyframes:t,name:n,element:r,motionValue:i}=this;for(let s=0;s<t.length;s++)if(t[s]===null)if(s===0){const a=i==null?void 0:i.get(),o=t[t.length-1];if(a!==void 0)t[0]=a;else if(r&&n){const l=r.readValue(n,o);l!=null&&(t[0]=l)}t[0]===void 0&&(t[0]=o),i&&a===void 0&&i.set(t[0])}else t[s]=t[s-1]}setFinalKeyframe(){}measureInitialState(){}renderEndStyles(){}measureEndState(){}complete(){this.isComplete=!0,this.onComplete(this.unresolvedKeyframes,this.finalKeyframe),yo.delete(this)}cancel(){this.isComplete||(this.isScheduled=!1,yo.delete(this))}resume(){this.isComplete||this.scheduleResolve()}}const WR=e=>/^-?(?:\d+(?:\.\d+)?|\.\d+)$/u.test(e),gO=/^var\(--(?:([\w-]+)|([\w-]+), ?([a-zA-Z\d ()%#.,-]+))\)/u;function vO(e){const t=gO.exec(e);if(!t)return[,];const[,n,r,i]=t;return[`--${n??r}`,i]}function GR(e,t,n=1){const[r,i]=vO(e);if(!r)return;const s=window.getComputedStyle(t).getPropertyValue(r);if(s){const a=s.trim();return WR(a)?parseFloat(a):a}return Xx(i)?GR(i,t,n+1):i}const qR=e=>t=>t.test(e),xO={test:e=>e==="auto",parse:e=>e},KR=[Cu,Ze,as,Xs,o8,a8,xO],bT=e=>KR.find(qR(e));class YR extends p1{constructor(t,n,r,i,s){super(t,n,r,i,s,!0)}readKeyframes(){const{unresolvedKeyframes:t,element:n,name:r}=this;if(!n||!n.current)return;super.readKeyframes();for(let l=0;l<t.length;l++){let u=t[l];if(typeof u=="string"&&(u=u.trim(),Xx(u))){const c=GR(u,n.current);c!==void 0&&(t[l]=c),l===t.length-1&&(this.finalKeyframe=u)}}if(this.resolveNoneKeyframes(),!_R.has(r)||t.length!==2)return;const[i,s]=t,a=bT(i),o=bT(s);if(a!==o)if(PT(a)&&PT(o))for(let l=0;l<t.length;l++){const u=t[l];typeof u=="string"&&(t[l]=parseFloat(u))}else this.needsMeasurement=!0}resolveNoneKeyframes(){const{unresolvedKeyframes:t,name:n}=this,r=[];for(let i=0;i<t.length;i++)Y8(t[i])&&r.push(i);r.length&&fO(t,r,n)}measureInitialState(){const{element:t,unresolvedKeyframes:n,name:r}=this;if(!t||!t.current)return;r==="height"&&(this.suspendedScrollY=window.pageYOffset),this.measuredOrigin=mu[r](t.measureViewportBox(),window.getComputedStyle(t.current)),n[0]=this.measuredOrigin;const i=n[n.length-1];i!==void 0&&t.getValue(r,i).jump(i,!1)}measureEndState(){var t;const{element:n,name:r,unresolvedKeyframes:i}=this;if(!n||!n.current)return;const s=n.getValue(r);s&&s.jump(this.measuredOrigin,!1);const a=i.length-1,o=i[a];i[a]=mu[r](n.measureViewportBox(),window.getComputedStyle(n.current)),o!==null&&this.finalKeyframe===void 0&&(this.finalKeyframe=o),!((t=this.removedTransforms)===null||t===void 0)&&t.length&&this.removedTransforms.forEach(([l,u])=>{n.getValue(l).set(u)}),this.resolveNoneKeyframes()}}const LT=(e,t)=>t==="zIndex"?!1:!!(typeof e=="number"||Array.isArray(e)||typeof e=="string"&&(Ia.test(e)||e==="0")&&!e.startsWith("url("));function yO(e){const t=e[0];if(e.length===1)return!0;for(let n=0;n<e.length;n++)if(e[n]!==t)return!0}function wO(e,t,n,r){const i=e[0];if(i===null)return!1;if(t==="display"||t==="visibility")return!0;const s=e[e.length-1],a=LT(i,t),o=LT(s,t);return!a||!o?!1:yO(e)||(n==="spring"||r1(n))&&r}const TO=e=>e!==null;function Yh(e,{repeat:t,repeatType:n="loop"},r){const i=e.filter(TO),s=t&&n!=="loop"&&t%2===1?0:i.length-1;return!s||r===void 0?i[s]:r}const SO=40;class XR{constructor({autoplay:t=!0,delay:n=0,type:r="keyframes",repeat:i=0,repeatDelay:s=0,repeatType:a="loop",...o}){this.isStopped=!1,this.hasAttemptedResolve=!1,this.createdAt=os.now(),this.options={autoplay:t,delay:n,type:r,repeat:i,repeatDelay:s,repeatType:a,...o},this.updateFinishedPromise()}calcStartTime(){return this.resolvedAt?this.resolvedAt-this.createdAt>SO?this.resolvedAt:this.createdAt:this.createdAt}get resolved(){return!this._resolved&&!this.hasAttemptedResolve&&mO(),this._resolved}onKeyframesResolved(t,n){this.resolvedAt=os.now(),this.hasAttemptedResolve=!0;const{name:r,type:i,velocity:s,delay:a,onComplete:o,onUpdate:l,isGenerator:u}=this.options;if(!u&&!wO(t,r,i,s))if(a)this.options.duration=0;else{l&&l(Yh(t,this.options,n)),o&&o(),this.resolveFinishedPromise();return}const c=this.initPlayback(t,n);c!==!1&&(this._resolved={keyframes:t,finalKeyframe:n,...c},this.onPostResolved())}onPostResolved(){}then(t,n){return this.currentFinishedPromise.then(t,n)}flatten(){this.options.type="keyframes",this.options.ease="linear"}updateFinishedPromise(){this.currentFinishedPromise=new Promise(t=>{this.resolveFinishedPromise=t})}}const an=(e,t,n)=>e+(t-e)*n;function Xp(e,t,n){return n<0&&(n+=1),n>1&&(n-=1),n<1/6?e+(t-e)*6*n:n<1/2?t:n<2/3?e+(t-e)*(2/3-n)*6:e}function EO({hue:e,saturation:t,lightness:n,alpha:r}){e/=360,t/=100,n/=100;let i=0,s=0,a=0;if(!t)i=s=a=n;else{const o=n<.5?n*(1+t):n+t-n*t,l=2*n-o;i=Xp(l,o,e+1/3),s=Xp(l,o,e),a=Xp(l,o,e-1/3)}return{red:Math.round(i*255),green:Math.round(s*255),blue:Math.round(a*255),alpha:r}}function X0(e,t){return n=>n>0?t:e}const Jp=(e,t,n)=>{const r=e*e,i=n*(t*t-r)+r;return i<0?0:Math.sqrt(i)},_O=[Ag,ao,Cl],CO=e=>_O.find(t=>t.test(e));function OT(e){const t=CO(e);if(!t)return!1;let n=t.parse(e);return t===Cl&&(n=EO(n)),n}const BT=(e,t)=>{const n=OT(e),r=OT(t);if(!n||!r)return X0(e,t);const i={...n};return s=>(i.red=Jp(n.red,r.red,s),i.green=Jp(n.green,r.green,s),i.blue=Jp(n.blue,r.blue,s),i.alpha=an(n.alpha,r.alpha,s),ao.transform(i))},kO=(e,t)=>n=>t(e(n)),zf=(...e)=>e.reduce(kO),Dg=new Set(["none","hidden"]);function AO(e,t){return Dg.has(e)?n=>n<=0?e:t:n=>n>=1?t:e}function RO(e,t){return n=>an(e,t,n)}function m1(e){return typeof e=="number"?RO:typeof e=="string"?Xx(e)?X0:ir.test(e)?BT:DO:Array.isArray(e)?JR:typeof e=="object"?ir.test(e)?BT:MO:X0}function JR(e,t){const n=[...e],r=n.length,i=e.map((s,a)=>m1(s)(s,t[a]));return s=>{for(let a=0;a<r;a++)n[a]=i[a](s);return n}}function MO(e,t){const n={...e,...t},r={};for(const i in n)e[i]!==void 0&&t[i]!==void 0&&(r[i]=m1(e[i])(e[i],t[i]));return i=>{for(const s in r)n[s]=r[s](i);return n}}function FO(e,t){var n;const r=[],i={color:0,var:0,number:0};for(let s=0;s<t.values.length;s++){const a=t.types[s],o=e.indexes[a][i[a]],l=(n=e.values[o])!==null&&n!==void 0?n:0;r[s]=l,i[a]++}return r}const DO=(e,t)=>{const n=Ia.createTransformer(t),r=lf(e),i=lf(t);return r.indexes.var.length===i.indexes.var.length&&r.indexes.color.length===i.indexes.color.length&&r.indexes.number.length>=i.indexes.number.length?Dg.has(e)&&!i.values.length||Dg.has(t)&&!r.values.length?AO(e,t):zf(JR(FO(r,i),i.values),n):X0(e,t)};function QR(e,t,n){return typeof e=="number"&&typeof t=="number"&&typeof n=="number"?an(e,t,n):m1(e)(e,t)}const PO=5;function jR(e,t,n){const r=Math.max(t-PO,0);return CR(n-e(r),t-r)}const hn={stiffness:100,damping:10,mass:1,velocity:0,duration:800,bounce:.3,visualDuration:.3,restSpeed:{granular:.01,default:2},restDelta:{granular:.005,default:.5},minDuration:.01,maxDuration:10,minDamping:.05,maxDamping:1},Qp=.001;function IO({duration:e=hn.duration,bounce:t=hn.bounce,velocity:n=hn.velocity,mass:r=hn.mass}){let i,s,a=1-t;a=Bs(hn.minDamping,hn.maxDamping,a),e=Bs(hn.minDuration,hn.maxDuration,Rs(e)),a<1?(i=u=>{const c=u*a,h=c*e,p=c-n,m=Pg(u,a),v=Math.exp(-h);return Qp-p/m*v},s=u=>{const h=u*a*e,p=h*n+n,m=Math.pow(a,2)*Math.pow(u,2)*e,v=Math.exp(-h),g=Pg(Math.pow(u,2),a);return(-i(u)+Qp>0?-1:1)*((p-m)*v)/g}):(i=u=>{const c=Math.exp(-u*e),h=(u-n)*e+1;return-Qp+c*h},s=u=>{const c=Math.exp(-u*e),h=(n-u)*(e*e);return c*h});const o=5/e,l=bO(i,s,o);if(e=As(e),isNaN(l))return{stiffness:hn.stiffness,damping:hn.damping,duration:e};{const u=Math.pow(l,2)*r;return{stiffness:u,damping:a*2*Math.sqrt(r*u),duration:e}}}const NO=12;function bO(e,t,n){let r=n;for(let i=1;i<NO;i++)r=r-e(r)/t(r);return r}function Pg(e,t){return e*Math.sqrt(1-t*t)}const LO=["duration","bounce"],OO=["stiffness","damping","mass"];function UT(e,t){return t.some(n=>e[n]!==void 0)}function BO(e){let t={velocity:hn.velocity,stiffness:hn.stiffness,damping:hn.damping,mass:hn.mass,isResolvedFromDuration:!1,...e};if(!UT(e,OO)&&UT(e,LO))if(e.visualDuration){const n=e.visualDuration,r=2*Math.PI/(n*1.2),i=r*r,s=2*Bs(.05,1,1-(e.bounce||0))*Math.sqrt(i);t={...t,mass:hn.mass,stiffness:i,damping:s}}else{const n=IO(e);t={...t,...n,mass:hn.mass},t.isResolvedFromDuration=!0}return t}function ZR(e=hn.visualDuration,t=hn.bounce){const n=typeof e!="object"?{visualDuration:e,keyframes:[0,1],bounce:t}:e;let{restSpeed:r,restDelta:i}=n;const s=n.keyframes[0],a=n.keyframes[n.keyframes.length-1],o={done:!1,value:s},{stiffness:l,damping:u,mass:c,duration:h,velocity:p,isResolvedFromDuration:m}=BO({...n,velocity:-Rs(n.velocity||0)}),v=p||0,g=u/(2*Math.sqrt(l*c)),w=a-s,x=Rs(Math.sqrt(l/c)),T=Math.abs(w)<5;r||(r=T?hn.restSpeed.granular:hn.restSpeed.default),i||(i=T?hn.restDelta.granular:hn.restDelta.default);let y;if(g<1){const k=Pg(x,g);y=S=>{const C=Math.exp(-g*x*S);return a-C*((v+g*x*w)/k*Math.sin(k*S)+w*Math.cos(k*S))}}else if(g===1)y=k=>a-Math.exp(-x*k)*(w+(v+x*w)*k);else{const k=x*Math.sqrt(g*g-1);y=S=>{const C=Math.exp(-g*x*S),M=Math.min(k*S,300);return a-C*((v+g*x*w)*Math.sinh(M)+k*w*Math.cosh(M))/k}}const _={calculatedDuration:m&&h||null,next:k=>{const S=y(k);if(m)o.done=k>=h;else{let C=0;g<1&&(C=k===0?As(v):jR(y,k,S));const M=Math.abs(C)<=r,F=Math.abs(a-S)<=i;o.done=M&&F}return o.value=o.done?a:S,o},toString:()=>{const k=Math.min(vR(_),_g),S=xR(C=>_.next(k*C).value,k,30);return k+"ms "+S}};return _}function VT({keyframes:e,velocity:t=0,power:n=.8,timeConstant:r=325,bounceDamping:i=10,bounceStiffness:s=500,modifyTarget:a,min:o,max:l,restDelta:u=.5,restSpeed:c}){const h=e[0],p={done:!1,value:h},m=M=>o!==void 0&&M<o||l!==void 0&&M>l,v=M=>o===void 0?l:l===void 0||Math.abs(o-M)<Math.abs(l-M)?o:l;let g=n*t;const w=h+g,x=a===void 0?w:a(w);x!==w&&(g=x-h);const T=M=>-g*Math.exp(-M/r),y=M=>x+T(M),_=M=>{const F=T(M),b=y(M);p.done=Math.abs(F)<=u,p.value=p.done?x:b};let k,S;const C=M=>{m(p.value)&&(k=M,S=ZR({keyframes:[p.value,v(p.value)],velocity:jR(y,M,p.value),damping:i,stiffness:s,restDelta:u,restSpeed:c}))};return C(0),{calculatedDuration:null,next:M=>{let F=!1;return!S&&k===void 0&&(F=!0,_(M),C(M)),k!==void 0&&M>=k?S.next(M-k):(!F&&_(M),p)}}}const UO=$f(.42,0,1,1),VO=$f(0,0,.58,1),eM=$f(.42,0,.58,1),HO=e=>Array.isArray(e)&&typeof e[0]!="number",$O={linear:Xr,easeIn:UO,easeInOut:eM,easeOut:VO,circIn:c1,circInOut:NR,circOut:IR,backIn:u1,backInOut:DR,backOut:FR,anticipate:PR},HT=e=>{if(i1(e)){QA(e.length===4);const[t,n,r,i]=e;return $f(t,n,r,i)}else if(typeof e=="string")return $O[e];return e};function zO(e,t,n){const r=[],i=n||QR,s=e.length-1;for(let a=0;a<s;a++){let o=i(e[a],e[a+1]);if(t){const l=Array.isArray(t)?t[a]||Xr:t;o=zf(l,o)}r.push(o)}return r}function WO(e,t,{clamp:n=!0,ease:r,mixer:i}={}){const s=e.length;if(QA(s===t.length),s===1)return()=>t[0];if(s===2&&t[0]===t[1])return()=>t[1];const a=e[0]===e[1];e[0]>e[s-1]&&(e=[...e].reverse(),t=[...t].reverse());const o=zO(t,r,i),l=o.length,u=c=>{if(a&&c<e[0])return t[0];let h=0;if(l>1)for(;h<e.length-2&&!(c<e[h+1]);h++);const p=hu(e[h],e[h+1],c);return o[h](p)};return n?c=>u(Bs(e[0],e[s-1],c)):u}function GO(e,t){const n=e[e.length-1];for(let r=1;r<=t;r++){const i=hu(0,t,r);e.push(an(n,1,i))}}function qO(e){const t=[0];return GO(t,e.length-1),t}function KO(e,t){return e.map(n=>n*t)}function YO(e,t){return e.map(()=>t||eM).splice(0,e.length-1)}function J0({duration:e=300,keyframes:t,times:n,ease:r="easeInOut"}){const i=HO(r)?r.map(HT):HT(r),s={done:!1,value:t[0]},a=KO(n&&n.length===t.length?n:qO(t),e),o=WO(a,t,{ease:Array.isArray(i)?i:YO(t,i)});return{calculatedDuration:e,next:l=>(s.value=o(l),s.done=l>=e,s)}}const XO=e=>{const t=({timestamp:n})=>e(n);return{start:()=>en.update(t,!0),stop:()=>Pa(t),now:()=>Xn.isProcessing?Xn.timestamp:os.now()}},JO={decay:VT,inertia:VT,tween:J0,keyframes:J0,spring:ZR},QO=e=>e/100;class g1 extends XR{constructor(t){super(t),this.holdTime=null,this.cancelTime=null,this.currentTime=0,this.playbackSpeed=1,this.pendingPlayState="running",this.startTime=null,this.state="idle",this.stop=()=>{if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.teardown();const{onStop:l}=this.options;l&&l()};const{name:n,motionValue:r,element:i,keyframes:s}=this.options,a=(i==null?void 0:i.KeyframeResolver)||p1,o=(l,u)=>this.onKeyframesResolved(l,u);this.resolver=new a(s,o,n,r,i),this.resolver.scheduleResolve()}flatten(){super.flatten(),this._resolved&&Object.assign(this._resolved,this.initPlayback(this._resolved.keyframes))}initPlayback(t){const{type:n="keyframes",repeat:r=0,repeatDelay:i=0,repeatType:s,velocity:a=0}=this.options,o=r1(n)?n:JO[n]||J0;let l,u;o!==J0&&typeof t[0]!="number"&&(l=zf(QO,QR(t[0],t[1])),t=[0,100]);const c=o({...this.options,keyframes:t});s==="mirror"&&(u=o({...this.options,keyframes:[...t].reverse(),velocity:-a})),c.calculatedDuration===null&&(c.calculatedDuration=vR(c));const{calculatedDuration:h}=c,p=h+i,m=p*(r+1)-i;return{generator:c,mirroredGenerator:u,mapPercentToKeyframes:l,calculatedDuration:h,resolvedDuration:p,totalDuration:m}}onPostResolved(){const{autoplay:t=!0}=this.options;this.play(),this.pendingPlayState==="paused"||!t?this.pause():this.state=this.pendingPlayState}tick(t,n=!1){const{resolved:r}=this;if(!r){const{keyframes:M}=this.options;return{done:!0,value:M[M.length-1]}}const{finalKeyframe:i,generator:s,mirroredGenerator:a,mapPercentToKeyframes:o,keyframes:l,calculatedDuration:u,totalDuration:c,resolvedDuration:h}=r;if(this.startTime===null)return s.next(0);const{delay:p,repeat:m,repeatType:v,repeatDelay:g,onUpdate:w}=this.options;this.speed>0?this.startTime=Math.min(this.startTime,t):this.speed<0&&(this.startTime=Math.min(t-c/this.speed,this.startTime)),n?this.currentTime=t:this.holdTime!==null?this.currentTime=this.holdTime:this.currentTime=Math.round(t-this.startTime)*this.speed;const x=this.currentTime-p*(this.speed>=0?1:-1),T=this.speed>=0?x<0:x>c;this.currentTime=Math.max(x,0),this.state==="finished"&&this.holdTime===null&&(this.currentTime=c);let y=this.currentTime,_=s;if(m){const M=Math.min(this.currentTime,c)/h;let F=Math.floor(M),b=M%1;!b&&M>=1&&(b=1),b===1&&F--,F=Math.min(F,m+1),!!(F%2)&&(v==="reverse"?(b=1-b,g&&(b-=g/h)):v==="mirror"&&(_=a)),y=Bs(0,1,b)*h}const k=T?{done:!1,value:l[0]}:_.next(y);o&&(k.value=o(k.value));let{done:S}=k;!T&&u!==null&&(S=this.speed>=0?this.currentTime>=c:this.currentTime<=0);const C=this.holdTime===null&&(this.state==="finished"||this.state==="running"&&S);return C&&i!==void 0&&(k.value=Yh(l,this.options,i)),w&&w(k.value),C&&this.finish(),k}get duration(){const{resolved:t}=this;return t?Rs(t.calculatedDuration):0}get time(){return Rs(this.currentTime)}set time(t){t=As(t),this.currentTime=t,this.holdTime!==null||this.speed===0?this.holdTime=t:this.driver&&(this.startTime=this.driver.now()-t/this.speed)}get speed(){return this.playbackSpeed}set speed(t){const n=this.playbackSpeed!==t;this.playbackSpeed=t,n&&(this.time=Rs(this.currentTime))}play(){if(this.resolver.isScheduled||this.resolver.resume(),!this._resolved){this.pendingPlayState="running";return}if(this.isStopped)return;const{driver:t=XO,onPlay:n,startTime:r}=this.options;this.driver||(this.driver=t(s=>this.tick(s))),n&&n();const i=this.driver.now();this.holdTime!==null?this.startTime=i-this.holdTime:this.startTime?this.state==="finished"&&(this.startTime=i):this.startTime=r??this.calcStartTime(),this.state==="finished"&&this.updateFinishedPromise(),this.cancelTime=this.startTime,this.holdTime=null,this.state="running",this.driver.start()}pause(){var t;if(!this._resolved){this.pendingPlayState="paused";return}this.state="paused",this.holdTime=(t=this.currentTime)!==null&&t!==void 0?t:0}complete(){this.state!=="running"&&this.play(),this.pendingPlayState=this.state="finished",this.holdTime=null}finish(){this.teardown(),this.state="finished";const{onComplete:t}=this.options;t&&t()}cancel(){this.cancelTime!==null&&this.tick(this.cancelTime),this.teardown(),this.updateFinishedPromise()}teardown(){this.state="idle",this.stopDriver(),this.resolveFinishedPromise(),this.updateFinishedPromise(),this.startTime=this.cancelTime=null,this.resolver.cancel()}stopDriver(){this.driver&&(this.driver.stop(),this.driver=void 0)}sample(t){return this.startTime=0,this.tick(t,!0)}}const jO=new Set(["opacity","clipPath","filter","transform"]);function ZO(e,t,n,{delay:r=0,duration:i=300,repeat:s=0,repeatType:a="loop",ease:o="easeInOut",times:l}={}){const u={[t]:n};l&&(u.offset=l);const c=wR(o,i);return Array.isArray(c)&&(u.easing=c),e.animate(u,{delay:r,duration:i,easing:Array.isArray(c)?"linear":c,fill:"both",iterations:s+1,direction:a==="reverse"?"alternate":"normal"})}const e6=$x(()=>Object.hasOwnProperty.call(Element.prototype,"animate")),Q0=10,t6=2e4;function n6(e){return r1(e.type)||e.type==="spring"||!yR(e.ease)}function r6(e,t){const n=new g1({...t,keyframes:e,repeat:0,delay:0,isGenerator:!0});let r={done:!1,value:e[0]};const i=[];let s=0;for(;!r.done&&s<t6;)r=n.sample(s),i.push(r.value),s+=Q0;return{times:void 0,keyframes:i,duration:s-Q0,ease:"linear"}}const tM={anticipate:PR,backInOut:DR,circInOut:NR};function i6(e){return e in tM}class $T extends XR{constructor(t){super(t);const{name:n,motionValue:r,element:i,keyframes:s}=this.options;this.resolver=new YR(s,(a,o)=>this.onKeyframesResolved(a,o),n,r,i),this.resolver.scheduleResolve()}initPlayback(t,n){let{duration:r=300,times:i,ease:s,type:a,motionValue:o,name:l,startTime:u}=this.options;if(!o.owner||!o.owner.current)return!1;if(typeof s=="string"&&Y0()&&i6(s)&&(s=tM[s]),n6(this.options)){const{onComplete:h,onUpdate:p,motionValue:m,element:v,...g}=this.options,w=r6(t,g);t=w.keyframes,t.length===1&&(t[1]=t[0]),r=w.duration,i=w.times,s=w.ease,a="keyframes"}const c=ZO(o.owner.current,l,t,{...this.options,duration:r,times:i,ease:s});return c.startTime=u??this.calcStartTime(),this.pendingTimeline?(CT(c,this.pendingTimeline),this.pendingTimeline=void 0):c.onfinish=()=>{const{onComplete:h}=this.options;o.set(Yh(t,this.options,n)),h&&h(),this.cancel(),this.resolveFinishedPromise()},{animation:c,duration:r,times:i,type:a,ease:s,keyframes:t}}get duration(){const{resolved:t}=this;if(!t)return 0;const{duration:n}=t;return Rs(n)}get time(){const{resolved:t}=this;if(!t)return 0;const{animation:n}=t;return Rs(n.currentTime||0)}set time(t){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.currentTime=As(t)}get speed(){const{resolved:t}=this;if(!t)return 1;const{animation:n}=t;return n.playbackRate}set speed(t){const{resolved:n}=this;if(!n)return;const{animation:r}=n;r.playbackRate=t}get state(){const{resolved:t}=this;if(!t)return"idle";const{animation:n}=t;return n.playState}get startTime(){const{resolved:t}=this;if(!t)return null;const{animation:n}=t;return n.startTime}attachTimeline(t){if(!this._resolved)this.pendingTimeline=t;else{const{resolved:n}=this;if(!n)return Xr;const{animation:r}=n;CT(r,t)}return Xr}play(){if(this.isStopped)return;const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.playState==="finished"&&this.updateFinishedPromise(),n.play()}pause(){const{resolved:t}=this;if(!t)return;const{animation:n}=t;n.pause()}stop(){if(this.resolver.cancel(),this.isStopped=!0,this.state==="idle")return;this.resolveFinishedPromise(),this.updateFinishedPromise();const{resolved:t}=this;if(!t)return;const{animation:n,keyframes:r,duration:i,type:s,ease:a,times:o}=t;if(n.playState==="idle"||n.playState==="finished")return;if(this.time){const{motionValue:u,onUpdate:c,onComplete:h,element:p,...m}=this.options,v=new g1({...m,keyframes:r,duration:i,type:s,ease:a,times:o,isGenerator:!0}),g=As(this.time);u.setWithVelocity(v.sample(g-Q0).value,v.sample(g).value,Q0)}const{onStop:l}=this.options;l&&l(),this.cancel()}complete(){const{resolved:t}=this;t&&t.animation.finish()}cancel(){const{resolved:t}=this;t&&t.animation.cancel()}static supports(t){const{motionValue:n,name:r,repeatDelay:i,repeatType:s,damping:a,type:o}=t;if(!n||!n.owner||!(n.owner.current instanceof HTMLElement))return!1;const{onUpdate:l,transformTemplate:u}=n.owner.getProps();return e6()&&r&&jO.has(r)&&!l&&!u&&!i&&s!=="mirror"&&a!==0&&o!=="inertia"}}const s6={type:"spring",stiffness:500,damping:25,restSpeed:10},a6=e=>({type:"spring",stiffness:550,damping:e===0?2*Math.sqrt(550):30,restSpeed:10}),o6={type:"keyframes",duration:.8},l6={type:"keyframes",ease:[.25,.1,.35,1],duration:.3},u6=(e,{keyframes:t})=>t.length>2?o6:Ko.has(e)?e.startsWith("scale")?a6(t[1]):s6:l6;function c6({when:e,delay:t,delayChildren:n,staggerChildren:r,staggerDirection:i,repeat:s,repeatType:a,repeatDelay:o,from:l,elapsed:u,...c}){return!!Object.keys(c).length}const v1=(e,t,n,r={},i,s)=>a=>{const o=n1(r,e)||{},l=o.delay||r.delay||0;let{elapsed:u=0}=r;u=u-As(l);let c={keyframes:Array.isArray(n)?n:[null,n],ease:"easeOut",velocity:t.getVelocity(),...o,delay:-u,onUpdate:p=>{t.set(p),o.onUpdate&&o.onUpdate(p)},onComplete:()=>{a(),o.onComplete&&o.onComplete()},name:e,motionValue:t,element:s?void 0:i};c6(o)||(c={...c,...u6(e,c)}),c.duration&&(c.duration=As(c.duration)),c.repeatDelay&&(c.repeatDelay=As(c.repeatDelay)),c.from!==void 0&&(c.keyframes[0]=c.from);let h=!1;if((c.type===!1||c.duration===0&&!c.repeatDelay)&&(c.duration=0,c.delay===0&&(h=!0)),h&&!s&&t.get()!==void 0){const p=Yh(c.keyframes,o);if(p!==void 0)return en.update(()=>{c.onUpdate(p),c.onComplete()}),new M8([])}return!s&&$T.supports(c)?new $T(c):new g1(c)};function f6({protectedKeys:e,needsAnimating:t},n){const r=e.hasOwnProperty(n)&&t[n]!==!0;return t[n]=!1,r}function nM(e,t,{delay:n=0,transitionOverride:r,type:i}={}){var s;let{transition:a=e.getDefaultTransition(),transitionEnd:o,...l}=t;r&&(a=r);const u=[],c=i&&e.animationState&&e.animationState.getState()[i];for(const h in l){const p=e.getValue(h,(s=e.latestValues[h])!==null&&s!==void 0?s:null),m=l[h];if(m===void 0||c&&f6(c,h))continue;const v={delay:n,...n1(a||{},h)};let g=!1;if(window.MotionHandoffAnimation){const x=kR(e);if(x){const T=window.MotionHandoffAnimation(x,h,en);T!==null&&(v.startTime=T,g=!0)}}kg(e,h),p.start(v1(h,p,m,e.shouldReduceMotion&&_R.has(h)?{type:!1}:v,e,g));const w=p.animation;w&&u.push(w)}return o&&Promise.all(u).then(()=>{en.update(()=>{o&&z8(e,o)})}),u}function Ig(e,t,n={}){var r;const i=Kh(e,t,n.type==="exit"?(r=e.presenceContext)===null||r===void 0?void 0:r.custom:void 0);let{transition:s=e.getDefaultTransition()||{}}=i||{};n.transitionOverride&&(s=n.transitionOverride);const a=i?()=>Promise.all(nM(e,i,n)):()=>Promise.resolve(),o=e.variantChildren&&e.variantChildren.size?(u=0)=>{const{delayChildren:c=0,staggerChildren:h,staggerDirection:p}=s;return d6(e,t,c+u,h,p,n)}:()=>Promise.resolve(),{when:l}=s;if(l){const[u,c]=l==="beforeChildren"?[a,o]:[o,a];return u().then(()=>c())}else return Promise.all([a(),o(n.delay)])}function d6(e,t,n=0,r=0,i=1,s){const a=[],o=(e.variantChildren.size-1)*r,l=i===1?(u=0)=>u*r:(u=0)=>o-u*r;return Array.from(e.variantChildren).sort(h6).forEach((u,c)=>{u.notify("AnimationStart",t),a.push(Ig(u,t,{...s,delay:n+l(c)}).then(()=>u.notify("AnimationComplete",t)))}),Promise.all(a)}function h6(e,t){return e.sortNodePosition(t)}function p6(e,t,n={}){e.notify("AnimationStart",t);let r;if(Array.isArray(t)){const i=t.map(s=>Ig(e,s,n));r=Promise.all(i)}else if(typeof t=="string")r=Ig(e,t,n);else{const i=typeof t=="function"?Kh(e,t,n.custom):t;r=Promise.all(nM(e,i,n))}return r.then(()=>{e.notify("AnimationComplete",t)})}const m6=Wx.length;function rM(e){if(!e)return;if(!e.isControllingVariants){const n=e.parent?rM(e.parent)||{}:{};return e.props.initial!==void 0&&(n.initial=e.props.initial),n}const t={};for(let n=0;n<m6;n++){const r=Wx[n],i=e.props[r];(sf(i)||i===!1)&&(t[r]=i)}return t}const g6=[...zx].reverse(),v6=zx.length;function x6(e){return t=>Promise.all(t.map(({animation:n,options:r})=>p6(e,n,r)))}function y6(e){let t=x6(e),n=zT(),r=!0;const i=l=>(u,c)=>{var h;const p=Kh(e,c,l==="exit"?(h=e.presenceContext)===null||h===void 0?void 0:h.custom:void 0);if(p){const{transition:m,transitionEnd:v,...g}=p;u={...u,...g,...v}}return u};function s(l){t=l(e)}function a(l){const{props:u}=e,c=rM(e.parent)||{},h=[],p=new Set;let m={},v=1/0;for(let w=0;w<v6;w++){const x=g6[w],T=n[x],y=u[x]!==void 0?u[x]:c[x],_=sf(y),k=x===l?T.isActive:null;k===!1&&(v=w);let S=y===c[x]&&y!==u[x]&&_;if(S&&r&&e.manuallyAnimateOnMount&&(S=!1),T.protectedKeys={...m},!T.isActive&&k===null||!y&&!T.prevProp||Gh(y)||typeof y=="boolean")continue;const C=w6(T.prevProp,y);let M=C||x===l&&T.isActive&&!S&&_||w>v&&_,F=!1;const b=Array.isArray(y)?y:[y];let V=b.reduce(i(x),{});k===!1&&(V={});const{prevResolvedValues:z={}}=T,ie={...z,...V},Q=ae=>{M=!0,p.has(ae)&&(F=!0,p.delete(ae)),T.needsAnimating[ae]=!0;const ne=e.getValue(ae);ne&&(ne.liveStyle=!1)};for(const ae in ie){const ne=V[ae],H=z[ae];if(m.hasOwnProperty(ae))continue;let fe=!1;Eg(ne)&&Eg(H)?fe=!gR(ne,H):fe=ne!==H,fe?ne!=null?Q(ae):p.add(ae):ne!==void 0&&p.has(ae)?Q(ae):T.protectedKeys[ae]=!0}T.prevProp=y,T.prevResolvedValues=V,T.isActive&&(m={...m,...V}),r&&e.blockInitialAnimation&&(M=!1),M&&(!(S&&C)||F)&&h.push(...b.map(ae=>({animation:ae,options:{type:x}})))}if(p.size){const w={};p.forEach(x=>{const T=e.getBaseTarget(x),y=e.getValue(x);y&&(y.liveStyle=!0),w[x]=T??null}),h.push({animation:w})}let g=!!h.length;return r&&(u.initial===!1||u.initial===u.animate)&&!e.manuallyAnimateOnMount&&(g=!1),r=!1,g?t(h):Promise.resolve()}function o(l,u){var c;if(n[l].isActive===u)return Promise.resolve();(c=e.variantChildren)===null||c===void 0||c.forEach(p=>{var m;return(m=p.animationState)===null||m===void 0?void 0:m.setActive(l,u)}),n[l].isActive=u;const h=a(l);for(const p in n)n[p].protectedKeys={};return h}return{animateChanges:a,setActive:o,setAnimateFunction:s,getState:()=>n,reset:()=>{n=zT(),r=!0}}}function w6(e,t){return typeof t=="string"?t!==e:Array.isArray(t)?!gR(t,e):!1}function Ya(e=!1){return{isActive:e,protectedKeys:{},needsAnimating:{},prevResolvedValues:{}}}function zT(){return{animate:Ya(!0),whileInView:Ya(),whileHover:Ya(),whileTap:Ya(),whileDrag:Ya(),whileFocus:Ya(),exit:Ya()}}class za{constructor(t){this.isMounted=!1,this.node=t}update(){}}class T6 extends za{constructor(t){super(t),t.animationState||(t.animationState=y6(t))}updateAnimationControlsSubscription(){const{animate:t}=this.node.getProps();Gh(t)&&(this.unmountControls=t.subscribe(this.node))}mount(){this.updateAnimationControlsSubscription()}update(){const{animate:t}=this.node.getProps(),{animate:n}=this.node.prevProps||{};t!==n&&this.updateAnimationControlsSubscription()}unmount(){var t;this.node.animationState.reset(),(t=this.unmountControls)===null||t===void 0||t.call(this)}}let S6=0;class E6 extends za{constructor(){super(...arguments),this.id=S6++}update(){if(!this.node.presenceContext)return;const{isPresent:t,onExitComplete:n}=this.node.presenceContext,{isPresent:r}=this.node.prevPresenceContext||{};if(!this.node.animationState||t===r)return;const i=this.node.animationState.setActive("exit",!t);n&&!t&&i.then(()=>n(this.id))}mount(){const{register:t}=this.node.presenceContext||{};t&&(this.unmount=t(this.id))}unmount(){}}const _6={animation:{Feature:T6},exit:{Feature:E6}};function uf(e,t,n,r={passive:!0}){return e.addEventListener(t,n,r),()=>e.removeEventListener(t,n)}function Wf(e){return{point:{x:e.pageX,y:e.pageY}}}const C6=e=>t=>s1(t)&&e(t,Wf(t));function Ec(e,t,n,r){return uf(e,t,C6(n),r)}const WT=(e,t)=>Math.abs(e-t);function k6(e,t){const n=WT(e.x,t.x),r=WT(e.y,t.y);return Math.sqrt(n**2+r**2)}class iM{constructor(t,n,{transformPagePoint:r,contextWindow:i,dragSnapToOrigin:s=!1}={}){if(this.startEvent=null,this.lastMoveEvent=null,this.lastMoveEventInfo=null,this.handlers={},this.contextWindow=window,this.updatePoint=()=>{if(!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const h=Zp(this.lastMoveEventInfo,this.history),p=this.startEvent!==null,m=k6(h.offset,{x:0,y:0})>=3;if(!p&&!m)return;const{point:v}=h,{timestamp:g}=Xn;this.history.push({...v,timestamp:g});const{onStart:w,onMove:x}=this.handlers;p||(w&&w(this.lastMoveEvent,h),this.startEvent=this.lastMoveEvent),x&&x(this.lastMoveEvent,h)},this.handlePointerMove=(h,p)=>{this.lastMoveEvent=h,this.lastMoveEventInfo=jp(p,this.transformPagePoint),en.update(this.updatePoint,!0)},this.handlePointerUp=(h,p)=>{this.end();const{onEnd:m,onSessionEnd:v,resumeAnimation:g}=this.handlers;if(this.dragSnapToOrigin&&g&&g(),!(this.lastMoveEvent&&this.lastMoveEventInfo))return;const w=Zp(h.type==="pointercancel"?this.lastMoveEventInfo:jp(p,this.transformPagePoint),this.history);this.startEvent&&m&&m(h,w),v&&v(h,w)},!s1(t))return;this.dragSnapToOrigin=s,this.handlers=n,this.transformPagePoint=r,this.contextWindow=i||window;const a=Wf(t),o=jp(a,this.transformPagePoint),{point:l}=o,{timestamp:u}=Xn;this.history=[{...l,timestamp:u}];const{onSessionStart:c}=n;c&&c(t,Zp(o,this.history)),this.removeListeners=zf(Ec(this.contextWindow,"pointermove",this.handlePointerMove),Ec(this.contextWindow,"pointerup",this.handlePointerUp),Ec(this.contextWindow,"pointercancel",this.handlePointerUp))}updateHandlers(t){this.handlers=t}end(){this.removeListeners&&this.removeListeners(),Pa(this.updatePoint)}}function jp(e,t){return t?{point:t(e.point)}:e}function GT(e,t){return{x:e.x-t.x,y:e.y-t.y}}function Zp({point:e},t){return{point:e,delta:GT(e,sM(t)),offset:GT(e,A6(t)),velocity:R6(t,.1)}}function A6(e){return e[0]}function sM(e){return e[e.length-1]}function R6(e,t){if(e.length<2)return{x:0,y:0};let n=e.length-1,r=null;const i=sM(e);for(;n>=0&&(r=e[n],!(i.timestamp-r.timestamp>As(t)));)n--;if(!r)return{x:0,y:0};const s=Rs(i.timestamp-r.timestamp);if(s===0)return{x:0,y:0};const a={x:(i.x-r.x)/s,y:(i.y-r.y)/s};return a.x===1/0&&(a.x=0),a.y===1/0&&(a.y=0),a}const aM=1e-4,M6=1-aM,F6=1+aM,oM=.01,D6=0-oM,P6=0+oM;function jr(e){return e.max-e.min}function I6(e,t,n){return Math.abs(e-t)<=n}function qT(e,t,n,r=.5){e.origin=r,e.originPoint=an(t.min,t.max,e.origin),e.scale=jr(n)/jr(t),e.translate=an(n.min,n.max,e.origin)-e.originPoint,(e.scale>=M6&&e.scale<=F6||isNaN(e.scale))&&(e.scale=1),(e.translate>=D6&&e.translate<=P6||isNaN(e.translate))&&(e.translate=0)}function _c(e,t,n,r){qT(e.x,t.x,n.x,r?r.originX:void 0),qT(e.y,t.y,n.y,r?r.originY:void 0)}function KT(e,t,n){e.min=n.min+t.min,e.max=e.min+jr(t)}function N6(e,t,n){KT(e.x,t.x,n.x),KT(e.y,t.y,n.y)}function YT(e,t,n){e.min=t.min-n.min,e.max=e.min+jr(t)}function Cc(e,t,n){YT(e.x,t.x,n.x),YT(e.y,t.y,n.y)}function b6(e,{min:t,max:n},r){return t!==void 0&&e<t?e=r?an(t,e,r.min):Math.max(e,t):n!==void 0&&e>n&&(e=r?an(n,e,r.max):Math.min(e,n)),e}function XT(e,t,n){return{min:t!==void 0?e.min+t:void 0,max:n!==void 0?e.max+n-(e.max-e.min):void 0}}function L6(e,{top:t,left:n,bottom:r,right:i}){return{x:XT(e.x,n,i),y:XT(e.y,t,r)}}function JT(e,t){let n=t.min-e.min,r=t.max-e.max;return t.max-t.min<e.max-e.min&&([n,r]=[r,n]),{min:n,max:r}}function O6(e,t){return{x:JT(e.x,t.x),y:JT(e.y,t.y)}}function B6(e,t){let n=.5;const r=jr(e),i=jr(t);return i>r?n=hu(t.min,t.max-r,e.min):r>i&&(n=hu(e.min,e.max-i,t.min)),Bs(0,1,n)}function U6(e,t){const n={};return t.min!==void 0&&(n.min=t.min-e.min),t.max!==void 0&&(n.max=t.max-e.min),n}const Ng=.35;function V6(e=Ng){return e===!1?e=0:e===!0&&(e=Ng),{x:QT(e,"left","right"),y:QT(e,"top","bottom")}}function QT(e,t,n){return{min:jT(e,t),max:jT(e,n)}}function jT(e,t){return typeof e=="number"?e:e[t]||0}const ZT=()=>({translate:0,scale:1,origin:0,originPoint:0}),kl=()=>({x:ZT(),y:ZT()}),eS=()=>({min:0,max:0}),wn=()=>({x:eS(),y:eS()});function li(e){return[e("x"),e("y")]}function lM({top:e,left:t,right:n,bottom:r}){return{x:{min:t,max:n},y:{min:e,max:r}}}function H6({x:e,y:t}){return{top:t.min,right:e.max,bottom:t.max,left:e.min}}function $6(e,t){if(!t)return e;const n=t({x:e.left,y:e.top}),r=t({x:e.right,y:e.bottom});return{top:n.y,left:n.x,bottom:r.y,right:r.x}}function em(e){return e===void 0||e===1}function bg({scale:e,scaleX:t,scaleY:n}){return!em(e)||!em(t)||!em(n)}function Qa(e){return bg(e)||uM(e)||e.z||e.rotate||e.rotateX||e.rotateY||e.skewX||e.skewY}function uM(e){return tS(e.x)||tS(e.y)}function tS(e){return e&&e!=="0%"}function j0(e,t,n){const r=e-n,i=t*r;return n+i}function nS(e,t,n,r,i){return i!==void 0&&(e=j0(e,i,r)),j0(e,n,r)+t}function Lg(e,t=0,n=1,r,i){e.min=nS(e.min,t,n,r,i),e.max=nS(e.max,t,n,r,i)}function cM(e,{x:t,y:n}){Lg(e.x,t.translate,t.scale,t.originPoint),Lg(e.y,n.translate,n.scale,n.originPoint)}const rS=.999999999999,iS=1.0000000000001;function z6(e,t,n,r=!1){const i=n.length;if(!i)return;t.x=t.y=1;let s,a;for(let o=0;o<i;o++){s=n[o],a=s.projectionDelta;const{visualElement:l}=s.options;l&&l.props.style&&l.props.style.display==="contents"||(r&&s.options.layoutScroll&&s.scroll&&s!==s.root&&Rl(e,{x:-s.scroll.offset.x,y:-s.scroll.offset.y}),a&&(t.x*=a.x.scale,t.y*=a.y.scale,cM(e,a)),r&&Qa(s.latestValues)&&Rl(e,s.latestValues))}t.x<iS&&t.x>rS&&(t.x=1),t.y<iS&&t.y>rS&&(t.y=1)}function Al(e,t){e.min=e.min+t,e.max=e.max+t}function sS(e,t,n,r,i=.5){const s=an(e.min,e.max,i);Lg(e,t,n,s,r)}function Rl(e,t){sS(e.x,t.x,t.scaleX,t.scale,t.originX),sS(e.y,t.y,t.scaleY,t.scale,t.originY)}function fM(e,t){return lM($6(e.getBoundingClientRect(),t))}function W6(e,t,n){const r=fM(e,n),{scroll:i}=t;return i&&(Al(r.x,i.offset.x),Al(r.y,i.offset.y)),r}const dM=({current:e})=>e?e.ownerDocument.defaultView:null,G6=new WeakMap;class q6{constructor(t){this.openDragLock=null,this.isDragging=!1,this.currentDirection=null,this.originPoint={x:0,y:0},this.constraints=!1,this.hasMutatedConstraints=!1,this.elastic=wn(),this.visualElement=t}start(t,{snapToCursor:n=!1}={}){const{presenceContext:r}=this.visualElement;if(r&&r.isPresent===!1)return;const i=c=>{const{dragSnapToOrigin:h}=this.getProps();h?this.pauseAnimation():this.stopAnimation(),n&&this.snapToCursor(Wf(c).point)},s=(c,h)=>{const{drag:p,dragPropagation:m,onDragStart:v}=this.getProps();if(p&&!m&&(this.openDragLock&&this.openDragLock(),this.openDragLock=B8(p),!this.openDragLock))return;this.isDragging=!0,this.currentDirection=null,this.resolveConstraints(),this.visualElement.projection&&(this.visualElement.projection.isAnimationBlocked=!0,this.visualElement.projection.target=void 0),li(w=>{let x=this.getAxisMotionValue(w).get()||0;if(as.test(x)){const{projection:T}=this.visualElement;if(T&&T.layout){const y=T.layout.layoutBox[w];y&&(x=jr(y)*(parseFloat(x)/100))}}this.originPoint[w]=x}),v&&en.postRender(()=>v(c,h)),kg(this.visualElement,"transform");const{animationState:g}=this.visualElement;g&&g.setActive("whileDrag",!0)},a=(c,h)=>{const{dragPropagation:p,dragDirectionLock:m,onDirectionLock:v,onDrag:g}=this.getProps();if(!p&&!this.openDragLock)return;const{offset:w}=h;if(m&&this.currentDirection===null){this.currentDirection=K6(w),this.currentDirection!==null&&v&&v(this.currentDirection);return}this.updateAxis("x",h.point,w),this.updateAxis("y",h.point,w),this.visualElement.render(),g&&g(c,h)},o=(c,h)=>this.stop(c,h),l=()=>li(c=>{var h;return this.getAnimationState(c)==="paused"&&((h=this.getAxisMotionValue(c).animation)===null||h===void 0?void 0:h.play())}),{dragSnapToOrigin:u}=this.getProps();this.panSession=new iM(t,{onSessionStart:i,onStart:s,onMove:a,onSessionEnd:o,resumeAnimation:l},{transformPagePoint:this.visualElement.getTransformPagePoint(),dragSnapToOrigin:u,contextWindow:dM(this.visualElement)})}stop(t,n){const r=this.isDragging;if(this.cancel(),!r)return;const{velocity:i}=n;this.startAnimation(i);const{onDragEnd:s}=this.getProps();s&&en.postRender(()=>s(t,n))}cancel(){this.isDragging=!1;const{projection:t,animationState:n}=this.visualElement;t&&(t.isAnimationBlocked=!1),this.panSession&&this.panSession.end(),this.panSession=void 0;const{dragPropagation:r}=this.getProps();!r&&this.openDragLock&&(this.openDragLock(),this.openDragLock=null),n&&n.setActive("whileDrag",!1)}updateAxis(t,n,r){const{drag:i}=this.getProps();if(!r||!Dd(t,i,this.currentDirection))return;const s=this.getAxisMotionValue(t);let a=this.originPoint[t]+r[t];this.constraints&&this.constraints[t]&&(a=b6(a,this.constraints[t],this.elastic[t])),s.set(a)}resolveConstraints(){var t;const{dragConstraints:n,dragElastic:r}=this.getProps(),i=this.visualElement.projection&&!this.visualElement.projection.layout?this.visualElement.projection.measure(!1):(t=this.visualElement.projection)===null||t===void 0?void 0:t.layout,s=this.constraints;n&&_l(n)?this.constraints||(this.constraints=this.resolveRefConstraints()):n&&i?this.constraints=L6(i.layoutBox,n):this.constraints=!1,this.elastic=V6(r),s!==this.constraints&&i&&this.constraints&&!this.hasMutatedConstraints&&li(a=>{this.constraints!==!1&&this.getAxisMotionValue(a)&&(this.constraints[a]=U6(i.layoutBox[a],this.constraints[a]))})}resolveRefConstraints(){const{dragConstraints:t,onMeasureDragConstraints:n}=this.getProps();if(!t||!_l(t))return!1;const r=t.current,{projection:i}=this.visualElement;if(!i||!i.layout)return!1;const s=W6(r,i.root,this.visualElement.getTransformPagePoint());let a=O6(i.layout.layoutBox,s);if(n){const o=n(H6(a));this.hasMutatedConstraints=!!o,o&&(a=lM(o))}return a}startAnimation(t){const{drag:n,dragMomentum:r,dragElastic:i,dragTransition:s,dragSnapToOrigin:a,onDragTransitionEnd:o}=this.getProps(),l=this.constraints||{},u=li(c=>{if(!Dd(c,n,this.currentDirection))return;let h=l&&l[c]||{};a&&(h={min:0,max:0});const p=i?200:1e6,m=i?40:1e7,v={type:"inertia",velocity:r?t[c]:0,bounceStiffness:p,bounceDamping:m,timeConstant:750,restDelta:1,restSpeed:10,...s,...h};return this.startAxisValueAnimation(c,v)});return Promise.all(u).then(o)}startAxisValueAnimation(t,n){const r=this.getAxisMotionValue(t);return kg(this.visualElement,t),r.start(v1(t,r,0,n,this.visualElement,!1))}stopAnimation(){li(t=>this.getAxisMotionValue(t).stop())}pauseAnimation(){li(t=>{var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.pause()})}getAnimationState(t){var n;return(n=this.getAxisMotionValue(t).animation)===null||n===void 0?void 0:n.state}getAxisMotionValue(t){const n=`_drag${t.toUpperCase()}`,r=this.visualElement.getProps(),i=r[n];return i||this.visualElement.getValue(t,(r.initial?r.initial[t]:void 0)||0)}snapToCursor(t){li(n=>{const{drag:r}=this.getProps();if(!Dd(n,r,this.currentDirection))return;const{projection:i}=this.visualElement,s=this.getAxisMotionValue(n);if(i&&i.layout){const{min:a,max:o}=i.layout.layoutBox[n];s.set(t[n]-an(a,o,.5))}})}scalePositionWithinConstraints(){if(!this.visualElement.current)return;const{drag:t,dragConstraints:n}=this.getProps(),{projection:r}=this.visualElement;if(!_l(n)||!r||!this.constraints)return;this.stopAnimation();const i={x:0,y:0};li(a=>{const o=this.getAxisMotionValue(a);if(o&&this.constraints!==!1){const l=o.get();i[a]=B6({min:l,max:l},this.constraints[a])}});const{transformTemplate:s}=this.visualElement.getProps();this.visualElement.current.style.transform=s?s({},""):"none",r.root&&r.root.updateScroll(),r.updateLayout(),this.resolveConstraints(),li(a=>{if(!Dd(a,t,null))return;const o=this.getAxisMotionValue(a),{min:l,max:u}=this.constraints[a];o.set(an(l,u,i[a]))})}addListeners(){if(!this.visualElement.current)return;G6.set(this.visualElement,this);const t=this.visualElement.current,n=Ec(t,"pointerdown",l=>{const{drag:u,dragListener:c=!0}=this.getProps();u&&c&&this.start(l)}),r=()=>{const{dragConstraints:l}=this.getProps();_l(l)&&l.current&&(this.constraints=this.resolveRefConstraints())},{projection:i}=this.visualElement,s=i.addEventListener("measure",r);i&&!i.layout&&(i.root&&i.root.updateScroll(),i.updateLayout()),en.read(r);const a=uf(window,"resize",()=>this.scalePositionWithinConstraints()),o=i.addEventListener("didUpdate",({delta:l,hasLayoutChanged:u})=>{this.isDragging&&u&&(li(c=>{const h=this.getAxisMotionValue(c);h&&(this.originPoint[c]+=l[c].translate,h.set(h.get()+l[c].translate))}),this.visualElement.render())});return()=>{a(),n(),s(),o&&o()}}getProps(){const t=this.visualElement.getProps(),{drag:n=!1,dragDirectionLock:r=!1,dragPropagation:i=!1,dragConstraints:s=!1,dragElastic:a=Ng,dragMomentum:o=!0}=t;return{...t,drag:n,dragDirectionLock:r,dragPropagation:i,dragConstraints:s,dragElastic:a,dragMomentum:o}}}function Dd(e,t,n){return(t===!0||t===e)&&(n===null||n===e)}function K6(e,t=10){let n=null;return Math.abs(e.y)>t?n="y":Math.abs(e.x)>t&&(n="x"),n}class Y6 extends za{constructor(t){super(t),this.removeGroupControls=Xr,this.removeListeners=Xr,this.controls=new q6(t)}mount(){const{dragControls:t}=this.node.getProps();t&&(this.removeGroupControls=t.subscribe(this.controls)),this.removeListeners=this.controls.addListeners()||Xr}unmount(){this.removeGroupControls(),this.removeListeners()}}const aS=e=>(t,n)=>{e&&en.postRender(()=>e(t,n))};class X6 extends za{constructor(){super(...arguments),this.removePointerDownListener=Xr}onPointerDown(t){this.session=new iM(t,this.createPanHandlers(),{transformPagePoint:this.node.getTransformPagePoint(),contextWindow:dM(this.node)})}createPanHandlers(){const{onPanSessionStart:t,onPanStart:n,onPan:r,onPanEnd:i}=this.node.getProps();return{onSessionStart:aS(t),onStart:aS(n),onMove:r,onEnd:(s,a)=>{delete this.session,i&&en.postRender(()=>i(s,a))}}}mount(){this.removePointerDownListener=Ec(this.node.current,"pointerdown",t=>this.onPointerDown(t))}update(){this.session&&this.session.updateHandlers(this.createPanHandlers())}unmount(){this.removePointerDownListener(),this.session&&this.session.end()}}const h0={hasAnimatedSinceResize:!0,hasEverUpdated:!1};function oS(e,t){return t.max===t.min?0:e/(t.max-t.min)*100}const ju={correct:(e,t)=>{if(!t.target)return e;if(typeof e=="string")if(Ze.test(e))e=parseFloat(e);else return e;const n=oS(e,t.target.x),r=oS(e,t.target.y);return`${n}% ${r}%`}},J6={correct:(e,{treeScale:t,projectionDelta:n})=>{const r=e,i=Ia.parse(e);if(i.length>5)return r;const s=Ia.createTransformer(e),a=typeof i[0]!="number"?1:0,o=n.x.scale*t.x,l=n.y.scale*t.y;i[0+a]/=o,i[1+a]/=l;const u=an(o,l,.5);return typeof i[2+a]=="number"&&(i[2+a]/=u),typeof i[3+a]=="number"&&(i[3+a]/=u),s(i)}};class Q6 extends E.Component{componentDidMount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r,layoutId:i}=this.props,{projection:s}=t;v8(j6),s&&(n.group&&n.group.add(s),r&&r.register&&i&&r.register(s),s.root.didUpdate(),s.addEventListener("animationComplete",()=>{this.safeToRemove()}),s.setOptions({...s.options,onExitComplete:()=>this.safeToRemove()})),h0.hasEverUpdated=!0}getSnapshotBeforeUpdate(t){const{layoutDependency:n,visualElement:r,drag:i,isPresent:s}=this.props,a=r.projection;return a&&(a.isPresent=s,i||t.layoutDependency!==n||n===void 0?a.willUpdate():this.safeToRemove(),t.isPresent!==s&&(s?a.promote():a.relegate()||en.postRender(()=>{const o=a.getStack();(!o||!o.members.length)&&this.safeToRemove()}))),null}componentDidUpdate(){const{projection:t}=this.props.visualElement;t&&(t.root.didUpdate(),qx.postRender(()=>{!t.currentAnimation&&t.isLead()&&this.safeToRemove()}))}componentWillUnmount(){const{visualElement:t,layoutGroup:n,switchLayoutGroup:r}=this.props,{projection:i}=t;i&&(i.scheduleCheckAfterUnmount(),n&&n.group&&n.group.remove(i),r&&r.deregister&&r.deregister(i))}safeToRemove(){const{safeToRemove:t}=this.props;t&&t()}render(){return null}}function hM(e){const[t,n]=XA(),r=E.useContext(Bx);return R.jsx(Q6,{...e,layoutGroup:r,switchLayoutGroup:E.useContext(rR),isPresent:t,safeToRemove:n})}const j6={borderRadius:{...ju,applyTo:["borderTopLeftRadius","borderTopRightRadius","borderBottomLeftRadius","borderBottomRightRadius"]},borderTopLeftRadius:ju,borderTopRightRadius:ju,borderBottomLeftRadius:ju,borderBottomRightRadius:ju,boxShadow:J6};function Z6(e,t,n){const r=cr(e)?e:of(e);return r.start(v1("",r,t,n)),r.animation}function e5(e){return e instanceof SVGElement&&e.tagName!=="svg"}const t5=(e,t)=>e.depth-t.depth;class n5{constructor(){this.children=[],this.isDirty=!1}add(t){a1(this.children,t),this.isDirty=!0}remove(t){o1(this.children,t),this.isDirty=!0}forEach(t){this.isDirty&&this.children.sort(t5),this.isDirty=!1,this.children.forEach(t)}}function r5(e,t){const n=os.now(),r=({timestamp:i})=>{const s=i-n;s>=t&&(Pa(r),e(s-t))};return en.read(r,!0),()=>Pa(r)}const pM=["TopLeft","TopRight","BottomLeft","BottomRight"],i5=pM.length,lS=e=>typeof e=="string"?parseFloat(e):e,uS=e=>typeof e=="number"||Ze.test(e);function s5(e,t,n,r,i,s){i?(e.opacity=an(0,n.opacity!==void 0?n.opacity:1,a5(r)),e.opacityExit=an(t.opacity!==void 0?t.opacity:1,0,o5(r))):s&&(e.opacity=an(t.opacity!==void 0?t.opacity:1,n.opacity!==void 0?n.opacity:1,r));for(let a=0;a<i5;a++){const o=`border${pM[a]}Radius`;let l=cS(t,o),u=cS(n,o);if(l===void 0&&u===void 0)continue;l||(l=0),u||(u=0),l===0||u===0||uS(l)===uS(u)?(e[o]=Math.max(an(lS(l),lS(u),r),0),(as.test(u)||as.test(l))&&(e[o]+="%")):e[o]=u}(t.rotate||n.rotate)&&(e.rotate=an(t.rotate||0,n.rotate||0,r))}function cS(e,t){return e[t]!==void 0?e[t]:e.borderRadius}const a5=mM(0,.5,IR),o5=mM(.5,.95,Xr);function mM(e,t,n){return r=>r<e?0:r>t?1:n(hu(e,t,r))}function fS(e,t){e.min=t.min,e.max=t.max}function ni(e,t){fS(e.x,t.x),fS(e.y,t.y)}function dS(e,t){e.translate=t.translate,e.scale=t.scale,e.originPoint=t.originPoint,e.origin=t.origin}function hS(e,t,n,r,i){return e-=t,e=j0(e,1/n,r),i!==void 0&&(e=j0(e,1/i,r)),e}function l5(e,t=0,n=1,r=.5,i,s=e,a=e){if(as.test(t)&&(t=parseFloat(t),t=an(a.min,a.max,t/100)-a.min),typeof t!="number")return;let o=an(s.min,s.max,r);e===s&&(o-=t),e.min=hS(e.min,t,n,o,i),e.max=hS(e.max,t,n,o,i)}function pS(e,t,[n,r,i],s,a){l5(e,t[n],t[r],t[i],t.scale,s,a)}const u5=["x","scaleX","originX"],c5=["y","scaleY","originY"];function mS(e,t,n,r){pS(e.x,t,u5,n?n.x:void 0,r?r.x:void 0),pS(e.y,t,c5,n?n.y:void 0,r?r.y:void 0)}function gS(e){return e.translate===0&&e.scale===1}function gM(e){return gS(e.x)&&gS(e.y)}function vS(e,t){return e.min===t.min&&e.max===t.max}function f5(e,t){return vS(e.x,t.x)&&vS(e.y,t.y)}function xS(e,t){return Math.round(e.min)===Math.round(t.min)&&Math.round(e.max)===Math.round(t.max)}function vM(e,t){return xS(e.x,t.x)&&xS(e.y,t.y)}function yS(e){return jr(e.x)/jr(e.y)}function wS(e,t){return e.translate===t.translate&&e.scale===t.scale&&e.originPoint===t.originPoint}class d5{constructor(){this.members=[]}add(t){a1(this.members,t),t.scheduleRender()}remove(t){if(o1(this.members,t),t===this.prevLead&&(this.prevLead=void 0),t===this.lead){const n=this.members[this.members.length-1];n&&this.promote(n)}}relegate(t){const n=this.members.findIndex(i=>t===i);if(n===0)return!1;let r;for(let i=n;i>=0;i--){const s=this.members[i];if(s.isPresent!==!1){r=s;break}}return r?(this.promote(r),!0):!1}promote(t,n){const r=this.lead;if(t!==r&&(this.prevLead=r,this.lead=t,t.show(),r)){r.instance&&r.scheduleRender(),t.scheduleRender(),t.resumeFrom=r,n&&(t.resumeFrom.preserveOpacity=!0),r.snapshot&&(t.snapshot=r.snapshot,t.snapshot.latestValues=r.animationValues||r.latestValues),t.root&&t.root.isUpdating&&(t.isLayoutDirty=!0);const{crossfade:i}=t.options;i===!1&&r.hide()}}exitAnimationComplete(){this.members.forEach(t=>{const{options:n,resumingFrom:r}=t;n.onExitComplete&&n.onExitComplete(),r&&r.options.onExitComplete&&r.options.onExitComplete()})}scheduleRender(){this.members.forEach(t=>{t.instance&&t.scheduleRender(!1)})}removeLeadSnapshot(){this.lead&&this.lead.snapshot&&(this.lead.snapshot=void 0)}}function h5(e,t,n){let r="";const i=e.x.translate/t.x,s=e.y.translate/t.y,a=(n==null?void 0:n.z)||0;if((i||s||a)&&(r=`translate3d(${i}px, ${s}px, ${a}px) `),(t.x!==1||t.y!==1)&&(r+=`scale(${1/t.x}, ${1/t.y}) `),n){const{transformPerspective:u,rotate:c,rotateX:h,rotateY:p,skewX:m,skewY:v}=n;u&&(r=`perspective(${u}px) ${r}`),c&&(r+=`rotate(${c}deg) `),h&&(r+=`rotateX(${h}deg) `),p&&(r+=`rotateY(${p}deg) `),m&&(r+=`skewX(${m}deg) `),v&&(r+=`skewY(${v}deg) `)}const o=e.x.scale*t.x,l=e.y.scale*t.y;return(o!==1||l!==1)&&(r+=`scale(${o}, ${l})`),r||"none"}const ja={type:"projectionFrame",totalNodes:0,resolvedTargetDeltas:0,recalculatedProjection:0},lc=typeof window<"u"&&window.MotionDebug!==void 0,tm=["","X","Y","Z"],p5={visibility:"hidden"},TS=1e3;let m5=0;function nm(e,t,n,r){const{latestValues:i}=t;i[e]&&(n[e]=i[e],t.setStaticValue(e,0),r&&(r[e]=0))}function xM(e){if(e.hasCheckedOptimisedAppear=!0,e.root===e)return;const{visualElement:t}=e.options;if(!t)return;const n=kR(t);if(window.MotionHasOptimisedAnimation(n,"transform")){const{layout:i,layoutId:s}=e.options;window.MotionCancelOptimisedAnimation(n,"transform",en,!(i||s))}const{parent:r}=e;r&&!r.hasCheckedOptimisedAppear&&xM(r)}function yM({attachResizeListener:e,defaultParent:t,measureScroll:n,checkIsScrollRoot:r,resetTransform:i}){return class{constructor(a={},o=t==null?void 0:t()){this.id=m5++,this.animationId=0,this.children=new Set,this.options={},this.isTreeAnimating=!1,this.isAnimationBlocked=!1,this.isLayoutDirty=!1,this.isProjectionDirty=!1,this.isSharedProjectionDirty=!1,this.isTransformDirty=!1,this.updateManuallyBlocked=!1,this.updateBlockedByResize=!1,this.isUpdating=!1,this.isSVG=!1,this.needsReset=!1,this.shouldResetTransform=!1,this.hasCheckedOptimisedAppear=!1,this.treeScale={x:1,y:1},this.eventHandlers=new Map,this.hasTreeAnimated=!1,this.updateScheduled=!1,this.scheduleUpdate=()=>this.update(),this.projectionUpdateScheduled=!1,this.checkUpdateFailed=()=>{this.isUpdating&&(this.isUpdating=!1,this.clearAllSnapshots())},this.updateProjection=()=>{this.projectionUpdateScheduled=!1,lc&&(ja.totalNodes=ja.resolvedTargetDeltas=ja.recalculatedProjection=0),this.nodes.forEach(x5),this.nodes.forEach(E5),this.nodes.forEach(_5),this.nodes.forEach(y5),lc&&window.MotionDebug.record(ja)},this.resolvedRelativeTargetAt=0,this.hasProjected=!1,this.isVisible=!0,this.animationProgress=0,this.sharedNodes=new Map,this.latestValues=a,this.root=o?o.root||o:this,this.path=o?[...o.path,o]:[],this.parent=o,this.depth=o?o.depth+1:0;for(let l=0;l<this.path.length;l++)this.path[l].shouldResetTransform=!0;this.root===this&&(this.nodes=new n5)}addEventListener(a,o){return this.eventHandlers.has(a)||this.eventHandlers.set(a,new l1),this.eventHandlers.get(a).add(o)}notifyListeners(a,...o){const l=this.eventHandlers.get(a);l&&l.notify(...o)}hasListeners(a){return this.eventHandlers.has(a)}mount(a,o=this.root.hasTreeAnimated){if(this.instance)return;this.isSVG=e5(a),this.instance=a;const{layoutId:l,layout:u,visualElement:c}=this.options;if(c&&!c.current&&c.mount(a),this.root.nodes.add(this),this.parent&&this.parent.children.add(this),o&&(u||l)&&(this.isLayoutDirty=!0),e){let h;const p=()=>this.root.updateBlockedByResize=!1;e(a,()=>{this.root.updateBlockedByResize=!0,h&&h(),h=r5(p,250),h0.hasAnimatedSinceResize&&(h0.hasAnimatedSinceResize=!1,this.nodes.forEach(ES))})}l&&this.root.registerSharedNode(l,this),this.options.animate!==!1&&c&&(l||u)&&this.addEventListener("didUpdate",({delta:h,hasLayoutChanged:p,hasRelativeTargetChanged:m,layout:v})=>{if(this.isTreeAnimationBlocked()){this.target=void 0,this.relativeTarget=void 0;return}const g=this.options.transition||c.getDefaultTransition()||M5,{onLayoutAnimationStart:w,onLayoutAnimationComplete:x}=c.getProps(),T=!this.targetLayout||!vM(this.targetLayout,v)||m,y=!p&&m;if(this.options.layoutRoot||this.resumeFrom&&this.resumeFrom.instance||y||p&&(T||!this.currentAnimation)){this.resumeFrom&&(this.resumingFrom=this.resumeFrom,this.resumingFrom.resumingFrom=void 0),this.setAnimationOrigin(h,y);const _={...n1(g,"layout"),onPlay:w,onComplete:x};(c.shouldReduceMotion||this.options.layoutRoot)&&(_.delay=0,_.type=!1),this.startAnimation(_)}else p||ES(this),this.isLead()&&this.options.onExitComplete&&this.options.onExitComplete();this.targetLayout=v})}unmount(){this.options.layoutId&&this.willUpdate(),this.root.nodes.remove(this);const a=this.getStack();a&&a.remove(this),this.parent&&this.parent.children.delete(this),this.instance=void 0,Pa(this.updateProjection)}blockUpdate(){this.updateManuallyBlocked=!0}unblockUpdate(){this.updateManuallyBlocked=!1}isUpdateBlocked(){return this.updateManuallyBlocked||this.updateBlockedByResize}isTreeAnimationBlocked(){return this.isAnimationBlocked||this.parent&&this.parent.isTreeAnimationBlocked()||!1}startUpdate(){this.isUpdateBlocked()||(this.isUpdating=!0,this.nodes&&this.nodes.forEach(C5),this.animationId++)}getTransformTemplate(){const{visualElement:a}=this.options;return a&&a.getProps().transformTemplate}willUpdate(a=!0){if(this.root.hasTreeAnimated=!0,this.root.isUpdateBlocked()){this.options.onExitComplete&&this.options.onExitComplete();return}if(window.MotionCancelOptimisedAnimation&&!this.hasCheckedOptimisedAppear&&xM(this),!this.root.isUpdating&&this.root.startUpdate(),this.isLayoutDirty)return;this.isLayoutDirty=!0;for(let c=0;c<this.path.length;c++){const h=this.path[c];h.shouldResetTransform=!0,h.updateScroll("snapshot"),h.options.layoutRoot&&h.willUpdate(!1)}const{layoutId:o,layout:l}=this.options;if(o===void 0&&!l)return;const u=this.getTransformTemplate();this.prevTransformTemplateValue=u?u(this.latestValues,""):void 0,this.updateSnapshot(),a&&this.notifyListeners("willUpdate")}update(){if(this.updateScheduled=!1,this.isUpdateBlocked()){this.unblockUpdate(),this.clearAllSnapshots(),this.nodes.forEach(SS);return}this.isUpdating||this.nodes.forEach(T5),this.isUpdating=!1,this.nodes.forEach(S5),this.nodes.forEach(g5),this.nodes.forEach(v5),this.clearAllSnapshots();const o=os.now();Xn.delta=Bs(0,1e3/60,o-Xn.timestamp),Xn.timestamp=o,Xn.isProcessing=!0,qp.update.process(Xn),qp.preRender.process(Xn),qp.render.process(Xn),Xn.isProcessing=!1}didUpdate(){this.updateScheduled||(this.updateScheduled=!0,qx.read(this.scheduleUpdate))}clearAllSnapshots(){this.nodes.forEach(w5),this.sharedNodes.forEach(k5)}scheduleUpdateProjection(){this.projectionUpdateScheduled||(this.projectionUpdateScheduled=!0,en.preRender(this.updateProjection,!1,!0))}scheduleCheckAfterUnmount(){en.postRender(()=>{this.isLayoutDirty?this.root.didUpdate():this.root.checkUpdateFailed()})}updateSnapshot(){this.snapshot||!this.instance||(this.snapshot=this.measure())}updateLayout(){if(!this.instance||(this.updateScroll(),!(this.options.alwaysMeasureLayout&&this.isLead())&&!this.isLayoutDirty))return;if(this.resumeFrom&&!this.resumeFrom.instance)for(let l=0;l<this.path.length;l++)this.path[l].updateScroll();const a=this.layout;this.layout=this.measure(!1),this.layoutCorrected=wn(),this.isLayoutDirty=!1,this.projectionDelta=void 0,this.notifyListeners("measure",this.layout.layoutBox);const{visualElement:o}=this.options;o&&o.notify("LayoutMeasure",this.layout.layoutBox,a?a.layoutBox:void 0)}updateScroll(a="measure"){let o=!!(this.options.layoutScroll&&this.instance);if(this.scroll&&this.scroll.animationId===this.root.animationId&&this.scroll.phase===a&&(o=!1),o){const l=r(this.instance);this.scroll={animationId:this.root.animationId,phase:a,isRoot:l,offset:n(this.instance),wasRoot:this.scroll?this.scroll.isRoot:l}}}resetTransform(){if(!i)return;const a=this.isLayoutDirty||this.shouldResetTransform||this.options.alwaysMeasureLayout,o=this.projectionDelta&&!gM(this.projectionDelta),l=this.getTransformTemplate(),u=l?l(this.latestValues,""):void 0,c=u!==this.prevTransformTemplateValue;a&&(o||Qa(this.latestValues)||c)&&(i(this.instance,u),this.shouldResetTransform=!1,this.scheduleRender())}measure(a=!0){const o=this.measurePageBox();let l=this.removeElementScroll(o);return a&&(l=this.removeTransform(l)),F5(l),{animationId:this.root.animationId,measuredBox:o,layoutBox:l,latestValues:{},source:this.id}}measurePageBox(){var a;const{visualElement:o}=this.options;if(!o)return wn();const l=o.measureViewportBox();if(!(((a=this.scroll)===null||a===void 0?void 0:a.wasRoot)||this.path.some(D5))){const{scroll:c}=this.root;c&&(Al(l.x,c.offset.x),Al(l.y,c.offset.y))}return l}removeElementScroll(a){var o;const l=wn();if(ni(l,a),!((o=this.scroll)===null||o===void 0)&&o.wasRoot)return l;for(let u=0;u<this.path.length;u++){const c=this.path[u],{scroll:h,options:p}=c;c!==this.root&&h&&p.layoutScroll&&(h.wasRoot&&ni(l,a),Al(l.x,h.offset.x),Al(l.y,h.offset.y))}return l}applyTransform(a,o=!1){const l=wn();ni(l,a);for(let u=0;u<this.path.length;u++){const c=this.path[u];!o&&c.options.layoutScroll&&c.scroll&&c!==c.root&&Rl(l,{x:-c.scroll.offset.x,y:-c.scroll.offset.y}),Qa(c.latestValues)&&Rl(l,c.latestValues)}return Qa(this.latestValues)&&Rl(l,this.latestValues),l}removeTransform(a){const o=wn();ni(o,a);for(let l=0;l<this.path.length;l++){const u=this.path[l];if(!u.instance||!Qa(u.latestValues))continue;bg(u.latestValues)&&u.updateSnapshot();const c=wn(),h=u.measurePageBox();ni(c,h),mS(o,u.latestValues,u.snapshot?u.snapshot.layoutBox:void 0,c)}return Qa(this.latestValues)&&mS(o,this.latestValues),o}setTargetDelta(a){this.targetDelta=a,this.root.scheduleUpdateProjection(),this.isProjectionDirty=!0}setOptions(a){this.options={...this.options,...a,crossfade:a.crossfade!==void 0?a.crossfade:!0}}clearMeasurements(){this.scroll=void 0,this.layout=void 0,this.snapshot=void 0,this.prevTransformTemplateValue=void 0,this.targetDelta=void 0,this.target=void 0,this.isLayoutDirty=!1}forceRelativeParentToResolveTarget(){this.relativeParent&&this.relativeParent.resolvedRelativeTargetAt!==Xn.timestamp&&this.relativeParent.resolveTargetDelta(!0)}resolveTargetDelta(a=!1){var o;const l=this.getLead();this.isProjectionDirty||(this.isProjectionDirty=l.isProjectionDirty),this.isTransformDirty||(this.isTransformDirty=l.isTransformDirty),this.isSharedProjectionDirty||(this.isSharedProjectionDirty=l.isSharedProjectionDirty);const u=!!this.resumingFrom||this!==l;if(!(a||u&&this.isSharedProjectionDirty||this.isProjectionDirty||!((o=this.parent)===null||o===void 0)&&o.isProjectionDirty||this.attemptToResolveRelativeTarget||this.root.updateBlockedByResize))return;const{layout:h,layoutId:p}=this.options;if(!(!this.layout||!(h||p))){if(this.resolvedRelativeTargetAt=Xn.timestamp,!this.targetDelta&&!this.relativeTarget){const m=this.getClosestProjectingParent();m&&m.layout&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=wn(),this.relativeTargetOrigin=wn(),Cc(this.relativeTargetOrigin,this.layout.layoutBox,m.layout.layoutBox),ni(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}if(!(!this.relativeTarget&&!this.targetDelta)){if(this.target||(this.target=wn(),this.targetWithTransforms=wn()),this.relativeTarget&&this.relativeTargetOrigin&&this.relativeParent&&this.relativeParent.target?(this.forceRelativeParentToResolveTarget(),N6(this.target,this.relativeTarget,this.relativeParent.target)):this.targetDelta?(this.resumingFrom?this.target=this.applyTransform(this.layout.layoutBox):ni(this.target,this.layout.layoutBox),cM(this.target,this.targetDelta)):ni(this.target,this.layout.layoutBox),this.attemptToResolveRelativeTarget){this.attemptToResolveRelativeTarget=!1;const m=this.getClosestProjectingParent();m&&!!m.resumingFrom==!!this.resumingFrom&&!m.options.layoutScroll&&m.target&&this.animationProgress!==1?(this.relativeParent=m,this.forceRelativeParentToResolveTarget(),this.relativeTarget=wn(),this.relativeTargetOrigin=wn(),Cc(this.relativeTargetOrigin,this.target,m.target),ni(this.relativeTarget,this.relativeTargetOrigin)):this.relativeParent=this.relativeTarget=void 0}lc&&ja.resolvedTargetDeltas++}}}getClosestProjectingParent(){if(!(!this.parent||bg(this.parent.latestValues)||uM(this.parent.latestValues)))return this.parent.isProjecting()?this.parent:this.parent.getClosestProjectingParent()}isProjecting(){return!!((this.relativeTarget||this.targetDelta||this.options.layoutRoot)&&this.layout)}calcProjection(){var a;const o=this.getLead(),l=!!this.resumingFrom||this!==o;let u=!0;if((this.isProjectionDirty||!((a=this.parent)===null||a===void 0)&&a.isProjectionDirty)&&(u=!1),l&&(this.isSharedProjectionDirty||this.isTransformDirty)&&(u=!1),this.resolvedRelativeTargetAt===Xn.timestamp&&(u=!1),u)return;const{layout:c,layoutId:h}=this.options;if(this.isTreeAnimating=!!(this.parent&&this.parent.isTreeAnimating||this.currentAnimation||this.pendingAnimation),this.isTreeAnimating||(this.targetDelta=this.relativeTarget=void 0),!this.layout||!(c||h))return;ni(this.layoutCorrected,this.layout.layoutBox);const p=this.treeScale.x,m=this.treeScale.y;z6(this.layoutCorrected,this.treeScale,this.path,l),o.layout&&!o.target&&(this.treeScale.x!==1||this.treeScale.y!==1)&&(o.target=o.layout.layoutBox,o.targetWithTransforms=wn());const{target:v}=o;if(!v){this.prevProjectionDelta&&(this.createProjectionDeltas(),this.scheduleRender());return}!this.projectionDelta||!this.prevProjectionDelta?this.createProjectionDeltas():(dS(this.prevProjectionDelta.x,this.projectionDelta.x),dS(this.prevProjectionDelta.y,this.projectionDelta.y)),_c(this.projectionDelta,this.layoutCorrected,v,this.latestValues),(this.treeScale.x!==p||this.treeScale.y!==m||!wS(this.projectionDelta.x,this.prevProjectionDelta.x)||!wS(this.projectionDelta.y,this.prevProjectionDelta.y))&&(this.hasProjected=!0,this.scheduleRender(),this.notifyListeners("projectionUpdate",v)),lc&&ja.recalculatedProjection++}hide(){this.isVisible=!1}show(){this.isVisible=!0}scheduleRender(a=!0){var o;if((o=this.options.visualElement)===null||o===void 0||o.scheduleRender(),a){const l=this.getStack();l&&l.scheduleRender()}this.resumingFrom&&!this.resumingFrom.instance&&(this.resumingFrom=void 0)}createProjectionDeltas(){this.prevProjectionDelta=kl(),this.projectionDelta=kl(),this.projectionDeltaWithTransform=kl()}setAnimationOrigin(a,o=!1){const l=this.snapshot,u=l?l.latestValues:{},c={...this.latestValues},h=kl();(!this.relativeParent||!this.relativeParent.options.layoutRoot)&&(this.relativeTarget=this.relativeTargetOrigin=void 0),this.attemptToResolveRelativeTarget=!o;const p=wn(),m=l?l.source:void 0,v=this.layout?this.layout.source:void 0,g=m!==v,w=this.getStack(),x=!w||w.members.length<=1,T=!!(g&&!x&&this.options.crossfade===!0&&!this.path.some(R5));this.animationProgress=0;let y;this.mixTargetDelta=_=>{const k=_/1e3;_S(h.x,a.x,k),_S(h.y,a.y,k),this.setTargetDelta(h),this.relativeTarget&&this.relativeTargetOrigin&&this.layout&&this.relativeParent&&this.relativeParent.layout&&(Cc(p,this.layout.layoutBox,this.relativeParent.layout.layoutBox),A5(this.relativeTarget,this.relativeTargetOrigin,p,k),y&&f5(this.relativeTarget,y)&&(this.isProjectionDirty=!1),y||(y=wn()),ni(y,this.relativeTarget)),g&&(this.animationValues=c,s5(c,u,this.latestValues,k,T,x)),this.root.scheduleUpdateProjection(),this.scheduleRender(),this.animationProgress=k},this.mixTargetDelta(this.options.layoutRoot?1e3:0)}startAnimation(a){this.notifyListeners("animationStart"),this.currentAnimation&&this.currentAnimation.stop(),this.resumingFrom&&this.resumingFrom.currentAnimation&&this.resumingFrom.currentAnimation.stop(),this.pendingAnimation&&(Pa(this.pendingAnimation),this.pendingAnimation=void 0),this.pendingAnimation=en.update(()=>{h0.hasAnimatedSinceResize=!0,this.currentAnimation=Z6(0,TS,{...a,onUpdate:o=>{this.mixTargetDelta(o),a.onUpdate&&a.onUpdate(o)},onComplete:()=>{a.onComplete&&a.onComplete(),this.completeAnimation()}}),this.resumingFrom&&(this.resumingFrom.currentAnimation=this.currentAnimation),this.pendingAnimation=void 0})}completeAnimation(){this.resumingFrom&&(this.resumingFrom.currentAnimation=void 0,this.resumingFrom.preserveOpacity=void 0);const a=this.getStack();a&&a.exitAnimationComplete(),this.resumingFrom=this.currentAnimation=this.animationValues=void 0,this.notifyListeners("animationComplete")}finishAnimation(){this.currentAnimation&&(this.mixTargetDelta&&this.mixTargetDelta(TS),this.currentAnimation.stop()),this.completeAnimation()}applyTransformsToTarget(){const a=this.getLead();let{targetWithTransforms:o,target:l,layout:u,latestValues:c}=a;if(!(!o||!l||!u)){if(this!==a&&this.layout&&u&&wM(this.options.animationType,this.layout.layoutBox,u.layoutBox)){l=this.target||wn();const h=jr(this.layout.layoutBox.x);l.x.min=a.target.x.min,l.x.max=l.x.min+h;const p=jr(this.layout.layoutBox.y);l.y.min=a.target.y.min,l.y.max=l.y.min+p}ni(o,l),Rl(o,c),_c(this.projectionDeltaWithTransform,this.layoutCorrected,o,c)}}registerSharedNode(a,o){this.sharedNodes.has(a)||this.sharedNodes.set(a,new d5),this.sharedNodes.get(a).add(o);const u=o.options.initialPromotionConfig;o.promote({transition:u?u.transition:void 0,preserveFollowOpacity:u&&u.shouldPreserveFollowOpacity?u.shouldPreserveFollowOpacity(o):void 0})}isLead(){const a=this.getStack();return a?a.lead===this:!0}getLead(){var a;const{layoutId:o}=this.options;return o?((a=this.getStack())===null||a===void 0?void 0:a.lead)||this:this}getPrevLead(){var a;const{layoutId:o}=this.options;return o?(a=this.getStack())===null||a===void 0?void 0:a.prevLead:void 0}getStack(){const{layoutId:a}=this.options;if(a)return this.root.sharedNodes.get(a)}promote({needsReset:a,transition:o,preserveFollowOpacity:l}={}){const u=this.getStack();u&&u.promote(this,l),a&&(this.projectionDelta=void 0,this.needsReset=!0),o&&this.setOptions({transition:o})}relegate(){const a=this.getStack();return a?a.relegate(this):!1}resetSkewAndRotation(){const{visualElement:a}=this.options;if(!a)return;let o=!1;const{latestValues:l}=a;if((l.z||l.rotate||l.rotateX||l.rotateY||l.rotateZ||l.skewX||l.skewY)&&(o=!0),!o)return;const u={};l.z&&nm("z",a,u,this.animationValues);for(let c=0;c<tm.length;c++)nm(`rotate${tm[c]}`,a,u,this.animationValues),nm(`skew${tm[c]}`,a,u,this.animationValues);a.render();for(const c in u)a.setStaticValue(c,u[c]),this.animationValues&&(this.animationValues[c]=u[c]);a.scheduleRender()}getProjectionStyles(a){var o,l;if(!this.instance||this.isSVG)return;if(!this.isVisible)return p5;const u={visibility:""},c=this.getTransformTemplate();if(this.needsReset)return this.needsReset=!1,u.opacity="",u.pointerEvents=f0(a==null?void 0:a.pointerEvents)||"",u.transform=c?c(this.latestValues,""):"none",u;const h=this.getLead();if(!this.projectionDelta||!this.layout||!h.target){const g={};return this.options.layoutId&&(g.opacity=this.latestValues.opacity!==void 0?this.latestValues.opacity:1,g.pointerEvents=f0(a==null?void 0:a.pointerEvents)||""),this.hasProjected&&!Qa(this.latestValues)&&(g.transform=c?c({},""):"none",this.hasProjected=!1),g}const p=h.animationValues||h.latestValues;this.applyTransformsToTarget(),u.transform=h5(this.projectionDeltaWithTransform,this.treeScale,p),c&&(u.transform=c(p,u.transform));const{x:m,y:v}=this.projectionDelta;u.transformOrigin=`${m.origin*100}% ${v.origin*100}% 0`,h.animationValues?u.opacity=h===this?(l=(o=p.opacity)!==null&&o!==void 0?o:this.latestValues.opacity)!==null&&l!==void 0?l:1:this.preserveOpacity?this.latestValues.opacity:p.opacityExit:u.opacity=h===this?p.opacity!==void 0?p.opacity:"":p.opacityExit!==void 0?p.opacityExit:0;for(const g in K0){if(p[g]===void 0)continue;const{correct:w,applyTo:x}=K0[g],T=u.transform==="none"?p[g]:w(p[g],h);if(x){const y=x.length;for(let _=0;_<y;_++)u[x[_]]=T}else u[g]=T}return this.options.layoutId&&(u.pointerEvents=h===this?f0(a==null?void 0:a.pointerEvents)||"":"none"),u}clearSnapshot(){this.resumeFrom=this.snapshot=void 0}resetTree(){this.root.nodes.forEach(a=>{var o;return(o=a.currentAnimation)===null||o===void 0?void 0:o.stop()}),this.root.nodes.forEach(SS),this.root.sharedNodes.clear()}}}function g5(e){e.updateLayout()}function v5(e){var t;const n=((t=e.resumeFrom)===null||t===void 0?void 0:t.snapshot)||e.snapshot;if(e.isLead()&&e.layout&&n&&e.hasListeners("didUpdate")){const{layoutBox:r,measuredBox:i}=e.layout,{animationType:s}=e.options,a=n.source!==e.layout.source;s==="size"?li(h=>{const p=a?n.measuredBox[h]:n.layoutBox[h],m=jr(p);p.min=r[h].min,p.max=p.min+m}):wM(s,n.layoutBox,r)&&li(h=>{const p=a?n.measuredBox[h]:n.layoutBox[h],m=jr(r[h]);p.max=p.min+m,e.relativeTarget&&!e.currentAnimation&&(e.isProjectionDirty=!0,e.relativeTarget[h].max=e.relativeTarget[h].min+m)});const o=kl();_c(o,r,n.layoutBox);const l=kl();a?_c(l,e.applyTransform(i,!0),n.measuredBox):_c(l,r,n.layoutBox);const u=!gM(o);let c=!1;if(!e.resumeFrom){const h=e.getClosestProjectingParent();if(h&&!h.resumeFrom){const{snapshot:p,layout:m}=h;if(p&&m){const v=wn();Cc(v,n.layoutBox,p.layoutBox);const g=wn();Cc(g,r,m.layoutBox),vM(v,g)||(c=!0),h.options.layoutRoot&&(e.relativeTarget=g,e.relativeTargetOrigin=v,e.relativeParent=h)}}}e.notifyListeners("didUpdate",{layout:r,snapshot:n,delta:l,layoutDelta:o,hasLayoutChanged:u,hasRelativeTargetChanged:c})}else if(e.isLead()){const{onExitComplete:r}=e.options;r&&r()}e.options.transition=void 0}function x5(e){lc&&ja.totalNodes++,e.parent&&(e.isProjecting()||(e.isProjectionDirty=e.parent.isProjectionDirty),e.isSharedProjectionDirty||(e.isSharedProjectionDirty=!!(e.isProjectionDirty||e.parent.isProjectionDirty||e.parent.isSharedProjectionDirty)),e.isTransformDirty||(e.isTransformDirty=e.parent.isTransformDirty))}function y5(e){e.isProjectionDirty=e.isSharedProjectionDirty=e.isTransformDirty=!1}function w5(e){e.clearSnapshot()}function SS(e){e.clearMeasurements()}function T5(e){e.isLayoutDirty=!1}function S5(e){const{visualElement:t}=e.options;t&&t.getProps().onBeforeLayoutMeasure&&t.notify("BeforeLayoutMeasure"),e.resetTransform()}function ES(e){e.finishAnimation(),e.targetDelta=e.relativeTarget=e.target=void 0,e.isProjectionDirty=!0}function E5(e){e.resolveTargetDelta()}function _5(e){e.calcProjection()}function C5(e){e.resetSkewAndRotation()}function k5(e){e.removeLeadSnapshot()}function _S(e,t,n){e.translate=an(t.translate,0,n),e.scale=an(t.scale,1,n),e.origin=t.origin,e.originPoint=t.originPoint}function CS(e,t,n,r){e.min=an(t.min,n.min,r),e.max=an(t.max,n.max,r)}function A5(e,t,n,r){CS(e.x,t.x,n.x,r),CS(e.y,t.y,n.y,r)}function R5(e){return e.animationValues&&e.animationValues.opacityExit!==void 0}const M5={duration:.45,ease:[.4,0,.1,1]},kS=e=>typeof navigator<"u"&&navigator.userAgent&&navigator.userAgent.toLowerCase().includes(e),AS=kS("applewebkit/")&&!kS("chrome/")?Math.round:Xr;function RS(e){e.min=AS(e.min),e.max=AS(e.max)}function F5(e){RS(e.x),RS(e.y)}function wM(e,t,n){return e==="position"||e==="preserve-aspect"&&!I6(yS(t),yS(n),.2)}function D5(e){var t;return e!==e.root&&((t=e.scroll)===null||t===void 0?void 0:t.wasRoot)}const P5=yM({attachResizeListener:(e,t)=>uf(e,"resize",t),measureScroll:()=>({x:document.documentElement.scrollLeft||document.body.scrollLeft,y:document.documentElement.scrollTop||document.body.scrollTop}),checkIsScrollRoot:()=>!0}),rm={current:void 0},TM=yM({measureScroll:e=>({x:e.scrollLeft,y:e.scrollTop}),defaultParent:()=>{if(!rm.current){const e=new P5({});e.mount(window),e.setOptions({layoutScroll:!0}),rm.current=e}return rm.current},resetTransform:(e,t)=>{e.style.transform=t!==void 0?t:"none"},checkIsScrollRoot:e=>window.getComputedStyle(e).position==="fixed"}),I5={pan:{Feature:X6},drag:{Feature:Y6,ProjectionNode:TM,MeasureLayout:hM}};function MS(e,t,n){const{props:r}=e;e.animationState&&r.whileHover&&e.animationState.setActive("whileHover",n==="Start");const i="onHover"+n,s=r[i];s&&en.postRender(()=>s(t,Wf(t)))}class N5 extends za{mount(){const{current:t}=this.node;t&&(this.unmount=I8(t,n=>(MS(this.node,n,"Start"),r=>MS(this.node,r,"End"))))}unmount(){}}class b5 extends za{constructor(){super(...arguments),this.isActive=!1}onFocus(){let t=!1;try{t=this.node.current.matches(":focus-visible")}catch{t=!0}!t||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!0),this.isActive=!0)}onBlur(){!this.isActive||!this.node.animationState||(this.node.animationState.setActive("whileFocus",!1),this.isActive=!1)}mount(){this.unmount=zf(uf(this.node.current,"focus",()=>this.onFocus()),uf(this.node.current,"blur",()=>this.onBlur()))}unmount(){}}function FS(e,t,n){const{props:r}=e;e.animationState&&r.whileTap&&e.animationState.setActive("whileTap",n==="Start");const i="onTap"+(n==="End"?"":n),s=r[i];s&&en.postRender(()=>s(t,Wf(t)))}class L5 extends za{mount(){const{current:t}=this.node;t&&(this.unmount=O8(t,n=>(FS(this.node,n,"Start"),(r,{success:i})=>FS(this.node,r,i?"End":"Cancel")),{useGlobalTarget:this.node.props.globalTapTarget}))}unmount(){}}const Og=new WeakMap,im=new WeakMap,O5=e=>{const t=Og.get(e.target);t&&t(e)},B5=e=>{e.forEach(O5)};function U5({root:e,...t}){const n=e||document;im.has(n)||im.set(n,{});const r=im.get(n),i=JSON.stringify(t);return r[i]||(r[i]=new IntersectionObserver(B5,{root:e,...t})),r[i]}function V5(e,t,n){const r=U5(t);return Og.set(e,n),r.observe(e),()=>{Og.delete(e),r.unobserve(e)}}const H5={some:0,all:1};class $5 extends za{constructor(){super(...arguments),this.hasEnteredView=!1,this.isInView=!1}startObserver(){this.unmount();const{viewport:t={}}=this.node.getProps(),{root:n,margin:r,amount:i="some",once:s}=t,a={root:n?n.current:void 0,rootMargin:r,threshold:typeof i=="number"?i:H5[i]},o=l=>{const{isIntersecting:u}=l;if(this.isInView===u||(this.isInView=u,s&&!u&&this.hasEnteredView))return;u&&(this.hasEnteredView=!0),this.node.animationState&&this.node.animationState.setActive("whileInView",u);const{onViewportEnter:c,onViewportLeave:h}=this.node.getProps(),p=u?c:h;p&&p(l)};return V5(this.node.current,a,o)}mount(){this.startObserver()}update(){if(typeof IntersectionObserver>"u")return;const{props:t,prevProps:n}=this.node;["amount","margin","root"].some(z5(t,n))&&this.startObserver()}unmount(){}}function z5({viewport:e={}},{viewport:t={}}={}){return n=>e[n]!==t[n]}const W5={inView:{Feature:$5},tap:{Feature:L5},focus:{Feature:b5},hover:{Feature:N5}},G5={layout:{ProjectionNode:TM,MeasureLayout:hM}},Bg={current:null},SM={current:!1};function q5(){if(SM.current=!0,!!Hx)if(window.matchMedia){const e=window.matchMedia("(prefers-reduced-motion)"),t=()=>Bg.current=e.matches;e.addListener(t),t()}else Bg.current=!1}const K5=[...KR,ir,Ia],Y5=e=>K5.find(qR(e)),DS=new WeakMap;function X5(e,t,n){for(const r in t){const i=t[r],s=n[r];if(cr(i))e.addValue(r,i);else if(cr(s))e.addValue(r,of(i,{owner:e}));else if(s!==i)if(e.hasValue(r)){const a=e.getValue(r);a.liveStyle===!0?a.jump(i):a.hasAnimated||a.set(i)}else{const a=e.getStaticValue(r);e.addValue(r,of(a!==void 0?a:i,{owner:e}))}}for(const r in n)t[r]===void 0&&e.removeValue(r);return t}const PS=["AnimationStart","AnimationComplete","Update","BeforeLayoutMeasure","LayoutMeasure","LayoutAnimationStart","LayoutAnimationComplete"];class J5{scrapeMotionValuesFromProps(t,n,r){return{}}constructor({parent:t,props:n,presenceContext:r,reducedMotionConfig:i,blockInitialAnimation:s,visualState:a},o={}){this.current=null,this.children=new Set,this.isVariantNode=!1,this.isControllingVariants=!1,this.shouldReduceMotion=null,this.values=new Map,this.KeyframeResolver=p1,this.features={},this.valueSubscriptions=new Map,this.prevMotionValues={},this.events={},this.propEventSubscriptions={},this.notifyUpdate=()=>this.notify("Update",this.latestValues),this.render=()=>{this.current&&(this.triggerBuild(),this.renderInstance(this.current,this.renderState,this.props.style,this.projection))},this.renderScheduledAt=0,this.scheduleRender=()=>{const m=os.now();this.renderScheduledAt<m&&(this.renderScheduledAt=m,en.render(this.render,!1,!0))};const{latestValues:l,renderState:u,onUpdate:c}=a;this.onUpdate=c,this.latestValues=l,this.baseTarget={...l},this.initialValues=n.initial?{...l}:{},this.renderState=u,this.parent=t,this.props=n,this.presenceContext=r,this.depth=t?t.depth+1:0,this.reducedMotionConfig=i,this.options=o,this.blockInitialAnimation=!!s,this.isControllingVariants=qh(n),this.isVariantNode=tR(n),this.isVariantNode&&(this.variantChildren=new Set),this.manuallyAnimateOnMount=!!(t&&t.current);const{willChange:h,...p}=this.scrapeMotionValuesFromProps(n,{},this);for(const m in p){const v=p[m];l[m]!==void 0&&cr(v)&&v.set(l[m],!1)}}mount(t){this.current=t,DS.set(t,this),this.projection&&!this.projection.instance&&this.projection.mount(t),this.parent&&this.isVariantNode&&!this.isControllingVariants&&(this.removeFromVariantTree=this.parent.addVariantChild(this)),this.values.forEach((n,r)=>this.bindToMotionValue(r,n)),SM.current||q5(),this.shouldReduceMotion=this.reducedMotionConfig==="never"?!1:this.reducedMotionConfig==="always"?!0:Bg.current,this.parent&&this.parent.children.add(this),this.update(this.props,this.presenceContext)}unmount(){DS.delete(this.current),this.projection&&this.projection.unmount(),Pa(this.notifyUpdate),Pa(this.render),this.valueSubscriptions.forEach(t=>t()),this.valueSubscriptions.clear(),this.removeFromVariantTree&&this.removeFromVariantTree(),this.parent&&this.parent.children.delete(this);for(const t in this.events)this.events[t].clear();for(const t in this.features){const n=this.features[t];n&&(n.unmount(),n.isMounted=!1)}this.current=null}bindToMotionValue(t,n){this.valueSubscriptions.has(t)&&this.valueSubscriptions.get(t)();const r=Ko.has(t),i=n.on("change",o=>{this.latestValues[t]=o,this.props.onUpdate&&en.preRender(this.notifyUpdate),r&&this.projection&&(this.projection.isTransformDirty=!0)}),s=n.on("renderRequest",this.scheduleRender);let a;window.MotionCheckAppearSync&&(a=window.MotionCheckAppearSync(this,t,n)),this.valueSubscriptions.set(t,()=>{i(),s(),a&&a(),n.owner&&n.stop()})}sortNodePosition(t){return!this.current||!this.sortInstanceNodePosition||this.type!==t.type?0:this.sortInstanceNodePosition(this.current,t.current)}updateFeatures(){let t="animation";for(t in pu){const n=pu[t];if(!n)continue;const{isEnabled:r,Feature:i}=n;if(!this.features[t]&&i&&r(this.props)&&(this.features[t]=new i(this)),this.features[t]){const s=this.features[t];s.isMounted?s.update():(s.mount(),s.isMounted=!0)}}}triggerBuild(){this.build(this.renderState,this.latestValues,this.props)}measureViewportBox(){return this.current?this.measureInstanceViewportBox(this.current,this.props):wn()}getStaticValue(t){return this.latestValues[t]}setStaticValue(t,n){this.latestValues[t]=n}update(t,n){(t.transformTemplate||this.props.transformTemplate)&&this.scheduleRender(),this.prevProps=this.props,this.props=t,this.prevPresenceContext=this.presenceContext,this.presenceContext=n;for(let r=0;r<PS.length;r++){const i=PS[r];this.propEventSubscriptions[i]&&(this.propEventSubscriptions[i](),delete this.propEventSubscriptions[i]);const s="on"+i,a=t[s];a&&(this.propEventSubscriptions[i]=this.on(i,a))}this.prevMotionValues=X5(this,this.scrapeMotionValuesFromProps(t,this.prevProps,this),this.prevMotionValues),this.handleChildMotionValue&&this.handleChildMotionValue(),this.onUpdate&&this.onUpdate(this)}getProps(){return this.props}getVariant(t){return this.props.variants?this.props.variants[t]:void 0}getDefaultTransition(){return this.props.transition}getTransformPagePoint(){return this.props.transformPagePoint}getClosestVariantNode(){return this.isVariantNode?this:this.parent?this.parent.getClosestVariantNode():void 0}addVariantChild(t){const n=this.getClosestVariantNode();if(n)return n.variantChildren&&n.variantChildren.add(t),()=>n.variantChildren.delete(t)}addValue(t,n){const r=this.values.get(t);n!==r&&(r&&this.removeValue(t),this.bindToMotionValue(t,n),this.values.set(t,n),this.latestValues[t]=n.get())}removeValue(t){this.values.delete(t);const n=this.valueSubscriptions.get(t);n&&(n(),this.valueSubscriptions.delete(t)),delete this.latestValues[t],this.removeValueFromRenderState(t,this.renderState)}hasValue(t){return this.values.has(t)}getValue(t,n){if(this.props.values&&this.props.values[t])return this.props.values[t];let r=this.values.get(t);return r===void 0&&n!==void 0&&(r=of(n===null?void 0:n,{owner:this}),this.addValue(t,r)),r}readValue(t,n){var r;let i=this.latestValues[t]!==void 0||!this.current?this.latestValues[t]:(r=this.getBaseTargetFromProps(this.props,t))!==null&&r!==void 0?r:this.readValueFromInstance(this.current,t,this.options);return i!=null&&(typeof i=="string"&&(WR(i)||bR(i))?i=parseFloat(i):!Y5(i)&&Ia.test(n)&&(i=HR(t,n)),this.setBaseTarget(t,cr(i)?i.get():i)),cr(i)?i.get():i}setBaseTarget(t,n){this.baseTarget[t]=n}getBaseTarget(t){var n;const{initial:r}=this.props;let i;if(typeof r=="string"||typeof r=="object"){const a=Yx(this.props,r,(n=this.presenceContext)===null||n===void 0?void 0:n.custom);a&&(i=a[t])}if(r&&i!==void 0)return i;const s=this.getBaseTargetFromProps(this.props,t);return s!==void 0&&!cr(s)?s:this.initialValues[t]!==void 0&&i===void 0?void 0:this.baseTarget[t]}on(t,n){return this.events[t]||(this.events[t]=new l1),this.events[t].add(n)}notify(t,...n){this.events[t]&&this.events[t].notify(...n)}}class EM extends J5{constructor(){super(...arguments),this.KeyframeResolver=YR}sortInstanceNodePosition(t,n){return t.compareDocumentPosition(n)&2?1:-1}getBaseTargetFromProps(t,n){return t.style?t.style[n]:void 0}removeValueFromRenderState(t,{vars:n,style:r}){delete n[t],delete r[t]}handleChildMotionValue(){this.childSubscription&&(this.childSubscription(),delete this.childSubscription);const{children:t}=this.props;cr(t)&&(this.childSubscription=t.on("change",n=>{this.current&&(this.current.textContent=`${n}`)}))}}function Q5(e){return window.getComputedStyle(e)}class j5 extends EM{constructor(){super(...arguments),this.type="html",this.renderInstance=cR}readValueFromInstance(t,n){if(Ko.has(n)){const r=h1(n);return r&&r.default||0}else{const r=Q5(t),i=(oR(n)?r.getPropertyValue(n):r[n])||0;return typeof i=="string"?i.trim():i}}measureInstanceViewportBox(t,{transformPagePoint:n}){return fM(t,n)}build(t,n,r){Qx(t,n,r.transformTemplate)}scrapeMotionValuesFromProps(t,n,r){return t1(t,n,r)}}class Z5 extends EM{constructor(){super(...arguments),this.type="svg",this.isSVGTag=!1,this.measureInstanceViewportBox=wn}getBaseTargetFromProps(t,n){return t[n]}readValueFromInstance(t,n){if(Ko.has(n)){const r=h1(n);return r&&r.default||0}return n=fR.has(n)?n:Gx(n),t.getAttribute(n)}scrapeMotionValuesFromProps(t,n,r){return pR(t,n,r)}build(t,n,r){jx(t,n,this.isSVGTag,r.transformTemplate)}renderInstance(t,n,r,i){dR(t,n,r,i)}mount(t){this.isSVGTag=e1(t.tagName),super.mount(t)}}const eB=(e,t)=>Kx(e)?new Z5(t):new j5(t,{allowProjection:e!==E.Fragment}),tB=k8({..._6,...W5,...I5,...G5},eB),dr=HL(tB),_M=xt.forwardRef(({children:e,variant:t="primary",size:n="md",leftIcon:r,rightIcon:i,isLoading:s,className:a,disabled:o,fullWidth:l,...u},c)=>{const h="font-semibold focus:outline-none focus-visible:ring-2 focus-visible:ring-offset-2 focus-visible:ring-offset-[var(--bg-card)] focus-visible:ring-opacity-70 flex items-center justify-center shadow-md hover:shadow-lg transition-all duration-200",p="rounded-lg",m={primary:"bg-gradient-to-r from-[var(--primary-accent-start)] to-[var(--primary-accent-end)] text-[var(--text-on-accent)] focus-visible:ring-[var(--primary-accent-start)] hover:opacity-95",secondary:"bg-gradient-to-r from-[var(--secondary-accent-start)] to-[var(--secondary-accent-end)] text-[var(--text-on-accent)] focus-visible:ring-[var(--secondary-accent-start)]",danger:"bg-gradient-to-r from-[var(--danger-start)] to-[var(--danger-end)] text-[var(--text-on-accent)] focus-visible:ring-[var(--danger-start)] hover:opacity-90",ghost:"bg-transparent hover:bg-white/5 text-[var(--text-secondary)] hover:text-[var(--text-primary)] focus-visible:ring-gray-500 shadow-none",outline:"bg-transparent border border-[var(--primary-accent-start)] text-[var(--primary-accent-start)] hover:bg-[var(--primary-accent-start)]/10 focus-visible:ring-[var(--primary-accent-start)] shadow-none",subtle:"bg-[var(--bg-card-subtle-accent)] hover:bg-[var(--border-color)] text-[var(--text-secondary)] hover:text-[var(--text-primary)] focus-visible:ring-gray-500 border border-[var(--border-color)] shadow-none"},v={sm:"px-3.5 py-1.5 text-xs",md:"px-5 py-2 text-sm",lg:"px-7 py-2.5 text-base",icon:"p-2.5 text-sm"},g=l?"w-full":"",w="opacity-40 cursor-not-allowed !shadow-none hover:!transform-none",x=v[n]||v.md;return R.jsxs("button",{ref:c,className:`${h} ${m[t]} ${x} ${p} ${o||s?w:""} ${g} ${a||""}`,disabled:o||s,...u,children:[s&&R.jsxs("svg",{className:"animate-spin h-5 w-5 text-current",style:e?{marginRight:"0.5rem",marginLeft:"-0.25rem"}:{},xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24",children:[R.jsx("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4"}),R.jsx("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]}),r&&!s&&R.jsx("span",{className:e?"mr-2 flex-shrink-0":"flex-shrink-0",children:xt.cloneElement(r,{size:n==="sm"?16:n==="icon"?20:18})}),e&&R.jsx("span",{className:"flex-grow-0",children:e}),i&&!s&&R.jsx("span",{className:e?"ml-2 flex-shrink-0":"flex-shrink-0",children:xt.cloneElement(i,{size:n==="sm"?16:n==="icon"?20:18})})]})});_M.displayName="Button";const Gt=xt.memo(_M);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const nB=e=>e.replace(/([a-z0-9])([A-Z])/g,"$1-$2").toLowerCase(),CM=(...e)=>e.filter((t,n,r)=>!!t&&r.indexOf(t)===n).join(" ");/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */var rB={xmlns:"http://www.w3.org/2000/svg",width:24,height:24,viewBox:"0 0 24 24",fill:"none",stroke:"currentColor",strokeWidth:2,strokeLinecap:"round",strokeLinejoin:"round"};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const iB=E.forwardRef(({color:e="currentColor",size:t=24,strokeWidth:n=2,absoluteStrokeWidth:r,className:i="",children:s,iconNode:a,...o},l)=>E.createElement("svg",{ref:l,...rB,width:t,height:t,stroke:e,strokeWidth:r?Number(n)*24/Number(t):n,className:CM("lucide",i),...o},[...a.map(([u,c])=>E.createElement(u,c)),...Array.isArray(s)?s:[s]]));/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ft=(e,t)=>{const n=E.forwardRef(({className:r,...i},s)=>E.createElement(iB,{ref:s,iconNode:t,className:CM(`lucide-${nB(e)}`,r),...i}));return n.displayName=`${e}`,n};/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const sB=ft("ArrowDownWideNarrow",[["path",{d:"m3 16 4 4 4-4",key:"1co6wj"}],["path",{d:"M7 20V4",key:"1yoxec"}],["path",{d:"M11 4h10",key:"1w87gc"}],["path",{d:"M11 8h7",key:"djye34"}],["path",{d:"M11 12h4",key:"q8tih4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const aB=ft("ArrowUpNarrowWide",[["path",{d:"m3 8 4-4 4 4",key:"11wl7u"}],["path",{d:"M7 4v16",key:"1glfcx"}],["path",{d:"M11 12h4",key:"q8tih4"}],["path",{d:"M11 16h7",key:"uosisv"}],["path",{d:"M11 20h10",key:"jvxblo"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kM=ft("BotMessageSquare",[["path",{d:"M12 6V2H8",key:"1155em"}],["path",{d:"m8 18-4 4V8a2 2 0 0 1 2-2h12a2 2 0 0 1 2 2v8a2 2 0 0 1-2 2Z",key:"w2lp3e"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M9 11v2",key:"1ueba0"}],["path",{d:"M15 11v2",key:"i11awn"}],["path",{d:"M20 12h2",key:"1q8mjw"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AM=ft("Check",[["path",{d:"M20 6 9 17l-5-5",key:"1gmf2c"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const oB=ft("ChevronLeft",[["path",{d:"m15 18-6-6 6-6",key:"1wnfg3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const lB=ft("ChevronRight",[["path",{d:"m9 18 6-6-6-6",key:"mthhwq"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const uB=ft("ChevronsRight",[["path",{d:"m6 17 5-5-5-5",key:"xnjwq"}],["path",{d:"m13 17 5-5-5-5",key:"17xmmf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const cB=ft("CircleAlert",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["line",{x1:"12",x2:"12",y1:"8",y2:"12",key:"1pkeuh"}],["line",{x1:"12",x2:"12.01",y1:"16",y2:"16",key:"4dfq90"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const RM=ft("CircleCheckBig",[["path",{d:"M22 11.08V12a10 10 0 1 1-5.93-9.14",key:"g774vq"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const fB=ft("CirclePlus",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M8 12h8",key:"1wcyev"}],["path",{d:"M12 8v8",key:"napkw2"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const dB=ft("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const hB=ft("Columns3",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}],["path",{d:"M9 3v18",key:"fh3hqa"}],["path",{d:"M15 3v18",key:"14nvp0"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pB=ft("CornerDownLeft",[["polyline",{points:"9 10 4 15 9 20",key:"r3jprv"}],["path",{d:"M20 4v7a4 4 0 0 1-4 4H4",key:"6o5b7l"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const MM=ft("Cpu",[["rect",{width:"16",height:"16",x:"4",y:"4",rx:"2",key:"14l7u7"}],["rect",{width:"6",height:"6",x:"9",y:"9",rx:"1",key:"5aljv4"}],["path",{d:"M15 2v2",key:"13l42r"}],["path",{d:"M15 20v2",key:"15mkzm"}],["path",{d:"M2 15h2",key:"1gxd5l"}],["path",{d:"M2 9h2",key:"1bbxkp"}],["path",{d:"M20 15h2",key:"19e6y8"}],["path",{d:"M20 9h2",key:"19tzq7"}],["path",{d:"M9 2v2",key:"165o2o"}],["path",{d:"M9 20v2",key:"i2bqo8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const FM=ft("Database",[["ellipse",{cx:"12",cy:"5",rx:"9",ry:"3",key:"msslwz"}],["path",{d:"M3 5V19A9 3 0 0 0 21 19V5",key:"1wlel7"}],["path",{d:"M3 12A9 3 0 0 0 21 12",key:"mv7ke4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const mB=ft("Filter",[["polygon",{points:"22 3 2 3 10 12.46 10 19 14 21 14 12.46 22 3",key:"1yg77f"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const gB=ft("GripVertical",[["circle",{cx:"9",cy:"12",r:"1",key:"1vctgf"}],["circle",{cx:"9",cy:"5",r:"1",key:"hp0tcf"}],["circle",{cx:"9",cy:"19",r:"1",key:"fkjjf6"}],["circle",{cx:"15",cy:"12",r:"1",key:"1tmaij"}],["circle",{cx:"15",cy:"5",r:"1",key:"19l28e"}],["circle",{cx:"15",cy:"19",r:"1",key:"f4zoj3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const DM=ft("Inbox",[["polyline",{points:"22 12 16 12 14 15 10 15 8 12 2 12",key:"o97t9d"}],["path",{d:"M5.45 5.11 2 12v6a2 2 0 0 0 2 2h16a2 2 0 0 0 2-2v-6l-3.45-6.89A2 2 0 0 0 16.76 4H7.24a2 2 0 0 0-1.79 1.11z",key:"oot6mr"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const vB=ft("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const PM=ft("LayoutDashboard",[["rect",{width:"7",height:"9",x:"3",y:"3",rx:"1",key:"10lvy0"}],["rect",{width:"7",height:"5",x:"14",y:"3",rx:"1",key:"16une8"}],["rect",{width:"7",height:"9",x:"14",y:"12",rx:"1",key:"1hutg5"}],["rect",{width:"7",height:"5",x:"3",y:"16",rx:"1",key:"ldoo1y"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xB=ft("LoaderCircle",[["path",{d:"M21 12a9 9 0 1 1-6.219-8.56",key:"13zald"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const yB=ft("LogIn",[["path",{d:"M15 3h4a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2h-4",key:"u53s6r"}],["polyline",{points:"10 17 15 12 10 7",key:"1ail0h"}],["line",{x1:"15",x2:"3",y1:"12",y2:"12",key:"v6grx8"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const wB=ft("Menu",[["line",{x1:"4",x2:"20",y1:"12",y2:"12",key:"1e0a9i"}],["line",{x1:"4",x2:"20",y1:"6",y2:"6",key:"1owob3"}],["line",{x1:"4",x2:"20",y1:"18",y2:"18",key:"yk5zj1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const IM=ft("Moon",[["path",{d:"M12 3a6 6 0 0 0 9 9 9 9 0 1 1-9-9Z",key:"a7tn18"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const NM=ft("PieChart",[["path",{d:"M21.21 15.89A10 10 0 1 1 8 2.83",key:"k2fpak"}],["path",{d:"M22 12A10 10 0 0 0 12 2v10z",key:"1rfc4y"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const TB=ft("RefreshCw",[["path",{d:"M3 12a9 9 0 0 1 9-9 9.75 9.75 0 0 1 6.74 2.74L21 8",key:"v9h5vc"}],["path",{d:"M21 3v5h-5",key:"1q7to0"}],["path",{d:"M21 12a9 9 0 0 1-9 9 9.75 9.75 0 0 1-6.74-2.74L3 16",key:"3uifl3"}],["path",{d:"M8 16H3v5",key:"1cv678"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const bM=ft("Save",[["path",{d:"M15.2 3a2 2 0 0 1 1.4.6l3.8 3.8a2 2 0 0 1 .6 1.4V19a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2z",key:"1c8476"}],["path",{d:"M17 21v-7a1 1 0 0 0-1-1H8a1 1 0 0 0-1 1v7",key:"1ydtos"}],["path",{d:"M7 3v4a1 1 0 0 0 1 1h7",key:"t51u73"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const Xh=ft("Search",[["circle",{cx:"11",cy:"11",r:"8",key:"4ej97u"}],["path",{d:"m21 21-4.3-4.3",key:"1qie3q"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const SB=ft("SquareCheckBig",[["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}],["path",{d:"M21 12v7a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2V5a2 2 0 0 1 2-2h11",key:"1jnkn4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const EB=ft("Square",[["rect",{width:"18",height:"18",x:"3",y:"3",rx:"2",key:"afitv7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const LM=ft("Star",[["polygon",{points:"12 2 15.09 8.26 22 9.27 17 14.14 18.18 21.02 12 17.77 5.82 21.02 7 14.14 2 9.27 8.91 8.26 12 2",key:"8f66p6"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const OM=ft("Sun",[["circle",{cx:"12",cy:"12",r:"4",key:"4exip2"}],["path",{d:"M12 2v2",key:"tus03m"}],["path",{d:"M12 20v2",key:"1lh1kg"}],["path",{d:"m4.93 4.93 1.41 1.41",key:"149t6j"}],["path",{d:"m17.66 17.66 1.41 1.41",key:"ptbguv"}],["path",{d:"M2 12h2",key:"1t8f8n"}],["path",{d:"M20 12h2",key:"1q8mjw"}],["path",{d:"m6.34 17.66-1.41 1.41",key:"1m8zz5"}],["path",{d:"m19.07 4.93-1.41 1.41",key:"1shlcs"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const x1=ft("Trash2",[["path",{d:"M3 6h18",key:"d0wm0j"}],["path",{d:"M19 6v14c0 1-1 2-2 2H7c-1 0-2-1-2-2V6",key:"4alrt4"}],["path",{d:"M8 6V4c0-1 1-2 2-2h4c1 0 2 1 2 2v2",key:"v07s0e"}],["line",{x1:"10",x2:"10",y1:"11",y2:"17",key:"1uufr5"}],["line",{x1:"14",x2:"14",y1:"11",y2:"17",key:"xtxkd"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const _B=ft("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const CB=ft("UserMinus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const y1=ft("UserPlus",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["line",{x1:"19",x2:"19",y1:"8",y2:"14",key:"1bvyxn"}],["line",{x1:"22",x2:"16",y1:"11",y2:"11",key:"1shjgl"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const kB=ft("Users",[["path",{d:"M16 21v-2a4 4 0 0 0-4-4H6a4 4 0 0 0-4 4v2",key:"1yyitq"}],["circle",{cx:"9",cy:"7",r:"4",key:"nufk8"}],["path",{d:"M22 21v-2a4 4 0 0 0-3-3.87",key:"kshegd"}],["path",{d:"M16 3.13a4 4 0 0 1 0 7.75",key:"1da9ce"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const BM=ft("WifiOff",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}],["path",{d:"M5 12.859a10 10 0 0 1 5.17-2.69",key:"1dl1wf"}],["path",{d:"M19 12.859a10 10 0 0 0-2.007-1.523",key:"4k23kn"}],["path",{d:"M2 8.82a15 15 0 0 1 4.177-2.643",key:"1grhjp"}],["path",{d:"M22 8.82a15 15 0 0 0-11.288-3.764",key:"z3jwby"}],["path",{d:"m2 2 20 20",key:"1ooewy"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const AB=ft("Wifi",[["path",{d:"M12 20h.01",key:"zekei9"}],["path",{d:"M2 8.82a15 15 0 0 1 20 0",key:"dnpr2z"}],["path",{d:"M5 12.859a10 10 0 0 1 14 0",key:"1x1e6c"}],["path",{d:"M8.5 16.429a5 5 0 0 1 7 0",key:"1bycff"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const UM=ft("X",[["path",{d:"M18 6 6 18",key:"1bl5f8"}],["path",{d:"m6 6 12 12",key:"d8bk6v"}]]),RB={success:R.jsx(RM,{className:"text-[var(--success-text)]",size:22}),error:R.jsx(dB,{className:"text-[var(--danger-text)]",size:22}),info:R.jsx(vB,{className:"text-[var(--secondary-accent-end)]",size:22}),warning:R.jsx(_B,{className:"text-[var(--warning-text)]",size:22})},MB={success:"border-[var(--success-border)] bg-[var(--bg-card)] text-[var(--success-text)]",error:"border-[var(--danger-border)] bg-[var(--bg-card)] text-[var(--danger-text)]",info:"border-[var(--secondary-accent-end)] bg-[var(--bg-card)] text-[var(--text-primary)]",warning:"border-[var(--warning-border)] bg-[var(--bg-card)] text-[var(--warning-text)]"},FB=({id:e,message:t,type:n,duration:r=5e3,actions:i,onDismiss:s})=>{E.useEffect(()=>{if(r&&r!==1/0){const o=setTimeout(()=>{s(e)},r);return()=>{clearTimeout(o)}}},[e,r,s]);const a=()=>{s(e)};return R.jsxs(dr.div,{layout:!0,initial:{opacity:0,x:100,scale:.8},animate:{opacity:1,x:0,scale:1},exit:{opacity:0,x:50,transition:{duration:.2}},transition:{type:"spring",stiffness:260,damping:20},role:"alert","aria-live":n==="error"||n==="warning"?"assertive":"polite",className:`w-full max-w-md p-4 rounded-xl shadow-xl border-l-4 flex flex-col mb-3 ${MB[n]}`,style:{backdropFilter:"blur(5px)"},children:[R.jsxs("div",{className:"flex items-start space-x-3.5",children:[R.jsx("div",{className:"flex-shrink-0 mt-0.5",children:RB[n]}),R.jsx("p",{className:`flex-grow text-sm font-medium min-w-0 break-words ${n==="info"?"text-[var(--text-primary)]":""}`,children:t}),R.jsx("button",{onClick:a,className:"ml-auto -mr-1 -my-1 p-1.5 rounded-lg text-[var(--text-muted)] hover:text-[var(--text-primary)] hover:bg-white/10 transition-colors","aria-label":"Dismiss",children:R.jsx(UM,{size:20})})]}),i&&i.length>0&&R.jsx("div",{className:"mt-2.5 pt-2.5 border-t border-[var(--border-color)]/30 flex gap-2.5 justify-end",children:i.map(o=>R.jsx(Gt,{onClick:()=>{o.onClick(),a()},size:"sm",variant:o.variant||"subtle",className:"!text-xs !px-3 !py-1",children:o.label},o.label))})]})},DB=({toasts:e,onDismiss:t})=>R.jsx("div",{className:"fixed bottom-6 right-6 z-[100] w-full max-w-md",children:R.jsx(ks,{children:e.map(n=>R.jsx(FB,{...n,onDismiss:t},n.id))})}),Ms=({isOpen:e,onClose:t,title:n,children:r,footerContent:i,size:s="md"})=>{if(!e)return null;const a={sm:"max-w-lg",md:"max-w-xl",lg:"max-w-2xl",xl:"max-w-4xl",xxl:"max-w-7xl",full:"max-w-full mx-4 sm:mx-8 md:mx-12 lg:mx-16"};return R.jsx("div",{className:"modal-overlay",onClick:t,role:"dialog","aria-modal":"true","aria-labelledby":"modal-title",children:R.jsxs("div",{className:`modal-content glassmorphism-bg ${a[s]}`,onClick:o=>o.stopPropagation(),children:[R.jsxs("div",{className:"modal-header",children:[R.jsx("h2",{id:"modal-title",className:"modal-title",children:n}),R.jsx("button",{onClick:t,className:"modal-close-button","aria-label":"Close modal",children:R.jsx(UM,{size:24})})]}),R.jsx("div",{className:"modal-body",children:r}),i&&R.jsx("div",{className:"modal-footer",children:i})]})})};/*! xlsx.js (C) 2013-present SheetJS -- http://sheetjs.com */var Z0={};Z0.version="0.18.5";var VM=1252,PB=[874,932,936,949,950,1250,1251,1252,1253,1254,1255,1256,1257,1258,1e4],w1={0:1252,1:65001,2:65001,77:1e4,128:932,129:949,130:1361,134:936,136:950,161:1253,162:1254,163:1258,177:1255,178:1256,186:1257,204:1251,222:874,238:1250,255:1252,69:6969},T1=function(e){PB.indexOf(e)!=-1&&(VM=w1[0]=e)};function IB(){T1(1252)}var Li=function(e){T1(e)};function S1(){Li(1200),IB()}function IS(e){for(var t=[],n=0,r=e.length;n<r;++n)t[n]=e.charCodeAt(n);return t}function NB(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n)+(e.charCodeAt(2*n+1)<<8));return t.join("")}function HM(e){for(var t=[],n=0;n<e.length>>1;++n)t[n]=String.fromCharCode(e.charCodeAt(2*n+1)+(e.charCodeAt(2*n)<<8));return t.join("")}var uc=function(e){var t=e.charCodeAt(0),n=e.charCodeAt(1);return t==255&&n==254?NB(e.slice(2)):t==254&&n==255?HM(e.slice(2)):t==65279?e.slice(1):e},Pd=function(t){return String.fromCharCode(t)},NS=function(t){return String.fromCharCode(t)},cf,ga="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=";function ff(e){for(var t="",n=0,r=0,i=0,s=0,a=0,o=0,l=0,u=0;u<e.length;)n=e.charCodeAt(u++),s=n>>2,r=e.charCodeAt(u++),a=(n&3)<<4|r>>4,i=e.charCodeAt(u++),o=(r&15)<<2|i>>6,l=i&63,isNaN(r)?o=l=64:isNaN(i)&&(l=64),t+=ga.charAt(s)+ga.charAt(a)+ga.charAt(o)+ga.charAt(l);return t}function Zr(e){var t="",n=0,r=0,i=0,s=0,a=0,o=0,l=0;e=e.replace(/[^\w\+\/\=]/g,"");for(var u=0;u<e.length;)s=ga.indexOf(e.charAt(u++)),a=ga.indexOf(e.charAt(u++)),n=s<<2|a>>4,t+=String.fromCharCode(n),o=ga.indexOf(e.charAt(u++)),r=(a&15)<<4|o>>2,o!==64&&(t+=String.fromCharCode(r)),l=ga.indexOf(e.charAt(u++)),i=(o&3)<<6|l,l!==64&&(t+=String.fromCharCode(i));return t}var dt=function(){return typeof Buffer<"u"&&typeof process<"u"&&typeof process.versions<"u"&&!!process.versions.node}(),$s=function(){if(typeof Buffer<"u"){var e=!Buffer.from;if(!e)try{Buffer.from("foo","utf8")}catch{e=!0}return e?function(t,n){return n?new Buffer(t,n):new Buffer(t)}:Buffer.from.bind(Buffer)}return function(){}}();function Na(e){return dt?Buffer.alloc?Buffer.alloc(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}function bS(e){return dt?Buffer.allocUnsafe?Buffer.allocUnsafe(e):new Buffer(e):typeof Uint8Array<"u"?new Uint8Array(e):new Array(e)}var Gr=function(t){return dt?$s(t,"binary"):t.split("").map(function(n){return n.charCodeAt(0)&255})};function Jh(e){if(typeof ArrayBuffer>"u")return Gr(e);for(var t=new ArrayBuffer(e.length),n=new Uint8Array(t),r=0;r!=e.length;++r)n[r]=e.charCodeAt(r)&255;return t}function Wa(e){if(Array.isArray(e))return e.map(function(r){return String.fromCharCode(r)}).join("");for(var t=[],n=0;n<e.length;++n)t[n]=String.fromCharCode(e[n]);return t.join("")}function bB(e){if(typeof Uint8Array>"u")throw new Error("Unsupported");return new Uint8Array(e)}function E1(e){if(typeof ArrayBuffer>"u")throw new Error("Unsupported");if(e instanceof ArrayBuffer)return E1(new Uint8Array(e));for(var t=new Array(e.length),n=0;n<e.length;++n)t[n]=e[n];return t}var Hn=dt?function(e){return Buffer.concat(e.map(function(t){return Buffer.isBuffer(t)?t:$s(t)}))}:function(e){if(typeof Uint8Array<"u"){var t=0,n=0;for(t=0;t<e.length;++t)n+=e[t].length;var r=new Uint8Array(n),i=0;for(t=0,n=0;t<e.length;n+=i,++t)if(i=e[t].length,e[t]instanceof Uint8Array)r.set(e[t],n);else{if(typeof e[t]=="string")throw"wtf";r.set(new Uint8Array(e[t]),n)}return r}return[].concat.apply([],e.map(function(s){return Array.isArray(s)?s:[].slice.call(s)}))};function LB(e){for(var t=[],n=0,r=e.length+250,i=Na(e.length+255),s=0;s<e.length;++s){var a=e.charCodeAt(s);if(a<128)i[n++]=a;else if(a<2048)i[n++]=192|a>>6&31,i[n++]=128|a&63;else if(a>=55296&&a<57344){a=(a&1023)+64;var o=e.charCodeAt(++s)&1023;i[n++]=240|a>>8&7,i[n++]=128|a>>2&63,i[n++]=128|o>>6&15|(a&3)<<4,i[n++]=128|o&63}else i[n++]=224|a>>12&15,i[n++]=128|a>>6&63,i[n++]=128|a&63;n>r&&(t.push(i.slice(0,n)),n=0,i=Na(65535),r=65530)}return t.push(i.slice(0,n)),Hn(t)}var _r=/\u0000/g,cc=/[\u0001-\u0006]/g;function Bl(e){for(var t="",n=e.length-1;n>=0;)t+=e.charAt(n--);return t}function Oi(e,t){var n=""+e;return n.length>=t?n:mn("0",t-n.length)+n}function _1(e,t){var n=""+e;return n.length>=t?n:mn(" ",t-n.length)+n}function eh(e,t){var n=""+e;return n.length>=t?n:n+mn(" ",t-n.length)}function OB(e,t){var n=""+Math.round(e);return n.length>=t?n:mn("0",t-n.length)+n}function BB(e,t){var n=""+e;return n.length>=t?n:mn("0",t-n.length)+n}var LS=Math.pow(2,32);function il(e,t){if(e>LS||e<-LS)return OB(e,t);var n=Math.round(e);return BB(n,t)}function th(e,t){return t=t||0,e.length>=7+t&&(e.charCodeAt(t)|32)===103&&(e.charCodeAt(t+1)|32)===101&&(e.charCodeAt(t+2)|32)===110&&(e.charCodeAt(t+3)|32)===101&&(e.charCodeAt(t+4)|32)===114&&(e.charCodeAt(t+5)|32)===97&&(e.charCodeAt(t+6)|32)===108}var OS=[["Sun","Sunday"],["Mon","Monday"],["Tue","Tuesday"],["Wed","Wednesday"],["Thu","Thursday"],["Fri","Friday"],["Sat","Saturday"]],sm=[["J","Jan","January"],["F","Feb","February"],["M","Mar","March"],["A","Apr","April"],["M","May","May"],["J","Jun","June"],["J","Jul","July"],["A","Aug","August"],["S","Sep","September"],["O","Oct","October"],["N","Nov","November"],["D","Dec","December"]];function UB(e){return e||(e={}),e[0]="General",e[1]="0",e[2]="0.00",e[3]="#,##0",e[4]="#,##0.00",e[9]="0%",e[10]="0.00%",e[11]="0.00E+00",e[12]="# ?/?",e[13]="# ??/??",e[14]="m/d/yy",e[15]="d-mmm-yy",e[16]="d-mmm",e[17]="mmm-yy",e[18]="h:mm AM/PM",e[19]="h:mm:ss AM/PM",e[20]="h:mm",e[21]="h:mm:ss",e[22]="m/d/yy h:mm",e[37]="#,##0 ;(#,##0)",e[38]="#,##0 ;[Red](#,##0)",e[39]="#,##0.00;(#,##0.00)",e[40]="#,##0.00;[Red](#,##0.00)",e[45]="mm:ss",e[46]="[h]:mm:ss",e[47]="mmss.0",e[48]="##0.0E+0",e[49]="@",e[56]='"/ "hh""mm""ss" "',e}var et={0:"General",1:"0",2:"0.00",3:"#,##0",4:"#,##0.00",9:"0%",10:"0.00%",11:"0.00E+00",12:"# ?/?",13:"# ??/??",14:"m/d/yy",15:"d-mmm-yy",16:"d-mmm",17:"mmm-yy",18:"h:mm AM/PM",19:"h:mm:ss AM/PM",20:"h:mm",21:"h:mm:ss",22:"m/d/yy h:mm",37:"#,##0 ;(#,##0)",38:"#,##0 ;[Red](#,##0)",39:"#,##0.00;(#,##0.00)",40:"#,##0.00;[Red](#,##0.00)",45:"mm:ss",46:"[h]:mm:ss",47:"mmss.0",48:"##0.0E+0",49:"@",56:'"/ "hh""mm""ss" "'},BS={5:37,6:38,7:39,8:40,23:0,24:0,25:0,26:0,27:14,28:14,29:14,30:14,31:14,50:14,51:14,52:14,53:14,54:14,55:14,56:14,57:14,58:14,59:1,60:2,61:3,62:4,67:9,68:10,69:12,70:13,71:14,72:14,73:15,74:16,75:17,76:20,77:21,78:22,79:45,80:46,81:47,82:0},VB={5:'"$"#,##0_);\\("$"#,##0\\)',63:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',41:'_(* #,##0_);_(* \\(#,##0\\);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* \\(#,##0\\);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* \\(#,##0.00\\);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* \\(#,##0.00\\);_("$"* "-"??_);_(@_)'};function nh(e,t,n){for(var r=e<0?-1:1,i=e*r,s=0,a=1,o=0,l=1,u=0,c=0,h=Math.floor(i);u<t&&(h=Math.floor(i),o=h*a+s,c=h*u+l,!(i-h<5e-8));)i=1/(i-h),s=a,a=o,l=u,u=c;if(c>t&&(u>t?(c=l,o=s):(c=u,o=a)),!n)return[0,r*o,c];var p=Math.floor(r*o/c);return[p,r*o-p*c,c]}function oo(e,t,n){if(e>2958465||e<0)return null;var r=e|0,i=Math.floor(86400*(e-r)),s=0,a=[],o={D:r,T:i,u:86400*(e-r)-i,y:0,m:0,d:0,H:0,M:0,S:0,q:0};if(Math.abs(o.u)<1e-6&&(o.u=0),t&&t.date1904&&(r+=1462),o.u>.9999&&(o.u=0,++i==86400&&(o.T=i=0,++r,++o.D)),r===60)a=n?[1317,10,29]:[1900,2,29],s=3;else if(r===0)a=n?[1317,8,29]:[1900,1,0],s=6;else{r>60&&--r;var l=new Date(1900,0,1);l.setDate(l.getDate()+r-1),a=[l.getFullYear(),l.getMonth()+1,l.getDate()],s=l.getDay(),r<60&&(s=(s+6)%7),n&&(s=qB(l,a))}return o.y=a[0],o.m=a[1],o.d=a[2],o.S=i%60,i=Math.floor(i/60),o.M=i%60,i=Math.floor(i/60),o.H=i,o.q=s,o}var $M=new Date(1899,11,31,0,0,0),HB=$M.getTime(),$B=new Date(1900,2,1,0,0,0);function zM(e,t){var n=e.getTime();return t?n-=1461*24*60*60*1e3:e>=$B&&(n+=24*60*60*1e3),(n-(HB+(e.getTimezoneOffset()-$M.getTimezoneOffset())*6e4))/(24*60*60*1e3)}function C1(e){return e.indexOf(".")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)$/,"$1")}function zB(e){return e.indexOf("E")==-1?e:e.replace(/(?:\.0*|(\.\d*[1-9])0+)[Ee]/,"$1E").replace(/(E[+-])(\d)$/,"$10$2")}function WB(e){var t=e<0?12:11,n=C1(e.toFixed(12));return n.length<=t||(n=e.toPrecision(10),n.length<=t)?n:e.toExponential(5)}function GB(e){var t=C1(e.toFixed(11));return t.length>(e<0?12:11)||t==="0"||t==="-0"?e.toPrecision(6):t}function df(e){var t=Math.floor(Math.log(Math.abs(e))*Math.LOG10E),n;return t>=-4&&t<=-1?n=e.toPrecision(10+t):Math.abs(t)<=9?n=WB(e):t===10?n=e.toFixed(10).substr(0,12):n=GB(e),C1(zB(n.toUpperCase()))}function Do(e,t){switch(typeof e){case"string":return e;case"boolean":return e?"TRUE":"FALSE";case"number":return(e|0)===e?e.toString(10):df(e);case"undefined":return"";case"object":if(e==null)return"";if(e instanceof Date)return _i(14,zM(e,t&&t.date1904),t)}throw new Error("unsupported value in General format: "+e)}function qB(e,t){t[0]-=581;var n=e.getDay();return e<60&&(n=(n+6)%7),n}function KB(e,t,n,r){var i="",s=0,a=0,o=n.y,l,u=0;switch(e){case 98:o=n.y+543;case 121:switch(t.length){case 1:case 2:l=o%100,u=2;break;default:l=o%1e4,u=4;break}break;case 109:switch(t.length){case 1:case 2:l=n.m,u=t.length;break;case 3:return sm[n.m-1][1];case 5:return sm[n.m-1][0];default:return sm[n.m-1][2]}break;case 100:switch(t.length){case 1:case 2:l=n.d,u=t.length;break;case 3:return OS[n.q][0];default:return OS[n.q][1]}break;case 104:switch(t.length){case 1:case 2:l=1+(n.H+11)%12,u=t.length;break;default:throw"bad hour format: "+t}break;case 72:switch(t.length){case 1:case 2:l=n.H,u=t.length;break;default:throw"bad hour format: "+t}break;case 77:switch(t.length){case 1:case 2:l=n.M,u=t.length;break;default:throw"bad minute format: "+t}break;case 115:if(t!="s"&&t!="ss"&&t!=".0"&&t!=".00"&&t!=".000")throw"bad second format: "+t;return n.u===0&&(t=="s"||t=="ss")?Oi(n.S,t.length):(r>=2?a=r===3?1e3:100:a=r===1?10:1,s=Math.round(a*(n.S+n.u)),s>=60*a&&(s=0),t==="s"?s===0?"0":""+s/a:(i=Oi(s,2+r),t==="ss"?i.substr(0,2):"."+i.substr(2,t.length-1)));case 90:switch(t){case"[h]":case"[hh]":l=n.D*24+n.H;break;case"[m]":case"[mm]":l=(n.D*24+n.H)*60+n.M;break;case"[s]":case"[ss]":l=((n.D*24+n.H)*60+n.M)*60+Math.round(n.S+n.u);break;default:throw"bad abstime format: "+t}u=t.length===3?1:2;break;case 101:l=o,u=1;break}var c=u>0?Oi(l,u):"";return c}function va(e){var t=3;if(e.length<=t)return e;for(var n=e.length%t,r=e.substr(0,n);n!=e.length;n+=t)r+=(r.length>0?",":"")+e.substr(n,t);return r}var WM=/%/g;function YB(e,t,n){var r=t.replace(WM,""),i=t.length-r.length;return Fs(e,r,n*Math.pow(10,2*i))+mn("%",i)}function XB(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Fs(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function GM(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+GM(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),n.indexOf("e")===-1){var a=Math.floor(Math.log(t)*Math.LOG10E);for(n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+s):n+="E+"+(a-s);n.substr(0,2)==="0.";)n=n.charAt(0)+n.substr(2,i)+"."+n.substr(2+i),n=n.replace(/^0+([1-9])/,"$1").replace(/^0+\./,"0.");n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}var qM=/# (\?+)( ?)\/( ?)(\d+)/;function JB(e,t,n){var r=parseInt(e[4],10),i=Math.round(t*r),s=Math.floor(i/r),a=i-s*r,o=r;return n+(s===0?"":""+s)+" "+(a===0?mn(" ",e[1].length+1+e[4].length):_1(a,e[1].length)+e[2]+"/"+e[3]+Oi(o,e[4].length))}function QB(e,t,n){return n+(t===0?"":""+t)+mn(" ",e[1].length+2+e[4].length)}var KM=/^#*0*\.([0#]+)/,YM=/\).*[0#]/,XM=/\(###\) ###\\?-####/;function wr(e){for(var t="",n,r=0;r!=e.length;++r)switch(n=e.charCodeAt(r)){case 35:break;case 63:t+=" ";break;case 48:t+="0";break;default:t+=String.fromCharCode(n)}return t}function US(e,t){var n=Math.pow(10,t);return""+Math.round(e*n)/n}function VS(e,t){var n=e-Math.floor(e),r=Math.pow(10,t);return t<(""+Math.round(n*r)).length?0:Math.round(n*r)}function jB(e,t){return t<(""+Math.round((e-Math.floor(e))*Math.pow(10,t))).length?1:0}function ZB(e){return e<2147483647&&e>-2147483648?""+(e>=0?e|0:e-1|0):""+Math.floor(e)}function si(e,t,n){if(e.charCodeAt(0)===40&&!t.match(YM)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?si("n",r,n):"("+si("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return XB(e,t,n);if(t.indexOf("%")!==-1)return YB(e,t,n);if(t.indexOf("E")!==-1)return GM(t,n);if(t.charCodeAt(0)===36)return"$"+si(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,a,o,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+il(l,t.length);if(t.match(/^[#?]+$/))return i=il(n,0),i==="0"&&(i=""),i.length>t.length?i:wr(t.substr(0,t.length-i.length))+i;if(s=t.match(qM))return JB(s,l,u);if(t.match(/^#+0+$/))return u+il(l,t.length-t.indexOf("0"));if(s=t.match(KM))return i=US(n,s[1].length).replace(/^([^\.]+)$/,"$1."+wr(s[1])).replace(/\.$/,"."+wr(s[1])).replace(/\.(\d*)$/,function(v,g){return"."+g+mn("0",wr(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+US(l,s[2].length).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+va(il(l,0));if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+si(e,t,-n):va(""+(Math.floor(n)+jB(n,s[1].length)))+"."+Oi(VS(n,s[1].length),s[1].length);if(s=t.match(/^#,#*,#0/))return si(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bl(si(e,t.replace(/[\\-]/g,""),n)),a=0,Bl(Bl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(XM))return i=si(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=nh(l,Math.pow(10,a)-1,!1),i=""+u,c=Fs("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=eh(o[2],a),c.length<s[4].length&&(c=wr(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=nh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?_1(o[1],a)+s[2]+"/"+s[3]+eh(o[2],a):mn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=il(n,0),t.length<=i.length?i:wr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0?]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,p=t.length-i.length-h;return wr(t.substr(0,h)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return a=VS(n,s[1].length),n<0?"-"+si(e,t,-n):va(ZB(n)).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Oi(0,3-v.length):"")+v})+"."+Oi(a,s[1].length);switch(t){case"###,##0.00":return si(e,"#,##0.00",n);case"###,###":case"##,###":case"#,###":var m=va(il(l,0));return m!=="0"?u+m:"";case"###,###.00":return si(e,"###,##0.00",n).replace(/^0\./,".");case"#,###.00":return si(e,"#,##0.00",n).replace(/^0\./,".")}throw new Error("unsupported format |"+t+"|")}function eU(e,t,n){for(var r=t.length-1;t.charCodeAt(r-1)===44;)--r;return Fs(e,t.substr(0,r),n/Math.pow(10,3*(t.length-r)))}function tU(e,t,n){var r=t.replace(WM,""),i=t.length-r.length;return Fs(e,r,n*Math.pow(10,2*i))+mn("%",i)}function JM(e,t){var n,r=e.indexOf("E")-e.indexOf(".")-1;if(e.match(/^#+0.0E\+0$/)){if(t==0)return"0.0E+0";if(t<0)return"-"+JM(e,-t);var i=e.indexOf(".");i===-1&&(i=e.indexOf("E"));var s=Math.floor(Math.log(t)*Math.LOG10E)%i;if(s<0&&(s+=i),n=(t/Math.pow(10,s)).toPrecision(r+1+(i+s)%i),!n.match(/[Ee]/)){var a=Math.floor(Math.log(t)*Math.LOG10E);n.indexOf(".")===-1?n=n.charAt(0)+"."+n.substr(1)+"E+"+(a-n.length+s):n+="E+"+(a-s),n=n.replace(/\+-/,"-")}n=n.replace(/^([+-]?)(\d*)\.(\d*)[Ee]/,function(o,l,u,c){return l+u+c.substr(0,(i+s)%i)+"."+c.substr(s)+"E"})}else n=t.toExponential(r);return e.match(/E\+00$/)&&n.match(/e[+-]\d$/)&&(n=n.substr(0,n.length-1)+"0"+n.charAt(n.length-1)),e.match(/E\-/)&&n.match(/e\+/)&&(n=n.replace(/e\+/,"e")),n.replace("e","E")}function Xi(e,t,n){if(e.charCodeAt(0)===40&&!t.match(YM)){var r=t.replace(/\( */,"").replace(/ \)/,"").replace(/\)/,"");return n>=0?Xi("n",r,n):"("+Xi("n",r,-n)+")"}if(t.charCodeAt(t.length-1)===44)return eU(e,t,n);if(t.indexOf("%")!==-1)return tU(e,t,n);if(t.indexOf("E")!==-1)return JM(t,n);if(t.charCodeAt(0)===36)return"$"+Xi(e,t.substr(t.charAt(1)==" "?2:1),n);var i,s,a,o,l=Math.abs(n),u=n<0?"-":"";if(t.match(/^00+$/))return u+Oi(l,t.length);if(t.match(/^[#?]+$/))return i=""+n,n===0&&(i=""),i.length>t.length?i:wr(t.substr(0,t.length-i.length))+i;if(s=t.match(qM))return QB(s,l,u);if(t.match(/^#+0+$/))return u+Oi(l,t.length-t.indexOf("0"));if(s=t.match(KM))return i=(""+n).replace(/^([^\.]+)$/,"$1."+wr(s[1])).replace(/\.$/,"."+wr(s[1])),i=i.replace(/\.(\d*)$/,function(v,g){return"."+g+mn("0",wr(s[1]).length-g.length)}),t.indexOf("0.")!==-1?i:i.replace(/^0\./,".");if(t=t.replace(/^#+([0.])/,"$1"),s=t.match(/^(0*)\.(#*)$/))return u+(""+l).replace(/\.(\d*[1-9])0*$/,".$1").replace(/^(-?\d*)$/,"$1.").replace(/^0\./,s[1].length?"0.":".");if(s=t.match(/^#{1,3},##0(\.?)$/))return u+va(""+l);if(s=t.match(/^#,##0\.([#0]*0)$/))return n<0?"-"+Xi(e,t,-n):va(""+n)+"."+mn("0",s[1].length);if(s=t.match(/^#,#*,#0/))return Xi(e,t.replace(/^#,#*,/,""),n);if(s=t.match(/^([0#]+)(\\?-([0#]+))+$/))return i=Bl(Xi(e,t.replace(/[\\-]/g,""),n)),a=0,Bl(Bl(t.replace(/\\/g,"")).replace(/[0#]/g,function(v){return a<i.length?i.charAt(a++):v==="0"?"0":""}));if(t.match(XM))return i=Xi(e,"##########",n),"("+i.substr(0,3)+") "+i.substr(3,3)+"-"+i.substr(6);var c="";if(s=t.match(/^([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(s[4].length,7),o=nh(l,Math.pow(10,a)-1,!1),i=""+u,c=Fs("n",s[1],o[1]),c.charAt(c.length-1)==" "&&(c=c.substr(0,c.length-1)+"0"),i+=c+s[2]+"/"+s[3],c=eh(o[2],a),c.length<s[4].length&&(c=wr(s[4].substr(s[4].length-c.length))+c),i+=c,i;if(s=t.match(/^# ([#0?]+)( ?)\/( ?)([#0?]+)/))return a=Math.min(Math.max(s[1].length,s[4].length),7),o=nh(l,Math.pow(10,a)-1,!0),u+(o[0]||(o[1]?"":"0"))+" "+(o[1]?_1(o[1],a)+s[2]+"/"+s[3]+eh(o[2],a):mn(" ",2*a+1+s[2].length+s[3].length));if(s=t.match(/^[#0?]+$/))return i=""+n,t.length<=i.length?i:wr(t.substr(0,t.length-i.length))+i;if(s=t.match(/^([#0]+)\.([#0]+)$/)){i=""+n.toFixed(Math.min(s[2].length,10)).replace(/([^0])0+$/,"$1"),a=i.indexOf(".");var h=t.indexOf(".")-a,p=t.length-i.length-h;return wr(t.substr(0,h)+i+t.substr(t.length-p))}if(s=t.match(/^00,000\.([#0]*0)$/))return n<0?"-"+Xi(e,t,-n):va(""+n).replace(/^\d,\d{3}$/,"0$&").replace(/^\d*$/,function(v){return"00,"+(v.length<3?Oi(0,3-v.length):"")+v})+"."+Oi(0,s[1].length);switch(t){case"###,###":case"##,###":case"#,###":var m=va(""+l);return m!=="0"?u+m:"";default:if(t.match(/\.[0#?]*$/))return Xi(e,t.slice(0,t.lastIndexOf(".")),n)+wr(t.slice(t.lastIndexOf(".")))}throw new Error("unsupported format |"+t+"|")}function Fs(e,t,n){return(n|0)===n?Xi(e,t,n):si(e,t,n)}function nU(e){for(var t=[],n=!1,r=0,i=0;r<e.length;++r)switch(e.charCodeAt(r)){case 34:n=!n;break;case 95:case 42:case 92:++r;break;case 59:t[t.length]=e.substr(i,r-i),i=r+1}if(t[t.length]=e.substr(i),n===!0)throw new Error("Format |"+e+"| unterminated string ");return t}var QM=/\[[HhMmSs\u0E0A\u0E19\u0E17]*\]/;function ku(e){for(var t=0,n="",r="";t<e.length;)switch(n=e.charAt(t)){case"G":th(e,t)&&(t+=6),t++;break;case'"':for(;e.charCodeAt(++t)!==34&&t<e.length;);++t;break;case"\\":t+=2;break;case"_":t+=2;break;case"@":++t;break;case"B":case"b":if(e.charAt(t+1)==="1"||e.charAt(t+1)==="2")return!0;case"M":case"D":case"Y":case"H":case"S":case"E":case"m":case"d":case"y":case"h":case"s":case"e":case"g":return!0;case"A":case"a":case"":if(e.substr(t,3).toUpperCase()==="A/P"||e.substr(t,5).toUpperCase()==="AM/PM"||e.substr(t,5).toUpperCase()==="/")return!0;++t;break;case"[":for(r=n;e.charAt(t++)!=="]"&&t<e.length;)r+=e.charAt(t);if(r.match(QM))return!0;break;case".":case"0":case"#":for(;t<e.length&&("0#?.,E+-%".indexOf(n=e.charAt(++t))>-1||n=="\\"&&e.charAt(t+1)=="-"&&"0#".indexOf(e.charAt(t+2))>-1););break;case"?":for(;e.charAt(++t)===n;);break;case"*":++t,(e.charAt(t)==" "||e.charAt(t)=="*")&&++t;break;case"(":case")":++t;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(;t<e.length&&"0123456789".indexOf(e.charAt(++t))>-1;);break;case" ":++t;break;default:++t;break}return!1}function rU(e,t,n,r){for(var i=[],s="",a=0,o="",l="t",u,c,h,p="H";a<e.length;)switch(o=e.charAt(a)){case"G":if(!th(e,a))throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"G",v:"General"},a+=7;break;case'"':for(s="";(h=e.charCodeAt(++a))!==34&&a<e.length;)s+=String.fromCharCode(h);i[i.length]={t:"t",v:s},++a;break;case"\\":var m=e.charAt(++a),v=m==="("||m===")"?m:"t";i[i.length]={t:v,v:m},++a;break;case"_":i[i.length]={t:"t",v:" "},a+=2;break;case"@":i[i.length]={t:"T",v:t},++a;break;case"B":case"b":if(e.charAt(a+1)==="1"||e.charAt(a+1)==="2"){if(u==null&&(u=oo(t,n,e.charAt(a+1)==="2"),u==null))return"";i[i.length]={t:"X",v:e.substr(a,2)},l=o,a+=2;break}case"M":case"D":case"Y":case"H":case"S":case"E":o=o.toLowerCase();case"m":case"d":case"y":case"h":case"s":case"e":case"g":if(t<0||u==null&&(u=oo(t,n),u==null))return"";for(s=o;++a<e.length&&e.charAt(a).toLowerCase()===o;)s+=o;o==="m"&&l.toLowerCase()==="h"&&(o="M"),o==="h"&&(o=p),i[i.length]={t:o,v:s},l=o;break;case"A":case"a":case"":var g={t:o,v:o};if(u==null&&(u=oo(t,n)),e.substr(a,3).toUpperCase()==="A/P"?(u!=null&&(g.v=u.H>=12?"P":"A"),g.t="T",p="h",a+=3):e.substr(a,5).toUpperCase()==="AM/PM"?(u!=null&&(g.v=u.H>=12?"PM":"AM"),g.t="T",a+=5,p="h"):e.substr(a,5).toUpperCase()==="/"?(u!=null&&(g.v=u.H>=12?"":""),g.t="T",a+=5,p="h"):(g.t="t",++a),u==null&&g.t==="T")return"";i[i.length]=g,l=o;break;case"[":for(s=o;e.charAt(a++)!=="]"&&a<e.length;)s+=e.charAt(a);if(s.slice(-1)!=="]")throw'unterminated "[" block: |'+s+"|";if(s.match(QM)){if(u==null&&(u=oo(t,n),u==null))return"";i[i.length]={t:"Z",v:s.toLowerCase()},l=s.charAt(1)}else s.indexOf("$")>-1&&(s=(s.match(/\$([^-\[\]]*)/)||[])[1]||"$",ku(e)||(i[i.length]={t:"t",v:s}));break;case".":if(u!=null){for(s=o;++a<e.length&&(o=e.charAt(a))==="0";)s+=o;i[i.length]={t:"s",v:s};break}case"0":case"#":for(s=o;++a<e.length&&"0#?.,E+-%".indexOf(o=e.charAt(a))>-1;)s+=o;i[i.length]={t:"n",v:s};break;case"?":for(s=o;e.charAt(++a)===o;)s+=o;i[i.length]={t:o,v:s},l=o;break;case"*":++a,(e.charAt(a)==" "||e.charAt(a)=="*")&&++a;break;case"(":case")":i[i.length]={t:r===1?"t":o,v:o},++a;break;case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":for(s=o;a<e.length&&"0123456789".indexOf(e.charAt(++a))>-1;)s+=e.charAt(a);i[i.length]={t:"D",v:s};break;case" ":i[i.length]={t:o,v:o},++a;break;case"$":i[i.length]={t:"t",v:"$"},++a;break;default:if(",$-+/():!^&'~{}<>=acfijklopqrtuvwxzP".indexOf(o)===-1)throw new Error("unrecognized character "+o+" in "+e);i[i.length]={t:"t",v:o},++a;break}var w=0,x=0,T;for(a=i.length-1,l="t";a>=0;--a)switch(i[a].t){case"h":case"H":i[a].t=p,l="h",w<1&&(w=1);break;case"s":(T=i[a].v.match(/\.0+$/))&&(x=Math.max(x,T[0].length-1)),w<3&&(w=3);case"d":case"y":case"M":case"e":l=i[a].t;break;case"m":l==="s"&&(i[a].t="M",w<2&&(w=2));break;case"X":break;case"Z":w<1&&i[a].v.match(/[Hh]/)&&(w=1),w<2&&i[a].v.match(/[Mm]/)&&(w=2),w<3&&i[a].v.match(/[Ss]/)&&(w=3)}switch(w){case 0:break;case 1:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M),u.M>=60&&(u.M=0,++u.H);break;case 2:u.u>=.5&&(u.u=0,++u.S),u.S>=60&&(u.S=0,++u.M);break}var y="",_;for(a=0;a<i.length;++a)switch(i[a].t){case"t":case"T":case" ":case"D":break;case"X":i[a].v="",i[a].t=";";break;case"d":case"m":case"y":case"h":case"H":case"M":case"s":case"e":case"b":case"Z":i[a].v=KB(i[a].t.charCodeAt(0),i[a].v,u,x),i[a].t="t";break;case"n":case"?":for(_=a+1;i[_]!=null&&((o=i[_].t)==="?"||o==="D"||(o===" "||o==="t")&&i[_+1]!=null&&(i[_+1].t==="?"||i[_+1].t==="t"&&i[_+1].v==="/")||i[a].t==="("&&(o===" "||o==="n"||o===")")||o==="t"&&(i[_].v==="/"||i[_].v===" "&&i[_+1]!=null&&i[_+1].t=="?"));)i[a].v+=i[_].v,i[_]={v:"",t:";"},++_;y+=i[a].v,a=_-1;break;case"G":i[a].t="t",i[a].v=Do(t,n);break}var k="",S,C;if(y.length>0){y.charCodeAt(0)==40?(S=t<0&&y.charCodeAt(0)===45?-t:t,C=Fs("n",y,S)):(S=t<0&&r>1?-t:t,C=Fs("n",y,S),S<0&&i[0]&&i[0].t=="t"&&(C=C.substr(1),i[0].v="-"+i[0].v)),_=C.length-1;var M=i.length;for(a=0;a<i.length;++a)if(i[a]!=null&&i[a].t!="t"&&i[a].v.indexOf(".")>-1){M=a;break}var F=i.length;if(M===i.length&&C.indexOf("E")===-1){for(a=i.length-1;a>=0;--a)i[a]==null||"n?".indexOf(i[a].t)===-1||(_>=i[a].v.length-1?(_-=i[a].v.length,i[a].v=C.substr(_+1,i[a].v.length)):_<0?i[a].v="":(i[a].v=C.substr(0,_+1),_=-1),i[a].t="t",F=a);_>=0&&F<i.length&&(i[F].v=C.substr(0,_+1)+i[F].v)}else if(M!==i.length&&C.indexOf("E")===-1){for(_=C.indexOf(".")-1,a=M;a>=0;--a)if(!(i[a]==null||"n?".indexOf(i[a].t)===-1)){for(c=i[a].v.indexOf(".")>-1&&a===M?i[a].v.indexOf(".")-1:i[a].v.length-1,k=i[a].v.substr(c+1);c>=0;--c)_>=0&&(i[a].v.charAt(c)==="0"||i[a].v.charAt(c)==="#")&&(k=C.charAt(_--)+k);i[a].v=k,i[a].t="t",F=a}for(_>=0&&F<i.length&&(i[F].v=C.substr(0,_+1)+i[F].v),_=C.indexOf(".")+1,a=M;a<i.length;++a)if(!(i[a]==null||"n?(".indexOf(i[a].t)===-1&&a!==M)){for(c=i[a].v.indexOf(".")>-1&&a===M?i[a].v.indexOf(".")+1:0,k=i[a].v.substr(0,c);c<i[a].v.length;++c)_<C.length&&(k+=C.charAt(_++));i[a].v=k,i[a].t="t",F=a}}}for(a=0;a<i.length;++a)i[a]!=null&&"n?".indexOf(i[a].t)>-1&&(S=r>1&&t<0&&a>0&&i[a-1].v==="-"?-t:t,i[a].v=Fs(i[a].t,i[a].v,S),i[a].t="t");var b="";for(a=0;a!==i.length;++a)i[a]!=null&&(b+=i[a].v);return b}var HS=/\[(=|>[=]?|<[>=]?)(-?\d+(?:\.\d*)?)\]/;function $S(e,t){if(t==null)return!1;var n=parseFloat(t[2]);switch(t[1]){case"=":if(e==n)return!0;break;case">":if(e>n)return!0;break;case"<":if(e<n)return!0;break;case"<>":if(e!=n)return!0;break;case">=":if(e>=n)return!0;break;case"<=":if(e<=n)return!0;break}return!1}function iU(e,t){var n=nU(e),r=n.length,i=n[r-1].indexOf("@");if(r<4&&i>-1&&--r,n.length>4)throw new Error("cannot find right format for |"+n.join("|")+"|");if(typeof t!="number")return[4,n.length===4||i>-1?n[n.length-1]:"@"];switch(n.length){case 1:n=i>-1?["General","General","General",n[0]]:[n[0],n[0],n[0],"@"];break;case 2:n=i>-1?[n[0],n[0],n[0],n[1]]:[n[0],n[1],n[0],"@"];break;case 3:n=i>-1?[n[0],n[1],n[0],n[2]]:[n[0],n[1],n[2],"@"];break}var s=t>0?n[0]:t<0?n[1]:n[2];if(n[0].indexOf("[")===-1&&n[1].indexOf("[")===-1)return[r,s];if(n[0].match(/\[[=<>]/)!=null||n[1].match(/\[[=<>]/)!=null){var a=n[0].match(HS),o=n[1].match(HS);return $S(t,a)?[r,n[0]]:$S(t,o)?[r,n[1]]:[r,n[a!=null&&o!=null?2:1]]}return[r,s]}function _i(e,t,n){n==null&&(n={});var r="";switch(typeof e){case"string":e=="m/d/yy"&&n.dateNF?r=n.dateNF:r=e;break;case"number":e==14&&n.dateNF?r=n.dateNF:r=(n.table!=null?n.table:et)[e],r==null&&(r=n.table&&n.table[BS[e]]||et[BS[e]]),r==null&&(r=VB[e]||"General");break}if(th(r,0))return Do(t,n);t instanceof Date&&(t=zM(t,n.date1904));var i=iU(r,t);if(th(i[1]))return Do(t,n);if(t===!0)t="TRUE";else if(t===!1)t="FALSE";else if(t===""||t==null)return"";return rU(i[1],t,n,i[0])}function Ds(e,t){if(typeof t!="number"){t=+t||-1;for(var n=0;n<392;++n){if(et[n]==null){t<0&&(t=n);continue}if(et[n]==e){t=n;break}}t<0&&(t=391)}return et[t]=e,t}function Qh(e){for(var t=0;t!=392;++t)e[t]!==void 0&&Ds(e[t],t)}function Au(){et=UB()}var sU={5:'"$"#,##0_);\\("$"#,##0\\)',6:'"$"#,##0_);[Red]\\("$"#,##0\\)',7:'"$"#,##0.00_);\\("$"#,##0.00\\)',8:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',23:"General",24:"General",25:"General",26:"General",27:"m/d/yy",28:"m/d/yy",29:"m/d/yy",30:"m/d/yy",31:"m/d/yy",32:"h:mm:ss",33:"h:mm:ss",34:"h:mm:ss",35:"h:mm:ss",36:"m/d/yy",41:'_(* #,##0_);_(* (#,##0);_(* "-"_);_(@_)',42:'_("$"* #,##0_);_("$"* (#,##0);_("$"* "-"_);_(@_)',43:'_(* #,##0.00_);_(* (#,##0.00);_(* "-"??_);_(@_)',44:'_("$"* #,##0.00_);_("$"* (#,##0.00);_("$"* "-"??_);_(@_)',50:"m/d/yy",51:"m/d/yy",52:"m/d/yy",53:"m/d/yy",54:"m/d/yy",55:"m/d/yy",56:"m/d/yy",57:"m/d/yy",58:"m/d/yy",59:"0",60:"0.00",61:"#,##0",62:"#,##0.00",63:'"$"#,##0_);\\("$"#,##0\\)',64:'"$"#,##0_);[Red]\\("$"#,##0\\)',65:'"$"#,##0.00_);\\("$"#,##0.00\\)',66:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',67:"0%",68:"0.00%",69:"# ?/?",70:"# ??/??",71:"m/d/yy",72:"m/d/yy",73:"d-mmm-yy",74:"d-mmm",75:"mmm-yy",76:"h:mm",77:"h:mm:ss",78:"m/d/yy h:mm",79:"mm:ss",80:"[h]:mm:ss",81:"mmss.0"},jM=/[dD]+|[mM]+|[yYeE]+|[Hh]+|[Ss]+/g;function aU(e){var t=typeof e=="number"?et[e]:e;return t=t.replace(jM,"(\\d+)"),new RegExp("^"+t+"$")}function oU(e,t,n){var r=-1,i=-1,s=-1,a=-1,o=-1,l=-1;(t.match(jM)||[]).forEach(function(h,p){var m=parseInt(n[p+1],10);switch(h.toLowerCase().charAt(0)){case"y":r=m;break;case"d":s=m;break;case"h":a=m;break;case"s":l=m;break;case"m":a>=0?o=m:i=m;break}}),l>=0&&o==-1&&i>=0&&(o=i,i=-1);var u=(""+(r>=0?r:new Date().getFullYear())).slice(-4)+"-"+("00"+(i>=1?i:1)).slice(-2)+"-"+("00"+(s>=1?s:1)).slice(-2);u.length==7&&(u="0"+u),u.length==8&&(u="20"+u);var c=("00"+(a>=0?a:0)).slice(-2)+":"+("00"+(o>=0?o:0)).slice(-2)+":"+("00"+(l>=0?l:0)).slice(-2);return a==-1&&o==-1&&l==-1?u:r==-1&&i==-1&&s==-1?c:u+"T"+c}var lU=function(){var e={};e.version="1.2.0";function t(){for(var C=0,M=new Array(256),F=0;F!=256;++F)C=F,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,C=C&1?-306674912^C>>>1:C>>>1,M[F]=C;return typeof Int32Array<"u"?new Int32Array(M):M}var n=t();function r(C){var M=0,F=0,b=0,V=typeof Int32Array<"u"?new Int32Array(4096):new Array(4096);for(b=0;b!=256;++b)V[b]=C[b];for(b=0;b!=256;++b)for(F=C[b],M=256+b;M<4096;M+=256)F=V[M]=F>>>8^C[F&255];var z=[];for(b=1;b!=16;++b)z[b-1]=typeof Int32Array<"u"?V.subarray(b*256,b*256+256):V.slice(b*256,b*256+256);return z}var i=r(n),s=i[0],a=i[1],o=i[2],l=i[3],u=i[4],c=i[5],h=i[6],p=i[7],m=i[8],v=i[9],g=i[10],w=i[11],x=i[12],T=i[13],y=i[14];function _(C,M){for(var F=M^-1,b=0,V=C.length;b<V;)F=F>>>8^n[(F^C.charCodeAt(b++))&255];return~F}function k(C,M){for(var F=M^-1,b=C.length-15,V=0;V<b;)F=y[C[V++]^F&255]^T[C[V++]^F>>8&255]^x[C[V++]^F>>16&255]^w[C[V++]^F>>>24]^g[C[V++]]^v[C[V++]]^m[C[V++]]^p[C[V++]]^h[C[V++]]^c[C[V++]]^u[C[V++]]^l[C[V++]]^o[C[V++]]^a[C[V++]]^s[C[V++]]^n[C[V++]];for(b+=15;V<b;)F=F>>>8^n[(F^C[V++])&255];return~F}function S(C,M){for(var F=M^-1,b=0,V=C.length,z=0,ie=0;b<V;)z=C.charCodeAt(b++),z<128?F=F>>>8^n[(F^z)&255]:z<2048?(F=F>>>8^n[(F^(192|z>>6&31))&255],F=F>>>8^n[(F^(128|z&63))&255]):z>=55296&&z<57344?(z=(z&1023)+64,ie=C.charCodeAt(b++)&1023,F=F>>>8^n[(F^(240|z>>8&7))&255],F=F>>>8^n[(F^(128|z>>2&63))&255],F=F>>>8^n[(F^(128|ie>>6&15|(z&3)<<4))&255],F=F>>>8^n[(F^(128|ie&63))&255]):(F=F>>>8^n[(F^(224|z>>12&15))&255],F=F>>>8^n[(F^(128|z>>6&63))&255],F=F>>>8^n[(F^(128|z&63))&255]);return~F}return e.table=n,e.bstr=_,e.buf=k,e.str=S,e}(),Ke=function(){var t={};t.version="1.2.1";function n(A,I){for(var D=A.split("/"),P=I.split("/"),N=0,O=0,Z=Math.min(D.length,P.length);N<Z;++N){if(O=D[N].length-P[N].length)return O;if(D[N]!=P[N])return D[N]<P[N]?-1:1}return D.length-P.length}function r(A){if(A.charAt(A.length-1)=="/")return A.slice(0,-1).indexOf("/")===-1?A:r(A.slice(0,-1));var I=A.lastIndexOf("/");return I===-1?A:A.slice(0,I+1)}function i(A){if(A.charAt(A.length-1)=="/")return i(A.slice(0,-1));var I=A.lastIndexOf("/");return I===-1?A:A.slice(I+1)}function s(A,I){typeof I=="string"&&(I=new Date(I));var D=I.getHours();D=D<<6|I.getMinutes(),D=D<<5|I.getSeconds()>>>1,A.write_shift(2,D);var P=I.getFullYear()-1980;P=P<<4|I.getMonth()+1,P=P<<5|I.getDate(),A.write_shift(2,P)}function a(A){var I=A.read_shift(2)&65535,D=A.read_shift(2)&65535,P=new Date,N=D&31;D>>>=5;var O=D&15;D>>>=4,P.setMilliseconds(0),P.setFullYear(D+1980),P.setMonth(O-1),P.setDate(N);var Z=I&31;I>>>=5;var ce=I&63;return I>>>=6,P.setHours(I),P.setMinutes(ce),P.setSeconds(Z<<1),P}function o(A){Jn(A,0);for(var I={},D=0;A.l<=A.length-4;){var P=A.read_shift(2),N=A.read_shift(2),O=A.l+N,Z={};switch(P){case 21589:D=A.read_shift(1),D&1&&(Z.mtime=A.read_shift(4)),N>5&&(D&2&&(Z.atime=A.read_shift(4)),D&4&&(Z.ctime=A.read_shift(4))),Z.mtime&&(Z.mt=new Date(Z.mtime*1e3));break}A.l=O,I[P]=Z}return I}var l;function u(){return l||(l={})}function c(A,I){if(A[0]==80&&A[1]==75)return Gn(A,I);if((A[0]|32)==109&&(A[1]|32)==105)return Y(A,I);if(A.length<512)throw new Error("CFB file size "+A.length+" < 512");var D=3,P=512,N=0,O=0,Z=0,ce=0,X=0,J=[],re=A.slice(0,512);Jn(re,0);var le=h(re);switch(D=le[0],D){case 3:P=512;break;case 4:P=4096;break;case 0:if(le[1]==0)return Gn(A,I);default:throw new Error("Major Version: Expected 3 or 4 saw "+D)}P!==512&&(re=A.slice(0,P),Jn(re,28));var Ae=A.slice(0,P);p(re,D);var Te=re.read_shift(4,"i");if(D===3&&Te!==0)throw new Error("# Directory Sectors: Expected 0 saw "+Te);re.l+=4,Z=re.read_shift(4,"i"),re.l+=4,re.chk("00100000","Mini Stream Cutoff Size: "),ce=re.read_shift(4,"i"),N=re.read_shift(4,"i"),X=re.read_shift(4,"i"),O=re.read_shift(4,"i");for(var Ee=-1,De=0;De<109&&(Ee=re.read_shift(4,"i"),!(Ee<0));++De)J[De]=Ee;var Ge=m(A,P);w(X,O,Ge,P,J);var _t=T(Ge,Z,J,P);_t[Z].name="!Directory",N>0&&ce!==ie&&(_t[ce].name="!MiniFAT"),_t[J[0]].name="!FAT",_t.fat_addrs=J,_t.ssz=P;var Tt={},je=[],Xt=[],Vr=[];y(Z,_t,Ge,je,N,Tt,Xt,ce),v(Xt,Vr,je),je.shift();var Ar={FileIndex:Xt,FullPaths:Vr};return I&&I.raw&&(Ar.raw={header:Ae,sectors:Ge}),Ar}function h(A){if(A[A.l]==80&&A[A.l+1]==75)return[0,0];A.chk(Q,"Header Signature: "),A.l+=16;var I=A.read_shift(2,"u");return[A.read_shift(2,"u"),I]}function p(A,I){var D=9;switch(A.l+=2,D=A.read_shift(2)){case 9:if(I!=3)throw new Error("Sector Shift: Expected 9 saw "+D);break;case 12:if(I!=4)throw new Error("Sector Shift: Expected 12 saw "+D);break;default:throw new Error("Sector Shift: Expected 9 or 12 saw "+D)}A.chk("0600","Mini Sector Shift: "),A.chk("000000000000","Reserved: ")}function m(A,I){for(var D=Math.ceil(A.length/I)-1,P=[],N=1;N<D;++N)P[N-1]=A.slice(N*I,(N+1)*I);return P[D-1]=A.slice(D*I),P}function v(A,I,D){for(var P=0,N=0,O=0,Z=0,ce=0,X=D.length,J=[],re=[];P<X;++P)J[P]=re[P]=P,I[P]=D[P];for(;ce<re.length;++ce)P=re[ce],N=A[P].L,O=A[P].R,Z=A[P].C,J[P]===P&&(N!==-1&&J[N]!==N&&(J[P]=J[N]),O!==-1&&J[O]!==O&&(J[P]=J[O])),Z!==-1&&(J[Z]=P),N!==-1&&P!=J[P]&&(J[N]=J[P],re.lastIndexOf(N)<ce&&re.push(N)),O!==-1&&P!=J[P]&&(J[O]=J[P],re.lastIndexOf(O)<ce&&re.push(O));for(P=1;P<X;++P)J[P]===P&&(O!==-1&&J[O]!==O?J[P]=J[O]:N!==-1&&J[N]!==N&&(J[P]=J[N]));for(P=1;P<X;++P)if(A[P].type!==0){if(ce=P,ce!=J[ce])do ce=J[ce],I[P]=I[ce]+"/"+I[P];while(ce!==0&&J[ce]!==-1&&ce!=J[ce]);J[P]=-1}for(I[0]+="/",P=1;P<X;++P)A[P].type!==2&&(I[P]+="/")}function g(A,I,D){for(var P=A.start,N=A.size,O=[],Z=P;D&&N>0&&Z>=0;)O.push(I.slice(Z*z,Z*z+z)),N-=z,Z=Za(D,Z*4);return O.length===0?me(0):Hn(O).slice(0,A.size)}function w(A,I,D,P,N){var O=ie;if(A===ie){if(I!==0)throw new Error("DIFAT chain shorter than expected")}else if(A!==-1){var Z=D[A],ce=(P>>>2)-1;if(!Z)return;for(var X=0;X<ce&&(O=Za(Z,X*4))!==ie;++X)N.push(O);w(Za(Z,P-4),I-1,D,P,N)}}function x(A,I,D,P,N){var O=[],Z=[];N||(N=[]);var ce=P-1,X=0,J=0;for(X=I;X>=0;){N[X]=!0,O[O.length]=X,Z.push(A[X]);var re=D[Math.floor(X*4/P)];if(J=X*4&ce,P<4+J)throw new Error("FAT boundary crossed: "+X+" 4 "+P);if(!A[re])break;X=Za(A[re],J)}return{nodes:O,data:eE([Z])}}function T(A,I,D,P){var N=A.length,O=[],Z=[],ce=[],X=[],J=P-1,re=0,le=0,Ae=0,Te=0;for(re=0;re<N;++re)if(ce=[],Ae=re+I,Ae>=N&&(Ae-=N),!Z[Ae]){X=[];var Ee=[];for(le=Ae;le>=0;){Ee[le]=!0,Z[le]=!0,ce[ce.length]=le,X.push(A[le]);var De=D[Math.floor(le*4/P)];if(Te=le*4&J,P<4+Te)throw new Error("FAT boundary crossed: "+le+" 4 "+P);if(!A[De]||(le=Za(A[De],Te),Ee[le]))break}O[Ae]={nodes:ce,data:eE([X])}}return O}function y(A,I,D,P,N,O,Z,ce){for(var X=0,J=P.length?2:0,re=I[A].data,le=0,Ae=0,Te;le<re.length;le+=128){var Ee=re.slice(le,le+128);Jn(Ee,64),Ae=Ee.read_shift(2),Te=P1(Ee,0,Ae-J),P.push(Te);var De={name:Te,type:Ee.read_shift(1),color:Ee.read_shift(1),L:Ee.read_shift(4,"i"),R:Ee.read_shift(4,"i"),C:Ee.read_shift(4,"i"),clsid:Ee.read_shift(16),state:Ee.read_shift(4,"i"),start:0,size:0},Ge=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);Ge!==0&&(De.ct=_(Ee,Ee.l-8));var _t=Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2)+Ee.read_shift(2);_t!==0&&(De.mt=_(Ee,Ee.l-8)),De.start=Ee.read_shift(4,"i"),De.size=Ee.read_shift(4,"i"),De.size<0&&De.start<0&&(De.size=De.type=0,De.start=ie,De.name=""),De.type===5?(X=De.start,N>0&&X!==ie&&(I[X].name="!StreamData")):De.size>=4096?(De.storage="fat",I[De.start]===void 0&&(I[De.start]=x(D,De.start,I.fat_addrs,I.ssz)),I[De.start].name=De.name,De.content=I[De.start].data.slice(0,De.size)):(De.storage="minifat",De.size<0?De.size=0:X!==ie&&De.start!==ie&&I[X]&&(De.content=g(De,I[X].data,(I[ce]||{}).data))),De.content&&Jn(De.content,0),O[Te]=De,Z.push(De)}}function _(A,I){return new Date((Wr(A,I+4)/1e7*Math.pow(2,32)+Wr(A,I)/1e7-11644473600)*1e3)}function k(A,I){return u(),c(l.readFileSync(A),I)}function S(A,I){var D=I&&I.type;switch(D||dt&&Buffer.isBuffer(A)&&(D="buffer"),D||"base64"){case"file":return k(A,I);case"base64":return c(Gr(Zr(A)),I);case"binary":return c(Gr(A),I)}return c(A,I)}function C(A,I){var D=I||{},P=D.root||"Root Entry";if(A.FullPaths||(A.FullPaths=[]),A.FileIndex||(A.FileIndex=[]),A.FullPaths.length!==A.FileIndex.length)throw new Error("inconsistent CFB structure");A.FullPaths.length===0&&(A.FullPaths[0]=P+"/",A.FileIndex[0]={name:P,type:5}),D.CLSID&&(A.FileIndex[0].clsid=D.CLSID),M(A)}function M(A){var I="Sh33tJ5";if(!Ke.find(A,"/"+I)){var D=me(4);D[0]=55,D[1]=D[3]=50,D[2]=54,A.FileIndex.push({name:I,type:2,content:D,size:4,L:69,R:69,C:69}),A.FullPaths.push(A.FullPaths[0]+I),F(A)}}function F(A,I){C(A);for(var D=!1,P=!1,N=A.FullPaths.length-1;N>=0;--N){var O=A.FileIndex[N];switch(O.type){case 0:P?D=!0:(A.FileIndex.pop(),A.FullPaths.pop());break;case 1:case 2:case 5:P=!0,isNaN(O.R*O.L*O.C)&&(D=!0),O.R>-1&&O.L>-1&&O.R==O.L&&(D=!0);break;default:D=!0;break}}if(!(!D&&!I)){var Z=new Date(1987,1,19),ce=0,X=Object.create?Object.create(null):{},J=[];for(N=0;N<A.FullPaths.length;++N)X[A.FullPaths[N]]=!0,A.FileIndex[N].type!==0&&J.push([A.FullPaths[N],A.FileIndex[N]]);for(N=0;N<J.length;++N){var re=r(J[N][0]);P=X[re],P||(J.push([re,{name:i(re).replace("/",""),type:1,clsid:de,ct:Z,mt:Z,content:null}]),X[re]=!0)}for(J.sort(function(Te,Ee){return n(Te[0],Ee[0])}),A.FullPaths=[],A.FileIndex=[],N=0;N<J.length;++N)A.FullPaths[N]=J[N][0],A.FileIndex[N]=J[N][1];for(N=0;N<J.length;++N){var le=A.FileIndex[N],Ae=A.FullPaths[N];if(le.name=i(Ae).replace("/",""),le.L=le.R=le.C=-(le.color=1),le.size=le.content?le.content.length:0,le.start=0,le.clsid=le.clsid||de,N===0)le.C=J.length>1?1:-1,le.size=0,le.type=5;else if(Ae.slice(-1)=="/"){for(ce=N+1;ce<J.length&&r(A.FullPaths[ce])!=Ae;++ce);for(le.C=ce>=J.length?-1:ce,ce=N+1;ce<J.length&&r(A.FullPaths[ce])!=r(Ae);++ce);le.R=ce>=J.length?-1:ce,le.type=1}else r(A.FullPaths[N+1]||"")==r(Ae)&&(le.R=N+1),le.type=2}}}function b(A,I){var D=I||{};if(D.fileType=="mad")return te(A,D);switch(F(A),D.fileType){case"zip":return Nt(A,D)}var P=function(Te){for(var Ee=0,De=0,Ge=0;Ge<Te.FileIndex.length;++Ge){var _t=Te.FileIndex[Ge];if(_t.content){var Tt=_t.content.length;Tt>0&&(Tt<4096?Ee+=Tt+63>>6:De+=Tt+511>>9)}}for(var je=Te.FullPaths.length+3>>2,Xt=Ee+7>>3,Vr=Ee+127>>7,Ar=Xt+De+je+Vr,Lt=Ar+127>>7,qi=Lt<=109?0:Math.ceil((Lt-109)/127);Ar+Lt+qi+127>>7>Lt;)qi=++Lt<=109?0:Math.ceil((Lt-109)/127);var Ln=[1,qi,Lt,Vr,je,De,Ee,0];return Te.FileIndex[0].size=Ee<<6,Ln[7]=(Te.FileIndex[0].start=Ln[0]+Ln[1]+Ln[2]+Ln[3]+Ln[4]+Ln[5])+(Ln[6]+7>>3),Ln}(A),N=me(P[7]<<9),O=0,Z=0;{for(O=0;O<8;++O)N.write_shift(1,se[O]);for(O=0;O<8;++O)N.write_shift(2,0);for(N.write_shift(2,62),N.write_shift(2,3),N.write_shift(2,65534),N.write_shift(2,9),N.write_shift(2,6),O=0;O<3;++O)N.write_shift(2,0);for(N.write_shift(4,0),N.write_shift(4,P[2]),N.write_shift(4,P[0]+P[1]+P[2]+P[3]-1),N.write_shift(4,0),N.write_shift(4,4096),N.write_shift(4,P[3]?P[0]+P[1]+P[2]-1:ie),N.write_shift(4,P[3]),N.write_shift(-4,P[1]?P[0]-1:ie),N.write_shift(4,P[1]),O=0;O<109;++O)N.write_shift(-4,O<P[2]?P[1]+O:-1)}if(P[1])for(Z=0;Z<P[1];++Z){for(;O<236+Z*127;++O)N.write_shift(-4,O<P[2]?P[1]+O:-1);N.write_shift(-4,Z===P[1]-1?ie:Z+1)}var ce=function(Te){for(Z+=Te;O<Z-1;++O)N.write_shift(-4,O+1);Te&&(++O,N.write_shift(-4,ie))};for(Z=O=0,Z+=P[1];O<Z;++O)N.write_shift(-4,ae.DIFSECT);for(Z+=P[2];O<Z;++O)N.write_shift(-4,ae.FATSECT);ce(P[3]),ce(P[4]);for(var X=0,J=0,re=A.FileIndex[0];X<A.FileIndex.length;++X)re=A.FileIndex[X],re.content&&(J=re.content.length,!(J<4096)&&(re.start=Z,ce(J+511>>9)));for(ce(P[6]+7>>3);N.l&511;)N.write_shift(-4,ae.ENDOFCHAIN);for(Z=O=0,X=0;X<A.FileIndex.length;++X)re=A.FileIndex[X],re.content&&(J=re.content.length,!(!J||J>=4096)&&(re.start=Z,ce(J+63>>6)));for(;N.l&511;)N.write_shift(-4,ae.ENDOFCHAIN);for(O=0;O<P[4]<<2;++O){var le=A.FullPaths[O];if(!le||le.length===0){for(X=0;X<17;++X)N.write_shift(4,0);for(X=0;X<3;++X)N.write_shift(4,-1);for(X=0;X<12;++X)N.write_shift(4,0);continue}re=A.FileIndex[O],O===0&&(re.start=re.size?re.start-1:ie);var Ae=O===0&&D.root||re.name;if(J=2*(Ae.length+1),N.write_shift(64,Ae,"utf16le"),N.write_shift(2,J),N.write_shift(1,re.type),N.write_shift(1,re.color),N.write_shift(-4,re.L),N.write_shift(-4,re.R),N.write_shift(-4,re.C),re.clsid)N.write_shift(16,re.clsid,"hex");else for(X=0;X<4;++X)N.write_shift(4,0);N.write_shift(4,re.state||0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,0),N.write_shift(4,re.start),N.write_shift(4,re.size),N.write_shift(4,0)}for(O=1;O<A.FileIndex.length;++O)if(re=A.FileIndex[O],re.size>=4096)if(N.l=re.start+1<<9,dt&&Buffer.isBuffer(re.content))re.content.copy(N,N.l,0,re.size),N.l+=re.size+511&-512;else{for(X=0;X<re.size;++X)N.write_shift(1,re.content[X]);for(;X&511;++X)N.write_shift(1,0)}for(O=1;O<A.FileIndex.length;++O)if(re=A.FileIndex[O],re.size>0&&re.size<4096)if(dt&&Buffer.isBuffer(re.content))re.content.copy(N,N.l,0,re.size),N.l+=re.size+63&-64;else{for(X=0;X<re.size;++X)N.write_shift(1,re.content[X]);for(;X&63;++X)N.write_shift(1,0)}if(dt)N.l=N.length;else for(;N.l<N.length;)N.write_shift(1,0);return N}function V(A,I){var D=A.FullPaths.map(function(X){return X.toUpperCase()}),P=D.map(function(X){var J=X.split("/");return J[J.length-(X.slice(-1)=="/"?2:1)]}),N=!1;I.charCodeAt(0)===47?(N=!0,I=D[0].slice(0,-1)+I):N=I.indexOf("/")!==-1;var O=I.toUpperCase(),Z=N===!0?D.indexOf(O):P.indexOf(O);if(Z!==-1)return A.FileIndex[Z];var ce=!O.match(cc);for(O=O.replace(_r,""),ce&&(O=O.replace(cc,"!")),Z=0;Z<D.length;++Z)if((ce?D[Z].replace(cc,"!"):D[Z]).replace(_r,"")==O||(ce?P[Z].replace(cc,"!"):P[Z]).replace(_r,"")==O)return A.FileIndex[Z];return null}var z=64,ie=-2,Q="d0cf11e0a1b11ae1",se=[208,207,17,224,161,177,26,225],de="00000000000000000000000000000000",ae={MAXREGSECT:-6,DIFSECT:-4,FATSECT:-3,ENDOFCHAIN:ie,FREESECT:-1,HEADER_SIGNATURE:Q,HEADER_MINOR_VERSION:"3e00",MAXREGSID:-6,NOSTREAM:-1,HEADER_CLSID:de,EntryTypes:["unknown","storage","stream","lockbytes","property","root"]};function ne(A,I,D){u();var P=b(A,D);l.writeFileSync(I,P)}function H(A){for(var I=new Array(A.length),D=0;D<A.length;++D)I[D]=String.fromCharCode(A[D]);return I.join("")}function fe(A,I){var D=b(A,I);switch(I&&I.type||"buffer"){case"file":return u(),l.writeFileSync(I.filename,D),D;case"binary":return typeof D=="string"?D:H(D);case"base64":return ff(typeof D=="string"?D:H(D));case"buffer":if(dt)return Buffer.isBuffer(D)?D:$s(D);case"array":return typeof D=="string"?Gr(D):D}return D}var xe;function L(A){try{var I=A.InflateRaw,D=new I;if(D._processChunk(new Uint8Array([3,0]),D._finishFlushFlag),D.bytesRead)xe=A;else throw new Error("zlib does not expose bytesRead")}catch(P){console.error("cannot use native zlib: "+(P.message||P))}}function q(A,I){if(!xe)return xn(A,I);var D=xe.InflateRaw,P=new D,N=P._processChunk(A.slice(A.l),P._finishFlushFlag);return A.l+=P.bytesRead,N}function W(A){return xe?xe.deflateRawSync(A):We(A)}var G=[16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15],ee=[3,4,5,6,7,8,9,10,11,13,15,17,19,23,27,31,35,43,51,59,67,83,99,115,131,163,195,227,258],Se=[1,2,3,4,5,7,9,13,17,25,33,49,65,97,129,193,257,385,513,769,1025,1537,2049,3073,4097,6145,8193,12289,16385,24577];function we(A){var I=(A<<1|A<<11)&139536|(A<<5|A<<15)&558144;return(I>>16|I>>8|I)&255}for(var pe=typeof Uint8Array<"u",oe=pe?new Uint8Array(256):[],Le=0;Le<256;++Le)oe[Le]=we(Le);function B(A,I){var D=oe[A&255];return I<=8?D>>>8-I:(D=D<<8|oe[A>>8&255],I<=16?D>>>16-I:(D=D<<8|oe[A>>16&255],D>>>24-I))}function st(A,I){var D=I&7,P=I>>>3;return(A[P]|(D<=6?0:A[P+1]<<8))>>>D&3}function Ue(A,I){var D=I&7,P=I>>>3;return(A[P]|(D<=5?0:A[P+1]<<8))>>>D&7}function at(A,I){var D=I&7,P=I>>>3;return(A[P]|(D<=4?0:A[P+1]<<8))>>>D&15}function $e(A,I){var D=I&7,P=I>>>3;return(A[P]|(D<=3?0:A[P+1]<<8))>>>D&31}function Re(A,I){var D=I&7,P=I>>>3;return(A[P]|(D<=1?0:A[P+1]<<8))>>>D&127}function ht(A,I,D){var P=I&7,N=I>>>3,O=(1<<D)-1,Z=A[N]>>>P;return D<8-P||(Z|=A[N+1]<<8-P,D<16-P)||(Z|=A[N+2]<<16-P,D<24-P)||(Z|=A[N+3]<<24-P),Z&O}function Dt(A,I,D){var P=I&7,N=I>>>3;return P<=5?A[N]|=(D&7)<<P:(A[N]|=D<<P&255,A[N+1]=(D&7)>>8-P),I+3}function tt(A,I,D){var P=I&7,N=I>>>3;return D=(D&1)<<P,A[N]|=D,I+1}function Kt(A,I,D){var P=I&7,N=I>>>3;return D<<=P,A[N]|=D&255,D>>>=8,A[N+1]=D,I+8}function ve(A,I,D){var P=I&7,N=I>>>3;return D<<=P,A[N]|=D&255,D>>>=8,A[N+1]=D&255,A[N+2]=D>>>8,I+16}function Ce(A,I){var D=A.length,P=2*D>I?2*D:I+5,N=0;if(D>=I)return A;if(dt){var O=bS(P);if(A.copy)A.copy(O);else for(;N<A.length;++N)O[N]=A[N];return O}else if(pe){var Z=new Uint8Array(P);if(Z.set)Z.set(A);else for(;N<D;++N)Z[N]=A[N];return Z}return A.length=P,A}function Ne(A){for(var I=new Array(A),D=0;D<A;++D)I[D]=0;return I}function Oe(A,I,D){var P=1,N=0,O=0,Z=0,ce=0,X=A.length,J=pe?new Uint16Array(32):Ne(32);for(O=0;O<32;++O)J[O]=0;for(O=X;O<D;++O)A[O]=0;X=A.length;var re=pe?new Uint16Array(X):Ne(X);for(O=0;O<X;++O)J[N=A[O]]++,P<N&&(P=N),re[O]=0;for(J[0]=0,O=1;O<=P;++O)J[O+16]=ce=ce+J[O-1]<<1;for(O=0;O<X;++O)ce=A[O],ce!=0&&(re[O]=J[ce+16]++);var le=0;for(O=0;O<X;++O)if(le=A[O],le!=0)for(ce=B(re[O],P)>>P-le,Z=(1<<P+4-le)-1;Z>=0;--Z)I[ce|Z<<le]=le&15|O<<4;return P}var He=pe?new Uint16Array(512):Ne(512),Je=pe?new Uint16Array(32):Ne(32);if(!pe){for(var Qe=0;Qe<512;++Qe)He[Qe]=0;for(Qe=0;Qe<32;++Qe)Je[Qe]=0}(function(){for(var A=[],I=0;I<32;I++)A.push(5);Oe(A,Je,32);var D=[];for(I=0;I<=143;I++)D.push(8);for(;I<=255;I++)D.push(9);for(;I<=279;I++)D.push(7);for(;I<=287;I++)D.push(8);Oe(D,He,288)})();var mt=function(){for(var I=pe?new Uint8Array(32768):[],D=0,P=0;D<Se.length-1;++D)for(;P<Se[D+1];++P)I[P]=D;for(;P<32768;++P)I[P]=29;var N=pe?new Uint8Array(259):[];for(D=0,P=0;D<ee.length-1;++D)for(;P<ee[D+1];++P)N[P]=D;function O(ce,X){for(var J=0;J<ce.length;){var re=Math.min(65535,ce.length-J),le=J+re==ce.length;for(X.write_shift(1,+le),X.write_shift(2,re),X.write_shift(2,~re&65535);re-- >0;)X[X.l++]=ce[J++]}return X.l}function Z(ce,X){for(var J=0,re=0,le=pe?new Uint16Array(32768):[];re<ce.length;){var Ae=Math.min(65535,ce.length-re);if(Ae<10){for(J=Dt(X,J,+(re+Ae==ce.length)),J&7&&(J+=8-(J&7)),X.l=J/8|0,X.write_shift(2,Ae),X.write_shift(2,~Ae&65535);Ae-- >0;)X[X.l++]=ce[re++];J=X.l*8;continue}J=Dt(X,J,+(re+Ae==ce.length)+2);for(var Te=0;Ae-- >0;){var Ee=ce[re];Te=(Te<<5^Ee)&32767;var De=-1,Ge=0;if((De=le[Te])&&(De|=re&-32768,De>re&&(De-=32768),De<re))for(;ce[De+Ge]==ce[re+Ge]&&Ge<250;)++Ge;if(Ge>2){Ee=N[Ge],Ee<=22?J=Kt(X,J,oe[Ee+1]>>1)-1:(Kt(X,J,3),J+=5,Kt(X,J,oe[Ee-23]>>5),J+=3);var _t=Ee<8?0:Ee-4>>2;_t>0&&(ve(X,J,Ge-ee[Ee]),J+=_t),Ee=I[re-De],J=Kt(X,J,oe[Ee]>>3),J-=3;var Tt=Ee<4?0:Ee-2>>1;Tt>0&&(ve(X,J,re-De-Se[Ee]),J+=Tt);for(var je=0;je<Ge;++je)le[Te]=re&32767,Te=(Te<<5^ce[re])&32767,++re;Ae-=Ge-1}else Ee<=143?Ee=Ee+48:J=tt(X,J,1),J=Kt(X,J,oe[Ee]),le[Te]=re&32767,++re}J=Kt(X,J,0)-1}return X.l=(J+7)/8|0,X.l}return function(X,J){return X.length<8?O(X,J):Z(X,J)}}();function We(A){var I=me(50+Math.floor(A.length*1.1)),D=mt(A,I);return I.slice(0,D)}var Xe=pe?new Uint16Array(32768):Ne(32768),Rt=pe?new Uint16Array(32768):Ne(32768),yt=pe?new Uint16Array(128):Ne(128),It=1,Mt=1;function bn(A,I){var D=$e(A,I)+257;I+=5;var P=$e(A,I)+1;I+=5;var N=at(A,I)+4;I+=4;for(var O=0,Z=pe?new Uint8Array(19):Ne(19),ce=[0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0],X=1,J=pe?new Uint8Array(8):Ne(8),re=pe?new Uint8Array(8):Ne(8),le=Z.length,Ae=0;Ae<N;++Ae)Z[G[Ae]]=O=Ue(A,I),X<O&&(X=O),J[O]++,I+=3;var Te=0;for(J[0]=0,Ae=1;Ae<=X;++Ae)re[Ae]=Te=Te+J[Ae-1]<<1;for(Ae=0;Ae<le;++Ae)(Te=Z[Ae])!=0&&(ce[Ae]=re[Te]++);var Ee=0;for(Ae=0;Ae<le;++Ae)if(Ee=Z[Ae],Ee!=0){Te=oe[ce[Ae]]>>8-Ee;for(var De=(1<<7-Ee)-1;De>=0;--De)yt[Te|De<<Ee]=Ee&7|Ae<<3}var Ge=[];for(X=1;Ge.length<D+P;)switch(Te=yt[Re(A,I)],I+=Te&7,Te>>>=3){case 16:for(O=3+st(A,I),I+=2,Te=Ge[Ge.length-1];O-- >0;)Ge.push(Te);break;case 17:for(O=3+Ue(A,I),I+=3;O-- >0;)Ge.push(0);break;case 18:for(O=11+Re(A,I),I+=7;O-- >0;)Ge.push(0);break;default:Ge.push(Te),X<Te&&(X=Te);break}var _t=Ge.slice(0,D),Tt=Ge.slice(D);for(Ae=D;Ae<286;++Ae)_t[Ae]=0;for(Ae=P;Ae<30;++Ae)Tt[Ae]=0;return It=Oe(_t,Xe,286),Mt=Oe(Tt,Rt,30),I}function Et(A,I){if(A[0]==3&&!(A[1]&3))return[Na(I),2];for(var D=0,P=0,N=bS(I||1<<18),O=0,Z=N.length>>>0,ce=0,X=0;!(P&1);){if(P=Ue(A,D),D+=3,P>>>1)P>>1==1?(ce=9,X=5):(D=bn(A,D),ce=It,X=Mt);else{D&7&&(D+=8-(D&7));var J=A[D>>>3]|A[(D>>>3)+1]<<8;if(D+=32,J>0)for(!I&&Z<O+J&&(N=Ce(N,O+J),Z=N.length);J-- >0;)N[O++]=A[D>>>3],D+=8;continue}for(;;){!I&&Z<O+32767&&(N=Ce(N,O+32767),Z=N.length);var re=ht(A,D,ce),le=P>>>1==1?He[re]:Xe[re];if(D+=le&15,le>>>=4,!(le>>>8&255))N[O++]=le;else{if(le==256)break;le-=257;var Ae=le<8?0:le-4>>2;Ae>5&&(Ae=0);var Te=O+ee[le];Ae>0&&(Te+=ht(A,D,Ae),D+=Ae),re=ht(A,D,X),le=P>>>1==1?Je[re]:Rt[re],D+=le&15,le>>>=4;var Ee=le<4?0:le-2>>1,De=Se[le];for(Ee>0&&(De+=ht(A,D,Ee),D+=Ee),!I&&Z<Te&&(N=Ce(N,Te+100),Z=N.length);O<Te;)N[O]=N[O-De],++O}}}return I?[N,D+7>>>3]:[N.slice(0,O),D+7>>>3]}function xn(A,I){var D=A.slice(A.l||0),P=Et(D,I);return A.l+=P[1],P[0]}function Wn(A,I){if(A)typeof console<"u"&&console.error(I);else throw new Error(I)}function Gn(A,I){var D=A;Jn(D,0);var P=[],N=[],O={FileIndex:P,FullPaths:N};C(O,{root:I.root});for(var Z=D.length-4;(D[Z]!=80||D[Z+1]!=75||D[Z+2]!=5||D[Z+3]!=6)&&Z>=0;)--Z;D.l=Z+4,D.l+=4;var ce=D.read_shift(2);D.l+=6;var X=D.read_shift(4);for(D.l=X,Z=0;Z<ce;++Z){D.l+=20;var J=D.read_shift(4),re=D.read_shift(4),le=D.read_shift(2),Ae=D.read_shift(2),Te=D.read_shift(2);D.l+=8;var Ee=D.read_shift(4),De=o(D.slice(D.l+le,D.l+le+Ae));D.l+=le+Ae+Te;var Ge=D.l;D.l=Ee+4,fn(D,J,re,O,De),D.l=Ge}return O}function fn(A,I,D,P,N){A.l+=2;var O=A.read_shift(2),Z=A.read_shift(2),ce=a(A);if(O&8257)throw new Error("Unsupported ZIP encryption");for(var X=A.read_shift(4),J=A.read_shift(4),re=A.read_shift(4),le=A.read_shift(2),Ae=A.read_shift(2),Te="",Ee=0;Ee<le;++Ee)Te+=String.fromCharCode(A[A.l++]);if(Ae){var De=o(A.slice(A.l,A.l+Ae));(De[21589]||{}).mt&&(ce=De[21589].mt),((N||{})[21589]||{}).mt&&(ce=N[21589].mt)}A.l+=Ae;var Ge=A.slice(A.l,A.l+J);switch(Z){case 8:Ge=q(A,re);break;case 0:break;default:throw new Error("Unsupported ZIP Compression method "+Z)}var _t=!1;O&8&&(X=A.read_shift(4),X==134695760&&(X=A.read_shift(4),_t=!0),J=A.read_shift(4),re=A.read_shift(4)),J!=I&&Wn(_t,"Bad compressed size: "+I+" != "+J),re!=D&&Wn(_t,"Bad uncompressed size: "+D+" != "+re),ue(P,Te,Ge,{unsafe:!0,mt:ce})}function Nt(A,I){var D=I||{},P=[],N=[],O=me(1),Z=D.compression?8:0,ce=0,X=0,J=0,re=0,le=0,Ae=A.FullPaths[0],Te=Ae,Ee=A.FileIndex[0],De=[],Ge=0;for(X=1;X<A.FullPaths.length;++X)if(Te=A.FullPaths[X].slice(Ae.length),Ee=A.FileIndex[X],!(!Ee.size||!Ee.content||Te=="Sh33tJ5")){var _t=re,Tt=me(Te.length);for(J=0;J<Te.length;++J)Tt.write_shift(1,Te.charCodeAt(J)&127);Tt=Tt.slice(0,Tt.l),De[le]=lU.buf(Ee.content,0);var je=Ee.content;Z==8&&(je=W(je)),O=me(30),O.write_shift(4,67324752),O.write_shift(2,20),O.write_shift(2,ce),O.write_shift(2,Z),Ee.mt?s(O,Ee.mt):O.write_shift(4,0),O.write_shift(-4,De[le]),O.write_shift(4,je.length),O.write_shift(4,Ee.content.length),O.write_shift(2,Tt.length),O.write_shift(2,0),re+=O.length,P.push(O),re+=Tt.length,P.push(Tt),re+=je.length,P.push(je),O=me(46),O.write_shift(4,33639248),O.write_shift(2,0),O.write_shift(2,20),O.write_shift(2,ce),O.write_shift(2,Z),O.write_shift(4,0),O.write_shift(-4,De[le]),O.write_shift(4,je.length),O.write_shift(4,Ee.content.length),O.write_shift(2,Tt.length),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(4,0),O.write_shift(4,_t),Ge+=O.l,N.push(O),Ge+=Tt.length,N.push(Tt),++le}return O=me(22),O.write_shift(4,101010256),O.write_shift(2,0),O.write_shift(2,0),O.write_shift(2,le),O.write_shift(2,le),O.write_shift(4,Ge),O.write_shift(4,re),O.write_shift(2,0),Hn([Hn(P),Hn(N),O])}var bt={htm:"text/html",xml:"text/xml",gif:"image/gif",jpg:"image/jpeg",png:"image/png",mso:"application/x-mso",thmx:"application/vnd.ms-officetheme",sh33tj5:"application/octet-stream"};function Ut(A,I){if(A.ctype)return A.ctype;var D=A.name||"",P=D.match(/\.([^\.]+)$/);return P&&bt[P[1]]||I&&(P=(D=I).match(/[\.\\]([^\.\\])+$/),P&&bt[P[1]])?bt[P[1]]:"application/octet-stream"}function ot(A){for(var I=ff(A),D=[],P=0;P<I.length;P+=76)D.push(I.slice(P,P+76));return D.join(`\r
`)+`\r
`}function wt(A){var I=A.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF=]/g,function(J){var re=J.charCodeAt(0).toString(16).toUpperCase();return"="+(re.length==1?"0"+re:re)});I=I.replace(/ $/mg,"=20").replace(/\t$/mg,"=09"),I.charAt(0)==`
`&&(I="=0D"+I.slice(1)),I=I.replace(/\r(?!\n)/mg,"=0D").replace(/\n\n/mg,`
=0A`).replace(/([^\r\n])\n/mg,"$1=0A");for(var D=[],P=I.split(`\r
`),N=0;N<P.length;++N){var O=P[N];if(O.length==0){D.push("");continue}for(var Z=0;Z<O.length;){var ce=76,X=O.slice(Z,Z+ce);X.charAt(ce-1)=="="?ce--:X.charAt(ce-2)=="="?ce-=2:X.charAt(ce-3)=="="&&(ce-=3),X=O.slice(Z,Z+ce),Z+=ce,Z<O.length&&(X+="="),D.push(X)}}return D.join(`\r
`)}function be(A){for(var I=[],D=0;D<A.length;++D){for(var P=A[D];D<=A.length&&P.charAt(P.length-1)=="=";)P=P.slice(0,P.length-1)+A[++D];I.push(P)}for(var N=0;N<I.length;++N)I[N]=I[N].replace(/[=][0-9A-Fa-f]{2}/g,function(O){return String.fromCharCode(parseInt(O.slice(1),16))});return Gr(I.join(`\r
`))}function U(A,I,D){for(var P="",N="",O="",Z,ce=0;ce<10;++ce){var X=I[ce];if(!X||X.match(/^\s*$/))break;var J=X.match(/^(.*?):\s*([^\s].*)$/);if(J)switch(J[1].toLowerCase()){case"content-location":P=J[2].trim();break;case"content-type":O=J[2].trim();break;case"content-transfer-encoding":N=J[2].trim();break}}switch(++ce,N.toLowerCase()){case"base64":Z=Gr(Zr(I.slice(ce).join("")));break;case"quoted-printable":Z=be(I.slice(ce));break;default:throw new Error("Unsupported Content-Transfer-Encoding "+N)}var re=ue(A,P.slice(D.length),Z,{unsafe:!0});O&&(re.ctype=O)}function Y(A,I){if(H(A.slice(0,13)).toLowerCase()!="mime-version:")throw new Error("Unsupported MAD header");var D=I&&I.root||"",P=(dt&&Buffer.isBuffer(A)?A.toString("binary"):H(A)).split(`\r
`),N=0,O="";for(N=0;N<P.length;++N)if(O=P[N],!!/^Content-Location:/i.test(O)&&(O=O.slice(O.indexOf("file")),D||(D=O.slice(0,O.lastIndexOf("/")+1)),O.slice(0,D.length)!=D))for(;D.length>0&&(D=D.slice(0,D.length-1),D=D.slice(0,D.lastIndexOf("/")+1),O.slice(0,D.length)!=D););var Z=(P[1]||"").match(/boundary="(.*?)"/);if(!Z)throw new Error("MAD cannot find boundary");var ce="--"+(Z[1]||""),X=[],J=[],re={FileIndex:X,FullPaths:J};C(re);var le,Ae=0;for(N=0;N<P.length;++N){var Te=P[N];Te!==ce&&Te!==ce+"--"||(Ae++&&U(re,P.slice(le,N),D),le=N)}return re}function te(A,I){var D=I||{},P=D.boundary||"SheetJS";P="------="+P;for(var N=["MIME-Version: 1.0",'Content-Type: multipart/related; boundary="'+P.slice(2)+'"',"","",""],O=A.FullPaths[0],Z=O,ce=A.FileIndex[0],X=1;X<A.FullPaths.length;++X)if(Z=A.FullPaths[X].slice(O.length),ce=A.FileIndex[X],!(!ce.size||!ce.content||Z=="Sh33tJ5")){Z=Z.replace(/[\x00-\x08\x0B\x0C\x0E-\x1F\x7E-\xFF]/g,function(Ge){return"_x"+Ge.charCodeAt(0).toString(16)+"_"}).replace(/[\u0080-\uFFFF]/g,function(Ge){return"_u"+Ge.charCodeAt(0).toString(16)+"_"});for(var J=ce.content,re=dt&&Buffer.isBuffer(J)?J.toString("binary"):H(J),le=0,Ae=Math.min(1024,re.length),Te=0,Ee=0;Ee<=Ae;++Ee)(Te=re.charCodeAt(Ee))>=32&&Te<128&&++le;var De=le>=Ae*4/5;N.push(P),N.push("Content-Location: "+(D.root||"file:///C:/SheetJS/")+Z),N.push("Content-Transfer-Encoding: "+(De?"quoted-printable":"base64")),N.push("Content-Type: "+Ut(ce,Z)),N.push(""),N.push(De?wt(re):ot(re))}return N.push(P+`--\r
`),N.join(`\r
`)}function j(A){var I={};return C(I,A),I}function ue(A,I,D,P){var N=P&&P.unsafe;N||C(A);var O=!N&&Ke.find(A,I);if(!O){var Z=A.FullPaths[0];I.slice(0,Z.length)==Z?Z=I:(Z.slice(-1)!="/"&&(Z+="/"),Z=(Z+I).replace("//","/")),O={name:i(I),type:2},A.FileIndex.push(O),A.FullPaths.push(Z),N||Ke.utils.cfb_gc(A)}return O.content=D,O.size=D?D.length:0,P&&(P.CLSID&&(O.clsid=P.CLSID),P.mt&&(O.mt=P.mt),P.ct&&(O.ct=P.ct)),O}function ye(A,I){C(A);var D=Ke.find(A,I);if(D){for(var P=0;P<A.FileIndex.length;++P)if(A.FileIndex[P]==D)return A.FileIndex.splice(P,1),A.FullPaths.splice(P,1),!0}return!1}function Fe(A,I,D){C(A);var P=Ke.find(A,I);if(P){for(var N=0;N<A.FileIndex.length;++N)if(A.FileIndex[N]==P)return A.FileIndex[N].name=i(D),A.FullPaths[N]=D,!0}return!1}function Me(A){F(A,!0)}return t.find=V,t.read=S,t.parse=c,t.write=fe,t.writeFile=ne,t.utils={cfb_new:j,cfb_add:ue,cfb_del:ye,cfb_mov:Fe,cfb_gc:Me,ReadShift:kc,CheckField:wF,prep_blob:Jn,bconcat:Hn,use_zlib:L,_deflateRaw:We,_inflateRaw:xn,consts:ae},t}();function uU(e){return typeof e=="string"?Jh(e):Array.isArray(e)?bB(e):e}function Gf(e,t,n){if(typeof Deno<"u"){if(n&&typeof t=="string")switch(n){case"utf8":t=new TextEncoder(n).encode(t);break;case"binary":t=Jh(t);break;default:throw new Error("Unsupported encoding "+n)}return Deno.writeFileSync(e,t)}var r=n=="utf8"?ns(t):t;if(typeof IE_SaveFile<"u")return IE_SaveFile(r,e);if(typeof Blob<"u"){var i=new Blob([uU(r)],{type:"application/octet-stream"});if(typeof navigator<"u"&&navigator.msSaveBlob)return navigator.msSaveBlob(i,e);if(typeof saveAs<"u")return saveAs(i,e);if(typeof URL<"u"&&typeof document<"u"&&document.createElement&&URL.createObjectURL){var s=URL.createObjectURL(i);if(typeof chrome=="object"&&typeof(chrome.downloads||{}).download=="function")return URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),chrome.downloads.download({url:s,filename:e,saveAs:!0});var a=document.createElement("a");if(a.download!=null)return a.download=e,a.href=s,document.body.appendChild(a),a.click(),document.body.removeChild(a),URL.revokeObjectURL&&typeof setTimeout<"u"&&setTimeout(function(){URL.revokeObjectURL(s)},6e4),s}}if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var o=File(e);return o.open("w"),o.encoding="binary",Array.isArray(t)&&(t=Wa(t)),o.write(t),o.close(),t}catch(l){if(!l.message||!l.message.match(/onstruct/))throw l}throw new Error("cannot save file "+e)}function cU(e){if(typeof Deno<"u")return Deno.readFileSync(e);if(typeof $<"u"&&typeof File<"u"&&typeof Folder<"u")try{var t=File(e);t.open("r"),t.encoding="binary";var n=t.read();return t.close(),n}catch(r){if(!r.message||!r.message.match(/onstruct/))throw r}throw new Error("Cannot access file "+e)}function vn(e){for(var t=Object.keys(e),n=[],r=0;r<t.length;++r)Object.prototype.hasOwnProperty.call(e,t[r])&&n.push(t[r]);return n}function zS(e,t){for(var n=[],r=vn(e),i=0;i!==r.length;++i)n[e[r[i]][t]]==null&&(n[e[r[i]][t]]=r[i]);return n}function jh(e){for(var t=[],n=vn(e),r=0;r!==n.length;++r)t[e[n[r]]]=n[r];return t}function Zh(e){for(var t=[],n=vn(e),r=0;r!==n.length;++r)t[e[n[r]]]=parseInt(n[r],10);return t}function fU(e){for(var t=[],n=vn(e),r=0;r!==n.length;++r)t[e[n[r]]]==null&&(t[e[n[r]]]=[]),t[e[n[r]]].push(n[r]);return t}var rh=new Date(1899,11,30,0,0,0);function Nn(e,t){var n=e.getTime(),r=rh.getTime()+(e.getTimezoneOffset()-rh.getTimezoneOffset())*6e4;return(n-r)/(24*60*60*1e3)}var ZM=new Date,dU=rh.getTime()+(ZM.getTimezoneOffset()-rh.getTimezoneOffset())*6e4,WS=ZM.getTimezoneOffset();function ep(e){var t=new Date;return t.setTime(e*24*60*60*1e3+dU),t.getTimezoneOffset()!==WS&&t.setTime(t.getTime()+(t.getTimezoneOffset()-WS)*6e4),t}function hU(e){var t=0,n=0,r=!1,i=e.match(/P([0-9\.]+Y)?([0-9\.]+M)?([0-9\.]+D)?T([0-9\.]+H)?([0-9\.]+M)?([0-9\.]+S)?/);if(!i)throw new Error("|"+e+"| is not an ISO8601 Duration");for(var s=1;s!=i.length;++s)if(i[s]){switch(n=1,s>3&&(r=!0),i[s].slice(i[s].length-1)){case"Y":throw new Error("Unsupported ISO Duration Field: "+i[s].slice(i[s].length-1));case"D":n*=24;case"H":n*=60;case"M":if(r)n*=60;else throw new Error("Unsupported ISO Duration Field: M")}t+=n*parseInt(i[s],10)}return t}var GS=new Date("2017-02-19T19:06:09.000Z"),eF=isNaN(GS.getFullYear())?new Date("2/19/17"):GS,pU=eF.getFullYear()==2017;function tn(e,t){var n=new Date(e);if(pU)return t>0?n.setTime(n.getTime()+n.getTimezoneOffset()*60*1e3):t<0&&n.setTime(n.getTime()-n.getTimezoneOffset()*60*1e3),n;if(e instanceof Date)return e;if(eF.getFullYear()==1917&&!isNaN(n.getFullYear())){var r=n.getFullYear();return e.indexOf(""+r)>-1||n.setFullYear(n.getFullYear()+100),n}var i=e.match(/\d+/g)||["2017","2","19","0","0","0"],s=new Date(+i[0],+i[1]-1,+i[2],+i[3]||0,+i[4]||0,+i[5]||0);return e.indexOf("Z")>-1&&(s=new Date(s.getTime()-s.getTimezoneOffset()*60*1e3)),s}function Po(e,t){if(dt&&Buffer.isBuffer(e)){if(t){if(e[0]==255&&e[1]==254)return ns(e.slice(2).toString("utf16le"));if(e[1]==254&&e[2]==255)return ns(HM(e.slice(2).toString("binary")))}return e.toString("binary")}if(typeof TextDecoder<"u")try{if(t){if(e[0]==255&&e[1]==254)return ns(new TextDecoder("utf-16le").decode(e.slice(2)));if(e[0]==254&&e[1]==255)return ns(new TextDecoder("utf-16be").decode(e.slice(2)))}var n={"":"","":"",:"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"","":"","":"","":"","":"","":"","":"","":"","":"","":"",:"","":"",:"",:"",:""};return Array.isArray(e)&&(e=new Uint8Array(e)),new TextDecoder("latin1").decode(e).replace(/[]/g,function(s){return n[s]||s})}catch{}for(var r=[],i=0;i!=e.length;++i)r.push(String.fromCharCode(e[i]));return r.join("")}function nn(e){if(typeof JSON<"u"&&!Array.isArray(e))return JSON.parse(JSON.stringify(e));if(typeof e!="object"||e==null)return e;if(e instanceof Date)return new Date(e.getTime());var t={};for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=nn(e[n]));return t}function mn(e,t){for(var n="";n.length<t;)n+=e;return n}function Vi(e){var t=Number(e);if(!isNaN(t))return isFinite(t)?t:NaN;if(!/\d/.test(e))return t;var n=1,r=e.replace(/([\d]),([\d])/g,"$1$2").replace(/[$]/g,"").replace(/[%]/g,function(){return n*=100,""});return!isNaN(t=Number(r))||(r=r.replace(/[(](.*)[)]/,function(i,s){return n=-n,s}),!isNaN(t=Number(r)))?t/n:t}var mU=["january","february","march","april","may","june","july","august","september","october","november","december"];function gu(e){var t=new Date(e),n=new Date(NaN),r=t.getYear(),i=t.getMonth(),s=t.getDate();if(isNaN(s))return n;var a=e.toLowerCase();if(a.match(/jan|feb|mar|apr|may|jun|jul|aug|sep|oct|nov|dec/)){if(a=a.replace(/[^a-z]/g,"").replace(/([^a-z]|^)[ap]m?([^a-z]|$)/,""),a.length>3&&mU.indexOf(a)==-1)return n}else if(a.match(/[a-z]/))return n;return r<0||r>8099?n:(i>0||s>1)&&r!=101?t:e.match(/[^-0-9:,\/\\]/)?n:t}var gU=function(){var e="abacaba".split(/(:?b)/i).length==5;return function(n,r,i){if(e||typeof r=="string")return n.split(r);for(var s=n.split(r),a=[s[0]],o=1;o<s.length;++o)a.push(i),a.push(s[o]);return a}}();function tF(e){return e?e.content&&e.type?Po(e.content,!0):e.data?uc(e.data):e.asNodeBuffer&&dt?uc(e.asNodeBuffer().toString("binary")):e.asBinary?uc(e.asBinary()):e._data&&e._data.getContent?uc(Po(Array.prototype.slice.call(e._data.getContent(),0))):null:null}function nF(e){if(!e)return null;if(e.data)return IS(e.data);if(e.asNodeBuffer&&dt)return e.asNodeBuffer();if(e._data&&e._data.getContent){var t=e._data.getContent();return typeof t=="string"?IS(t):Array.prototype.slice.call(t)}return e.content&&e.type?e.content:null}function vU(e){return e&&e.name.slice(-4)===".bin"?nF(e):tF(e)}function ui(e,t){for(var n=e.FullPaths||vn(e.files),r=t.toLowerCase().replace(/[\/]/g,"\\"),i=r.replace(/\\/g,"/"),s=0;s<n.length;++s){var a=n[s].replace(/^Root Entry[\/]/,"").toLowerCase();if(r==a||i==a)return e.files?e.files[n[s]]:e.FileIndex[s]}return null}function k1(e,t){var n=ui(e,t);if(n==null)throw new Error("Cannot find file "+t+" in zip");return n}function Cn(e,t,n){if(!n)return vU(k1(e,t));if(!t)return null;try{return Cn(e,t)}catch{return null}}function qr(e,t,n){if(!n)return tF(k1(e,t));if(!t)return null;try{return qr(e,t)}catch{return null}}function xU(e,t,n){return nF(k1(e,t))}function qS(e){for(var t=e.FullPaths||vn(e.files),n=[],r=0;r<t.length;++r)t[r].slice(-1)!="/"&&n.push(t[r].replace(/^Root Entry[\/]/,""));return n.sort()}function ut(e,t,n){if(e.FullPaths){if(typeof n=="string"){var r;return dt?r=$s(n):r=LB(n),Ke.utils.cfb_add(e,t,r)}Ke.utils.cfb_add(e,t,n)}else e.file(t,n)}function A1(){return Ke.utils.cfb_new()}function rF(e,t){switch(t.type){case"base64":return Ke.read(e,{type:"base64"});case"binary":return Ke.read(e,{type:"binary"});case"buffer":case"array":return Ke.read(e,{type:"buffer"})}throw new Error("Unrecognized type "+t.type)}function fc(e,t){if(e.charAt(0)=="/")return e.slice(1);var n=t.split("/");t.slice(-1)!="/"&&n.pop();for(var r=e.split("/");r.length!==0;){var i=r.shift();i===".."?n.pop():i!=="."&&n.push(i)}return n.join("/")}var En=`<?xml version="1.0" encoding="UTF-8" standalone="yes"?>\r
`,yU=/([^"\s?>\/]+)\s*=\s*((?:")([^"]*)(?:")|(?:')([^']*)(?:')|([^'">\s]+))/g,KS=/<[\/\?]?[a-zA-Z0-9:_-]+(?:\s+[^"\s?>\/]+\s*=\s*(?:"[^"]*"|'[^']*'|[^'">\s=]+))*\s*[\/\?]?>/mg,wU=/<[^>]*>/g,gr=En.match(KS)?KS:wU,TU=/<\w*:/,SU=/<(\/?)\w+:/;function it(e,t,n){for(var r={},i=0,s=0;i!==e.length&&!((s=e.charCodeAt(i))===32||s===10||s===13);++i);if(t||(r[0]=e.slice(0,i)),i===e.length)return r;var a=e.match(yU),o=0,l="",u=0,c="",h="",p=1;if(a)for(u=0;u!=a.length;++u){for(h=a[u],s=0;s!=h.length&&h.charCodeAt(s)!==61;++s);for(c=h.slice(0,s).trim();h.charCodeAt(s+1)==32;)++s;for(p=(i=h.charCodeAt(s+1))==34||i==39?1:0,l=h.slice(s+1+p,h.length-p),o=0;o!=c.length&&c.charCodeAt(o)!==58;++o);if(o===c.length)c.indexOf("_")>0&&(c=c.slice(0,c.indexOf("_"))),r[c]=l,r[c.toLowerCase()]=l;else{var m=(o===5&&c.slice(0,5)==="xmlns"?"xmlns":"")+c.slice(o+1);if(r[m]&&c.slice(o-3,o)=="ext")continue;r[m]=l,r[m.toLowerCase()]=l}}return r}function hs(e){return e.replace(SU,"<$1")}var iF={"&quot;":'"',"&apos;":"'","&gt;":">","&lt;":"<","&amp;":"&"},R1=jh(iF),kt=function(){var e=/&(?:quot|apos|gt|lt|amp|#x?([\da-fA-F]+));/ig,t=/_x([\da-fA-F]{4})_/ig;return function n(r){var i=r+"",s=i.indexOf("<![CDATA[");if(s==-1)return i.replace(e,function(o,l){return iF[o]||String.fromCharCode(parseInt(l,o.indexOf("x")>-1?16:10))||o}).replace(t,function(o,l){return String.fromCharCode(parseInt(l,16))});var a=i.indexOf("]]>");return n(i.slice(0,s))+i.slice(s+9,a)+n(i.slice(a+3))}}(),M1=/[&<>'"]/g,EU=/[\u0000-\u0008\u000b-\u001f]/g;function $t(e){var t=e+"";return t.replace(M1,function(n){return R1[n]}).replace(EU,function(n){return"_x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+"_"})}function YS(e){return $t(e).replace(/ /g,"_x0020_")}var sF=/[\u0000-\u001f]/g;function F1(e){var t=e+"";return t.replace(M1,function(n){return R1[n]}).replace(/\n/g,"<br/>").replace(sF,function(n){return"&#x"+("000"+n.charCodeAt(0).toString(16)).slice(-4)+";"})}function _U(e){var t=e+"";return t.replace(M1,function(n){return R1[n]}).replace(sF,function(n){return"&#x"+n.charCodeAt(0).toString(16).toUpperCase()+";"})}var XS=function(){var e=/&#(\d+);/g;function t(n,r){return String.fromCharCode(parseInt(r,10))}return function(r){return r.replace(e,t)}}();function CU(e){return e.replace(/(\r\n|[\r\n])/g,"&#10;")}function jt(e){switch(e){case 1:case!0:case"1":case"true":case"TRUE":return!0;default:return!1}}function am(e){for(var t="",n=0,r=0,i=0,s=0,a=0,o=0;n<e.length;){if(r=e.charCodeAt(n++),r<128){t+=String.fromCharCode(r);continue}if(i=e.charCodeAt(n++),r>191&&r<224){a=(r&31)<<6,a|=i&63,t+=String.fromCharCode(a);continue}if(s=e.charCodeAt(n++),r<240){t+=String.fromCharCode((r&15)<<12|(i&63)<<6|s&63);continue}a=e.charCodeAt(n++),o=((r&7)<<18|(i&63)<<12|(s&63)<<6|a&63)-65536,t+=String.fromCharCode(55296+(o>>>10&1023)),t+=String.fromCharCode(56320+(o&1023))}return t}function JS(e){var t=Na(2*e.length),n,r,i=1,s=0,a=0,o;for(r=0;r<e.length;r+=i)i=1,(o=e.charCodeAt(r))<128?n=o:o<224?(n=(o&31)*64+(e.charCodeAt(r+1)&63),i=2):o<240?(n=(o&15)*4096+(e.charCodeAt(r+1)&63)*64+(e.charCodeAt(r+2)&63),i=3):(i=4,n=(o&7)*262144+(e.charCodeAt(r+1)&63)*4096+(e.charCodeAt(r+2)&63)*64+(e.charCodeAt(r+3)&63),n-=65536,a=55296+(n>>>10&1023),n=56320+(n&1023)),a!==0&&(t[s++]=a&255,t[s++]=a>>>8,a=0),t[s++]=n%256,t[s++]=n>>>8;return t.slice(0,s).toString("ucs2")}function QS(e){return $s(e,"binary").toString("utf8")}var Id="foo bar baz",qt=dt&&(QS(Id)==am(Id)&&QS||JS(Id)==am(Id)&&JS)||am,ns=dt?function(e){return $s(e,"utf8").toString("binary")}:function(e){for(var t=[],n=0,r=0,i=0;n<e.length;)switch(r=e.charCodeAt(n++),!0){case r<128:t.push(String.fromCharCode(r));break;case r<2048:t.push(String.fromCharCode(192+(r>>6))),t.push(String.fromCharCode(128+(r&63)));break;case(r>=55296&&r<57344):r-=55296,i=e.charCodeAt(n++)-56320+(r<<10),t.push(String.fromCharCode(240+(i>>18&7))),t.push(String.fromCharCode(144+(i>>12&63))),t.push(String.fromCharCode(128+(i>>6&63))),t.push(String.fromCharCode(128+(i&63)));break;default:t.push(String.fromCharCode(224+(r>>12))),t.push(String.fromCharCode(128+(r>>6&63))),t.push(String.fromCharCode(128+(r&63)))}return t.join("")},hf=function(){var e={};return function(n,r){var i=n+"|"+(r||"");return e[i]?e[i]:e[i]=new RegExp("<(?:\\w+:)?"+n+'(?: xml:space="preserve")?(?:[^>]*)>([\\s\\S]*?)</(?:\\w+:)?'+n+">",r||"")}}(),aF=function(){var e=[["nbsp"," "],["middot",""],["quot",'"'],["apos","'"],["gt",">"],["lt","<"],["amp","&"]].map(function(t){return[new RegExp("&"+t[0]+";","ig"),t[1]]});return function(n){for(var r=n.replace(/^[\t\n\r ]+/,"").replace(/[\t\n\r ]+$/,"").replace(/>\s+/g,">").replace(/\s+</g,"<").replace(/[\t\n\r ]+/g," ").replace(/<\s*[bB][rR]\s*\/?>/g,`
`).replace(/<[^>]*>/g,""),i=0;i<e.length;++i)r=r.replace(e[i][0],e[i][1]);return r}}(),kU=function(){var e={};return function(n){return e[n]!==void 0?e[n]:e[n]=new RegExp("<(?:vt:)?"+n+">([\\s\\S]*?)</(?:vt:)?"+n+">","g")}}(),AU=/<\/?(?:vt:)?variant>/g,RU=/<(?:vt:)([^>]*)>([\s\S]*)</;function jS(e,t){var n=it(e),r=e.match(kU(n.baseType))||[],i=[];if(r.length!=n.size){if(t.WTF)throw new Error("unexpected vector length "+r.length+" != "+n.size);return i}return r.forEach(function(s){var a=s.replace(AU,"").match(RU);a&&i.push({v:qt(a[2]),t:a[1]})}),i}var oF=/(^\s|\s$|\n)/;function Qn(e,t){return"<"+e+(t.match(oF)?' xml:space="preserve"':"")+">"+t+"</"+e+">"}function pf(e){return vn(e).map(function(t){return" "+t+'="'+e[t]+'"'}).join("")}function Pe(e,t,n){return"<"+e+(n!=null?pf(n):"")+(t!=null?(t.match(oF)?' xml:space="preserve"':"")+">"+t+"</"+e:"/")+">"}function Ug(e,t){try{return e.toISOString().replace(/\.\d*/,"")}catch(n){if(t)throw n}return""}function MU(e,t){switch(typeof e){case"string":var n=Pe("vt:lpwstr",$t(e));return n=n.replace(/&quot;/g,"_x0022_"),n;case"number":return Pe((e|0)==e?"vt:i4":"vt:r8",$t(String(e)));case"boolean":return Pe("vt:bool",e?"true":"false")}if(e instanceof Date)return Pe("vt:filetime",Ug(e));throw new Error("Unable to serialize "+e)}function D1(e){if(dt&&Buffer.isBuffer(e))return e.toString("utf8");if(typeof e=="string")return e;if(typeof Uint8Array<"u"&&e instanceof Uint8Array)return qt(Wa(E1(e)));throw new Error("Bad input format: expected Buffer or string")}var mf=/<(\/?)([^\s?><!\/:]*:|)([^\s?<>:\/]+)(?:[\s?:\/][^>]*)?>/mg,Pn={CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/metadata/core-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/custom-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/extended-properties",CT:"http://schemas.openxmlformats.org/package/2006/content-types",RELS:"http://schemas.openxmlformats.org/package/2006/relationships",TCMNT:"http://schemas.microsoft.com/office/spreadsheetml/2018/threadedcomments",dc:"http://purl.org/dc/elements/1.1/",dcterms:"http://purl.org/dc/terms/",dcmitype:"http://purl.org/dc/dcmitype/",r:"http://schemas.openxmlformats.org/officeDocument/2006/relationships",vt:"http://schemas.openxmlformats.org/officeDocument/2006/docPropsVTypes",xsi:"http://www.w3.org/2001/XMLSchema-instance",xsd:"http://www.w3.org/2001/XMLSchema"},Yo=["http://schemas.openxmlformats.org/spreadsheetml/2006/main","http://purl.oclc.org/ooxml/spreadsheetml/main","http://schemas.microsoft.com/office/excel/2006/main","http://schemas.microsoft.com/office/excel/2006/2"],zr={o:"urn:schemas-microsoft-com:office:office",x:"urn:schemas-microsoft-com:office:excel",ss:"urn:schemas-microsoft-com:office:spreadsheet",dt:"uuid:C2F41010-65B3-11d1-A29F-00AA00C14882",mv:"http://macVmlSchemaUri",v:"urn:schemas-microsoft-com:vml",html:"http://www.w3.org/TR/REC-html40"};function FU(e,t){for(var n=1-2*(e[t+7]>>>7),r=((e[t+7]&127)<<4)+(e[t+6]>>>4&15),i=e[t+6]&15,s=5;s>=0;--s)i=i*256+e[t+s];return r==2047?i==0?n*(1/0):NaN:(r==0?r=-1022:(r-=1023,i+=Math.pow(2,52)),n*Math.pow(2,r-52)*i)}function DU(e,t,n){var r=(t<0||1/t==-1/0?1:0)<<7,i=0,s=0,a=r?-t:t;isFinite(a)?a==0?i=s=0:(i=Math.floor(Math.log(a)/Math.LN2),s=a*Math.pow(2,52-i),i<=-1023&&(!isFinite(s)||s<Math.pow(2,52))?i=-1022:(s-=Math.pow(2,52),i+=1023)):(i=2047,s=isNaN(t)?26985:0);for(var o=0;o<=5;++o,s/=256)e[n+o]=s&255;e[n+6]=(i&15)<<4|s&15,e[n+7]=i>>4|r}var ZS=function(e){for(var t=[],n=10240,r=0;r<e[0].length;++r)if(e[0][r])for(var i=0,s=e[0][r].length;i<s;i+=n)t.push.apply(t,e[0][r].slice(i,i+n));return t},eE=dt?function(e){return e[0].length>0&&Buffer.isBuffer(e[0][0])?Buffer.concat(e[0].map(function(t){return Buffer.isBuffer(t)?t:$s(t)})):ZS(e)}:ZS,tE=function(e,t,n){for(var r=[],i=t;i<n;i+=2)r.push(String.fromCharCode(_s(e,i)));return r.join("").replace(_r,"")},P1=dt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("utf16le",t,n).replace(_r,""):tE(e,t,n)}:tE,nE=function(e,t,n){for(var r=[],i=t;i<t+n;++i)r.push(("0"+e[i].toString(16)).slice(-2));return r.join("")},lF=dt?function(e,t,n){return Buffer.isBuffer(e)?e.toString("hex",t,t+n):nE(e,t,n)}:nE,rE=function(e,t,n){for(var r=[],i=t;i<n;i++)r.push(String.fromCharCode(fl(e,i)));return r.join("")},qf=dt?function(t,n,r){return Buffer.isBuffer(t)?t.toString("utf8",n,r):rE(t,n,r)}:rE,uF=function(e,t){var n=Wr(e,t);return n>0?qf(e,t+4,t+4+n-1):""},cF=uF,fF=function(e,t){var n=Wr(e,t);return n>0?qf(e,t+4,t+4+n-1):""},dF=fF,hF=function(e,t){var n=2*Wr(e,t);return n>0?qf(e,t+4,t+4+n-1):""},pF=hF,mF=function(t,n){var r=Wr(t,n);return r>0?P1(t,n+4,n+4+r):""},gF=mF,vF=function(e,t){var n=Wr(e,t);return n>0?qf(e,t+4,t+4+n):""},xF=vF,yF=function(e,t){return FU(e,t)},ih=yF,I1=function(t){return Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array};dt&&(cF=function(t,n){if(!Buffer.isBuffer(t))return uF(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},dF=function(t,n){if(!Buffer.isBuffer(t))return fF(t,n);var r=t.readUInt32LE(n);return r>0?t.toString("utf8",n+4,n+4+r-1):""},pF=function(t,n){if(!Buffer.isBuffer(t))return hF(t,n);var r=2*t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r-1)},gF=function(t,n){if(!Buffer.isBuffer(t))return mF(t,n);var r=t.readUInt32LE(n);return t.toString("utf16le",n+4,n+4+r)},xF=function(t,n){if(!Buffer.isBuffer(t))return vF(t,n);var r=t.readUInt32LE(n);return t.toString("utf8",n+4,n+4+r)},ih=function(t,n){return Buffer.isBuffer(t)?t.readDoubleLE(n):yF(t,n)},I1=function(t){return Buffer.isBuffer(t)||Array.isArray(t)||typeof Uint8Array<"u"&&t instanceof Uint8Array});var fl=function(e,t){return e[t]},_s=function(e,t){return e[t+1]*256+e[t]},PU=function(e,t){var n=e[t+1]*256+e[t];return n<32768?n:(65535-n+1)*-1},Wr=function(e,t){return e[t+3]*(1<<24)+(e[t+2]<<16)+(e[t+1]<<8)+e[t]},Za=function(e,t){return e[t+3]<<24|e[t+2]<<16|e[t+1]<<8|e[t]},IU=function(e,t){return e[t]<<24|e[t+1]<<16|e[t+2]<<8|e[t+3]};function kc(e,t){var n="",r,i,s=[],a,o,l,u;switch(t){case"dbcs":if(u=this.l,dt&&Buffer.isBuffer(this))n=this.slice(this.l,this.l+2*e).toString("utf16le");else for(l=0;l<e;++l)n+=String.fromCharCode(_s(this,u)),u+=2;e*=2;break;case"utf8":n=qf(this,this.l,this.l+e);break;case"utf16le":e*=2,n=P1(this,this.l,this.l+e);break;case"wstr":return kc.call(this,e,"dbcs");case"lpstr-ansi":n=cF(this,this.l),e=4+Wr(this,this.l);break;case"lpstr-cp":n=dF(this,this.l),e=4+Wr(this,this.l);break;case"lpwstr":n=pF(this,this.l),e=4+2*Wr(this,this.l);break;case"lpp4":e=4+Wr(this,this.l),n=gF(this,this.l),e&2&&(e+=2);break;case"8lpp4":e=4+Wr(this,this.l),n=xF(this,this.l),e&3&&(e+=4-(e&3));break;case"cstr":for(e=0,n="";(a=fl(this,this.l+e++))!==0;)s.push(Pd(a));n=s.join("");break;case"_wstr":for(e=0,n="";(a=_s(this,this.l+e))!==0;)s.push(Pd(a)),e+=2;e+=2,n=s.join("");break;case"dbcs-cont":for(n="",u=this.l,l=0;l<e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=fl(this,u),this.l=u+1,o=kc.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Pd(_s(this,u))),u+=2}n=s.join(""),e*=2;break;case"cpstr":case"sbcs-cont":for(n="",u=this.l,l=0;l!=e;++l){if(this.lens&&this.lens.indexOf(u)!==-1)return a=fl(this,u),this.l=u+1,o=kc.call(this,e-l,a?"dbcs-cont":"sbcs-cont"),s.join("")+o;s.push(Pd(fl(this,u))),u+=1}n=s.join("");break;default:switch(e){case 1:return r=fl(this,this.l),this.l++,r;case 2:return r=(t==="i"?PU:_s)(this,this.l),this.l+=2,r;case 4:case-4:return t==="i"||!(this[this.l+3]&128)?(r=(e>0?Za:IU)(this,this.l),this.l+=4,r):(i=Wr(this,this.l),this.l+=4,i);case 8:case-8:if(t==="f")return e==8?i=ih(this,this.l):i=ih([this[this.l+7],this[this.l+6],this[this.l+5],this[this.l+4],this[this.l+3],this[this.l+2],this[this.l+1],this[this.l+0]],0),this.l+=8,i;e=8;case 16:n=lF(this,this.l,e);break}}return this.l+=e,n}var NU=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255,e[n+2]=t>>>16&255,e[n+3]=t>>>24&255},bU=function(e,t,n){e[n]=t&255,e[n+1]=t>>8&255,e[n+2]=t>>16&255,e[n+3]=t>>24&255},LU=function(e,t,n){e[n]=t&255,e[n+1]=t>>>8&255};function OU(e,t,n){var r=0,i=0;if(n==="dbcs"){for(i=0;i!=t.length;++i)LU(this,t.charCodeAt(i),this.l+2*i);r=2*t.length}else if(n==="sbcs"){for(t=t.replace(/[^\x00-\x7F]/g,"_"),i=0;i!=t.length;++i)this[this.l+i]=t.charCodeAt(i)&255;r=t.length}else if(n==="hex"){for(;i<e;++i)this[this.l++]=parseInt(t.slice(2*i,2*i+2),16)||0;return this}else if(n==="utf16le"){var s=Math.min(this.l+e,this.length);for(i=0;i<Math.min(t.length,e);++i){var a=t.charCodeAt(i);this[this.l++]=a&255,this[this.l++]=a>>8}for(;this.l<s;)this[this.l++]=0;return this}else switch(e){case 1:r=1,this[this.l]=t&255;break;case 2:r=2,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255;break;case 3:r=3,this[this.l]=t&255,t>>>=8,this[this.l+1]=t&255,t>>>=8,this[this.l+2]=t&255;break;case 4:r=4,NU(this,t,this.l);break;case 8:if(r=8,n==="f"){DU(this,t,this.l);break}case 16:break;case-4:r=4,bU(this,t,this.l);break}return this.l+=r,this}function wF(e,t){var n=lF(this,this.l,e.length>>1);if(n!==e)throw new Error(t+"Expected "+e+" saw "+n);this.l+=e.length>>1}function Jn(e,t){e.l=t,e.read_shift=kc,e.chk=wF,e.write_shift=OU}function mr(e,t){e.l+=t}function me(e){var t=Na(e);return Jn(t,0),t}function zs(e,t,n){if(e){var r,i,s;Jn(e,e.l||0);for(var a=e.length,o=0,l=0;e.l<a;){o=e.read_shift(1),o&128&&(o=(o&127)+((e.read_shift(1)&127)<<7));var u=Tf[o]||Tf[65535];for(r=e.read_shift(1),s=r&127,i=1;i<4&&r&128;++i)s+=((r=e.read_shift(1))&127)<<7*i;l=e.l+s;var c=u.f&&u.f(e,s,n);if(e.l=l,t(c,u,o))return}}}function Or(){var e=[],t=dt?256:2048,n=function(u){var c=me(u);return Jn(c,0),c},r=n(t),i=function(){r&&(r.length>r.l&&(r=r.slice(0,r.l),r.l=r.length),r.length>0&&e.push(r),r=null)},s=function(u){return r&&u<r.length-r.l?r:(i(),r=n(Math.max(u+1,t)))},a=function(){return i(),Hn(e)},o=function(u){i(),r=u,r.l==null&&(r.l=r.length),s(t)};return{next:s,push:o,end:a,_bufs:e}}function _e(e,t,n,r){var i=+t,s;if(!isNaN(i)){r||(r=Tf[i].p||(n||[]).length||0),s=1+(i>=128?1:0)+1,r>=128&&++s,r>=16384&&++s,r>=2097152&&++s;var a=e.next(s);i<=127?a.write_shift(1,i):(a.write_shift(1,(i&127)+128),a.write_shift(1,i>>7));for(var o=0;o!=4;++o)if(r>=128)a.write_shift(1,(r&127)+128),r>>=7;else{a.write_shift(1,r);break}r>0&&I1(n)&&e.push(n)}}function Ac(e,t,n){var r=nn(e);if(t.s?(r.cRel&&(r.c+=t.s.c),r.rRel&&(r.r+=t.s.r)):(r.cRel&&(r.c+=t.c),r.rRel&&(r.r+=t.r)),!n||n.biff<12){for(;r.c>=256;)r.c-=256;for(;r.r>=65536;)r.r-=65536}return r}function iE(e,t,n){var r=nn(e);return r.s=Ac(r.s,t.s,n),r.e=Ac(r.e,t.s,n),r}function Rc(e,t){if(e.cRel&&e.c<0)for(e=nn(e);e.c<0;)e.c+=t>8?16384:256;if(e.rRel&&e.r<0)for(e=nn(e);e.r<0;)e.r+=t>8?1048576:t>5?65536:16384;var n=nt(e);return!e.cRel&&e.cRel!=null&&(n=VU(n)),!e.rRel&&e.rRel!=null&&(n=BU(n)),n}function om(e,t){return e.s.r==0&&!e.s.rRel&&e.e.r==(t.biff>=12?1048575:t.biff>=8?65536:16384)&&!e.e.rRel?(e.s.cRel?"":"$")+on(e.s.c)+":"+(e.e.cRel?"":"$")+on(e.e.c):e.s.c==0&&!e.s.cRel&&e.e.c==(t.biff>=12?16383:255)&&!e.e.cRel?(e.s.rRel?"":"$")+Sn(e.s.r)+":"+(e.e.rRel?"":"$")+Sn(e.e.r):Rc(e.s,t.biff)+":"+Rc(e.e,t.biff)}function N1(e){return parseInt(UU(e),10)-1}function Sn(e){return""+(e+1)}function BU(e){return e.replace(/([A-Z]|^)(\d+)$/,"$1$$$2")}function UU(e){return e.replace(/\$(\d+)$/,"$1")}function b1(e){for(var t=HU(e),n=0,r=0;r!==t.length;++r)n=26*n+t.charCodeAt(r)-64;return n-1}function on(e){if(e<0)throw new Error("invalid column "+e);var t="";for(++e;e;e=Math.floor((e-1)/26))t=String.fromCharCode((e-1)%26+65)+t;return t}function VU(e){return e.replace(/^([A-Z])/,"$$$1")}function HU(e){return e.replace(/^\$([A-Z])/,"$1")}function $U(e){return e.replace(/(\$?[A-Z]*)(\$?\d*)/,"$1,$2").split(",")}function ln(e){for(var t=0,n=0,r=0;r<e.length;++r){var i=e.charCodeAt(r);i>=48&&i<=57?t=10*t+(i-48):i>=65&&i<=90&&(n=26*n+(i-64))}return{c:n-1,r:t-1}}function nt(e){for(var t=e.c+1,n="";t;t=(t-1)/26|0)n=String.fromCharCode((t-1)%26+65)+n;return n+(e.r+1)}function Br(e){var t=e.indexOf(":");return t==-1?{s:ln(e),e:ln(e)}:{s:ln(e.slice(0,t)),e:ln(e.slice(t+1))}}function lt(e,t){return typeof t>"u"||typeof t=="number"?lt(e.s,e.e):(typeof e!="string"&&(e=nt(e)),typeof t!="string"&&(t=nt(t)),e==t?e:e+":"+t)}function At(e){var t={s:{c:0,r:0},e:{c:0,r:0}},n=0,r=0,i=0,s=e.length;for(n=0;r<s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.s.c=--n,n=0;r<s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;if(t.s.r=--n,r===s||i!=10)return t.e.c=t.s.c,t.e.r=t.s.r,t;for(++r,n=0;r!=s&&!((i=e.charCodeAt(r)-64)<1||i>26);++r)n=26*n+i;for(t.e.c=--n,n=0;r!=s&&!((i=e.charCodeAt(r)-48)<0||i>9);++r)n=10*n+i;return t.e.r=--n,t}function sE(e,t){var n=e.t=="d"&&t instanceof Date;if(e.z!=null)try{return e.w=_i(e.z,n?Nn(t):t)}catch{}try{return e.w=_i((e.XF||{}).numFmtId||(n?14:0),n?Nn(t):t)}catch{return""+t}}function Us(e,t,n){return e==null||e.t==null||e.t=="z"?"":e.w!==void 0?e.w:(e.t=="d"&&!e.z&&n&&n.dateNF&&(e.z=n.dateNF),e.t=="e"?Ws[e.v]||e.v:t==null?sE(e,e.v):sE(e,t))}function Ga(e,t){var n=t&&t.sheet?t.sheet:"Sheet1",r={};return r[n]=e,{SheetNames:[n],Sheets:r}}function TF(e,t,n){var r=n||{},i=e?Array.isArray(e):r.dense,s=e||(i?[]:{}),a=0,o=0;if(s&&r.origin!=null){if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}s["!ref"]||(s["!ref"]="A1:A1")}var u={s:{c:1e7,r:1e7},e:{c:0,r:0}};if(s["!ref"]){var c=At(s["!ref"]);u.s.c=c.s.c,u.s.r=c.s.r,u.e.c=Math.max(u.e.c,c.e.c),u.e.r=Math.max(u.e.r,c.e.r),a==-1&&(u.e.r=a=c.e.r+1)}for(var h=0;h!=t.length;++h)if(t[h]){if(!Array.isArray(t[h]))throw new Error("aoa_to_sheet expects an array of arrays");for(var p=0;p!=t[h].length;++p)if(!(typeof t[h][p]>"u")){var m={v:t[h][p]},v=a+h,g=o+p;if(u.s.r>v&&(u.s.r=v),u.s.c>g&&(u.s.c=g),u.e.r<v&&(u.e.r=v),u.e.c<g&&(u.e.c=g),t[h][p]&&typeof t[h][p]=="object"&&!Array.isArray(t[h][p])&&!(t[h][p]instanceof Date))m=t[h][p];else if(Array.isArray(m.v)&&(m.f=t[h][p][1],m.v=m.v[0]),m.v===null)if(m.f)m.t="n";else if(r.nullError)m.t="e",m.v=0;else if(r.sheetStubs)m.t="z";else continue;else typeof m.v=="number"?m.t="n":typeof m.v=="boolean"?m.t="b":m.v instanceof Date?(m.z=r.dateNF||et[14],r.cellDates?(m.t="d",m.w=_i(m.z,Nn(m.v))):(m.t="n",m.v=Nn(m.v),m.w=_i(m.z,m.v))):m.t="s";if(i)s[v]||(s[v]=[]),s[v][g]&&s[v][g].z&&(m.z=s[v][g].z),s[v][g]=m;else{var w=nt({c:g,r:v});s[w]&&s[w].z&&(m.z=s[w].z),s[w]=m}}}return u.s.c<1e7&&(s["!ref"]=lt(u)),s}function Ru(e,t){return TF(null,e,t)}function zU(e){return e.read_shift(4,"i")}function Hi(e,t){return t||(t=me(4)),t.write_shift(4,e),t}function hr(e){var t=e.read_shift(4);return t===0?"":e.read_shift(t,"dbcs")}function $n(e,t){var n=!1;return t==null&&(n=!0,t=me(4+2*e.length)),t.write_shift(4,e.length),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}function WU(e){return{ich:e.read_shift(2),ifnt:e.read_shift(2)}}function GU(e,t){return t||(t=me(4)),t.write_shift(2,0),t.write_shift(2,0),t}function L1(e,t){var n=e.l,r=e.read_shift(1),i=hr(e),s=[],a={t:i,h:i};if(r&1){for(var o=e.read_shift(4),l=0;l!=o;++l)s.push(WU(e));a.r=s}else a.r=[{ich:0,ifnt:0}];return e.l=n+t,a}function qU(e,t){var n=!1;return t==null&&(n=!0,t=me(15+4*e.t.length)),t.write_shift(1,0),$n(e.t,t),n?t.slice(0,t.l):t}var KU=L1;function YU(e,t){var n=!1;return t==null&&(n=!0,t=me(23+4*e.t.length)),t.write_shift(1,1),$n(e.t,t),t.write_shift(4,1),GU({},t),n?t.slice(0,t.l):t}function Ci(e){var t=e.read_shift(4),n=e.read_shift(2);return n+=e.read_shift(1)<<16,e.l++,{c:t,iStyleRef:n}}function Xo(e,t){return t==null&&(t=me(8)),t.write_shift(-4,e.c),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}function Jo(e){var t=e.read_shift(2);return t+=e.read_shift(1)<<16,e.l++,{c:-1,iStyleRef:t}}function Qo(e,t){return t==null&&(t=me(4)),t.write_shift(3,e.iStyleRef||e.s),t.write_shift(1,0),t}var XU=hr,SF=$n;function O1(e){var t=e.read_shift(4);return t===0||t===4294967295?"":e.read_shift(t,"dbcs")}function sh(e,t){var n=!1;return t==null&&(n=!0,t=me(127)),t.write_shift(4,e.length>0?e.length:4294967295),e.length>0&&t.write_shift(0,e,"dbcs"),n?t.slice(0,t.l):t}var JU=hr,Vg=O1,B1=sh;function U1(e){var t=e.slice(e.l,e.l+4),n=t[0]&1,r=t[0]&2;e.l+=4;var i=r===0?ih([0,0,0,0,t[0]&252,t[1],t[2],t[3]],0):Za(t,0)>>2;return n?i/100:i}function EF(e,t){t==null&&(t=me(4));var n=0,r=0,i=e*100;if(e==(e|0)&&e>=-536870912&&e<1<<29?r=1:i==(i|0)&&i>=-536870912&&i<1<<29&&(r=1,n=1),r)t.write_shift(-4,((n?i:e)<<2)+(n+2));else throw new Error("unsupported RkNumber "+e)}function _F(e){var t={s:{},e:{}};return t.s.r=e.read_shift(4),t.e.r=e.read_shift(4),t.s.c=e.read_shift(4),t.e.c=e.read_shift(4),t}function QU(e,t){return t||(t=me(16)),t.write_shift(4,e.s.r),t.write_shift(4,e.e.r),t.write_shift(4,e.s.c),t.write_shift(4,e.e.c),t}var jo=_F,Mu=QU;function ur(e){if(e.length-e.l<8)throw"XLS Xnum Buffer underflow";return e.read_shift(8,"f")}function Io(e,t){return(t||me(8)).write_shift(8,e,"f")}function jU(e){var t={},n=e.read_shift(1),r=n>>>1,i=e.read_shift(1),s=e.read_shift(2,"i"),a=e.read_shift(1),o=e.read_shift(1),l=e.read_shift(1);switch(e.l++,r){case 0:t.auto=1;break;case 1:t.index=i;var u=wo[i];u&&(t.rgb=vf(u));break;case 2:t.rgb=vf([a,o,l]);break;case 3:t.theme=i;break}return s!=0&&(t.tint=s>0?s/32767:s/32768),t}function ah(e,t){if(t||(t=me(8)),!e||e.auto)return t.write_shift(4,0),t.write_shift(4,0),t;e.index!=null?(t.write_shift(1,2),t.write_shift(1,e.index)):e.theme!=null?(t.write_shift(1,6),t.write_shift(1,e.theme)):(t.write_shift(1,5),t.write_shift(1,0));var n=e.tint||0;if(n>0?n*=32767:n<0&&(n*=32768),t.write_shift(2,n),!e.rgb||e.theme!=null)t.write_shift(2,0),t.write_shift(1,0),t.write_shift(1,0);else{var r=e.rgb||"FFFFFF";typeof r=="number"&&(r=("000000"+r.toString(16)).slice(-6)),t.write_shift(1,parseInt(r.slice(0,2),16)),t.write_shift(1,parseInt(r.slice(2,4),16)),t.write_shift(1,parseInt(r.slice(4,6),16)),t.write_shift(1,255)}return t}function ZU(e){var t=e.read_shift(1);e.l++;var n={fBold:t&1,fItalic:t&2,fUnderline:t&4,fStrikeout:t&8,fOutline:t&16,fShadow:t&32,fCondense:t&64,fExtend:t&128};return n}function eV(e,t){t||(t=me(2));var n=(e.italic?2:0)|(e.strike?8:0)|(e.outline?16:0)|(e.shadow?32:0)|(e.condense?64:0)|(e.extend?128:0);return t.write_shift(1,n),t.write_shift(1,0),t}function CF(e,t){var n={2:"BITMAP",3:"METAFILEPICT",8:"DIB",14:"ENHMETAFILE"},r=e.read_shift(4);switch(r){case 0:return"";case 4294967295:case 4294967294:return n[e.read_shift(4)]||""}if(r>400)throw new Error("Unsupported Clipboard: "+r.toString(16));return e.l-=4,e.read_shift(0,t==1?"lpstr":"lpwstr")}function tV(e){return CF(e,1)}function nV(e){return CF(e,2)}var V1=2,Fr=3,Nd=11,aE=12,oh=19,bd=64,rV=65,iV=71,sV=4108,aV=4126,Bn=80,kF=81,oV=[Bn,kF],Hg={1:{n:"CodePage",t:V1},2:{n:"Category",t:Bn},3:{n:"PresentationFormat",t:Bn},4:{n:"ByteCount",t:Fr},5:{n:"LineCount",t:Fr},6:{n:"ParagraphCount",t:Fr},7:{n:"SlideCount",t:Fr},8:{n:"NoteCount",t:Fr},9:{n:"HiddenCount",t:Fr},10:{n:"MultimediaClipCount",t:Fr},11:{n:"ScaleCrop",t:Nd},12:{n:"HeadingPairs",t:sV},13:{n:"TitlesOfParts",t:aV},14:{n:"Manager",t:Bn},15:{n:"Company",t:Bn},16:{n:"LinksUpToDate",t:Nd},17:{n:"CharacterCount",t:Fr},19:{n:"SharedDoc",t:Nd},22:{n:"HyperlinksChanged",t:Nd},23:{n:"AppVersion",t:Fr,p:"version"},24:{n:"DigSig",t:rV},26:{n:"ContentType",t:Bn},27:{n:"ContentStatus",t:Bn},28:{n:"Language",t:Bn},29:{n:"Version",t:Bn},255:{},2147483648:{n:"Locale",t:oh},2147483651:{n:"Behavior",t:oh},1919054434:{}},$g={1:{n:"CodePage",t:V1},2:{n:"Title",t:Bn},3:{n:"Subject",t:Bn},4:{n:"Author",t:Bn},5:{n:"Keywords",t:Bn},6:{n:"Comments",t:Bn},7:{n:"Template",t:Bn},8:{n:"LastAuthor",t:Bn},9:{n:"RevNumber",t:Bn},10:{n:"EditTime",t:bd},11:{n:"LastPrinted",t:bd},12:{n:"CreatedDate",t:bd},13:{n:"ModifiedDate",t:bd},14:{n:"PageCount",t:Fr},15:{n:"WordCount",t:Fr},16:{n:"CharCount",t:Fr},17:{n:"Thumbnail",t:iV},18:{n:"Application",t:Bn},19:{n:"DocSecurity",t:Fr},255:{},2147483648:{n:"Locale",t:oh},2147483651:{n:"Behavior",t:oh},1919054434:{}},oE={1:"US",2:"CA",3:"",7:"RU",20:"EG",30:"GR",31:"NL",32:"BE",33:"FR",34:"ES",36:"HU",39:"IT",41:"CH",43:"AT",44:"GB",45:"DK",46:"SE",47:"NO",48:"PL",49:"DE",52:"MX",55:"BR",61:"AU",64:"NZ",66:"TH",81:"JP",82:"KR",84:"VN",86:"CN",90:"TR",105:"JS",213:"DZ",216:"MA",218:"LY",351:"PT",354:"IS",358:"FI",420:"CZ",886:"TW",961:"LB",962:"JO",963:"SY",964:"IQ",965:"KW",966:"SA",971:"AE",972:"IL",974:"QA",981:"IR",65535:"US"},lV=[null,"solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"];function uV(e){return e.map(function(t){return[t>>16&255,t>>8&255,t&255]})}var cV=uV([0,16777215,16711680,65280,255,16776960,16711935,65535,0,16777215,16711680,65280,255,16776960,16711935,65535,8388608,32768,128,8421376,8388736,32896,12632256,8421504,10066431,10040166,16777164,13434879,6684774,16744576,26316,13421823,128,16711935,16776960,65535,8388736,8388608,32896,255,52479,13434879,13434828,16777113,10079487,16751052,13408767,16764057,3368703,3394764,10079232,16763904,16750848,16737792,6710937,9868950,13158,3381606,13056,3355392,10040064,10040166,3355545,3355443,16777215,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0,0]),wo=nn(cV),Ws={0:"#NULL!",7:"#DIV/0!",15:"#VALUE!",23:"#REF!",29:"#NAME?",36:"#NUM!",42:"#N/A",43:"#GETTING_DATA",255:"#WTF?"},AF={"#NULL!":0,"#DIV/0!":7,"#VALUE!":15,"#REF!":23,"#NAME?":29,"#NUM!":36,"#N/A":42,"#GETTING_DATA":43,"#WTF?":255},zg={"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml":"workbooks","application/vnd.ms-excel.sheet.macroEnabled.main+xml":"workbooks","application/vnd.ms-excel.sheet.binary.macroEnabled.main":"workbooks","application/vnd.ms-excel.addin.macroEnabled.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml":"workbooks","application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml":"sheets","application/vnd.ms-excel.worksheet":"sheets","application/vnd.ms-excel.binIndexWs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml":"charts","application/vnd.ms-excel.chartsheet":"charts","application/vnd.ms-excel.macrosheet+xml":"macros","application/vnd.ms-excel.macrosheet":"macros","application/vnd.ms-excel.intlmacrosheet":"TODO","application/vnd.ms-excel.binIndexMs":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml":"dialogs","application/vnd.ms-excel.dialogsheet":"dialogs","application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml":"strs","application/vnd.ms-excel.sharedStrings":"strs","application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml":"styles","application/vnd.ms-excel.styles":"styles","application/vnd.openxmlformats-package.core-properties+xml":"coreprops","application/vnd.openxmlformats-officedocument.custom-properties+xml":"custprops","application/vnd.openxmlformats-officedocument.extended-properties+xml":"extprops","application/vnd.openxmlformats-officedocument.customXmlProperties+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.customProperty":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml":"comments","application/vnd.ms-excel.comments":"comments","application/vnd.ms-excel.threadedcomments+xml":"threadedcomments","application/vnd.ms-excel.person+xml":"people","application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml":"metadata","application/vnd.ms-excel.sheetMetadata":"metadata","application/vnd.ms-excel.pivotTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotTable+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.chart+xml":"TODO","application/vnd.ms-office.chartcolorstyle+xml":"TODO","application/vnd.ms-office.chartstyle+xml":"TODO","application/vnd.ms-office.chartex+xml":"TODO","application/vnd.ms-excel.calcChain":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.calcChain+xml":"calcchains","application/vnd.openxmlformats-officedocument.spreadsheetml.printerSettings":"TODO","application/vnd.ms-office.activeX":"TODO","application/vnd.ms-office.activeX+xml":"TODO","application/vnd.ms-excel.attachedToolbars":"TODO","application/vnd.ms-excel.connections":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.connections+xml":"TODO","application/vnd.ms-excel.externalLink":"links","application/vnd.openxmlformats-officedocument.spreadsheetml.externalLink+xml":"links","application/vnd.ms-excel.pivotCacheDefinition":"TODO","application/vnd.ms-excel.pivotCacheRecords":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheDefinition+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.pivotCacheRecords+xml":"TODO","application/vnd.ms-excel.queryTable":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.queryTable+xml":"TODO","application/vnd.ms-excel.userNames":"TODO","application/vnd.ms-excel.revisionHeaders":"TODO","application/vnd.ms-excel.revisionLog":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionHeaders+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.revisionLog+xml":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.userNames+xml":"TODO","application/vnd.ms-excel.tableSingleCells":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.tableSingleCells+xml":"TODO","application/vnd.ms-excel.slicer":"TODO","application/vnd.ms-excel.slicerCache":"TODO","application/vnd.ms-excel.slicer+xml":"TODO","application/vnd.ms-excel.slicerCache+xml":"TODO","application/vnd.ms-excel.wsSortMap":"TODO","application/vnd.ms-excel.table":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.table+xml":"TODO","application/vnd.openxmlformats-officedocument.theme+xml":"themes","application/vnd.openxmlformats-officedocument.themeOverride+xml":"TODO","application/vnd.ms-excel.Timeline+xml":"TODO","application/vnd.ms-excel.TimelineCache+xml":"TODO","application/vnd.ms-office.vbaProject":"vba","application/vnd.ms-office.vbaProjectSignature":"TODO","application/vnd.ms-office.volatileDependencies":"TODO","application/vnd.openxmlformats-officedocument.spreadsheetml.volatileDependencies+xml":"TODO","application/vnd.ms-excel.controlproperties+xml":"TODO","application/vnd.openxmlformats-officedocument.model+data":"TODO","application/vnd.ms-excel.Survey+xml":"TODO","application/vnd.openxmlformats-officedocument.drawing+xml":"drawings","application/vnd.openxmlformats-officedocument.drawingml.chartshapes+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramColors+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramData+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramLayout+xml":"TODO","application/vnd.openxmlformats-officedocument.drawingml.diagramStyle+xml":"TODO","application/vnd.openxmlformats-officedocument.vmlDrawing":"TODO","application/vnd.openxmlformats-package.relationships+xml":"rels","application/vnd.openxmlformats-officedocument.oleObject":"TODO","image/png":"TODO",sheet:"js"},Ld={workbooks:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheet.main+xml",xlsm:"application/vnd.ms-excel.sheet.macroEnabled.main+xml",xlsb:"application/vnd.ms-excel.sheet.binary.macroEnabled.main",xlam:"application/vnd.ms-excel.addin.macroEnabled.main+xml",xltx:"application/vnd.openxmlformats-officedocument.spreadsheetml.template.main+xml"},strs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sharedStrings+xml",xlsb:"application/vnd.ms-excel.sharedStrings"},comments:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.comments+xml",xlsb:"application/vnd.ms-excel.comments"},sheets:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.worksheet+xml",xlsb:"application/vnd.ms-excel.worksheet"},charts:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.chartsheet+xml",xlsb:"application/vnd.ms-excel.chartsheet"},dialogs:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.dialogsheet+xml",xlsb:"application/vnd.ms-excel.dialogsheet"},macros:{xlsx:"application/vnd.ms-excel.macrosheet+xml",xlsb:"application/vnd.ms-excel.macrosheet"},metadata:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.sheetMetadata+xml",xlsb:"application/vnd.ms-excel.sheetMetadata"},styles:{xlsx:"application/vnd.openxmlformats-officedocument.spreadsheetml.styles+xml",xlsb:"application/vnd.ms-excel.styles"}};function H1(){return{workbooks:[],sheets:[],charts:[],dialogs:[],macros:[],rels:[],strs:[],comments:[],threadedcomments:[],links:[],coreprops:[],extprops:[],custprops:[],themes:[],styles:[],calcchains:[],vba:[],drawings:[],metadata:[],people:[],TODO:[],xmlns:""}}function fV(e){var t=H1();if(!e||!e.match)return t;var n={};if((e.match(gr)||[]).forEach(function(r){var i=it(r);switch(i[0].replace(TU,"<")){case"<?xml":break;case"<Types":t.xmlns=i["xmlns"+(i[0].match(/<(\w+):/)||["",""])[1]];break;case"<Default":n[i.Extension]=i.ContentType;break;case"<Override":t[zg[i.ContentType]]!==void 0&&t[zg[i.ContentType]].push(i.PartName);break}}),t.xmlns!==Pn.CT)throw new Error("Unknown Namespace: "+t.xmlns);return t.calcchain=t.calcchains.length>0?t.calcchains[0]:"",t.sst=t.strs.length>0?t.strs[0]:"",t.style=t.styles.length>0?t.styles[0]:"",t.defaults=n,delete t.calcchains,t}function RF(e,t){var n=fU(zg),r=[],i;r[r.length]=En,r[r.length]=Pe("Types",null,{xmlns:Pn.CT,"xmlns:xsd":Pn.xsd,"xmlns:xsi":Pn.xsi}),r=r.concat([["xml","application/xml"],["bin","application/vnd.ms-excel.sheet.binary.macroEnabled.main"],["vml","application/vnd.openxmlformats-officedocument.vmlDrawing"],["data","application/vnd.openxmlformats-officedocument.model+data"],["bmp","image/bmp"],["png","image/png"],["gif","image/gif"],["emf","image/x-emf"],["wmf","image/x-wmf"],["jpg","image/jpeg"],["jpeg","image/jpeg"],["tif","image/tiff"],["tiff","image/tiff"],["pdf","application/pdf"],["rels","application/vnd.openxmlformats-package.relationships+xml"]].map(function(l){return Pe("Default",null,{Extension:l[0],ContentType:l[1]})}));var s=function(l){e[l]&&e[l].length>0&&(i=e[l][0],r[r.length]=Pe("Override",null,{PartName:(i[0]=="/"?"":"/")+i,ContentType:Ld[l][t.bookType]||Ld[l].xlsx}))},a=function(l){(e[l]||[]).forEach(function(u){r[r.length]=Pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:Ld[l][t.bookType]||Ld[l].xlsx})})},o=function(l){(e[l]||[]).forEach(function(u){r[r.length]=Pe("Override",null,{PartName:(u[0]=="/"?"":"/")+u,ContentType:n[l][0]})})};return s("workbooks"),a("sheets"),a("charts"),o("themes"),["strs","styles"].forEach(s),["coreprops","extprops","custprops"].forEach(o),o("vba"),o("comments"),o("threadedcomments"),o("drawings"),a("metadata"),o("people"),r.length>2&&(r[r.length]="</Types>",r[1]=r[1].replace("/>",">")),r.join("")}var pt={WB:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/officeDocument",SHEET:"http://sheetjs.openxmlformats.org/officeDocument/2006/relationships/officeDocument",HLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/hyperlink",VML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/vmlDrawing",XPATH:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLinkPath",XMISS:"http://schemas.microsoft.com/office/2006/relationships/xlExternalLinkPath/xlPathMissing",XLINK:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/externalLink",CXML:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXml",CXMLP:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/customXmlProps",CMNT:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/comments",CORE_PROPS:"http://schemas.openxmlformats.org/package/2006/relationships/metadata/core-properties",EXT_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/extended-properties",CUST_PROPS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/custom-properties",SST:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sharedStrings",STY:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/styles",THEME:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/theme",CHART:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chart",CHARTEX:"http://schemas.microsoft.com/office/2014/relationships/chartEx",CS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/chartsheet",WS:["http://schemas.openxmlformats.org/officeDocument/2006/relationships/worksheet","http://purl.oclc.org/ooxml/officeDocument/relationships/worksheet"],DS:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/dialogsheet",MS:"http://schemas.microsoft.com/office/2006/relationships/xlMacrosheet",IMG:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/image",DRAW:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/drawing",XLMETA:"http://schemas.openxmlformats.org/officeDocument/2006/relationships/sheetMetadata",TCMNT:"http://schemas.microsoft.com/office/2017/10/relationships/threadedComment",PEOPLE:"http://schemas.microsoft.com/office/2017/10/relationships/person",VBA:"http://schemas.microsoft.com/office/2006/relationships/vbaProject"};function gf(e){var t=e.lastIndexOf("/");return e.slice(0,t+1)+"_rels/"+e.slice(t+1)+".rels"}function Mc(e,t){var n={"!id":{}};if(!e)return n;t.charAt(0)!=="/"&&(t="/"+t);var r={};return(e.match(gr)||[]).forEach(function(i){var s=it(i);if(s[0]==="<Relationship"){var a={};a.Type=s.Type,a.Target=s.Target,a.Id=s.Id,s.TargetMode&&(a.TargetMode=s.TargetMode);var o=s.TargetMode==="External"?s.Target:fc(s.Target,t);n[o]=a,r[s.Id]=a}}),n["!id"]=r,n}function Ul(e){var t=[En,Pe("Relationships",null,{xmlns:Pn.RELS})];return vn(e["!id"]).forEach(function(n){t[t.length]=Pe("Relationship",null,e["!id"][n])}),t.length>2&&(t[t.length]="</Relationships>",t[1]=t[1].replace("/>",">")),t.join("")}function Ht(e,t,n,r,i,s){if(i||(i={}),e["!id"]||(e["!id"]={}),e["!idx"]||(e["!idx"]=1),t<0)for(t=e["!idx"];e["!id"]["rId"+t];++t);if(e["!idx"]=t+1,i.Id="rId"+t,i.Type=r,i.Target=n,[pt.HLINK,pt.XPATH,pt.XMISS].indexOf(i.Type)>-1&&(i.TargetMode="External"),e["!id"][i.Id])throw new Error("Cannot rewrite rId "+t);return e["!id"][i.Id]=i,e[("/"+i.Target).replace("//","/")]=i,t}var dV="application/vnd.oasis.opendocument.spreadsheet";function hV(e,t){for(var n=D1(e),r,i;r=mf.exec(n);)switch(r[3]){case"manifest":break;case"file-entry":if(i=it(r[0],!1),i.path=="/"&&i.type!==dV)throw new Error("This OpenDocument is not a spreadsheet");break;case"encryption-data":case"algorithm":case"start-key-generation":case"key-derivation":throw new Error("Unsupported ODS Encryption");default:if(t&&t.WTF)throw r}}function pV(e){var t=[En];t.push(`<manifest:manifest xmlns:manifest="urn:oasis:names:tc:opendocument:xmlns:manifest:1.0" manifest:version="1.2">
`),t.push(`  <manifest:file-entry manifest:full-path="/" manifest:version="1.2" manifest:media-type="application/vnd.oasis.opendocument.spreadsheet"/>
`);for(var n=0;n<e.length;++n)t.push('  <manifest:file-entry manifest:full-path="'+e[n][0]+'" manifest:media-type="'+e[n][1]+`"/>
`);return t.push("</manifest:manifest>"),t.join("")}function lE(e,t,n){return['  <rdf:Description rdf:about="'+e+`">
`,'    <rdf:type rdf:resource="http://docs.oasis-open.org/ns/office/1.2/meta/'+(n||"odf")+"#"+t+`"/>
`,`  </rdf:Description>
`].join("")}function mV(e,t){return['  <rdf:Description rdf:about="'+e+`">
`,'    <ns0:hasPart xmlns:ns0="http://docs.oasis-open.org/ns/office/1.2/meta/pkg#" rdf:resource="'+t+`"/>
`,`  </rdf:Description>
`].join("")}function gV(e){var t=[En];t.push(`<rdf:RDF xmlns:rdf="http://www.w3.org/1999/02/22-rdf-syntax-ns#">
`);for(var n=0;n!=e.length;++n)t.push(lE(e[n][0],e[n][1])),t.push(mV("",e[n][0]));return t.push(lE("","Document","pkg")),t.push("</rdf:RDF>"),t.join("")}function MF(){return'<office:document-meta xmlns:office="urn:oasis:names:tc:opendocument:xmlns:office:1.0" xmlns:meta="urn:oasis:names:tc:opendocument:xmlns:meta:1.0" xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:xlink="http://www.w3.org/1999/xlink" office:version="1.2"><office:meta><meta:generator>SheetJS '+Z0.version+"</meta:generator></office:meta></office:document-meta>"}var yi=[["cp:category","Category"],["cp:contentStatus","ContentStatus"],["cp:keywords","Keywords"],["cp:lastModifiedBy","LastAuthor"],["cp:lastPrinted","LastPrinted"],["cp:revision","RevNumber"],["cp:version","Version"],["dc:creator","Author"],["dc:description","Comments"],["dc:identifier","Identifier"],["dc:language","Language"],["dc:subject","Subject"],["dc:title","Title"],["dcterms:created","CreatedDate","date"],["dcterms:modified","ModifiedDate","date"]],vV=function(){for(var e=new Array(yi.length),t=0;t<yi.length;++t){var n=yi[t],r="(?:"+n[0].slice(0,n[0].indexOf(":"))+":)"+n[0].slice(n[0].indexOf(":")+1);e[t]=new RegExp("<"+r+"[^>]*>([\\s\\S]*?)</"+r+">")}return e}();function FF(e){var t={};e=qt(e);for(var n=0;n<yi.length;++n){var r=yi[n],i=e.match(vV[n]);i!=null&&i.length>0&&(t[r[1]]=kt(i[1])),r[2]==="date"&&t[r[1]]&&(t[r[1]]=tn(t[r[1]]))}return t}function lm(e,t,n,r,i){i[e]!=null||t==null||t===""||(i[e]=t,t=$t(t),r[r.length]=n?Pe(e,t,n):Qn(e,t))}function DF(e,t){var n=t||{},r=[En,Pe("cp:coreProperties",null,{"xmlns:cp":Pn.CORE_PROPS,"xmlns:dc":Pn.dc,"xmlns:dcterms":Pn.dcterms,"xmlns:dcmitype":Pn.dcmitype,"xmlns:xsi":Pn.xsi})],i={};if(!e&&!n.Props)return r.join("");e&&(e.CreatedDate!=null&&lm("dcterms:created",typeof e.CreatedDate=="string"?e.CreatedDate:Ug(e.CreatedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i),e.ModifiedDate!=null&&lm("dcterms:modified",typeof e.ModifiedDate=="string"?e.ModifiedDate:Ug(e.ModifiedDate,n.WTF),{"xsi:type":"dcterms:W3CDTF"},r,i));for(var s=0;s!=yi.length;++s){var a=yi[s],o=n.Props&&n.Props[a[1]]!=null?n.Props[a[1]]:e?e[a[1]]:null;o===!0?o="1":o===!1?o="0":typeof o=="number"&&(o=String(o)),o!=null&&lm(a[0],o,null,r,i)}return r.length>2&&(r[r.length]="</cp:coreProperties>",r[1]=r[1].replace("/>",">")),r.join("")}var To=[["Application","Application","string"],["AppVersion","AppVersion","string"],["Company","Company","string"],["DocSecurity","DocSecurity","string"],["Manager","Manager","string"],["HyperlinksChanged","HyperlinksChanged","bool"],["SharedDoc","SharedDoc","bool"],["LinksUpToDate","LinksUpToDate","bool"],["ScaleCrop","ScaleCrop","bool"],["HeadingPairs","HeadingPairs","raw"],["TitlesOfParts","TitlesOfParts","raw"]],PF=["Worksheets","SheetNames","NamedRanges","DefinedNames","Chartsheets","ChartNames"];function IF(e,t,n,r){var i=[];if(typeof e=="string")i=jS(e,r);else for(var s=0;s<e.length;++s)i=i.concat(e[s].map(function(c){return{v:c}}));var a=typeof t=="string"?jS(t,r).map(function(c){return c.v}):t,o=0,l=0;if(a.length>0)for(var u=0;u!==i.length;u+=2){switch(l=+i[u+1].v,i[u].v){case"Worksheets":case"":case"":case" ":case"":case" ":case"Arbeitsbltter":case"alma Sayfalar":case"Feuilles de calcul":case"Fogli di lavoro":case"Folhas de clculo":case"Planilhas":case"Regneark":case"Hojas de clculo":case"Werkbladen":n.Worksheets=l,n.SheetNames=a.slice(o,o+l);break;case"Named Ranges":case"Rangos con nombre":case"":case"Benannte Bereiche":case"Navngivne omrder":n.NamedRanges=l,n.DefinedNames=a.slice(o,o+l);break;case"Charts":case"Diagramme":n.Chartsheets=l,n.ChartNames=a.slice(o,o+l);break}o+=l}}function xV(e,t,n){var r={};return t||(t={}),e=qt(e),To.forEach(function(i){var s=(e.match(hf(i[0]))||[])[1];switch(i[2]){case"string":s&&(t[i[1]]=kt(s));break;case"bool":t[i[1]]=s==="true";break;case"raw":var a=e.match(new RegExp("<"+i[0]+"[^>]*>([\\s\\S]*?)</"+i[0]+">"));a&&a.length>0&&(r[i[1]]=a[1]);break}}),r.HeadingPairs&&r.TitlesOfParts&&IF(r.HeadingPairs,r.TitlesOfParts,t,n),t}function NF(e){var t=[],n=Pe;return e||(e={}),e.Application="SheetJS",t[t.length]=En,t[t.length]=Pe("Properties",null,{xmlns:Pn.EXT_PROPS,"xmlns:vt":Pn.vt}),To.forEach(function(r){if(e[r[1]]!==void 0){var i;switch(r[2]){case"string":i=$t(String(e[r[1]]));break;case"bool":i=e[r[1]]?"true":"false";break}i!==void 0&&(t[t.length]=n(r[0],i))}}),t[t.length]=n("HeadingPairs",n("vt:vector",n("vt:variant","<vt:lpstr>Worksheets</vt:lpstr>")+n("vt:variant",n("vt:i4",String(e.Worksheets))),{size:2,baseType:"variant"})),t[t.length]=n("TitlesOfParts",n("vt:vector",e.SheetNames.map(function(r){return"<vt:lpstr>"+$t(r)+"</vt:lpstr>"}).join(""),{size:e.Worksheets,baseType:"lpstr"})),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var yV=/<[^>]+>[^<]*/g;function wV(e,t){var n={},r="",i=e.match(yV);if(i)for(var s=0;s!=i.length;++s){var a=i[s],o=it(a);switch(o[0]){case"<?xml":break;case"<Properties":break;case"<property":r=kt(o.name);break;case"</property>":r=null;break;default:if(a.indexOf("<vt:")===0){var l=a.split(">"),u=l[0].slice(4),c=l[1];switch(u){case"lpstr":case"bstr":case"lpwstr":n[r]=kt(c);break;case"bool":n[r]=jt(c);break;case"i1":case"i2":case"i4":case"i8":case"int":case"uint":n[r]=parseInt(c,10);break;case"r4":case"r8":case"decimal":n[r]=parseFloat(c);break;case"filetime":case"date":n[r]=tn(c);break;case"cy":case"error":n[r]=kt(c);break;default:if(u.slice(-1)=="/")break;t.WTF&&typeof console<"u"&&console.warn("Unexpected",a,u,l)}}else if(a.slice(0,2)!=="</"){if(t.WTF)throw new Error(a)}}}return n}function bF(e){var t=[En,Pe("Properties",null,{xmlns:Pn.CUST_PROPS,"xmlns:vt":Pn.vt})];if(!e)return t.join("");var n=1;return vn(e).forEach(function(i){++n,t[t.length]=Pe("property",MU(e[i]),{fmtid:"{D5CDD505-2E9C-101B-9397-08002B2CF9AE}",pid:n,name:$t(i)})}),t.length>2&&(t[t.length]="</Properties>",t[1]=t[1].replace("/>",">")),t.join("")}var Wg={Title:"Title",Subject:"Subject",Author:"Author",Keywords:"Keywords",Comments:"Description",LastAuthor:"LastAuthor",RevNumber:"Revision",Application:"AppName",LastPrinted:"LastPrinted",CreatedDate:"Created",ModifiedDate:"LastSaved",Category:"Category",Manager:"Manager",Company:"Company",AppVersion:"Version",ContentStatus:"ContentStatus",Identifier:"Identifier",Language:"Language"},um;function TV(e,t,n){um||(um=jh(Wg)),t=um[t]||t,e[t]=n}function SV(e,t){var n=[];return vn(Wg).map(function(r){for(var i=0;i<yi.length;++i)if(yi[i][1]==r)return yi[i];for(i=0;i<To.length;++i)if(To[i][1]==r)return To[i];throw r}).forEach(function(r){if(e[r[1]]!=null){var i=t&&t.Props&&t.Props[r[1]]!=null?t.Props[r[1]]:e[r[1]];switch(r[2]){case"date":i=new Date(i).toISOString().replace(/\.\d*Z/,"Z");break}typeof i=="number"?i=String(i):i===!0||i===!1?i=i?"1":"0":i instanceof Date&&(i=new Date(i).toISOString().replace(/\.\d*Z/,"")),n.push(Qn(Wg[r[1]]||r[1],i))}}),Pe("DocumentProperties",n.join(""),{xmlns:zr.o})}function EV(e,t){var n=["Worksheets","SheetNames"],r="CustomDocumentProperties",i=[];return e&&vn(e).forEach(function(s){if(Object.prototype.hasOwnProperty.call(e,s)){for(var a=0;a<yi.length;++a)if(s==yi[a][1])return;for(a=0;a<To.length;++a)if(s==To[a][1])return;for(a=0;a<n.length;++a)if(s==n[a])return;var o=e[s],l="string";typeof o=="number"?(l="float",o=String(o)):o===!0||o===!1?(l="boolean",o=o?"1":"0"):o=String(o),i.push(Pe(YS(s),o,{"dt:dt":l}))}}),t&&vn(t).forEach(function(s){if(Object.prototype.hasOwnProperty.call(t,s)&&!(e&&Object.prototype.hasOwnProperty.call(e,s))){var a=t[s],o="string";typeof a=="number"?(o="float",a=String(a)):a===!0||a===!1?(o="boolean",a=a?"1":"0"):a instanceof Date?(o="dateTime.tz",a=a.toISOString()):a=String(a),i.push(Pe(YS(s),a,{"dt:dt":o}))}}),"<"+r+' xmlns="'+zr.o+'">'+i.join("")+"</"+r+">"}function $1(e){var t=e.read_shift(4),n=e.read_shift(4);return new Date((n/1e7*Math.pow(2,32)+t/1e7-11644473600)*1e3).toISOString().replace(/\.000/,"")}function _V(e){var t=typeof e=="string"?new Date(Date.parse(e)):e,n=t.getTime()/1e3+11644473600,r=n%Math.pow(2,32),i=(n-r)/Math.pow(2,32);r*=1e7,i*=1e7;var s=r/Math.pow(2,32)|0;s>0&&(r=r%Math.pow(2,32),i+=s);var a=me(8);return a.write_shift(4,r),a.write_shift(4,i),a}function LF(e,t,n){var r=e.l,i=e.read_shift(0,"lpstr-cp");if(n)for(;e.l-r&3;)++e.l;return i}function OF(e,t,n){var r=e.read_shift(0,"lpwstr");return r}function BF(e,t,n){return t===31?OF(e):LF(e,t,n)}function Gg(e,t,n){return BF(e,t,n===!1?0:4)}function CV(e,t){if(!t)throw new Error("VtUnalignedString must have positive length");return BF(e,t,0)}function kV(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r){var i=e.l;n[r]=e.read_shift(0,"lpwstr").replace(_r,""),e.l-i&2&&(e.l+=2)}return n}function AV(e){for(var t=e.read_shift(4),n=[],r=0;r!=t;++r)n[r]=e.read_shift(0,"lpstr-cp").replace(_r,"");return n}function RV(e){var t=e.l,n=lh(e,kF);e[e.l]==0&&e[e.l+1]==0&&e.l-t&2&&(e.l+=2);var r=lh(e,Fr);return[n,r]}function MV(e){for(var t=e.read_shift(4),n=[],r=0;r<t/2;++r)n.push(RV(e));return n}function uE(e,t){for(var n=e.read_shift(4),r={},i=0;i!=n;++i){var s=e.read_shift(4),a=e.read_shift(4);r[s]=e.read_shift(a,t===1200?"utf16le":"utf8").replace(_r,"").replace(cc,"!"),t===1200&&a%2&&(e.l+=2)}return e.l&3&&(e.l=e.l>>3<<2),r}function UF(e){var t=e.read_shift(4),n=e.slice(e.l,e.l+t);return e.l+=t,(t&3)>0&&(e.l+=4-(t&3)&3),n}function FV(e){var t={};return t.Size=e.read_shift(4),e.l+=t.Size+3-(t.Size-1)%4,t}function lh(e,t,n){var r=e.read_shift(2),i,s=n||{};if(e.l+=2,t!==aE&&r!==t&&oV.indexOf(t)===-1&&!((t&65534)==4126&&(r&65534)==4126))throw new Error("Expected type "+t+" saw "+r);switch(t===aE?r:t){case 2:return i=e.read_shift(2,"i"),s.raw||(e.l+=2),i;case 3:return i=e.read_shift(4,"i"),i;case 11:return e.read_shift(4)!==0;case 19:return i=e.read_shift(4),i;case 30:return LF(e,r,4).replace(_r,"");case 31:return OF(e);case 64:return $1(e);case 65:return UF(e);case 71:return FV(e);case 80:return Gg(e,r,!s.raw).replace(_r,"");case 81:return CV(e,r).replace(_r,"");case 4108:return MV(e);case 4126:case 4127:return r==4127?kV(e):AV(e);default:throw new Error("TypedPropertyValue unrecognized type "+t+" "+r)}}function cE(e,t){var n=me(4),r=me(4);switch(n.write_shift(4,e==80?31:e),e){case 3:r.write_shift(-4,t);break;case 5:r=me(8),r.write_shift(8,t,"f");break;case 11:r.write_shift(4,t?1:0);break;case 64:r=_V(t);break;case 31:case 80:for(r=me(4+2*(t.length+1)+(t.length%2?0:2)),r.write_shift(4,t.length+1),r.write_shift(0,t,"dbcs");r.l!=r.length;)r.write_shift(1,0);break;default:throw new Error("TypedPropertyValue unrecognized type "+e+" "+t)}return Hn([n,r])}function fE(e,t){var n=e.l,r=e.read_shift(4),i=e.read_shift(4),s=[],a=0,o=0,l=-1,u={};for(a=0;a!=i;++a){var c=e.read_shift(4),h=e.read_shift(4);s[a]=[c,h+n]}s.sort(function(T,y){return T[1]-y[1]});var p={};for(a=0;a!=i;++a){if(e.l!==s[a][1]){var m=!0;if(a>0&&t)switch(t[s[a-1][0]].t){case 2:e.l+2===s[a][1]&&(e.l+=2,m=!1);break;case 80:e.l<=s[a][1]&&(e.l=s[a][1],m=!1);break;case 4108:e.l<=s[a][1]&&(e.l=s[a][1],m=!1);break}if((!t||a==0)&&e.l<=s[a][1]&&(m=!1,e.l=s[a][1]),m)throw new Error("Read Error: Expected address "+s[a][1]+" at "+e.l+" :"+a)}if(t){var v=t[s[a][0]];if(p[v.n]=lh(e,v.t,{raw:!0}),v.p==="version"&&(p[v.n]=String(p[v.n]>>16)+"."+("0000"+String(p[v.n]&65535)).slice(-4)),v.n=="CodePage")switch(p[v.n]){case 0:p[v.n]=1252;case 874:case 932:case 936:case 949:case 950:case 1250:case 1251:case 1253:case 1254:case 1255:case 1256:case 1257:case 1258:case 1e4:case 1200:case 1201:case 1252:case 65e3:case-536:case 65001:case-535:Li(o=p[v.n]>>>0&65535);break;default:throw new Error("Unsupported CodePage: "+p[v.n])}}else if(s[a][0]===1){if(o=p.CodePage=lh(e,V1),Li(o),l!==-1){var g=e.l;e.l=s[l][1],u=uE(e,o),e.l=g}}else if(s[a][0]===0){if(o===0){l=a,e.l=s[a+1][1];continue}u=uE(e,o)}else{var w=u[s[a][0]],x;switch(e[e.l]){case 65:e.l+=4,x=UF(e);break;case 30:e.l+=4,x=Gg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 31:e.l+=4,x=Gg(e,e[e.l-4]).replace(/\u0000+$/,"");break;case 3:e.l+=4,x=e.read_shift(4,"i");break;case 19:e.l+=4,x=e.read_shift(4);break;case 5:e.l+=4,x=e.read_shift(8,"f");break;case 11:e.l+=4,x=yn(e,4);break;case 64:e.l+=4,x=tn($1(e));break;default:throw new Error("unparsed value: "+e[e.l])}p[w]=x}}return e.l=n+r,p}var VF=["CodePage","Thumbnail","_PID_LINKBASE","_PID_HLINKS","SystemIdentifier","FMTID"];function DV(e){switch(typeof e){case"boolean":return 11;case"number":return(e|0)==e?3:5;case"string":return 31;case"object":if(e instanceof Date)return 64;break}return-1}function dE(e,t,n){var r=me(8),i=[],s=[],a=8,o=0,l=me(8),u=me(8);if(l.write_shift(4,2),l.write_shift(4,1200),u.write_shift(4,1),s.push(l),i.push(u),a+=8+l.length,!t){u=me(8),u.write_shift(4,0),i.unshift(u);var c=[me(4)];for(c[0].write_shift(4,e.length),o=0;o<e.length;++o){var h=e[o][0];for(l=me(8+2*(h.length+1)+(h.length%2?0:2)),l.write_shift(4,o+2),l.write_shift(4,h.length+1),l.write_shift(0,h,"dbcs");l.l!=l.length;)l.write_shift(1,0);c.push(l)}l=Hn(c),s.unshift(l),a+=8+l.length}for(o=0;o<e.length;++o)if(!(t&&!t[e[o][0]])&&!(VF.indexOf(e[o][0])>-1||PF.indexOf(e[o][0])>-1)&&e[o][1]!=null){var p=e[o][1],m=0;if(t){m=+t[e[o][0]];var v=n[m];if(v.p=="version"&&typeof p=="string"){var g=p.split(".");p=(+g[0]<<16)+(+g[1]||0)}l=cE(v.t,p)}else{var w=DV(p);w==-1&&(w=31,p=String(p)),l=cE(w,p)}s.push(l),u=me(8),u.write_shift(4,t?m:2+o),i.push(u),a+=8+l.length}var x=8*(s.length+1);for(o=0;o<s.length;++o)i[o].write_shift(4,x),x+=s[o].length;return r.write_shift(4,a),r.write_shift(4,s.length),Hn([r].concat(i).concat(s))}function hE(e,t,n){var r=e.content;if(!r)return{};Jn(r,0);var i,s,a,o,l=0;r.chk("feff","Byte Order: "),r.read_shift(2);var u=r.read_shift(4),c=r.read_shift(16);if(c!==Ke.utils.consts.HEADER_CLSID&&c!==n)throw new Error("Bad PropertySet CLSID "+c);if(i=r.read_shift(4),i!==1&&i!==2)throw new Error("Unrecognized #Sets: "+i);if(s=r.read_shift(16),o=r.read_shift(4),i===1&&o!==r.l)throw new Error("Length mismatch: "+o+" !== "+r.l);i===2&&(a=r.read_shift(16),l=r.read_shift(4));var h=fE(r,t),p={SystemIdentifier:u};for(var m in h)p[m]=h[m];if(p.FMTID=s,i===1)return p;if(l-r.l==2&&(r.l+=2),r.l!==l)throw new Error("Length mismatch 2: "+r.l+" !== "+l);var v;try{v=fE(r,null)}catch{}for(m in v)p[m]=v[m];return p.FMTID=[s,a],p}function pE(e,t,n,r,i,s){var a=me(i?68:48),o=[a];a.write_shift(2,65534),a.write_shift(2,0),a.write_shift(4,842412599),a.write_shift(16,Ke.utils.consts.HEADER_CLSID,"hex"),a.write_shift(4,i?2:1),a.write_shift(16,t,"hex"),a.write_shift(4,i?68:48);var l=dE(e,n,r);if(o.push(l),i){var u=dE(i,null,null);a.write_shift(16,s,"hex"),a.write_shift(4,68+l.length),o.push(u)}return Hn(o)}function Ks(e,t){return e.read_shift(t),null}function PV(e,t){t||(t=me(e));for(var n=0;n<e;++n)t.write_shift(1,0);return t}function IV(e,t,n){for(var r=[],i=e.l+t;e.l<i;)r.push(n(e,i-e.l));if(i!==e.l)throw new Error("Slurp error");return r}function yn(e,t){return e.read_shift(t)===1}function Tr(e,t){return t||(t=me(2)),t.write_shift(2,+!!e),t}function kn(e){return e.read_shift(2,"u")}function di(e,t){return t||(t=me(2)),t.write_shift(2,e),t}function HF(e,t){return IV(e,t,kn)}function NV(e){var t=e.read_shift(1),n=e.read_shift(1);return n===1?t:t===1}function $F(e,t,n){return n||(n=me(2)),n.write_shift(1,t=="e"?+e:+!!e),n.write_shift(1,t=="e"?1:0),n}function Kf(e,t,n){var r=e.read_shift(n&&n.biff>=12?2:1),i="sbcs-cont";if(n&&n.biff>=8,!n||n.biff==8){var s=e.read_shift(1);s&&(i="dbcs-cont")}else n.biff==12&&(i="wstr");n.biff>=2&&n.biff<=5&&(i="cpstr");var a=r?e.read_shift(r,i):"";return a}function bV(e){var t=e.read_shift(2),n=e.read_shift(1),r=n&4,i=n&8,s=1+(n&1),a=0,o,l={};i&&(a=e.read_shift(2)),r&&(o=e.read_shift(4));var u=s==2?"dbcs-cont":"sbcs-cont",c=t===0?"":e.read_shift(t,u);return i&&(e.l+=4*a),r&&(e.l+=o),l.t=c,i||(l.raw="<t>"+l.t+"</t>",l.r=l.t),l}function LV(e){var t=e.t||"",n=me(3);n.write_shift(2,t.length),n.write_shift(1,1);var r=me(2*t.length);r.write_shift(2*t.length,t,"utf16le");var i=[n,r];return Hn(i)}function No(e,t,n){var r;if(n){if(n.biff>=2&&n.biff<=5)return e.read_shift(t,"cpstr");if(n.biff>=12)return e.read_shift(t,"dbcs-cont")}var i=e.read_shift(1);return i===0?r=e.read_shift(t,"sbcs-cont"):r=e.read_shift(t,"dbcs-cont"),r}function Yf(e,t,n){var r=e.read_shift(n&&n.biff==2?1:2);return r===0?(e.l++,""):No(e,r,n)}function Zo(e,t,n){if(n.biff>5)return Yf(e,t,n);var r=e.read_shift(1);return r===0?(e.l++,""):e.read_shift(r,n.biff<=4||!e.lens?"cpstr":"sbcs-cont")}function zF(e,t,n){return n||(n=me(3+2*e.length)),n.write_shift(2,e.length),n.write_shift(1,1),n.write_shift(31,e,"utf16le"),n}function OV(e){var t=e.read_shift(1);e.l++;var n=e.read_shift(2);return e.l+=2,[t,n]}function BV(e){var t=e.read_shift(4),n=e.l,r=!1;t>24&&(e.l+=t-24,e.read_shift(16)==="795881f43b1d7f48af2c825dc4852763"&&(r=!0),e.l=n);var i=e.read_shift((r?t-24:t)>>1,"utf16le").replace(_r,"");return r&&(e.l+=24),i}function UV(e){for(var t=e.read_shift(2),n="";t-- >0;)n+="../";var r=e.read_shift(0,"lpstr-ansi");if(e.l+=2,e.read_shift(2)!=57005)throw new Error("Bad FileMoniker");var i=e.read_shift(4);if(i===0)return n+r.replace(/\\/g,"/");var s=e.read_shift(4);if(e.read_shift(2)!=3)throw new Error("Bad FileMoniker");var a=e.read_shift(s>>1,"utf16le").replace(_r,"");return n+a}function VV(e,t){var n=e.read_shift(16);switch(n){case"e0c9ea79f9bace118c8200aa004ba90b":return BV(e);case"0303000000000000c000000000000046":return UV(e);default:throw new Error("Unsupported Moniker "+n)}}function Od(e){var t=e.read_shift(4),n=t>0?e.read_shift(t,"utf16le").replace(_r,""):"";return n}function mE(e,t){t||(t=me(6+e.length*2)),t.write_shift(4,1+e.length);for(var n=0;n<e.length;++n)t.write_shift(2,e.charCodeAt(n));return t.write_shift(2,0),t}function HV(e,t){var n=e.l+t,r=e.read_shift(4);if(r!==2)throw new Error("Unrecognized streamVersion: "+r);var i=e.read_shift(2);e.l+=2;var s,a,o,l,u="",c,h;i&16&&(s=Od(e,n-e.l)),i&128&&(a=Od(e,n-e.l)),(i&257)===257&&(o=Od(e,n-e.l)),(i&257)===1&&(l=VV(e,n-e.l)),i&8&&(u=Od(e,n-e.l)),i&32&&(c=e.read_shift(16)),i&64&&(h=$1(e)),e.l=n;var p=a||o||l||"";p&&u&&(p+="#"+u),p||(p="#"+u),i&2&&p.charAt(0)=="/"&&p.charAt(1)!="/"&&(p="file://"+p);var m={Target:p};return c&&(m.guid=c),h&&(m.time=h),s&&(m.Tooltip=s),m}function $V(e){var t=me(512),n=0,r=e.Target;r.slice(0,7)=="file://"&&(r=r.slice(7));var i=r.indexOf("#"),s=i>-1?31:23;switch(r.charAt(0)){case"#":s=28;break;case".":s&=-3;break}t.write_shift(4,2),t.write_shift(4,s);var a=[8,6815827,6619237,4849780,83];for(n=0;n<a.length;++n)t.write_shift(4,a[n]);if(s==28)r=r.slice(1),mE(r,t);else if(s&2){for(a="e0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));var o=i>-1?r.slice(0,i):r;for(t.write_shift(4,2*(o.length+1)),n=0;n<o.length;++n)t.write_shift(2,o.charCodeAt(n));t.write_shift(2,0),s&8&&mE(i>-1?r.slice(i+1):"",t)}else{for(a="03 03 00 00 00 00 00 00 c0 00 00 00 00 00 00 46".split(" "),n=0;n<a.length;++n)t.write_shift(1,parseInt(a[n],16));for(var l=0;r.slice(l*3,l*3+3)=="../"||r.slice(l*3,l*3+3)=="..\\";)++l;for(t.write_shift(2,l),t.write_shift(4,r.length-3*l+1),n=0;n<r.length-3*l;++n)t.write_shift(1,r.charCodeAt(n+3*l)&255);for(t.write_shift(1,0),t.write_shift(2,65535),t.write_shift(2,57005),n=0;n<6;++n)t.write_shift(4,0)}return t.slice(0,t.l)}function WF(e){var t=e.read_shift(1),n=e.read_shift(1),r=e.read_shift(1),i=e.read_shift(1);return[t,n,r,i]}function GF(e,t){var n=WF(e);return n[3]=0,n}function ps(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return{r:t,c:n,ixfe:r}}function bo(e,t,n,r){return r||(r=me(6)),r.write_shift(2,e),r.write_shift(2,t),r.write_shift(2,n||0),r}function zV(e){var t=e.read_shift(2),n=e.read_shift(2);return e.l+=8,{type:t,flags:n}}function WV(e,t,n){return t===0?"":Zo(e,t,n)}function GV(e,t,n){var r=n.biff>8?4:2,i=e.read_shift(r),s=e.read_shift(r,"i"),a=e.read_shift(r,"i");return[i,s,a]}function qF(e){var t=e.read_shift(2),n=U1(e);return[t,n]}function qV(e,t,n){e.l+=4,t-=4;var r=e.l+t,i=Kf(e,t,n),s=e.read_shift(2);if(r-=e.l,s!==r)throw new Error("Malformed AddinUdf: padding = "+r+" != "+s);return e.l+=s,i}function tp(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2);return{s:{c:r,r:t},e:{c:i,r:n}}}function KF(e,t){return t||(t=me(8)),t.write_shift(2,e.s.r),t.write_shift(2,e.e.r),t.write_shift(2,e.s.c),t.write_shift(2,e.e.c),t}function YF(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(1),i=e.read_shift(1);return{s:{c:r,r:t},e:{c:i,r:n}}}var KV=YF;function XF(e){e.l+=4;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2);return e.l+=12,[n,t,r]}function YV(e){var t={};return e.l+=4,e.l+=16,t.fSharedNote=e.read_shift(2),e.l+=4,t}function XV(e){var t={};return e.l+=4,e.cf=e.read_shift(2),t}function rr(e){e.l+=2,e.l+=e.read_shift(2)}var JV={0:rr,4:rr,5:rr,6:rr,7:XV,8:rr,9:rr,10:rr,11:rr,12:rr,13:YV,14:rr,15:rr,16:rr,17:rr,18:rr,19:rr,20:rr,21:XF};function QV(e,t){for(var n=e.l+t,r=[];e.l<n;){var i=e.read_shift(2);e.l-=2;try{r.push(JV[i](e,n-e.l))}catch{return e.l=n,r}}return e.l!=n&&(e.l=n),r}function Bd(e,t){var n={BIFFVer:0,dt:0};switch(n.BIFFVer=e.read_shift(2),t-=2,t>=2&&(n.dt=e.read_shift(2),e.l-=2),n.BIFFVer){case 1536:case 1280:case 1024:case 768:case 512:case 2:case 7:break;default:if(t>6)throw new Error("Unexpected BIFF Ver "+n.BIFFVer)}return e.read_shift(t),n}function z1(e,t,n){var r=1536,i=16;switch(n.bookType){case"biff8":break;case"biff5":r=1280,i=8;break;case"biff4":r=4,i=6;break;case"biff3":r=3,i=6;break;case"biff2":r=2,i=4;break;case"xla":break;default:throw new Error("unsupported BIFF version")}var s=me(i);return s.write_shift(2,r),s.write_shift(2,t),i>4&&s.write_shift(2,29282),i>6&&s.write_shift(2,1997),i>8&&(s.write_shift(2,49161),s.write_shift(2,1),s.write_shift(2,1798),s.write_shift(2,0)),s}function jV(e,t){return t===0||e.read_shift(2),1200}function ZV(e,t,n){if(n.enc)return e.l+=t,"";var r=e.l,i=Zo(e,0,n);return e.read_shift(t+r-e.l),i}function e9(e,t){var n=!t||t.biff==8,r=me(n?112:54);for(r.write_shift(t.biff==8?2:1,7),n&&r.write_shift(1,0),r.write_shift(4,859007059),r.write_shift(4,5458548|(n?0:536870912));r.l<r.length;)r.write_shift(1,n?0:32);return r}function t9(e,t,n){var r=n&&n.biff==8||t==2?e.read_shift(2):(e.l+=t,0);return{fDialog:r&16,fBelow:r&64,fRight:r&128}}function n9(e,t,n){var r=e.read_shift(4),i=e.read_shift(1)&3,s=e.read_shift(1);switch(s){case 0:s="Worksheet";break;case 1:s="Macrosheet";break;case 2:s="Chartsheet";break;case 6:s="VBAModule";break}var a=Kf(e,0,n);return a.length===0&&(a="Sheet1"),{pos:r,hs:i,dt:s,name:a}}function r9(e,t){var n=!t||t.biff>=8?2:1,r=me(8+n*e.name.length);r.write_shift(4,e.pos),r.write_shift(1,e.hs||0),r.write_shift(1,e.dt),r.write_shift(1,e.name.length),t.biff>=8&&r.write_shift(1,1),r.write_shift(n*e.name.length,e.name,t.biff<8?"sbcs":"utf16le");var i=r.slice(0,r.l);return i.l=r.l,i}function i9(e,t){for(var n=e.l+t,r=e.read_shift(4),i=e.read_shift(4),s=[],a=0;a!=i&&e.l<n;++a)s.push(bV(e));return s.Count=r,s.Unique=i,s}function s9(e,t){var n=me(8);n.write_shift(4,e.Count),n.write_shift(4,e.Unique);for(var r=[],i=0;i<e.length;++i)r[i]=LV(e[i]);var s=Hn([n].concat(r));return s.parts=[n.length].concat(r.map(function(a){return a.length})),s}function a9(e,t){var n={};return n.dsst=e.read_shift(2),e.l+=t-2,n}function o9(e){var t={};t.r=e.read_shift(2),t.c=e.read_shift(2),t.cnt=e.read_shift(2)-t.c;var n=e.read_shift(2);e.l+=4;var r=e.read_shift(1);return e.l+=3,r&7&&(t.level=r&7),r&32&&(t.hidden=!0),r&64&&(t.hpt=n/20),t}function l9(e){var t=zV(e);if(t.type!=2211)throw new Error("Invalid Future Record "+t.type);var n=e.read_shift(4);return n!==0}function u9(e){return e.read_shift(2),e.read_shift(4)}function gE(e,t,n){var r=0;n&&n.biff==2||(r=e.read_shift(2));var i=e.read_shift(2);n&&n.biff==2&&(r=1-(i>>15),i&=32767);var s={Unsynced:r&1,DyZero:(r&2)>>1,ExAsc:(r&4)>>2,ExDsc:(r&8)>>3};return[s,i]}function c9(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=e.read_shift(2),l=e.read_shift(2),u=e.read_shift(2);return{Pos:[t,n],Dim:[r,i],Flags:s,CurTab:a,FirstTab:o,Selected:l,TabRatio:u}}function f9(){var e=me(18);return e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,29280),e.write_shift(2,17600),e.write_shift(2,56),e.write_shift(2,0),e.write_shift(2,0),e.write_shift(2,1),e.write_shift(2,500),e}function d9(e,t,n){if(n&&n.biff>=2&&n.biff<5)return{};var r=e.read_shift(2);return{RTL:r&64}}function h9(e){var t=me(18),n=1718;return e&&e.RTL&&(n|=64),t.write_shift(2,n),t.write_shift(4,0),t.write_shift(4,64),t.write_shift(4,0),t.write_shift(4,0),t}function p9(){}function m9(e,t,n){var r={dyHeight:e.read_shift(2),fl:e.read_shift(2)};switch(n&&n.biff||8){case 2:break;case 3:case 4:e.l+=2;break;default:e.l+=10;break}return r.name=Kf(e,0,n),r}function g9(e,t){var n=e.name||"Arial",r=t&&t.biff==5,i=r?15+n.length:16+2*n.length,s=me(i);return s.write_shift(2,e.sz*20),s.write_shift(4,0),s.write_shift(2,400),s.write_shift(4,0),s.write_shift(2,0),s.write_shift(1,n.length),r||s.write_shift(1,1),s.write_shift((r?1:2)*n.length,n,r?"sbcs":"utf16le"),s}function v9(e){var t=ps(e);return t.isst=e.read_shift(4),t}function x9(e,t,n,r){var i=me(10);return bo(e,t,r,i),i.write_shift(4,n),i}function y9(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=e.l+t,i=ps(e);n.biff==2&&e.l++;var s=Yf(e,r-e.l,n);return i.val=s,i}function w9(e,t,n,r,i){var s=!i||i.biff==8,a=me(8+ +s+(1+s)*n.length);return bo(e,t,r,a),a.write_shift(2,n.length),s&&a.write_shift(1,1),a.write_shift((1+s)*n.length,n,s?"utf16le":"sbcs"),a}function T9(e,t,n){var r=e.read_shift(2),i=Zo(e,0,n);return[r,i]}function S9(e,t,n,r){var i=n&&n.biff==5;r||(r=me(i?3+t.length:5+2*t.length)),r.write_shift(2,e),r.write_shift(i?1:2,t.length),i||r.write_shift(1,1),r.write_shift((i?1:2)*t.length,t,i?"sbcs":"utf16le");var s=r.length>r.l?r.slice(0,r.l):r;return s.l==null&&(s.l=s.length),s}var E9=Zo;function vE(e,t,n){var r=e.l+t,i=n.biff==8||!n.biff?4:2,s=e.read_shift(i),a=e.read_shift(i),o=e.read_shift(2),l=e.read_shift(2);return e.l=r,{s:{r:s,c:o},e:{r:a,c:l}}}function _9(e,t){var n=t.biff==8||!t.biff?4:2,r=me(2*n+6);return r.write_shift(n,e.s.r),r.write_shift(n,e.e.r+1),r.write_shift(2,e.s.c),r.write_shift(2,e.e.c+1),r.write_shift(2,0),r}function C9(e){var t=e.read_shift(2),n=e.read_shift(2),r=qF(e);return{r:t,c:n,ixfe:r[0],rknum:r[1]}}function k9(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(qF(e));if(e.l!==n)throw new Error("MulRK read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulRK length mismatch");return{r,c:i,C:a,rkrec:s}}function A9(e,t){for(var n=e.l+t-2,r=e.read_shift(2),i=e.read_shift(2),s=[];e.l<n;)s.push(e.read_shift(2));if(e.l!==n)throw new Error("MulBlank read error");var a=e.read_shift(2);if(s.length!=a-i+1)throw new Error("MulBlank length mismatch");return{r,c:i,C:a,ixfe:s}}function R9(e,t,n,r){var i={},s=e.read_shift(4),a=e.read_shift(4),o=e.read_shift(4),l=e.read_shift(2);return i.patternType=lV[o>>26],r.cellStyles&&(i.alc=s&7,i.fWrap=s>>3&1,i.alcV=s>>4&7,i.fJustLast=s>>7&1,i.trot=s>>8&255,i.cIndent=s>>16&15,i.fShrinkToFit=s>>20&1,i.iReadOrder=s>>22&2,i.fAtrNum=s>>26&1,i.fAtrFnt=s>>27&1,i.fAtrAlc=s>>28&1,i.fAtrBdr=s>>29&1,i.fAtrPat=s>>30&1,i.fAtrProt=s>>31&1,i.dgLeft=a&15,i.dgRight=a>>4&15,i.dgTop=a>>8&15,i.dgBottom=a>>12&15,i.icvLeft=a>>16&127,i.icvRight=a>>23&127,i.grbitDiag=a>>30&3,i.icvTop=o&127,i.icvBottom=o>>7&127,i.icvDiag=o>>14&127,i.dgDiag=o>>21&15,i.icvFore=l&127,i.icvBack=l>>7&127,i.fsxButton=l>>14&1),i}function M9(e,t,n){var r={};return r.ifnt=e.read_shift(2),r.numFmtId=e.read_shift(2),r.flags=e.read_shift(2),r.fStyle=r.flags>>2&1,t-=6,r.data=R9(e,t,r.fStyle,n),r}function xE(e,t,n,r){var i=n&&n.biff==5;r||(r=me(i?16:20)),r.write_shift(2,0),e.style?(r.write_shift(2,e.numFmtId||0),r.write_shift(2,65524)):(r.write_shift(2,e.numFmtId||0),r.write_shift(2,t<<4));var s=0;return e.numFmtId>0&&i&&(s|=1024),r.write_shift(4,s),r.write_shift(4,0),i||r.write_shift(4,0),r.write_shift(2,0),r}function F9(e){e.l+=4;var t=[e.read_shift(2),e.read_shift(2)];if(t[0]!==0&&t[0]--,t[1]!==0&&t[1]--,t[0]>7||t[1]>7)throw new Error("Bad Gutters: "+t.join("|"));return t}function D9(e){var t=me(8);return t.write_shift(4,0),t.write_shift(2,0),t.write_shift(2,0),t}function yE(e,t,n){var r=ps(e);(n.biff==2||t==9)&&++e.l;var i=NV(e);return r.val=i,r.t=i===!0||i===!1?"b":"e",r}function P9(e,t,n,r,i,s){var a=me(8);return bo(e,t,r,a),$F(n,s,a),a}function I9(e,t,n){n.biffguess&&n.biff==2&&(n.biff=5);var r=ps(e),i=ur(e);return r.val=i,r}function N9(e,t,n,r){var i=me(14);return bo(e,t,r,i),Io(n,i),i}var wE=WV;function b9(e,t,n){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(2);if(n.sbcch=s,s==1025||s==14849)return[s,i];if(s<1||s>255)throw new Error("Unexpected SupBook type: "+s);for(var a=No(e,s),o=[];r>e.l;)o.push(Yf(e));return[s,i,a,o]}function TE(e,t,n){var r=e.read_shift(2),i,s={fBuiltIn:r&1,fWantAdvise:r>>>1&1,fWantPict:r>>>2&1,fOle:r>>>3&1,fOleLink:r>>>4&1,cf:r>>>5&1023,fIcon:r>>>15&1};return n.sbcch===14849&&(i=qV(e,t-2,n)),s.body=i||e.read_shift(t-2),typeof i=="string"&&(s.Name=i),s}var L9=["_xlnm.Consolidate_Area","_xlnm.Auto_Open","_xlnm.Auto_Close","_xlnm.Extract","_xlnm.Database","_xlnm.Criteria","_xlnm.Print_Area","_xlnm.Print_Titles","_xlnm.Recorder","_xlnm.Data_Form","_xlnm.Auto_Activate","_xlnm.Auto_Deactivate","_xlnm.Sheet_Title","_xlnm._FilterDatabase"];function SE(e,t,n){var r=e.l+t,i=e.read_shift(2),s=e.read_shift(1),a=e.read_shift(1),o=e.read_shift(n&&n.biff==2?1:2),l=0;(!n||n.biff>=5)&&(n.biff!=5&&(e.l+=2),l=e.read_shift(2),n.biff==5&&(e.l+=2),e.l+=4);var u=No(e,a,n);i&32&&(u=L9[u.charCodeAt(0)]);var c=r-e.l;n&&n.biff==2&&--c;var h=r==e.l||o===0||!(c>0)?[]:Qz(e,c,n,o);return{chKey:s,Name:u,itab:l,rgce:h}}function JF(e,t,n){if(n.biff<8)return O9(e,t,n);for(var r=[],i=e.l+t,s=e.read_shift(n.biff>8?4:2);s--!==0;)r.push(GV(e,n.biff>8?12:6,n));if(e.l!=i)throw new Error("Bad ExternSheet: "+e.l+" != "+i);return r}function O9(e,t,n){e[e.l+1]==3&&e[e.l]++;var r=Kf(e,t,n);return r.charCodeAt(0)==3?r.slice(1):r}function B9(e,t,n){if(n.biff<8){e.l+=t;return}var r=e.read_shift(2),i=e.read_shift(2),s=No(e,r,n),a=No(e,i,n);return[s,a]}function U9(e,t,n){var r=YF(e);e.l++;var i=e.read_shift(1);return t-=8,[jz(e,t,n),i,r]}function EE(e,t,n){var r=KV(e);switch(n.biff){case 2:e.l++,t-=7;break;case 3:case 4:e.l+=2,t-=8;break;default:e.l+=6,t-=12}return[r,Xz(e,t,n)]}function V9(e){var t=e.read_shift(4)!==0,n=e.read_shift(4)!==0,r=e.read_shift(4);return[t,n,r]}function H9(e,t,n){if(!(n.biff<8)){var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2),a=e.read_shift(2),o=Zo(e,0,n);return n.biff<8&&e.read_shift(1),[{r,c:i},o,a,s]}}function $9(e,t,n){return H9(e,t,n)}function z9(e,t){for(var n=[],r=e.read_shift(2);r--;)n.push(tp(e));return n}function W9(e){var t=me(2+e.length*8);t.write_shift(2,e.length);for(var n=0;n<e.length;++n)KF(e[n],t);return t}function G9(e,t,n){if(n&&n.biff<8)return K9(e,t,n);var r=XF(e),i=QV(e,t-22,r[1]);return{cmo:r,ft:i}}var q9={8:function(e,t){var n=e.l+t;e.l+=10;var r=e.read_shift(2);e.l+=4,e.l+=2,e.l+=2,e.l+=2,e.l+=4;var i=e.read_shift(1);return e.l+=i,e.l=n,{fmt:r}}};function K9(e,t,n){e.l+=4;var r=e.read_shift(2),i=e.read_shift(2),s=e.read_shift(2);e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=2,e.l+=6,t-=36;var a=[];return a.push((q9[r]||mr)(e,t,n)),{cmo:[i,r,s],ft:a}}function Y9(e,t,n){var r=e.l,i="";try{e.l+=4;var s=(n.lastobj||{cmo:[0,0]}).cmo[1],a;[0,5,7,11,12,14].indexOf(s)==-1?e.l+=6:a=OV(e,6,n);var o=e.read_shift(2);e.read_shift(2),kn(e,2);var l=e.read_shift(2);e.l+=l;for(var u=1;u<e.lens.length-1;++u){if(e.l-r!=e.lens[u])throw new Error("TxO: bad continue record");var c=e[e.l],h=No(e,e.lens[u+1]-e.lens[u]-1);if(i+=h,i.length>=(c?o:2*o))break}if(i.length!==o&&i.length!==o*2)throw new Error("cchText: "+o+" != "+i.length);return e.l=r+t,{t:i}}catch{return e.l=r+t,{t:i}}}function X9(e,t){var n=tp(e);e.l+=16;var r=HV(e,t-24);return[n,r]}function J9(e){var t=me(24),n=ln(e[0]);t.write_shift(2,n.r),t.write_shift(2,n.r),t.write_shift(2,n.c),t.write_shift(2,n.c);for(var r="d0 c9 ea 79 f9 ba ce 11 8c 82 00 aa 00 4b a9 0b".split(" "),i=0;i<16;++i)t.write_shift(1,parseInt(r[i],16));return Hn([t,$V(e[1])])}function Q9(e,t){e.read_shift(2);var n=tp(e),r=e.read_shift((t-10)/2,"dbcs-cont");return r=r.replace(_r,""),[n,r]}function j9(e){var t=e[1].Tooltip,n=me(10+2*(t.length+1));n.write_shift(2,2048);var r=ln(e[0]);n.write_shift(2,r.r),n.write_shift(2,r.r),n.write_shift(2,r.c),n.write_shift(2,r.c);for(var i=0;i<t.length;++i)n.write_shift(2,t.charCodeAt(i));return n.write_shift(2,0),n}function Z9(e){var t=[0,0],n;return n=e.read_shift(2),t[0]=oE[n]||n,n=e.read_shift(2),t[1]=oE[n]||n,t}function e7(e){return e||(e=me(4)),e.write_shift(2,1),e.write_shift(2,1),e}function t7(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(GF(e));return n}function n7(e){for(var t=e.read_shift(2),n=[];t-- >0;)n.push(GF(e));return n}function r7(e){e.l+=2;var t={cxfs:0,crc:0};return t.cxfs=e.read_shift(2),t.crc=e.read_shift(4),t}function QF(e,t,n){if(!n.cellStyles)return mr(e,t);var r=n&&n.biff>=12?4:2,i=e.read_shift(r),s=e.read_shift(r),a=e.read_shift(r),o=e.read_shift(r),l=e.read_shift(2);r==2&&(e.l+=2);var u={s:i,e:s,w:a,ixfe:o,flags:l};return(n.biff>=5||!n.biff)&&(u.level=l>>8&7),u}function i7(e,t){var n=me(12);n.write_shift(2,t),n.write_shift(2,t),n.write_shift(2,e.width*256),n.write_shift(2,0);var r=0;return e.hidden&&(r|=1),n.write_shift(1,r),r=e.level||0,n.write_shift(1,r),n.write_shift(2,0),n}function s7(e,t){var n={};return t<32||(e.l+=16,n.header=ur(e),n.footer=ur(e),e.l+=2),n}function a7(e,t,n){var r={area:!1};if(n.biff!=5)return e.l+=t,r;var i=e.read_shift(1);return e.l+=3,i&16&&(r.area=!0),r}function o7(e){for(var t=me(2*e),n=0;n<e;++n)t.write_shift(2,n+1);return t}var l7=ps,u7=HF,c7=Yf;function f7(e){var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i={fmt:t,env:n,len:r,data:e.slice(e.l,e.l+r)};return e.l+=r,i}function d7(e,t,n){n.biffguess&&n.biff==5&&(n.biff=2);var r=ps(e);++e.l;var i=Zo(e,t-7,n);return r.t="str",r.val=i,r}function h7(e){var t=ps(e);++e.l;var n=ur(e);return t.t="n",t.val=n,t}function p7(e,t,n){var r=me(15);return jf(r,e,t),r.write_shift(8,n,"f"),r}function m7(e){var t=ps(e);++e.l;var n=e.read_shift(2);return t.t="n",t.val=n,t}function g7(e,t,n){var r=me(9);return jf(r,e,t),r.write_shift(2,n),r}function v7(e){var t=e.read_shift(1);return t===0?(e.l++,""):e.read_shift(t,"sbcs-cont")}function x7(e,t){e.l+=6,e.l+=2,e.l+=1,e.l+=3,e.l+=1,e.l+=t-13}function y7(e,t,n){var r=e.l+t,i=ps(e),s=e.read_shift(2),a=No(e,s,n);return e.l=r,i.t="str",i.val=a,i}var w7=[2,3,48,49,131,139,140,245],qg=function(){var e={1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127,8:865,9:437,10:850,11:437,13:437,14:850,15:437,16:850,17:437,18:850,19:932,20:850,21:437,22:850,23:865,24:437,25:437,26:850,27:437,28:863,29:850,31:852,34:852,35:852,36:860,37:850,38:866,55:850,64:852,77:936,78:949,79:950,80:874,87:1252,88:1252,89:1252,108:863,134:737,135:852,136:857,204:1257,255:16969},t=jh({1:437,2:850,3:1252,4:1e4,100:852,101:866,102:865,103:861,104:895,105:620,106:737,107:857,120:950,121:949,122:936,123:932,124:874,125:1255,126:1256,150:10007,151:10029,152:10006,200:1250,201:1251,202:1254,203:1253,0:20127});function n(o,l){var u=[],c=Na(1);switch(l.type){case"base64":c=Gr(Zr(o));break;case"binary":c=Gr(o);break;case"buffer":case"array":c=o;break}Jn(c,0);var h=c.read_shift(1),p=!!(h&136),m=!1,v=!1;switch(h){case 2:break;case 3:break;case 48:m=!0,p=!0;break;case 49:m=!0,p=!0;break;case 131:break;case 139:break;case 140:v=!0;break;case 245:break;default:throw new Error("DBF Unsupported Version: "+h.toString(16))}var g=0,w=521;h==2&&(g=c.read_shift(2)),c.l+=3,h!=2&&(g=c.read_shift(4)),g>1048576&&(g=1e6),h!=2&&(w=c.read_shift(2));var x=c.read_shift(2),T=l.codepage||1252;h!=2&&(c.l+=16,c.read_shift(1),c[c.l]!==0&&(T=e[c[c.l]]),c.l+=1,c.l+=2),v&&(c.l+=36);for(var y=[],_={},k=Math.min(c.length,h==2?521:w-10-(m?264:0)),S=v?32:11;c.l<k&&c[c.l]!=13;)switch(_={},_.name=cf.utils.decode(T,c.slice(c.l,c.l+S)).replace(/[\u0000\r\n].*$/g,""),c.l+=S,_.type=String.fromCharCode(c.read_shift(1)),h!=2&&!v&&(_.offset=c.read_shift(4)),_.len=c.read_shift(1),h==2&&(_.offset=c.read_shift(2)),_.dec=c.read_shift(1),_.name.length&&y.push(_),h!=2&&(c.l+=v?13:14),_.type){case"B":(!m||_.len!=8)&&l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"G":case"P":l.WTF&&console.log("Skipping "+_.name+":"+_.type);break;case"+":case"0":case"@":case"C":case"D":case"F":case"I":case"L":case"M":case"N":case"O":case"T":case"Y":break;default:throw new Error("Unknown Field Type: "+_.type)}if(c[c.l]!==13&&(c.l=w-1),c.read_shift(1)!==13)throw new Error("DBF Terminator not found "+c.l+" "+c[c.l]);c.l=w;var C=0,M=0;for(u[0]=[],M=0;M!=y.length;++M)u[0][M]=y[M].name;for(;g-- >0;){if(c[c.l]===42){c.l+=x;continue}for(++c.l,u[++C]=[],M=0,M=0;M!=y.length;++M){var F=c.slice(c.l,c.l+y[M].len);c.l+=y[M].len,Jn(F,0);var b=cf.utils.decode(T,F);switch(y[M].type){case"C":b.trim().length&&(u[C][M]=b.replace(/\s+$/,""));break;case"D":b.length===8?u[C][M]=new Date(+b.slice(0,4),+b.slice(4,6)-1,+b.slice(6,8)):u[C][M]=b;break;case"F":u[C][M]=parseFloat(b.trim());break;case"+":case"I":u[C][M]=v?F.read_shift(-4,"i")^2147483648:F.read_shift(4,"i");break;case"L":switch(b.trim().toUpperCase()){case"Y":case"T":u[C][M]=!0;break;case"N":case"F":u[C][M]=!1;break;case"":case"?":break;default:throw new Error("DBF Unrecognized L:|"+b+"|")}break;case"M":if(!p)throw new Error("DBF Unexpected MEMO for type "+h.toString(16));u[C][M]="##MEMO##"+(v?parseInt(b.trim(),10):F.read_shift(4));break;case"N":b=b.replace(/\u0000/g,"").trim(),b&&b!="."&&(u[C][M]=+b||0);break;case"@":u[C][M]=new Date(F.read_shift(-8,"f")-621356832e5);break;case"T":u[C][M]=new Date((F.read_shift(4)-2440588)*864e5+F.read_shift(4));break;case"Y":u[C][M]=F.read_shift(4,"i")/1e4+F.read_shift(4,"i")/1e4*Math.pow(2,32);break;case"O":u[C][M]=-F.read_shift(-8,"f");break;case"B":if(m&&y[M].len==8){u[C][M]=F.read_shift(8,"f");break}case"G":case"P":F.l+=y[M].len;break;case"0":if(y[M].name==="_NullFlags")break;default:throw new Error("DBF Unsupported data type "+y[M].type)}}}if(h!=2&&c.l<c.length&&c[c.l++]!=26)throw new Error("DBF EOF Marker missing "+(c.l-1)+" of "+c.length+" "+c[c.l-1].toString(16));return l&&l.sheetRows&&(u=u.slice(0,l.sheetRows)),l.DBF=y,u}function r(o,l){var u=l||{};u.dateNF||(u.dateNF="yyyymmdd");var c=Ru(n(o,u),u);return c["!cols"]=u.DBF.map(function(h){return{wch:h.len,DBF:h}}),delete u.DBF,c}function i(o,l){try{return Ga(r(o,l),l)}catch(u){if(l&&l.WTF)throw u}return{SheetNames:[],Sheets:{}}}var s={B:8,C:250,L:1,D:8,"?":0,"":0};function a(o,l){var u=l||{};if(+u.codepage>=0&&Li(+u.codepage),u.type=="string")throw new Error("Cannot write DBF to JS string");var c=Or(),h=fh(o,{header:1,raw:!0,cellDates:!0}),p=h[0],m=h.slice(1),v=o["!cols"]||[],g=0,w=0,x=0,T=1;for(g=0;g<p.length;++g){if(((v[g]||{}).DBF||{}).name){p[g]=v[g].DBF.name,++x;continue}if(p[g]!=null){if(++x,typeof p[g]=="number"&&(p[g]=p[g].toString(10)),typeof p[g]!="string")throw new Error("DBF Invalid column name "+p[g]+" |"+typeof p[g]+"|");if(p.indexOf(p[g])!==g){for(w=0;w<1024;++w)if(p.indexOf(p[g]+"_"+w)==-1){p[g]+="_"+w;break}}}}var y=At(o["!ref"]),_=[],k=[],S=[];for(g=0;g<=y.e.c-y.s.c;++g){var C="",M="",F=0,b=[];for(w=0;w<m.length;++w)m[w][g]!=null&&b.push(m[w][g]);if(b.length==0||p[g]==null){_[g]="?";continue}for(w=0;w<b.length;++w){switch(typeof b[w]){case"number":M="B";break;case"string":M="C";break;case"boolean":M="L";break;case"object":M=b[w]instanceof Date?"D":"C";break;default:M="C"}F=Math.max(F,String(b[w]).length),C=C&&C!=M?"C":M}F>250&&(F=250),M=((v[g]||{}).DBF||{}).type,M=="C"&&v[g].DBF.len>F&&(F=v[g].DBF.len),C=="B"&&M=="N"&&(C="N",S[g]=v[g].DBF.dec,F=v[g].DBF.len),k[g]=C=="C"||M=="N"?F:s[C]||0,T+=k[g],_[g]=C}var V=c.next(32);for(V.write_shift(4,318902576),V.write_shift(4,m.length),V.write_shift(2,296+32*x),V.write_shift(2,T),g=0;g<4;++g)V.write_shift(4,0);for(V.write_shift(4,0|(+t[VM]||3)<<8),g=0,w=0;g<p.length;++g)if(p[g]!=null){var z=c.next(32),ie=(p[g].slice(-10)+"\0\0\0\0\0\0\0\0\0\0\0").slice(0,11);z.write_shift(1,ie,"sbcs"),z.write_shift(1,_[g]=="?"?"C":_[g],"sbcs"),z.write_shift(4,w),z.write_shift(1,k[g]||s[_[g]]||0),z.write_shift(1,S[g]||0),z.write_shift(1,2),z.write_shift(4,0),z.write_shift(1,0),z.write_shift(4,0),z.write_shift(4,0),w+=k[g]||s[_[g]]||0}var Q=c.next(264);for(Q.write_shift(4,13),g=0;g<65;++g)Q.write_shift(4,0);for(g=0;g<m.length;++g){var se=c.next(T);for(se.write_shift(1,0),w=0;w<p.length;++w)if(p[w]!=null)switch(_[w]){case"L":se.write_shift(1,m[g][w]==null?63:m[g][w]?84:70);break;case"B":se.write_shift(8,m[g][w]||0,"f");break;case"N":var de="0";for(typeof m[g][w]=="number"&&(de=m[g][w].toFixed(S[w]||0)),x=0;x<k[w]-de.length;++x)se.write_shift(1,32);se.write_shift(1,de,"sbcs");break;case"D":m[g][w]?(se.write_shift(4,("0000"+m[g][w].getFullYear()).slice(-4),"sbcs"),se.write_shift(2,("00"+(m[g][w].getMonth()+1)).slice(-2),"sbcs"),se.write_shift(2,("00"+m[g][w].getDate()).slice(-2),"sbcs")):se.write_shift(8,"00000000","sbcs");break;case"C":var ae=String(m[g][w]!=null?m[g][w]:"").slice(0,k[w]);for(se.write_shift(1,ae,"sbcs"),x=0;x<k[w]-ae.length;++x)se.write_shift(1,32);break}}return c.next(1).write_shift(1,26),c.end()}return{to_workbook:i,to_sheet:r,from_sheet:a}}(),jF=function(){var e={AA:"",BA:"",CA:"",DA:195,HA:"",JA:197,AE:"",BE:"",CE:"",HE:"",AI:"",BI:"",CI:"",HI:"",AO:"",BO:"",CO:"",DO:213,HO:"",AU:"",BU:"",CU:"",HU:"",Aa:"",Ba:"",Ca:"",Da:227,Ha:"",Ja:229,Ae:"",Be:"",Ce:"",He:"",Ai:"",Bi:"",Ci:"",Hi:"",Ao:"",Bo:"",Co:"",Do:245,Ho:"",Au:"",Bu:"",Cu:"",Hu:"",KC:"",Kc:"",q:"",z:"",a:"",j:"",DN:209,Dn:241,Hy:255,S:169,c:170,R:174,"B ":180,0:176,1:177,2:178,3:179,5:181,6:182,7:183,Q:185,k:186,b:208,i:216,l:222,s:240,y:248,"!":161,'"':162,"#":163,"(":164,"%":165,"'":167,"H ":168,"+":171,";":187,"<":188,"=":189,">":190,"?":191,"{":223},t=new RegExp("\x1BN("+vn(e).join("|").replace(/\|\|\|/,"|\\||").replace(/([?()+])/g,"\\$1")+"|\\|)","gm"),n=function(p,m){var v=e[m];return typeof v=="number"?NS(v):v},r=function(p,m,v){var g=m.charCodeAt(0)-32<<4|v.charCodeAt(0)-48;return g==59?p:NS(g)};e["|"]=254;function i(p,m){switch(m.type){case"base64":return s(Zr(p),m);case"binary":return s(p,m);case"buffer":return s(dt&&Buffer.isBuffer(p)?p.toString("binary"):Wa(p),m);case"array":return s(Po(p),m)}throw new Error("Unrecognized type "+m.type)}function s(p,m){var v=p.split(/[\n\r]+/),g=-1,w=-1,x=0,T=0,y=[],_=[],k=null,S={},C=[],M=[],F=[],b=0,V;for(+m.codepage>=0&&Li(+m.codepage);x!==v.length;++x){b=0;var z=v[x].trim().replace(/\x1B([\x20-\x2F])([\x30-\x3F])/g,r).replace(t,n),ie=z.replace(/;;/g,"\0").split(";").map(function(G){return G.replace(/\u0000/g,";")}),Q=ie[0],se;if(z.length>0)switch(Q){case"ID":break;case"E":break;case"B":break;case"O":break;case"W":break;case"P":ie[1].charAt(0)=="P"&&_.push(z.slice(3).replace(/;;/g,";"));break;case"C":var de=!1,ae=!1,ne=!1,H=!1,fe=-1,xe=-1;for(T=1;T<ie.length;++T)switch(ie[T].charAt(0)){case"A":break;case"X":w=parseInt(ie[T].slice(1))-1,ae=!0;break;case"Y":for(g=parseInt(ie[T].slice(1))-1,ae||(w=0),V=y.length;V<=g;++V)y[V]=[];break;case"K":se=ie[T].slice(1),se.charAt(0)==='"'?se=se.slice(1,se.length-1):se==="TRUE"?se=!0:se==="FALSE"?se=!1:isNaN(Vi(se))?isNaN(gu(se).getDate())||(se=tn(se)):(se=Vi(se),k!==null&&ku(k)&&(se=ep(se))),de=!0;break;case"E":H=!0;var L=Vl(ie[T].slice(1),{r:g,c:w});y[g][w]=[y[g][w],L];break;case"S":ne=!0,y[g][w]=[y[g][w],"S5S"];break;case"G":break;case"R":fe=parseInt(ie[T].slice(1))-1;break;case"C":xe=parseInt(ie[T].slice(1))-1;break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}if(de&&(y[g][w]&&y[g][w].length==2?y[g][w][0]=se:y[g][w]=se,k=null),ne){if(H)throw new Error("SYLK shared formula cannot have own formula");var q=fe>-1&&y[fe][xe];if(!q||!q[1])throw new Error("SYLK shared formula cannot find base");y[g][w][1]=gD(q[1],{r:g-fe,c:w-xe})}break;case"F":var W=0;for(T=1;T<ie.length;++T)switch(ie[T].charAt(0)){case"X":w=parseInt(ie[T].slice(1))-1,++W;break;case"Y":for(g=parseInt(ie[T].slice(1))-1,V=y.length;V<=g;++V)y[V]=[];break;case"M":b=parseInt(ie[T].slice(1))/20;break;case"F":break;case"G":break;case"P":k=_[parseInt(ie[T].slice(1))];break;case"S":break;case"D":break;case"N":break;case"W":for(F=ie[T].slice(1).split(" "),V=parseInt(F[0],10);V<=parseInt(F[1],10);++V)b=parseInt(F[2],10),M[V-1]=b===0?{hidden:!0}:{wch:b},ba(M[V-1]);break;case"C":w=parseInt(ie[T].slice(1))-1,M[w]||(M[w]={});break;case"R":g=parseInt(ie[T].slice(1))-1,C[g]||(C[g]={}),b>0?(C[g].hpt=b,C[g].hpx=xu(b)):b===0&&(C[g].hidden=!0);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}W<1&&(k=null);break;default:if(m&&m.WTF)throw new Error("SYLK bad record "+z)}}return C.length>0&&(S["!rows"]=C),M.length>0&&(S["!cols"]=M),m&&m.sheetRows&&(y=y.slice(0,m.sheetRows)),[y,S]}function a(p,m){var v=i(p,m),g=v[0],w=v[1],x=Ru(g,m);return vn(w).forEach(function(T){x[T]=w[T]}),x}function o(p,m){return Ga(a(p,m),m)}function l(p,m,v,g){var w="C;Y"+(v+1)+";X"+(g+1)+";K";switch(p.t){case"n":w+=p.v||0,p.f&&!p.F&&(w+=";E"+X1(p.f,{r:v,c:g}));break;case"b":w+=p.v?"TRUE":"FALSE";break;case"e":w+=p.w||p.v;break;case"d":w+='"'+(p.w||p.v)+'"';break;case"s":w+='"'+p.v.replace(/"/g,"").replace(/;/g,";;")+'"';break}return w}function u(p,m){m.forEach(function(v,g){var w="F;W"+(g+1)+" "+(g+1)+" ";v.hidden?w+="0":(typeof v.width=="number"&&!v.wpx&&(v.wpx=xf(v.width)),typeof v.wpx=="number"&&!v.wch&&(v.wch=yf(v.wpx)),typeof v.wch=="number"&&(w+=Math.round(v.wch))),w.charAt(w.length-1)!=" "&&p.push(w)})}function c(p,m){m.forEach(function(v,g){var w="F;";v.hidden?w+="M0;":v.hpt?w+="M"+20*v.hpt+";":v.hpx&&(w+="M"+20*wf(v.hpx)+";"),w.length>2&&p.push(w+"R"+(g+1))})}function h(p,m){var v=["ID;PWXL;N;E"],g=[],w=At(p["!ref"]),x,T=Array.isArray(p),y=`\r
`;v.push("P;PGeneral"),v.push("F;P0;DG0G8;M255"),p["!cols"]&&u(v,p["!cols"]),p["!rows"]&&c(v,p["!rows"]),v.push("B;Y"+(w.e.r-w.s.r+1)+";X"+(w.e.c-w.s.c+1)+";D"+[w.s.c,w.s.r,w.e.c,w.e.r].join(" "));for(var _=w.s.r;_<=w.e.r;++_)for(var k=w.s.c;k<=w.e.c;++k){var S=nt({r:_,c:k});x=T?(p[_]||[])[k]:p[S],!(!x||x.v==null&&(!x.f||x.F))&&g.push(l(x,p,_,k))}return v.join(y)+y+g.join(y)+y+"E"+y}return{to_workbook:o,to_sheet:a,from_sheet:h}}(),ZF=function(){function e(s,a){switch(a.type){case"base64":return t(Zr(s),a);case"binary":return t(s,a);case"buffer":return t(dt&&Buffer.isBuffer(s)?s.toString("binary"):Wa(s),a);case"array":return t(Po(s),a)}throw new Error("Unrecognized type "+a.type)}function t(s,a){for(var o=s.split(`
`),l=-1,u=-1,c=0,h=[];c!==o.length;++c){if(o[c].trim()==="BOT"){h[++l]=[],u=0;continue}if(!(l<0)){var p=o[c].trim().split(","),m=p[0],v=p[1];++c;for(var g=o[c]||"";(g.match(/["]/g)||[]).length&1&&c<o.length-1;)g+=`
`+o[++c];switch(g=g.trim(),+m){case-1:if(g==="BOT"){h[++l]=[],u=0;continue}else if(g!=="EOD")throw new Error("Unrecognized DIF special command "+g);break;case 0:g==="TRUE"?h[l][u]=!0:g==="FALSE"?h[l][u]=!1:isNaN(Vi(v))?isNaN(gu(v).getDate())?h[l][u]=v:h[l][u]=tn(v):h[l][u]=Vi(v),++u;break;case 1:g=g.slice(1,g.length-1),g=g.replace(/""/g,'"'),g&&g.match(/^=".*"$/)&&(g=g.slice(2,-1)),h[l][u++]=g!==""?g:null;break}if(g==="EOD")break}}return a&&a.sheetRows&&(h=h.slice(0,a.sheetRows)),h}function n(s,a){return Ru(e(s,a),a)}function r(s,a){return Ga(n(s,a),a)}var i=function(){var s=function(l,u,c,h,p){l.push(u),l.push(c+","+h),l.push('"'+p.replace(/"/g,'""')+'"')},a=function(l,u,c,h){l.push(u+","+c),l.push(u==1?'"'+h.replace(/"/g,'""')+'"':h)};return function(l){var u=[],c=At(l["!ref"]),h,p=Array.isArray(l);s(u,"TABLE",0,1,"sheetjs"),s(u,"VECTORS",0,c.e.r-c.s.r+1,""),s(u,"TUPLES",0,c.e.c-c.s.c+1,""),s(u,"DATA",0,0,"");for(var m=c.s.r;m<=c.e.r;++m){a(u,-1,0,"BOT");for(var v=c.s.c;v<=c.e.c;++v){var g=nt({r:m,c:v});if(h=p?(l[m]||[])[v]:l[g],!h){a(u,1,0,"");continue}switch(h.t){case"n":var w=h.w;!w&&h.v!=null&&(w=h.v),w==null?h.f&&!h.F?a(u,1,0,"="+h.f):a(u,1,0,""):a(u,0,w,"V");break;case"b":a(u,0,h.v?1:0,h.v?"TRUE":"FALSE");break;case"s":a(u,1,0,isNaN(h.v)?h.v:'="'+h.v+'"');break;case"d":h.w||(h.w=_i(h.z||et[14],Nn(tn(h.v)))),a(u,0,h.w,"V");break;default:a(u,1,0,"")}}}a(u,-1,0,"EOD");var x=`\r
`,T=u.join(x);return T}}();return{to_workbook:r,to_sheet:n,from_sheet:i}}(),eD=function(){function e(h){return h.replace(/\\b/g,"\\").replace(/\\c/g,":").replace(/\\n/g,`
`)}function t(h){return h.replace(/\\/g,"\\b").replace(/:/g,"\\c").replace(/\n/g,"\\n")}function n(h,p){for(var m=h.split(`
`),v=-1,g=-1,w=0,x=[];w!==m.length;++w){var T=m[w].trim().split(":");if(T[0]==="cell"){var y=ln(T[1]);if(x.length<=y.r)for(v=x.length;v<=y.r;++v)x[v]||(x[v]=[]);switch(v=y.r,g=y.c,T[2]){case"t":x[v][g]=e(T[3]);break;case"v":x[v][g]=+T[3];break;case"vtf":var _=T[T.length-1];case"vtc":switch(T[3]){case"nl":x[v][g]=!!+T[4];break;default:x[v][g]=+T[4];break}T[2]=="vtf"&&(x[v][g]=[x[v][g],_])}}}return p&&p.sheetRows&&(x=x.slice(0,p.sheetRows)),x}function r(h,p){return Ru(n(h,p),p)}function i(h,p){return Ga(r(h,p),p)}var s=["socialcalc:version:1.5","MIME-Version: 1.0","Content-Type: multipart/mixed; boundary=SocialCalcSpreadsheetControlSave"].join(`
`),a=["--SocialCalcSpreadsheetControlSave","Content-type: text/plain; charset=UTF-8"].join(`
`)+`
`,o=["# SocialCalc Spreadsheet Control Save","part:sheet"].join(`
`),l="--SocialCalcSpreadsheetControlSave--";function u(h){if(!h||!h["!ref"])return"";for(var p=[],m=[],v,g="",w=Br(h["!ref"]),x=Array.isArray(h),T=w.s.r;T<=w.e.r;++T)for(var y=w.s.c;y<=w.e.c;++y)if(g=nt({r:T,c:y}),v=x?(h[T]||[])[y]:h[g],!(!v||v.v==null||v.t==="z")){switch(m=["cell",g,"t"],v.t){case"s":case"str":m.push(t(v.v));break;case"n":v.f?(m[2]="vtf",m[3]="n",m[4]=v.v,m[5]=t(v.f)):(m[2]="v",m[3]=v.v);break;case"b":m[2]="vt"+(v.f?"f":"c"),m[3]="nl",m[4]=v.v?"1":"0",m[5]=t(v.f||(v.v?"TRUE":"FALSE"));break;case"d":var _=Nn(tn(v.v));m[2]="vtc",m[3]="nd",m[4]=""+_,m[5]=v.w||_i(v.z||et[14],_);break;case"e":continue}p.push(m.join(":"))}return p.push("sheet:c:"+(w.e.c-w.s.c+1)+":r:"+(w.e.r-w.s.r+1)+":tvf:1"),p.push("valueformat:1:text-wiki"),p.join(`
`)}function c(h){return[s,a,o,a,u(h),l].join(`
`)}return{to_workbook:i,to_sheet:r,from_sheet:c}}(),vu=function(){function e(c,h,p,m,v){v.raw?h[p][m]=c:c===""||(c==="TRUE"?h[p][m]=!0:c==="FALSE"?h[p][m]=!1:isNaN(Vi(c))?isNaN(gu(c).getDate())?h[p][m]=c:h[p][m]=tn(c):h[p][m]=Vi(c))}function t(c,h){var p=h||{},m=[];if(!c||c.length===0)return m;for(var v=c.split(/[\r\n]/),g=v.length-1;g>=0&&v[g].length===0;)--g;for(var w=10,x=0,T=0;T<=g;++T)x=v[T].indexOf(" "),x==-1?x=v[T].length:x++,w=Math.max(w,x);for(T=0;T<=g;++T){m[T]=[];var y=0;for(e(v[T].slice(0,w).trim(),m,T,y,p),y=1;y<=(v[T].length-w)/10+1;++y)e(v[T].slice(w+(y-1)*10,w+y*10).trim(),m,T,y,p)}return p.sheetRows&&(m=m.slice(0,p.sheetRows)),m}var n={44:",",9:"	",59:";",124:"|"},r={44:3,9:2,59:1,124:0};function i(c){for(var h={},p=!1,m=0,v=0;m<c.length;++m)(v=c.charCodeAt(m))==34?p=!p:!p&&v in n&&(h[v]=(h[v]||0)+1);v=[];for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m]);if(!v.length){h=r;for(m in h)Object.prototype.hasOwnProperty.call(h,m)&&v.push([h[m],m])}return v.sort(function(g,w){return g[0]-w[0]||r[g[1]]-r[w[1]]}),n[v.pop()[1]]||44}function s(c,h){var p=h||{},m="",v=p.dense?[]:{},g={s:{c:0,r:0},e:{c:0,r:0}};c.slice(0,4)=="sep="?c.charCodeAt(5)==13&&c.charCodeAt(6)==10?(m=c.charAt(4),c=c.slice(7)):c.charCodeAt(5)==13||c.charCodeAt(5)==10?(m=c.charAt(4),c=c.slice(6)):m=i(c.slice(0,1024)):p&&p.FS?m=p.FS:m=i(c.slice(0,1024));var w=0,x=0,T=0,y=0,_=0,k=m.charCodeAt(0),S=!1,C=0,M=c.charCodeAt(0);c=c.replace(/\r\n/mg,`
`);var F=p.dateNF!=null?aU(p.dateNF):null;function b(){var V=c.slice(y,_),z={};if(V.charAt(0)=='"'&&V.charAt(V.length-1)=='"'&&(V=V.slice(1,-1).replace(/""/g,'"')),V.length===0)z.t="z";else if(p.raw)z.t="s",z.v=V;else if(V.trim().length===0)z.t="s",z.v=V;else if(V.charCodeAt(0)==61)V.charCodeAt(1)==34&&V.charCodeAt(V.length-1)==34?(z.t="s",z.v=V.slice(2,-1).replace(/""/g,'"')):b$(V)?(z.t="n",z.f=V.slice(1)):(z.t="s",z.v=V);else if(V=="TRUE")z.t="b",z.v=!0;else if(V=="FALSE")z.t="b",z.v=!1;else if(!isNaN(T=Vi(V)))z.t="n",p.cellText!==!1&&(z.w=V),z.v=T;else if(!isNaN(gu(V).getDate())||F&&V.match(F)){z.z=p.dateNF||et[14];var ie=0;F&&V.match(F)&&(V=oU(V,p.dateNF,V.match(F)||[]),ie=1),p.cellDates?(z.t="d",z.v=tn(V,ie)):(z.t="n",z.v=Nn(tn(V,ie))),p.cellText!==!1&&(z.w=_i(z.z,z.v instanceof Date?Nn(z.v):z.v)),p.cellNF||delete z.z}else z.t="s",z.v=V;if(z.t=="z"||(p.dense?(v[w]||(v[w]=[]),v[w][x]=z):v[nt({c:x,r:w})]=z),y=_+1,M=c.charCodeAt(y),g.e.c<x&&(g.e.c=x),g.e.r<w&&(g.e.r=w),C==k)++x;else if(x=0,++w,p.sheetRows&&p.sheetRows<=w)return!0}e:for(;_<c.length;++_)switch(C=c.charCodeAt(_)){case 34:M===34&&(S=!S);break;case k:case 10:case 13:if(!S&&b())break e;break}return _-y>0&&b(),v["!ref"]=lt(g),v}function a(c,h){return!(h&&h.PRN)||h.FS||c.slice(0,4)=="sep="||c.indexOf("	")>=0||c.indexOf(",")>=0||c.indexOf(";")>=0?s(c,h):Ru(t(c,h),h)}function o(c,h){var p="",m=h.type=="string"?[0,0,0,0]:ry(c,h);switch(h.type){case"base64":p=Zr(c);break;case"binary":p=c;break;case"buffer":h.codepage==65001?p=c.toString("utf8"):h.codepage&&typeof cf<"u"||(p=dt&&Buffer.isBuffer(c)?c.toString("binary"):Wa(c));break;case"array":p=Po(c);break;case"string":p=c;break;default:throw new Error("Unrecognized type "+h.type)}return m[0]==239&&m[1]==187&&m[2]==191?p=qt(p.slice(3)):h.type!="string"&&h.type!="buffer"&&h.codepage==65001?p=qt(p):h.type=="binary"&&typeof cf<"u",p.slice(0,19)=="socialcalc:version:"?eD.to_sheet(h.type=="string"?p:qt(p),h):a(p,h)}function l(c,h){return Ga(o(c,h),h)}function u(c){for(var h=[],p=At(c["!ref"]),m,v=Array.isArray(c),g=p.s.r;g<=p.e.r;++g){for(var w=[],x=p.s.c;x<=p.e.c;++x){var T=nt({r:g,c:x});if(m=v?(c[g]||[])[x]:c[T],!m||m.v==null){w.push("          ");continue}for(var y=(m.w||(Us(m),m.w)||"").slice(0,10);y.length<10;)y+=" ";w.push(y+(x===0?" ":""))}h.push(w.join(""))}return h.join(`
`)}return{to_workbook:l,to_sheet:o,from_sheet:u}}();function T7(e,t){var n=t||{},r=!!n.WTF;n.WTF=!0;try{var i=jF.to_workbook(e,n);return n.WTF=r,i}catch(s){if(n.WTF=r,!s.message.match(/SYLK bad record ID/)&&r)throw s;return vu.to_workbook(e,t)}}var So=function(){function e(L,q,W){if(L){Jn(L,L.l||0);for(var G=W.Enum||fe;L.l<L.length;){var ee=L.read_shift(2),Se=G[ee]||G[65535],we=L.read_shift(2),pe=L.l+we,oe=Se.f&&Se.f(L,we,W);if(L.l=pe,q(oe,Se,ee))return}}}function t(L,q){switch(q.type){case"base64":return n(Gr(Zr(L)),q);case"binary":return n(Gr(L),q);case"buffer":case"array":return n(L,q)}throw"Unsupported type "+q.type}function n(L,q){if(!L)return L;var W=q||{},G=W.dense?[]:{},ee="Sheet1",Se="",we=0,pe={},oe=[],Le=[],B={s:{r:0,c:0},e:{r:0,c:0}},st=W.sheetRows||0;if(L[2]==0&&(L[3]==8||L[3]==9)&&L.length>=16&&L[14]==5&&L[15]===108)throw new Error("Unsupported Works 3 for Mac file");if(L[2]==2)W.Enum=fe,e(L,function(Re,ht,Dt){switch(Dt){case 0:W.vers=Re,Re>=4096&&(W.qpro=!0);break;case 6:B=Re;break;case 204:Re&&(Se=Re);break;case 222:Se=Re;break;case 15:case 51:W.qpro||(Re[1].v=Re[1].v.slice(1));case 13:case 14:case 16:Dt==14&&(Re[2]&112)==112&&(Re[2]&15)>1&&(Re[2]&15)<15&&(Re[1].z=W.dateNF||et[14],W.cellDates&&(Re[1].t="d",Re[1].v=ep(Re[1].v))),W.qpro&&Re[3]>we&&(G["!ref"]=lt(B),pe[ee]=G,oe.push(ee),G=W.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},we=Re[3],ee=Se||"Sheet"+(we+1),Se="");var tt=W.dense?(G[Re[0].r]||[])[Re[0].c]:G[nt(Re[0])];if(tt){tt.t=Re[1].t,tt.v=Re[1].v,Re[1].z!=null&&(tt.z=Re[1].z),Re[1].f!=null&&(tt.f=Re[1].f);break}W.dense?(G[Re[0].r]||(G[Re[0].r]=[]),G[Re[0].r][Re[0].c]=Re[1]):G[nt(Re[0])]=Re[1];break}},W);else if(L[2]==26||L[2]==14)W.Enum=xe,L[2]==14&&(W.qpro=!0,L.l=0),e(L,function(Re,ht,Dt){switch(Dt){case 204:ee=Re;break;case 22:Re[1].v=Re[1].v.slice(1);case 23:case 24:case 25:case 37:case 39:case 40:if(Re[3]>we&&(G["!ref"]=lt(B),pe[ee]=G,oe.push(ee),G=W.dense?[]:{},B={s:{r:0,c:0},e:{r:0,c:0}},we=Re[3],ee="Sheet"+(we+1)),st>0&&Re[0].r>=st)break;W.dense?(G[Re[0].r]||(G[Re[0].r]=[]),G[Re[0].r][Re[0].c]=Re[1]):G[nt(Re[0])]=Re[1],B.e.c<Re[0].c&&(B.e.c=Re[0].c),B.e.r<Re[0].r&&(B.e.r=Re[0].r);break;case 27:Re[14e3]&&(Le[Re[14e3][0]]=Re[14e3][1]);break;case 1537:Le[Re[0]]=Re[1],Re[0]==we&&(ee=Re[1]);break}},W);else throw new Error("Unrecognized LOTUS BOF "+L[2]);if(G["!ref"]=lt(B),pe[Se||ee]=G,oe.push(Se||ee),!Le.length)return{SheetNames:oe,Sheets:pe};for(var Ue={},at=[],$e=0;$e<Le.length;++$e)pe[oe[$e]]?(at.push(Le[$e]||oe[$e]),Ue[Le[$e]]=pe[Le[$e]]||pe[oe[$e]]):(at.push(Le[$e]),Ue[Le[$e]]={"!ref":"A1"});return{SheetNames:at,Sheets:Ue}}function r(L,q){var W=q||{};if(+W.codepage>=0&&Li(+W.codepage),W.type=="string")throw new Error("Cannot write WK1 to JS string");var G=Or(),ee=At(L["!ref"]),Se=Array.isArray(L),we=[];Ie(G,0,s(1030)),Ie(G,6,l(ee));for(var pe=Math.min(ee.e.r,8191),oe=ee.s.r;oe<=pe;++oe)for(var Le=Sn(oe),B=ee.s.c;B<=ee.e.c;++B){oe===ee.s.r&&(we[B]=on(B));var st=we[B]+Le,Ue=Se?(L[oe]||[])[B]:L[st];if(!(!Ue||Ue.t=="z"))if(Ue.t=="n")(Ue.v|0)==Ue.v&&Ue.v>=-32768&&Ue.v<=32767?Ie(G,13,m(oe,B,Ue.v)):Ie(G,14,g(oe,B,Ue.v));else{var at=Us(Ue);Ie(G,15,h(oe,B,at.slice(0,239)))}}return Ie(G,1),G.end()}function i(L,q){var W=q||{};if(+W.codepage>=0&&Li(+W.codepage),W.type=="string")throw new Error("Cannot write WK3 to JS string");var G=Or();Ie(G,0,a(L));for(var ee=0,Se=0;ee<L.SheetNames.length;++ee)(L.Sheets[L.SheetNames[ee]]||{})["!ref"]&&Ie(G,27,H(L.SheetNames[ee],Se++));var we=0;for(ee=0;ee<L.SheetNames.length;++ee){var pe=L.Sheets[L.SheetNames[ee]];if(!(!pe||!pe["!ref"])){for(var oe=At(pe["!ref"]),Le=Array.isArray(pe),B=[],st=Math.min(oe.e.r,8191),Ue=oe.s.r;Ue<=st;++Ue)for(var at=Sn(Ue),$e=oe.s.c;$e<=oe.e.c;++$e){Ue===oe.s.r&&(B[$e]=on($e));var Re=B[$e]+at,ht=Le?(pe[Ue]||[])[$e]:pe[Re];if(!(!ht||ht.t=="z"))if(ht.t=="n")Ie(G,23,b(Ue,$e,we,ht.v));else{var Dt=Us(ht);Ie(G,22,C(Ue,$e,we,Dt.slice(0,239)))}}++we}}return Ie(G,1),G.end()}function s(L){var q=me(2);return q.write_shift(2,L),q}function a(L){var q=me(26);q.write_shift(2,4096),q.write_shift(2,4),q.write_shift(4,0);for(var W=0,G=0,ee=0,Se=0;Se<L.SheetNames.length;++Se){var we=L.SheetNames[Se],pe=L.Sheets[we];if(!(!pe||!pe["!ref"])){++ee;var oe=Br(pe["!ref"]);W<oe.e.r&&(W=oe.e.r),G<oe.e.c&&(G=oe.e.c)}}return W>8191&&(W=8191),q.write_shift(2,W),q.write_shift(1,ee),q.write_shift(1,G),q.write_shift(2,0),q.write_shift(2,0),q.write_shift(1,1),q.write_shift(1,2),q.write_shift(4,0),q.write_shift(4,0),q}function o(L,q,W){var G={s:{c:0,r:0},e:{c:0,r:0}};return q==8&&W.qpro?(G.s.c=L.read_shift(1),L.l++,G.s.r=L.read_shift(2),G.e.c=L.read_shift(1),L.l++,G.e.r=L.read_shift(2),G):(G.s.c=L.read_shift(2),G.s.r=L.read_shift(2),q==12&&W.qpro&&(L.l+=2),G.e.c=L.read_shift(2),G.e.r=L.read_shift(2),q==12&&W.qpro&&(L.l+=2),G.s.c==65535&&(G.s.c=G.e.c=G.s.r=G.e.r=0),G)}function l(L){var q=me(8);return q.write_shift(2,L.s.c),q.write_shift(2,L.s.r),q.write_shift(2,L.e.c),q.write_shift(2,L.e.r),q}function u(L,q,W){var G=[{c:0,r:0},{t:"n",v:0},0,0];return W.qpro&&W.vers!=20768?(G[0].c=L.read_shift(1),G[3]=L.read_shift(1),G[0].r=L.read_shift(2),L.l+=2):(G[2]=L.read_shift(1),G[0].c=L.read_shift(2),G[0].r=L.read_shift(2)),G}function c(L,q,W){var G=L.l+q,ee=u(L,q,W);if(ee[1].t="s",W.vers==20768){L.l++;var Se=L.read_shift(1);return ee[1].v=L.read_shift(Se,"utf8"),ee}return W.qpro&&L.l++,ee[1].v=L.read_shift(G-L.l,"cstr"),ee}function h(L,q,W){var G=me(7+W.length);G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,L),G.write_shift(1,39);for(var ee=0;ee<G.length;++ee){var Se=W.charCodeAt(ee);G.write_shift(1,Se>=128?95:Se)}return G.write_shift(1,0),G}function p(L,q,W){var G=u(L,q,W);return G[1].v=L.read_shift(2,"i"),G}function m(L,q,W){var G=me(7);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,L),G.write_shift(2,W,"i"),G}function v(L,q,W){var G=u(L,q,W);return G[1].v=L.read_shift(8,"f"),G}function g(L,q,W){var G=me(13);return G.write_shift(1,255),G.write_shift(2,q),G.write_shift(2,L),G.write_shift(8,W,"f"),G}function w(L,q,W){var G=L.l+q,ee=u(L,q,W);if(ee[1].v=L.read_shift(8,"f"),W.qpro)L.l=G;else{var Se=L.read_shift(2);_(L.slice(L.l,L.l+Se),ee),L.l+=Se}return ee}function x(L,q,W){var G=q&32768;return q&=-32769,q=(G?L:0)+(q>=8192?q-16384:q),(G?"":"$")+(W?on(q):Sn(q))}var T={51:["FALSE",0],52:["TRUE",0],70:["LEN",1],80:["SUM",69],81:["AVERAGEA",69],82:["COUNTA",69],83:["MINA",69],84:["MAXA",69],111:["T",1]},y=["","","","","","","","","","+","-","*","/","^","=","<>","<=",">=","<",">","","","","","&","","","","","","",""];function _(L,q){Jn(L,0);for(var W=[],G=0,ee="",Se="",we="",pe="";L.l<L.length;){var oe=L[L.l++];switch(oe){case 0:W.push(L.read_shift(8,"f"));break;case 1:Se=x(q[0].c,L.read_shift(2),!0),ee=x(q[0].r,L.read_shift(2),!1),W.push(Se+ee);break;case 2:{var Le=x(q[0].c,L.read_shift(2),!0),B=x(q[0].r,L.read_shift(2),!1);Se=x(q[0].c,L.read_shift(2),!0),ee=x(q[0].r,L.read_shift(2),!1),W.push(Le+B+":"+Se+ee)}break;case 3:if(L.l<L.length){console.error("WK1 premature formula end");return}break;case 4:W.push("("+W.pop()+")");break;case 5:W.push(L.read_shift(2));break;case 6:{for(var st="";oe=L[L.l++];)st+=String.fromCharCode(oe);W.push('"'+st.replace(/"/g,'""')+'"')}break;case 8:W.push("-"+W.pop());break;case 23:W.push("+"+W.pop());break;case 22:W.push("NOT("+W.pop()+")");break;case 20:case 21:pe=W.pop(),we=W.pop(),W.push(["AND","OR"][oe-20]+"("+we+","+pe+")");break;default:if(oe<32&&y[oe])pe=W.pop(),we=W.pop(),W.push(we+y[oe]+pe);else if(T[oe]){if(G=T[oe][1],G==69&&(G=L[L.l++]),G>W.length){console.error("WK1 bad formula parse 0x"+oe.toString(16)+":|"+W.join("|")+"|");return}var Ue=W.slice(-G);W.length-=G,W.push(T[oe][0]+"("+Ue.join(",")+")")}else return oe<=7?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=24?console.error("WK1 unsupported op "+oe.toString(16)):oe<=30?console.error("WK1 invalid opcode "+oe.toString(16)):oe<=115?console.error("WK1 unsupported function opcode "+oe.toString(16)):console.error("WK1 unrecognized opcode "+oe.toString(16))}}W.length==1?q[1].f=""+W[0]:console.error("WK1 bad formula parse |"+W.join("|")+"|")}function k(L){var q=[{c:0,r:0},{t:"n",v:0},0];return q[0].r=L.read_shift(2),q[3]=L[L.l++],q[0].c=L[L.l++],q}function S(L,q){var W=k(L);return W[1].t="s",W[1].v=L.read_shift(q-4,"cstr"),W}function C(L,q,W,G){var ee=me(6+G.length);ee.write_shift(2,L),ee.write_shift(1,W),ee.write_shift(1,q),ee.write_shift(1,39);for(var Se=0;Se<G.length;++Se){var we=G.charCodeAt(Se);ee.write_shift(1,we>=128?95:we)}return ee.write_shift(1,0),ee}function M(L,q){var W=k(L);W[1].v=L.read_shift(2);var G=W[1].v>>1;if(W[1].v&1)switch(G&7){case 0:G=(G>>3)*5e3;break;case 1:G=(G>>3)*500;break;case 2:G=(G>>3)/20;break;case 3:G=(G>>3)/200;break;case 4:G=(G>>3)/2e3;break;case 5:G=(G>>3)/2e4;break;case 6:G=(G>>3)/16;break;case 7:G=(G>>3)/64;break}return W[1].v=G,W}function F(L,q){var W=k(L),G=L.read_shift(4),ee=L.read_shift(4),Se=L.read_shift(2);if(Se==65535)return G===0&&ee===3221225472?(W[1].t="e",W[1].v=15):G===0&&ee===3489660928?(W[1].t="e",W[1].v=42):W[1].v=0,W;var we=Se&32768;return Se=(Se&32767)-16446,W[1].v=(1-we*2)*(ee*Math.pow(2,Se+32)+G*Math.pow(2,Se)),W}function b(L,q,W,G){var ee=me(14);if(ee.write_shift(2,L),ee.write_shift(1,W),ee.write_shift(1,q),G==0)return ee.write_shift(4,0),ee.write_shift(4,0),ee.write_shift(2,65535),ee;var Se=0,we=0,pe=0,oe=0;return G<0&&(Se=1,G=-G),we=Math.log2(G)|0,G/=Math.pow(2,we-31),oe=G>>>0,oe&2147483648||(G/=2,++we,oe=G>>>0),G-=oe,oe|=2147483648,oe>>>=0,G*=Math.pow(2,32),pe=G>>>0,ee.write_shift(4,pe),ee.write_shift(4,oe),we+=16383+(Se?32768:0),ee.write_shift(2,we),ee}function V(L,q){var W=F(L);return L.l+=q-14,W}function z(L,q){var W=k(L),G=L.read_shift(4);return W[1].v=G>>6,W}function ie(L,q){var W=k(L),G=L.read_shift(8,"f");return W[1].v=G,W}function Q(L,q){var W=ie(L);return L.l+=q-10,W}function se(L,q){return L[L.l+q-1]==0?L.read_shift(q,"cstr"):""}function de(L,q){var W=L[L.l++];W>q-1&&(W=q-1);for(var G="";G.length<W;)G+=String.fromCharCode(L[L.l++]);return G}function ae(L,q,W){if(!(!W.qpro||q<21)){var G=L.read_shift(1);L.l+=17,L.l+=1,L.l+=2;var ee=L.read_shift(q-21,"cstr");return[G,ee]}}function ne(L,q){for(var W={},G=L.l+q;L.l<G;){var ee=L.read_shift(2);if(ee==14e3){for(W[ee]=[0,""],W[ee][0]=L.read_shift(2);L[L.l];)W[ee][1]+=String.fromCharCode(L[L.l]),L.l++;L.l++}}return W}function H(L,q){var W=me(5+L.length);W.write_shift(2,14e3),W.write_shift(2,q);for(var G=0;G<L.length;++G){var ee=L.charCodeAt(G);W[W.l++]=ee>127?95:ee}return W[W.l++]=0,W}var fe={0:{n:"BOF",f:kn},1:{n:"EOF"},2:{n:"CALCMODE"},3:{n:"CALCORDER"},4:{n:"SPLIT"},5:{n:"SYNC"},6:{n:"RANGE",f:o},7:{n:"WINDOW1"},8:{n:"COLW1"},9:{n:"WINTWO"},10:{n:"COLW2"},11:{n:"NAME"},12:{n:"BLANK"},13:{n:"INTEGER",f:p},14:{n:"NUMBER",f:v},15:{n:"LABEL",f:c},16:{n:"FORMULA",f:w},24:{n:"TABLE"},25:{n:"ORANGE"},26:{n:"PRANGE"},27:{n:"SRANGE"},28:{n:"FRANGE"},29:{n:"KRANGE1"},32:{n:"HRANGE"},35:{n:"KRANGE2"},36:{n:"PROTEC"},37:{n:"FOOTER"},38:{n:"HEADER"},39:{n:"SETUP"},40:{n:"MARGINS"},41:{n:"LABELFMT"},42:{n:"TITLES"},43:{n:"SHEETJS"},45:{n:"GRAPH"},46:{n:"NGRAPH"},47:{n:"CALCCOUNT"},48:{n:"UNFORMATTED"},49:{n:"CURSORW12"},50:{n:"WINDOW"},51:{n:"STRING",f:c},55:{n:"PASSWORD"},56:{n:"LOCKED"},60:{n:"QUERY"},61:{n:"QUERYNAME"},62:{n:"PRINT"},63:{n:"PRINTNAME"},64:{n:"GRAPH2"},65:{n:"GRAPHNAME"},66:{n:"ZOOM"},67:{n:"SYMSPLIT"},68:{n:"NSROWS"},69:{n:"NSCOLS"},70:{n:"RULER"},71:{n:"NNAME"},72:{n:"ACOMM"},73:{n:"AMACRO"},74:{n:"PARSE"},102:{n:"PRANGES??"},103:{n:"RRANGES??"},104:{n:"FNAME??"},105:{n:"MRANGES??"},204:{n:"SHEETNAMECS",f:se},222:{n:"SHEETNAMELP",f:de},65535:{n:""}},xe={0:{n:"BOF"},1:{n:"EOF"},2:{n:"PASSWORD"},3:{n:"CALCSET"},4:{n:"WINDOWSET"},5:{n:"SHEETCELLPTR"},6:{n:"SHEETLAYOUT"},7:{n:"COLUMNWIDTH"},8:{n:"HIDDENCOLUMN"},9:{n:"USERRANGE"},10:{n:"SYSTEMRANGE"},11:{n:"ZEROFORCE"},12:{n:"SORTKEYDIR"},13:{n:"FILESEAL"},14:{n:"DATAFILLNUMS"},15:{n:"PRINTMAIN"},16:{n:"PRINTSTRING"},17:{n:"GRAPHMAIN"},18:{n:"GRAPHSTRING"},19:{n:"??"},20:{n:"ERRCELL"},21:{n:"NACELL"},22:{n:"LABEL16",f:S},23:{n:"NUMBER17",f:F},24:{n:"NUMBER18",f:M},25:{n:"FORMULA19",f:V},26:{n:"FORMULA1A"},27:{n:"XFORMAT",f:ne},28:{n:"DTLABELMISC"},29:{n:"DTLABELCELL"},30:{n:"GRAPHWINDOW"},31:{n:"CPA"},32:{n:"LPLAUTO"},33:{n:"QUERY"},34:{n:"HIDDENSHEET"},35:{n:"??"},37:{n:"NUMBER25",f:z},38:{n:"??"},39:{n:"NUMBER27",f:ie},40:{n:"FORMULA28",f:Q},142:{n:"??"},147:{n:"??"},150:{n:"??"},151:{n:"??"},152:{n:"??"},153:{n:"??"},154:{n:"??"},155:{n:"??"},156:{n:"??"},163:{n:"??"},174:{n:"??"},175:{n:"??"},176:{n:"??"},177:{n:"??"},184:{n:"??"},185:{n:"??"},186:{n:"??"},187:{n:"??"},188:{n:"??"},195:{n:"??"},201:{n:"??"},204:{n:"SHEETNAMECS",f:se},205:{n:"??"},206:{n:"??"},207:{n:"??"},208:{n:"??"},256:{n:"??"},259:{n:"??"},260:{n:"??"},261:{n:"??"},262:{n:"??"},263:{n:"??"},265:{n:"??"},266:{n:"??"},267:{n:"??"},268:{n:"??"},270:{n:"??"},271:{n:"??"},384:{n:"??"},389:{n:"??"},390:{n:"??"},393:{n:"??"},396:{n:"??"},512:{n:"??"},514:{n:"??"},513:{n:"??"},516:{n:"??"},517:{n:"??"},640:{n:"??"},641:{n:"??"},642:{n:"??"},643:{n:"??"},644:{n:"??"},645:{n:"??"},646:{n:"??"},647:{n:"??"},648:{n:"??"},658:{n:"??"},659:{n:"??"},660:{n:"??"},661:{n:"??"},662:{n:"??"},665:{n:"??"},666:{n:"??"},768:{n:"??"},772:{n:"??"},1537:{n:"SHEETINFOQP",f:ae},1600:{n:"??"},1602:{n:"??"},1793:{n:"??"},1794:{n:"??"},1795:{n:"??"},1796:{n:"??"},1920:{n:"??"},2048:{n:"??"},2049:{n:"??"},2052:{n:"??"},2688:{n:"??"},10998:{n:"??"},12849:{n:"??"},28233:{n:"??"},28484:{n:"??"},65535:{n:""}};return{sheet_to_wk1:r,book_to_wk3:i,to_workbook:t}}();function S7(e){var t={},n=e.match(gr),r=0,i=!1;if(n)for(;r!=n.length;++r){var s=it(n[r]);switch(s[0].replace(/\w*:/g,"")){case"<condense":break;case"<extend":break;case"<shadow":if(!s.val)break;case"<shadow>":case"<shadow/>":t.shadow=1;break;case"</shadow>":break;case"<charset":if(s.val=="1")break;t.cp=w1[parseInt(s.val,10)];break;case"<outline":if(!s.val)break;case"<outline>":case"<outline/>":t.outline=1;break;case"</outline>":break;case"<rFont":t.name=s.val;break;case"<sz":t.sz=s.val;break;case"<strike":if(!s.val)break;case"<strike>":case"<strike/>":t.strike=1;break;case"</strike>":break;case"<u":if(!s.val)break;switch(s.val){case"double":t.uval="double";break;case"singleAccounting":t.uval="single-accounting";break;case"doubleAccounting":t.uval="double-accounting";break}case"<u>":case"<u/>":t.u=1;break;case"</u>":break;case"<b":if(s.val=="0")break;case"<b>":case"<b/>":t.b=1;break;case"</b>":break;case"<i":if(s.val=="0")break;case"<i>":case"<i/>":t.i=1;break;case"</i>":break;case"<color":s.rgb&&(t.color=s.rgb.slice(2,8));break;case"<color>":case"<color/>":case"</color>":break;case"<family":t.family=s.val;break;case"<family>":case"<family/>":case"</family>":break;case"<vertAlign":t.valign=s.val;break;case"<vertAlign>":case"<vertAlign/>":case"</vertAlign>":break;case"<scheme":break;case"<scheme>":case"<scheme/>":case"</scheme>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(s[0].charCodeAt(1)!==47&&!i)throw new Error("Unrecognized rich format "+s[0])}}return t}var E7=function(){var e=hf("t"),t=hf("rPr");function n(s){var a=s.match(e);if(!a)return{t:"s",v:""};var o={t:"s",v:kt(a[1])},l=s.match(t);return l&&(o.s=S7(l[1])),o}var r=/<(?:\w+:)?r>/g,i=/<\/(?:\w+:)?r>/;return function(a){return a.replace(r,"").split(i).map(n).filter(function(o){return o.v})}}(),_7=function(){var t=/(\r\n|\n)/g;function n(i,s,a){var o=[];i.u&&o.push("text-decoration: underline;"),i.uval&&o.push("text-underline-style:"+i.uval+";"),i.sz&&o.push("font-size:"+i.sz+"pt;"),i.outline&&o.push("text-effect: outline;"),i.shadow&&o.push("text-shadow: auto;"),s.push('<span style="'+o.join("")+'">'),i.b&&(s.push("<b>"),a.push("</b>")),i.i&&(s.push("<i>"),a.push("</i>")),i.strike&&(s.push("<s>"),a.push("</s>"));var l=i.valign||"";return l=="superscript"||l=="super"?l="sup":l=="subscript"&&(l="sub"),l!=""&&(s.push("<"+l+">"),a.push("</"+l+">")),a.push("</span>"),i}function r(i){var s=[[],i.v,[]];return i.v?(i.s&&n(i.s,s[0],s[2]),s[0].join("")+s[1].replace(t,"<br/>")+s[2].join("")):""}return function(s){return s.map(r).join("")}}(),C7=/<(?:\w+:)?t[^>]*>([^<]*)<\/(?:\w+:)?t>/g,k7=/<(?:\w+:)?r>/,A7=/<(?:\w+:)?rPh.*?>([\s\S]*?)<\/(?:\w+:)?rPh>/g;function W1(e,t){var n=t?t.cellHTML:!0,r={};return e?(e.match(/^\s*<(?:\w+:)?t[^>]*>/)?(r.t=kt(qt(e.slice(e.indexOf(">")+1).split(/<\/(?:\w+:)?t>/)[0]||"")),r.r=qt(e),n&&(r.h=F1(r.t))):e.match(k7)&&(r.r=qt(e),r.t=kt(qt((e.replace(A7,"").match(C7)||[]).join("").replace(gr,""))),n&&(r.h=_7(E7(r.r)))),r):{t:""}}var R7=/<(?:\w+:)?sst([^>]*)>([\s\S]*)<\/(?:\w+:)?sst>/,M7=/<(?:\w+:)?(?:si|sstItem)>/g,F7=/<\/(?:\w+:)?(?:si|sstItem)>/;function D7(e,t){var n=[],r="";if(!e)return n;var i=e.match(R7);if(i){r=i[2].replace(M7,"").split(F7);for(var s=0;s!=r.length;++s){var a=W1(r[s].trim(),t);a!=null&&(n[n.length]=a)}i=it(i[1]),n.Count=i.count,n.Unique=i.uniqueCount}return n}var P7=/^\s|\s$|[\t\n\r]/;function tD(e,t){if(!t.bookSST)return"";var n=[En];n[n.length]=Pe("sst",null,{xmlns:Yo[0],count:e.Count,uniqueCount:e.Unique});for(var r=0;r!=e.length;++r)if(e[r]!=null){var i=e[r],s="<si>";i.r?s+=i.r:(s+="<t",i.t||(i.t=""),i.t.match(P7)&&(s+=' xml:space="preserve"'),s+=">"+$t(i.t)+"</t>"),s+="</si>",n[n.length]=s}return n.length>2&&(n[n.length]="</sst>",n[1]=n[1].replace("/>",">")),n.join("")}function I7(e){return[e.read_shift(4),e.read_shift(4)]}function N7(e,t){var n=[],r=!1;return zs(e,function(s,a,o){switch(o){case 159:n.Count=s[0],n.Unique=s[1];break;case 19:n.push(s);break;case 160:return!0;case 35:r=!0;break;case 36:r=!1;break;default:if(a.T,!r||t.WTF)throw new Error("Unexpected record 0x"+o.toString(16))}}),n}function b7(e,t){return t||(t=me(8)),t.write_shift(4,e.Count),t.write_shift(4,e.Unique),t}var L7=qU;function O7(e){var t=Or();_e(t,159,b7(e));for(var n=0;n<e.length;++n)_e(t,19,L7(e[n]));return _e(t,160),t.end()}function nD(e){for(var t=[],n=e.split(""),r=0;r<n.length;++r)t[r]=n[r].charCodeAt(0);return t}function Ps(e,t){var n={};return n.Major=e.read_shift(2),n.Minor=e.read_shift(2),t>=4&&(e.l+=t-4),n}function B7(e){var t={};return t.id=e.read_shift(0,"lpp4"),t.R=Ps(e,4),t.U=Ps(e,4),t.W=Ps(e,4),t}function U7(e){for(var t=e.read_shift(4),n=e.l+t-4,r={},i=e.read_shift(4),s=[];i-- >0;)s.push({t:e.read_shift(4),v:e.read_shift(0,"lpp4")});if(r.name=e.read_shift(0,"lpp4"),r.comps=s,e.l!=n)throw new Error("Bad DataSpaceMapEntry: "+e.l+" != "+n);return r}function V7(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(U7(e));return t}function H7(e){var t=[];e.l+=4;for(var n=e.read_shift(4);n-- >0;)t.push(e.read_shift(0,"lpp4"));return t}function $7(e){var t={};return e.read_shift(4),e.l+=4,t.id=e.read_shift(0,"lpp4"),t.name=e.read_shift(0,"lpp4"),t.R=Ps(e,4),t.U=Ps(e,4),t.W=Ps(e,4),t}function z7(e){var t=$7(e);if(t.ename=e.read_shift(0,"8lpp4"),t.blksz=e.read_shift(4),t.cmode=e.read_shift(4),e.read_shift(4)!=4)throw new Error("Bad !Primary record");return t}function rD(e,t){var n=e.l+t,r={};r.Flags=e.read_shift(4)&63,e.l+=4,r.AlgID=e.read_shift(4);var i=!1;switch(r.AlgID){case 26126:case 26127:case 26128:i=r.Flags==36;break;case 26625:i=r.Flags==4;break;case 0:i=r.Flags==16||r.Flags==4||r.Flags==36;break;default:throw"Unrecognized encryption algorithm: "+r.AlgID}if(!i)throw new Error("Encryption Flags/AlgID mismatch");return r.AlgIDHash=e.read_shift(4),r.KeySize=e.read_shift(4),r.ProviderType=e.read_shift(4),e.l+=8,r.CSPName=e.read_shift(n-e.l>>1,"utf16le"),e.l=n,r}function iD(e,t){var n={},r=e.l+t;return e.l+=4,n.Salt=e.slice(e.l,e.l+16),e.l+=16,n.Verifier=e.slice(e.l,e.l+16),e.l+=16,e.read_shift(4),n.VerifierHash=e.slice(e.l,r),e.l=r,n}function W7(e){var t=Ps(e);switch(t.Minor){case 2:return[t.Minor,G7(e)];case 3:return[t.Minor,q7()];case 4:return[t.Minor,K7(e)]}throw new Error("ECMA-376 Encrypted file unrecognized Version: "+t.Minor)}function G7(e){var t=e.read_shift(4);if((t&63)!=36)throw new Error("EncryptionInfo mismatch");var n=e.read_shift(4),r=rD(e,n),i=iD(e,e.length-e.l);return{t:"Std",h:r,v:i}}function q7(){throw new Error("File is password-protected: ECMA-376 Extensible")}function K7(e){var t=["saltSize","blockSize","keyBits","hashSize","cipherAlgorithm","cipherChaining","hashAlgorithm","saltValue"];e.l+=4;var n=e.read_shift(e.length-e.l,"utf8"),r={};return n.replace(gr,function(s){var a=it(s);switch(hs(a[0])){case"<?xml":break;case"<encryption":case"</encryption>":break;case"<keyData":t.forEach(function(o){r[o]=a[o]});break;case"<dataIntegrity":r.encryptedHmacKey=a.encryptedHmacKey,r.encryptedHmacValue=a.encryptedHmacValue;break;case"<keyEncryptors>":case"<keyEncryptors":r.encs=[];break;case"</keyEncryptors>":break;case"<keyEncryptor":r.uri=a.uri;break;case"</keyEncryptor>":break;case"<encryptedKey":r.encs.push(a);break;default:throw a[0]}}),r}function Y7(e,t){var n={},r=n.EncryptionVersionInfo=Ps(e,4);if(t-=4,r.Minor!=2)throw new Error("unrecognized minor version code: "+r.Minor);if(r.Major>4||r.Major<2)throw new Error("unrecognized major version code: "+r.Major);n.Flags=e.read_shift(4),t-=4;var i=e.read_shift(4);return t-=4,n.EncryptionHeader=rD(e,i),t-=i,n.EncryptionVerifier=iD(e,t),n}function X7(e){var t={},n=t.EncryptionVersionInfo=Ps(e,4);if(n.Major!=1||n.Minor!=1)throw"unrecognized version code "+n.Major+" : "+n.Minor;return t.Salt=e.read_shift(16),t.EncryptedVerifier=e.read_shift(16),t.EncryptedVerifierHash=e.read_shift(16),t}function G1(e){var t=0,n,r=nD(e),i=r.length+1,s,a,o,l,u;for(n=Na(i),n[0]=r.length,s=1;s!=i;++s)n[s]=r[s-1];for(s=i-1;s>=0;--s)a=n[s],o=t&16384?1:0,l=t<<1&32767,u=o|l,t=u^a;return t^52811}var sD=function(){var e=[187,255,255,186,255,255,185,128,0,190,15,0,191,15,0],t=[57840,7439,52380,33984,4364,3600,61902,12606,6258,57657,54287,34041,10252,43370,20163],n=[44796,19929,39858,10053,20106,40212,10761,31585,63170,64933,60267,50935,40399,11199,17763,35526,1453,2906,5812,11624,23248,885,1770,3540,7080,14160,28320,56640,55369,41139,20807,41614,21821,43642,17621,28485,56970,44341,19019,38038,14605,29210,60195,50791,40175,10751,21502,43004,24537,18387,36774,3949,7898,15796,31592,63184,47201,24803,49606,37805,14203,28406,56812,17824,35648,1697,3394,6788,13576,27152,43601,17539,35078,557,1114,2228,4456,30388,60776,51953,34243,7079,14158,28316,14128,28256,56512,43425,17251,34502,7597,13105,26210,52420,35241,883,1766,3532,4129,8258,16516,33032,4657,9314,18628],r=function(a){return(a/2|a*128)&255},i=function(a,o){return r(a^o)},s=function(a){for(var o=t[a.length-1],l=104,u=a.length-1;u>=0;--u)for(var c=a[u],h=0;h!=7;++h)c&64&&(o^=n[l]),c*=2,--l;return o};return function(a){for(var o=nD(a),l=s(o),u=o.length,c=Na(16),h=0;h!=16;++h)c[h]=0;var p,m,v;for((u&1)===1&&(p=l>>8,c[u]=i(e[0],p),--u,p=l&255,m=o[o.length-1],c[u]=i(m,p));u>0;)--u,p=l>>8,c[u]=i(o[u],p),--u,p=l&255,c[u]=i(o[u],p);for(u=15,v=15-o.length;v>0;)p=l>>8,c[u]=i(e[v],p),--u,--v,p=l&255,c[u]=i(o[u],p),--u,--v;return c}}(),J7=function(e,t,n,r,i){i||(i=t),r||(r=sD(e));var s,a;for(s=0;s!=t.length;++s)a=t[s],a^=r[n],a=(a>>5|a<<3)&255,i[s]=a,++n;return[i,n,r]},Q7=function(e){var t=0,n=sD(e);return function(r){var i=J7("",r,t,n);return t=i[1],i[0]}};function j7(e,t,n,r){var i={key:kn(e),verificationBytes:kn(e)};return n.password&&(i.verifier=G1(n.password)),r.valid=i.verificationBytes===i.verifier,r.valid&&(r.insitu=Q7(n.password)),i}function Z7(e,t,n){var r=n||{};return r.Info=e.read_shift(2),e.l-=2,r.Info===1?r.Data=X7(e):r.Data=Y7(e,t),r}function eH(e,t,n){var r={Type:n.biff>=8?e.read_shift(2):0};return r.Type?Z7(e,t-2,r):j7(e,n.biff>=8?t:t-2,n,r),r}var aD=function(){function e(i,s){switch(s.type){case"base64":return t(Zr(i),s);case"binary":return t(i,s);case"buffer":return t(dt&&Buffer.isBuffer(i)?i.toString("binary"):Wa(i),s);case"array":return t(Po(i),s)}throw new Error("Unrecognized type "+s.type)}function t(i,s){var a=s||{},o=a.dense?[]:{},l=i.match(/\\trowd.*?\\row\b/g);if(!l.length)throw new Error("RTF missing table");var u={s:{c:0,r:0},e:{c:0,r:l.length-1}};return l.forEach(function(c,h){Array.isArray(o)&&(o[h]=[]);for(var p=/\\\w+\b/g,m=0,v,g=-1;v=p.exec(c);){switch(v[0]){case"\\cell":var w=c.slice(m,p.lastIndex-v[0].length);if(w[0]==" "&&(w=w.slice(1)),++g,w.length){var x={v:w,t:"s"};Array.isArray(o)?o[h][g]=x:o[nt({r:h,c:g})]=x}break}m=p.lastIndex}g>u.e.c&&(u.e.c=g)}),o["!ref"]=lt(u),o}function n(i,s){return Ga(e(i,s),s)}function r(i){for(var s=["{\\rtf1\\ansi"],a=At(i["!ref"]),o,l=Array.isArray(i),u=a.s.r;u<=a.e.r;++u){s.push("\\trowd\\trautofit1");for(var c=a.s.c;c<=a.e.c;++c)s.push("\\cellx"+(c+1));for(s.push("\\pard\\intbl"),c=a.s.c;c<=a.e.c;++c){var h=nt({r:u,c});o=l?(i[u]||[])[c]:i[h],!(!o||o.v==null&&(!o.f||o.F))&&(s.push(" "+(o.w||(Us(o),o.w))),s.push("\\cell"))}s.push("\\pard\\intbl\\row")}return s.join("")+"}"}return{to_workbook:n,to_sheet:e,from_sheet:r}}();function tH(e){var t=e.slice(e[0]==="#"?1:0).slice(0,6);return[parseInt(t.slice(0,2),16),parseInt(t.slice(2,4),16),parseInt(t.slice(4,6),16)]}function vf(e){for(var t=0,n=1;t!=3;++t)n=n*256+(e[t]>255?255:e[t]<0?0:e[t]);return n.toString(16).toUpperCase().slice(1)}function nH(e){var t=e[0]/255,n=e[1]/255,r=e[2]/255,i=Math.max(t,n,r),s=Math.min(t,n,r),a=i-s;if(a===0)return[0,0,t];var o=0,l=0,u=i+s;switch(l=a/(u>1?2-u:u),i){case t:o=((n-r)/a+6)%6;break;case n:o=(r-t)/a+2;break;case r:o=(t-n)/a+4;break}return[o/6,l,u/2]}function rH(e){var t=e[0],n=e[1],r=e[2],i=n*2*(r<.5?r:1-r),s=r-i/2,a=[s,s,s],o=6*t,l;if(n!==0)switch(o|0){case 0:case 6:l=i*o,a[0]+=i,a[1]+=l;break;case 1:l=i*(2-o),a[0]+=l,a[1]+=i;break;case 2:l=i*(o-2),a[1]+=i,a[2]+=l;break;case 3:l=i*(4-o),a[1]+=l,a[2]+=i;break;case 4:l=i*(o-4),a[2]+=i,a[0]+=l;break;case 5:l=i*(6-o),a[2]+=l,a[0]+=i;break}for(var u=0;u!=3;++u)a[u]=Math.round(a[u]*255);return a}function uh(e,t){if(t===0)return e;var n=nH(tH(e));return t<0?n[2]=n[2]*(1+t):n[2]=1-(1-n[2])*(1-t),vf(rH(n))}var oD=6,iH=15,sH=1,lr=oD;function xf(e){return Math.floor((e+Math.round(128/lr)/256)*lr)}function yf(e){return Math.floor((e-5)/lr*100+.5)/100}function ch(e){return Math.round((e*lr+5)/lr*256)/256}function cm(e){return ch(yf(xf(e)))}function q1(e){var t=Math.abs(e-cm(e)),n=lr;if(t>.005)for(lr=sH;lr<iH;++lr)Math.abs(e-cm(e))<=t&&(t=Math.abs(e-cm(e)),n=lr);lr=n}function ba(e){e.width?(e.wpx=xf(e.width),e.wch=yf(e.wpx),e.MDW=lr):e.wpx?(e.wch=yf(e.wpx),e.width=ch(e.wch),e.MDW=lr):typeof e.wch=="number"&&(e.width=ch(e.wch),e.wpx=xf(e.width),e.MDW=lr),e.customWidth&&delete e.customWidth}var aH=96,lD=aH;function wf(e){return e*96/lD}function xu(e){return e*lD/96}var oH={None:"none",Solid:"solid",Gray50:"mediumGray",Gray75:"darkGray",Gray25:"lightGray",HorzStripe:"darkHorizontal",VertStripe:"darkVertical",ReverseDiagStripe:"darkDown",DiagStripe:"darkUp",DiagCross:"darkGrid",ThickDiagCross:"darkTrellis",ThinHorzStripe:"lightHorizontal",ThinVertStripe:"lightVertical",ThinReverseDiagStripe:"lightDown",ThinHorzCross:"lightGrid"};function lH(e,t,n,r){t.Borders=[];var i={},s=!1;(e[0].match(gr)||[]).forEach(function(a){var o=it(a);switch(hs(o[0])){case"<borders":case"<borders>":case"</borders>":break;case"<border":case"<border>":case"<border/>":i={},o.diagonalUp&&(i.diagonalUp=jt(o.diagonalUp)),o.diagonalDown&&(i.diagonalDown=jt(o.diagonalDown)),t.Borders.push(i);break;case"</border>":break;case"<left/>":break;case"<left":case"<left>":break;case"</left>":break;case"<right/>":break;case"<right":case"<right>":break;case"</right>":break;case"<top/>":break;case"<top":case"<top>":break;case"</top>":break;case"<bottom/>":break;case"<bottom":case"<bottom>":break;case"</bottom>":break;case"<diagonal":case"<diagonal>":case"<diagonal/>":break;case"</diagonal>":break;case"<horizontal":case"<horizontal>":case"<horizontal/>":break;case"</horizontal>":break;case"<vertical":case"<vertical>":case"<vertical/>":break;case"</vertical>":break;case"<start":case"<start>":case"<start/>":break;case"</start>":break;case"<end":case"<end>":case"<end/>":break;case"</end>":break;case"<color":case"<color>":break;case"<color/>":case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in borders")}})}function uH(e,t,n,r){t.Fills=[];var i={},s=!1;(e[0].match(gr)||[]).forEach(function(a){var o=it(a);switch(hs(o[0])){case"<fills":case"<fills>":case"</fills>":break;case"<fill>":case"<fill":case"<fill/>":i={},t.Fills.push(i);break;case"</fill>":break;case"<gradientFill>":break;case"<gradientFill":case"</gradientFill>":t.Fills.push(i),i={};break;case"<patternFill":case"<patternFill>":o.patternType&&(i.patternType=o.patternType);break;case"<patternFill/>":case"</patternFill>":break;case"<bgColor":i.bgColor||(i.bgColor={}),o.indexed&&(i.bgColor.indexed=parseInt(o.indexed,10)),o.theme&&(i.bgColor.theme=parseInt(o.theme,10)),o.tint&&(i.bgColor.tint=parseFloat(o.tint)),o.rgb&&(i.bgColor.rgb=o.rgb.slice(-6));break;case"<bgColor/>":case"</bgColor>":break;case"<fgColor":i.fgColor||(i.fgColor={}),o.theme&&(i.fgColor.theme=parseInt(o.theme,10)),o.tint&&(i.fgColor.tint=parseFloat(o.tint)),o.rgb!=null&&(i.fgColor.rgb=o.rgb.slice(-6));break;case"<fgColor/>":case"</fgColor>":break;case"<stop":case"<stop/>":break;case"</stop>":break;case"<color":case"<color/>":break;case"</color>":break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fills")}})}function cH(e,t,n,r){t.Fonts=[];var i={},s=!1;(e[0].match(gr)||[]).forEach(function(a){var o=it(a);switch(hs(o[0])){case"<fonts":case"<fonts>":case"</fonts>":break;case"<font":case"<font>":break;case"</font>":case"<font/>":t.Fonts.push(i),i={};break;case"<name":o.val&&(i.name=qt(o.val));break;case"<name/>":case"</name>":break;case"<b":i.bold=o.val?jt(o.val):1;break;case"<b/>":i.bold=1;break;case"<i":i.italic=o.val?jt(o.val):1;break;case"<i/>":i.italic=1;break;case"<u":switch(o.val){case"none":i.underline=0;break;case"single":i.underline=1;break;case"double":i.underline=2;break;case"singleAccounting":i.underline=33;break;case"doubleAccounting":i.underline=34;break}break;case"<u/>":i.underline=1;break;case"<strike":i.strike=o.val?jt(o.val):1;break;case"<strike/>":i.strike=1;break;case"<outline":i.outline=o.val?jt(o.val):1;break;case"<outline/>":i.outline=1;break;case"<shadow":i.shadow=o.val?jt(o.val):1;break;case"<shadow/>":i.shadow=1;break;case"<condense":i.condense=o.val?jt(o.val):1;break;case"<condense/>":i.condense=1;break;case"<extend":i.extend=o.val?jt(o.val):1;break;case"<extend/>":i.extend=1;break;case"<sz":o.val&&(i.sz=+o.val);break;case"<sz/>":case"</sz>":break;case"<vertAlign":o.val&&(i.vertAlign=o.val);break;case"<vertAlign/>":case"</vertAlign>":break;case"<family":o.val&&(i.family=parseInt(o.val,10));break;case"<family/>":case"</family>":break;case"<scheme":o.val&&(i.scheme=o.val);break;case"<scheme/>":case"</scheme>":break;case"<charset":if(o.val=="1")break;o.codepage=w1[parseInt(o.val,10)];break;case"<color":if(i.color||(i.color={}),o.auto&&(i.color.auto=jt(o.auto)),o.rgb)i.color.rgb=o.rgb.slice(-6);else if(o.indexed){i.color.index=parseInt(o.indexed,10);var l=wo[i.color.index];i.color.index==81&&(l=wo[1]),l||(l=wo[1]),i.color.rgb=l[0].toString(16)+l[1].toString(16)+l[2].toString(16)}else o.theme&&(i.color.theme=parseInt(o.theme,10),o.tint&&(i.color.tint=parseFloat(o.tint)),o.theme&&n.themeElements&&n.themeElements.clrScheme&&(i.color.rgb=uh(n.themeElements.clrScheme[i.color.theme].rgb,i.color.tint||0)));break;case"<color/>":case"</color>":break;case"<AlternateContent":s=!0;break;case"</AlternateContent>":s=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":s=!0;break;case"</ext>":s=!1;break;default:if(r&&r.WTF&&!s)throw new Error("unrecognized "+o[0]+" in fonts")}})}function fH(e,t,n){t.NumberFmt=[];for(var r=vn(et),i=0;i<r.length;++i)t.NumberFmt[r[i]]=et[r[i]];var s=e[0].match(gr);if(s)for(i=0;i<s.length;++i){var a=it(s[i]);switch(hs(a[0])){case"<numFmts":case"</numFmts>":case"<numFmts/>":case"<numFmts>":break;case"<numFmt":{var o=kt(qt(a.formatCode)),l=parseInt(a.numFmtId,10);if(t.NumberFmt[l]=o,l>0){if(l>392){for(l=392;l>60&&t.NumberFmt[l]!=null;--l);t.NumberFmt[l]=o}Ds(o,l)}}break;case"</numFmt>":break;default:if(n.WTF)throw new Error("unrecognized "+a[0]+" in numFmts")}}}function dH(e){var t=["<numFmts>"];return[[5,8],[23,26],[41,44],[50,392]].forEach(function(n){for(var r=n[0];r<=n[1];++r)e[r]!=null&&(t[t.length]=Pe("numFmt",null,{numFmtId:r,formatCode:$t(e[r])}))}),t.length===1?"":(t[t.length]="</numFmts>",t[0]=Pe("numFmts",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var Ud=["numFmtId","fillId","fontId","borderId","xfId"],Vd=["applyAlignment","applyBorder","applyFill","applyFont","applyNumberFormat","applyProtection","pivotButton","quotePrefix"];function hH(e,t,n){t.CellXf=[];var r,i=!1;(e[0].match(gr)||[]).forEach(function(s){var a=it(s),o=0;switch(hs(a[0])){case"<cellXfs":case"<cellXfs>":case"<cellXfs/>":case"</cellXfs>":break;case"<xf":case"<xf/>":for(r=a,delete r[0],o=0;o<Ud.length;++o)r[Ud[o]]&&(r[Ud[o]]=parseInt(r[Ud[o]],10));for(o=0;o<Vd.length;++o)r[Vd[o]]&&(r[Vd[o]]=jt(r[Vd[o]]));if(t.NumberFmt&&r.numFmtId>392){for(o=392;o>60;--o)if(t.NumberFmt[r.numFmtId]==t.NumberFmt[o]){r.numFmtId=o;break}}t.CellXf.push(r);break;case"</xf>":break;case"<alignment":case"<alignment/>":var l={};a.vertical&&(l.vertical=a.vertical),a.horizontal&&(l.horizontal=a.horizontal),a.textRotation!=null&&(l.textRotation=a.textRotation),a.indent&&(l.indent=a.indent),a.wrapText&&(l.wrapText=jt(a.wrapText)),r.alignment=l;break;case"</alignment>":break;case"<protection":break;case"</protection>":case"<protection/>":break;case"<AlternateContent":i=!0;break;case"</AlternateContent>":i=!1;break;case"<extLst":case"<extLst>":case"</extLst>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;default:if(n&&n.WTF&&!i)throw new Error("unrecognized "+a[0]+" in cellXfs")}})}function pH(e){var t=[];return t[t.length]=Pe("cellXfs",null),e.forEach(function(n){t[t.length]=Pe("xf",null,n)}),t[t.length]="</cellXfs>",t.length===2?"":(t[0]=Pe("cellXfs",null,{count:t.length-2}).replace("/>",">"),t.join(""))}var mH=function(){var t=/<(?:\w+:)?numFmts([^>]*)>[\S\s]*?<\/(?:\w+:)?numFmts>/,n=/<(?:\w+:)?cellXfs([^>]*)>[\S\s]*?<\/(?:\w+:)?cellXfs>/,r=/<(?:\w+:)?fills([^>]*)>[\S\s]*?<\/(?:\w+:)?fills>/,i=/<(?:\w+:)?fonts([^>]*)>[\S\s]*?<\/(?:\w+:)?fonts>/,s=/<(?:\w+:)?borders([^>]*)>[\S\s]*?<\/(?:\w+:)?borders>/;return function(o,l,u){var c={};if(!o)return c;o=o.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");var h;return(h=o.match(t))&&fH(h,c,u),(h=o.match(i))&&cH(h,c,l,u),(h=o.match(r))&&uH(h,c,l,u),(h=o.match(s))&&lH(h,c,l,u),(h=o.match(n))&&hH(h,c,u),c}}();function uD(e,t){var n=[En,Pe("styleSheet",null,{xmlns:Yo[0],"xmlns:vt":Pn.vt})],r;return e.SSF&&(r=dH(e.SSF))!=null&&(n[n.length]=r),n[n.length]='<fonts count="1"><font><sz val="12"/><color theme="1"/><name val="Calibri"/><family val="2"/><scheme val="minor"/></font></fonts>',n[n.length]='<fills count="2"><fill><patternFill patternType="none"/></fill><fill><patternFill patternType="gray125"/></fill></fills>',n[n.length]='<borders count="1"><border><left/><right/><top/><bottom/><diagonal/></border></borders>',n[n.length]='<cellStyleXfs count="1"><xf numFmtId="0" fontId="0" fillId="0" borderId="0"/></cellStyleXfs>',(r=pH(t.cellXfs))&&(n[n.length]=r),n[n.length]='<cellStyles count="1"><cellStyle name="Normal" xfId="0" builtinId="0"/></cellStyles>',n[n.length]='<dxfs count="0"/>',n[n.length]='<tableStyles count="0" defaultTableStyle="TableStyleMedium9" defaultPivotStyle="PivotStyleMedium4"/>',n.length>2&&(n[n.length]="</styleSheet>",n[1]=n[1].replace("/>",">")),n.join("")}function gH(e,t){var n=e.read_shift(2),r=hr(e);return[n,r]}function vH(e,t,n){n||(n=me(6+4*t.length)),n.write_shift(2,e),$n(t,n);var r=n.length>n.l?n.slice(0,n.l):n;return n.l==null&&(n.l=n.length),r}function xH(e,t,n){var r={};r.sz=e.read_shift(2)/20;var i=ZU(e);i.fItalic&&(r.italic=1),i.fCondense&&(r.condense=1),i.fExtend&&(r.extend=1),i.fShadow&&(r.shadow=1),i.fOutline&&(r.outline=1),i.fStrikeout&&(r.strike=1);var s=e.read_shift(2);switch(s===700&&(r.bold=1),e.read_shift(2)){case 1:r.vertAlign="superscript";break;case 2:r.vertAlign="subscript";break}var a=e.read_shift(1);a!=0&&(r.underline=a);var o=e.read_shift(1);o>0&&(r.family=o);var l=e.read_shift(1);switch(l>0&&(r.charset=l),e.l++,r.color=jU(e),e.read_shift(1)){case 1:r.scheme="major";break;case 2:r.scheme="minor";break}return r.name=hr(e),r}function yH(e,t){t||(t=me(25+4*32)),t.write_shift(2,e.sz*20),eV(e,t),t.write_shift(2,e.bold?700:400);var n=0;e.vertAlign=="superscript"?n=1:e.vertAlign=="subscript"&&(n=2),t.write_shift(2,n),t.write_shift(1,e.underline||0),t.write_shift(1,e.family||0),t.write_shift(1,e.charset||0),t.write_shift(1,0),ah(e.color,t);var r=0;return r=2,t.write_shift(1,r),$n(e.name,t),t.length>t.l?t.slice(0,t.l):t}var wH=["none","solid","mediumGray","darkGray","lightGray","darkHorizontal","darkVertical","darkDown","darkUp","darkGrid","darkTrellis","lightHorizontal","lightVertical","lightDown","lightUp","lightGrid","lightTrellis","gray125","gray0625"],fm,TH=mr;function _E(e,t){t||(t=me(4*3+8*7+16*1)),fm||(fm=jh(wH));var n=fm[e.patternType];n==null&&(n=40),t.write_shift(4,n);var r=0;if(n!=40)for(ah({auto:1},t),ah({auto:1},t);r<12;++r)t.write_shift(4,0);else{for(;r<4;++r)t.write_shift(4,0);for(;r<12;++r)t.write_shift(4,0)}return t.length>t.l?t.slice(0,t.l):t}function SH(e,t){var n=e.l+t,r=e.read_shift(2),i=e.read_shift(2);return e.l=n,{ixfe:r,numFmtId:i}}function cD(e,t,n){n||(n=me(16)),n.write_shift(2,t||0),n.write_shift(2,e.numFmtId||0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(1,0),n.write_shift(1,0);var r=0;return n.write_shift(1,r),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(1,0),n}function Zu(e,t){return t||(t=me(10)),t.write_shift(1,0),t.write_shift(1,0),t.write_shift(4,0),t.write_shift(4,0),t}var EH=mr;function _H(e,t){return t||(t=me(51)),t.write_shift(1,0),Zu(null,t),Zu(null,t),Zu(null,t),Zu(null,t),Zu(null,t),t.length>t.l?t.slice(0,t.l):t}function CH(e,t){return t||(t=me(12+4*10)),t.write_shift(4,e.xfId),t.write_shift(2,1),t.write_shift(1,0),t.write_shift(1,0),sh(e.name||"",t),t.length>t.l?t.slice(0,t.l):t}function kH(e,t,n){var r=me(2052);return r.write_shift(4,e),sh(t,r),sh(n,r),r.length>r.l?r.slice(0,r.l):r}function AH(e,t,n){var r={};r.NumberFmt=[];for(var i in et)r.NumberFmt[i]=et[i];r.CellXf=[],r.Fonts=[];var s=[],a=!1;return zs(e,function(l,u,c){switch(c){case 44:r.NumberFmt[l[0]]=l[1],Ds(l[1],l[0]);break;case 43:r.Fonts.push(l),l.color.theme!=null&&t&&t.themeElements&&t.themeElements.clrScheme&&(l.color.rgb=uh(t.themeElements.clrScheme[l.color.theme].rgb,l.color.tint||0));break;case 1025:break;case 45:break;case 46:break;case 47:s[s.length-1]==617&&r.CellXf.push(l);break;case 48:case 507:case 572:case 475:break;case 1171:case 2102:case 1130:case 512:case 2095:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:s.push(c),a=!0;break;case 38:s.pop(),a=!1;break;default:if(u.T>0)s.push(c);else if(u.T<0)s.pop();else if(!a||n.WTF&&s[s.length-1]!=37)throw new Error("Unexpected record 0x"+c.toString(16))}}),r}function RH(e,t){if(t){var n=0;[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&++n}),n!=0&&(_e(e,615,Hi(n)),[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&_e(e,44,vH(i,t[i]))}),_e(e,616))}}function MH(e){var t=1;_e(e,611,Hi(t)),_e(e,43,yH({sz:12,color:{theme:1},name:"Calibri",family:2})),_e(e,612)}function FH(e){var t=2;_e(e,603,Hi(t)),_e(e,45,_E({patternType:"none"})),_e(e,45,_E({patternType:"gray125"})),_e(e,604)}function DH(e){var t=1;_e(e,613,Hi(t)),_e(e,46,_H()),_e(e,614)}function PH(e){var t=1;_e(e,626,Hi(t)),_e(e,47,cD({numFmtId:0},65535)),_e(e,627)}function IH(e,t){_e(e,617,Hi(t.length)),t.forEach(function(n){_e(e,47,cD(n,0))}),_e(e,618)}function NH(e){var t=1;_e(e,619,Hi(t)),_e(e,48,CH({xfId:0,name:"Normal"})),_e(e,620)}function bH(e){var t=0;_e(e,505,Hi(t)),_e(e,506)}function LH(e){var t=0;_e(e,508,kH(t,"TableStyleMedium9","PivotStyleMedium4")),_e(e,509)}function OH(e,t){var n=Or();return _e(n,278),RH(n,e.SSF),MH(n),FH(n),DH(n),PH(n),IH(n,t.cellXfs),NH(n),bH(n),LH(n),_e(n,279),n.end()}var BH=["</a:lt1>","</a:dk1>","</a:lt2>","</a:dk2>","</a:accent1>","</a:accent2>","</a:accent3>","</a:accent4>","</a:accent5>","</a:accent6>","</a:hlink>","</a:folHlink>"];function UH(e,t,n){t.themeElements.clrScheme=[];var r={};(e[0].match(gr)||[]).forEach(function(i){var s=it(i);switch(s[0]){case"<a:clrScheme":case"</a:clrScheme>":break;case"<a:srgbClr":r.rgb=s.val;break;case"<a:sysClr":r.rgb=s.lastClr;break;case"<a:dk1>":case"</a:dk1>":case"<a:lt1>":case"</a:lt1>":case"<a:dk2>":case"</a:dk2>":case"<a:lt2>":case"</a:lt2>":case"<a:accent1>":case"</a:accent1>":case"<a:accent2>":case"</a:accent2>":case"<a:accent3>":case"</a:accent3>":case"<a:accent4>":case"</a:accent4>":case"<a:accent5>":case"</a:accent5>":case"<a:accent6>":case"</a:accent6>":case"<a:hlink>":case"</a:hlink>":case"<a:folHlink>":case"</a:folHlink>":s[0].charAt(1)==="/"?(t.themeElements.clrScheme[BH.indexOf(s[0])]=r,r={}):r.name=s[0].slice(3,s[0].length-1);break;default:if(n&&n.WTF)throw new Error("Unrecognized "+s[0]+" in clrScheme")}})}function VH(){}function HH(){}var $H=/<a:clrScheme([^>]*)>[\s\S]*<\/a:clrScheme>/,zH=/<a:fontScheme([^>]*)>[\s\S]*<\/a:fontScheme>/,WH=/<a:fmtScheme([^>]*)>[\s\S]*<\/a:fmtScheme>/;function GH(e,t,n){t.themeElements={};var r;[["clrScheme",$H,UH],["fontScheme",zH,VH],["fmtScheme",WH,HH]].forEach(function(i){if(!(r=e.match(i[1])))throw new Error(i[0]+" not found in themeElements");i[2](r,t,n)})}var qH=/<a:themeElements([^>]*)>[\s\S]*<\/a:themeElements>/;function fD(e,t){(!e||e.length===0)&&(e=K1());var n,r={};if(!(n=e.match(qH)))throw new Error("themeElements not found in theme");return GH(n[0],r,t),r.raw=e,r}function K1(e,t){if(t&&t.themeXLSX)return t.themeXLSX;if(e&&typeof e.raw=="string")return e.raw;var n=[En];return n[n.length]='<a:theme xmlns:a="http://schemas.openxmlformats.org/drawingml/2006/main" name="Office Theme">',n[n.length]="<a:themeElements>",n[n.length]='<a:clrScheme name="Office">',n[n.length]='<a:dk1><a:sysClr val="windowText" lastClr="000000"/></a:dk1>',n[n.length]='<a:lt1><a:sysClr val="window" lastClr="FFFFFF"/></a:lt1>',n[n.length]='<a:dk2><a:srgbClr val="1F497D"/></a:dk2>',n[n.length]='<a:lt2><a:srgbClr val="EEECE1"/></a:lt2>',n[n.length]='<a:accent1><a:srgbClr val="4F81BD"/></a:accent1>',n[n.length]='<a:accent2><a:srgbClr val="C0504D"/></a:accent2>',n[n.length]='<a:accent3><a:srgbClr val="9BBB59"/></a:accent3>',n[n.length]='<a:accent4><a:srgbClr val="8064A2"/></a:accent4>',n[n.length]='<a:accent5><a:srgbClr val="4BACC6"/></a:accent5>',n[n.length]='<a:accent6><a:srgbClr val="F79646"/></a:accent6>',n[n.length]='<a:hlink><a:srgbClr val="0000FF"/></a:hlink>',n[n.length]='<a:folHlink><a:srgbClr val="800080"/></a:folHlink>',n[n.length]="</a:clrScheme>",n[n.length]='<a:fontScheme name="Office">',n[n.length]="<a:majorFont>",n[n.length]='<a:latin typeface="Cambria"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Times New Roman"/>',n[n.length]='<a:font script="Hebr" typeface="Times New Roman"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="MoolBoran"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Times New Roman"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:majorFont>",n[n.length]="<a:minorFont>",n[n.length]='<a:latin typeface="Calibri"/>',n[n.length]='<a:ea typeface=""/>',n[n.length]='<a:cs typeface=""/>',n[n.length]='<a:font script="Jpan" typeface=" "/>',n[n.length]='<a:font script="Hang" typeface=" "/>',n[n.length]='<a:font script="Hans" typeface=""/>',n[n.length]='<a:font script="Hant" typeface=""/>',n[n.length]='<a:font script="Arab" typeface="Arial"/>',n[n.length]='<a:font script="Hebr" typeface="Arial"/>',n[n.length]='<a:font script="Thai" typeface="Tahoma"/>',n[n.length]='<a:font script="Ethi" typeface="Nyala"/>',n[n.length]='<a:font script="Beng" typeface="Vrinda"/>',n[n.length]='<a:font script="Gujr" typeface="Shruti"/>',n[n.length]='<a:font script="Khmr" typeface="DaunPenh"/>',n[n.length]='<a:font script="Knda" typeface="Tunga"/>',n[n.length]='<a:font script="Guru" typeface="Raavi"/>',n[n.length]='<a:font script="Cans" typeface="Euphemia"/>',n[n.length]='<a:font script="Cher" typeface="Plantagenet Cherokee"/>',n[n.length]='<a:font script="Yiii" typeface="Microsoft Yi Baiti"/>',n[n.length]='<a:font script="Tibt" typeface="Microsoft Himalaya"/>',n[n.length]='<a:font script="Thaa" typeface="MV Boli"/>',n[n.length]='<a:font script="Deva" typeface="Mangal"/>',n[n.length]='<a:font script="Telu" typeface="Gautami"/>',n[n.length]='<a:font script="Taml" typeface="Latha"/>',n[n.length]='<a:font script="Syrc" typeface="Estrangelo Edessa"/>',n[n.length]='<a:font script="Orya" typeface="Kalinga"/>',n[n.length]='<a:font script="Mlym" typeface="Kartika"/>',n[n.length]='<a:font script="Laoo" typeface="DokChampa"/>',n[n.length]='<a:font script="Sinh" typeface="Iskoola Pota"/>',n[n.length]='<a:font script="Mong" typeface="Mongolian Baiti"/>',n[n.length]='<a:font script="Viet" typeface="Arial"/>',n[n.length]='<a:font script="Uigh" typeface="Microsoft Uighur"/>',n[n.length]='<a:font script="Geor" typeface="Sylfaen"/>',n[n.length]="</a:minorFont>",n[n.length]="</a:fontScheme>",n[n.length]='<a:fmtScheme name="Office">',n[n.length]="<a:fillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="50000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="35000"><a:schemeClr val="phClr"><a:tint val="37000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="15000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="1"/>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="100000"/><a:shade val="100000"/><a:satMod val="130000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:tint val="50000"/><a:shade val="100000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:lin ang="16200000" scaled="0"/>',n[n.length]="</a:gradFill>",n[n.length]="</a:fillStyleLst>",n[n.length]="<a:lnStyleLst>",n[n.length]='<a:ln w="9525" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"><a:shade val="95000"/><a:satMod val="105000"/></a:schemeClr></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="25400" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]='<a:ln w="38100" cap="flat" cmpd="sng" algn="ctr"><a:solidFill><a:schemeClr val="phClr"/></a:solidFill><a:prstDash val="solid"/></a:ln>',n[n.length]="</a:lnStyleLst>",n[n.length]="<a:effectStyleLst>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="20000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="38000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]="</a:effectStyle>",n[n.length]="<a:effectStyle>",n[n.length]="<a:effectLst>",n[n.length]='<a:outerShdw blurRad="40000" dist="23000" dir="5400000" rotWithShape="0"><a:srgbClr val="000000"><a:alpha val="35000"/></a:srgbClr></a:outerShdw>',n[n.length]="</a:effectLst>",n[n.length]='<a:scene3d><a:camera prst="orthographicFront"><a:rot lat="0" lon="0" rev="0"/></a:camera><a:lightRig rig="threePt" dir="t"><a:rot lat="0" lon="0" rev="1200000"/></a:lightRig></a:scene3d>',n[n.length]='<a:sp3d><a:bevelT w="63500" h="25400"/></a:sp3d>',n[n.length]="</a:effectStyle>",n[n.length]="</a:effectStyleLst>",n[n.length]="<a:bgFillStyleLst>",n[n.length]='<a:solidFill><a:schemeClr val="phClr"/></a:solidFill>',n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="40000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="40000"><a:schemeClr val="phClr"><a:tint val="45000"/><a:shade val="99000"/><a:satMod val="350000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="20000"/><a:satMod val="255000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="-80000" r="50000" b="180000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]='<a:gradFill rotWithShape="1">',n[n.length]="<a:gsLst>",n[n.length]='<a:gs pos="0"><a:schemeClr val="phClr"><a:tint val="80000"/><a:satMod val="300000"/></a:schemeClr></a:gs>',n[n.length]='<a:gs pos="100000"><a:schemeClr val="phClr"><a:shade val="30000"/><a:satMod val="200000"/></a:schemeClr></a:gs>',n[n.length]="</a:gsLst>",n[n.length]='<a:path path="circle"><a:fillToRect l="50000" t="50000" r="50000" b="50000"/></a:path>',n[n.length]="</a:gradFill>",n[n.length]="</a:bgFillStyleLst>",n[n.length]="</a:fmtScheme>",n[n.length]="</a:themeElements>",n[n.length]="<a:objectDefaults>",n[n.length]="<a:spDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="1"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="3"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="2"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="lt1"/></a:fontRef></a:style>',n[n.length]="</a:spDef>",n[n.length]="<a:lnDef>",n[n.length]='<a:spPr/><a:bodyPr/><a:lstStyle/><a:style><a:lnRef idx="2"><a:schemeClr val="accent1"/></a:lnRef><a:fillRef idx="0"><a:schemeClr val="accent1"/></a:fillRef><a:effectRef idx="1"><a:schemeClr val="accent1"/></a:effectRef><a:fontRef idx="minor"><a:schemeClr val="tx1"/></a:fontRef></a:style>',n[n.length]="</a:lnDef>",n[n.length]="</a:objectDefaults>",n[n.length]="<a:extraClrSchemeLst/>",n[n.length]="</a:theme>",n.join("")}function KH(e,t,n){var r=e.l+t,i=e.read_shift(4);if(i!==124226){if(!n.cellStyles){e.l=r;return}var s=e.slice(e.l);e.l=r;var a;try{a=rF(s,{type:"array"})}catch{return}var o=qr(a,"theme/theme/theme1.xml",!0);if(o)return fD(o,n)}}function YH(e){return e.read_shift(4)}function XH(e){var t={};switch(t.xclrType=e.read_shift(2),t.nTintShade=e.read_shift(2),t.xclrType){case 0:e.l+=4;break;case 1:t.xclrValue=JH(e,4);break;case 2:t.xclrValue=WF(e);break;case 3:t.xclrValue=YH(e);break;case 4:e.l+=4;break}return e.l+=8,t}function JH(e,t){return mr(e,t)}function QH(e,t){return mr(e,t)}function jH(e){var t=e.read_shift(2),n=e.read_shift(2)-4,r=[t];switch(t){case 4:case 5:case 7:case 8:case 9:case 10:case 11:case 13:r[1]=XH(e);break;case 6:r[1]=QH(e,n);break;case 14:case 15:r[1]=e.read_shift(n===1?1:2);break;default:throw new Error("Unrecognized ExtProp type: "+t+" "+n)}return r}function ZH(e,t){var n=e.l+t;e.l+=2;var r=e.read_shift(2);e.l+=2;for(var i=e.read_shift(2),s=[];i-- >0;)s.push(jH(e,n-e.l));return{ixfe:r,ext:s}}function e$(e,t){t.forEach(function(n){switch(n[0]){}})}function t$(e,t){return{flags:e.read_shift(4),version:e.read_shift(4),name:hr(e)}}function n$(e){var t=me(12+2*e.name.length);return t.write_shift(4,e.flags),t.write_shift(4,e.version),$n(e.name,t),t.slice(0,t.l)}function r$(e){for(var t=[],n=e.read_shift(4);n-- >0;)t.push([e.read_shift(4),e.read_shift(4)]);return t}function i$(e){var t=me(4+8*e.length);t.write_shift(4,e.length);for(var n=0;n<e.length;++n)t.write_shift(4,e[n][0]),t.write_shift(4,e[n][1]);return t}function s$(e,t){var n=me(8+2*t.length);return n.write_shift(4,e),$n(t,n),n.slice(0,n.l)}function a$(e){return e.l+=4,e.read_shift(4)!=0}function o$(e,t){var n=me(8);return n.write_shift(4,e),n.write_shift(4,1),n}function l$(e,t,n){var r={Types:[],Cell:[],Value:[]},i=n||{},s=[],a=!1,o=2;return zs(e,function(l,u,c){switch(c){case 335:r.Types.push({name:l.name});break;case 51:l.forEach(function(h){o==1?r.Cell.push({type:r.Types[h[0]-1].name,index:h[1]}):o==0&&r.Value.push({type:r.Types[h[0]-1].name,index:h[1]})});break;case 337:o=l?1:0;break;case 338:o=2;break;case 35:s.push(c),a=!0;break;case 36:s.pop(),a=!1;break;default:if(!u.T){if(!a||i.WTF&&s[s.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}}),r}function u$(){var e=Or();return _e(e,332),_e(e,334,Hi(1)),_e(e,335,n$({name:"XLDAPR",version:12e4,flags:3496657072})),_e(e,336),_e(e,339,s$(1,"XLDAPR")),_e(e,52),_e(e,35,Hi(514)),_e(e,4096,Hi(0)),_e(e,4097,di(1)),_e(e,36),_e(e,53),_e(e,340),_e(e,337,o$(1)),_e(e,51,i$([[1,0]])),_e(e,338),_e(e,333),e.end()}function c$(e,t,n){var r={Types:[],Cell:[],Value:[]};if(!e)return r;var i=!1,s=2,a;return e.replace(gr,function(o){var l=it(o);switch(hs(l[0])){case"<?xml":break;case"<metadata":case"</metadata>":break;case"<metadataTypes":case"</metadataTypes>":break;case"<metadataType":r.Types.push({name:l.name});break;case"</metadataType>":break;case"<futureMetadata":for(var u=0;u<r.Types.length;++u)r.Types[u].name==l.name&&(a=r.Types[u]);break;case"</futureMetadata>":break;case"<bk>":break;case"</bk>":break;case"<rc":s==1?r.Cell.push({type:r.Types[l.t-1].name,index:+l.v}):s==0&&r.Value.push({type:r.Types[l.t-1].name,index:+l.v});break;case"</rc>":break;case"<cellMetadata":s=1;break;case"</cellMetadata>":s=2;break;case"<valueMetadata":s=0;break;case"</valueMetadata>":s=2;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":i=!0;break;case"</ext>":i=!1;break;case"<rvb":if(!a)break;a.offsets||(a.offsets=[]),a.offsets.push(+l.i);break;default:if(!i&&n.WTF)throw new Error("unrecognized "+l[0]+" in metadata")}return o}),r}function dD(){var e=[En];return e.push(`<metadata xmlns="http://schemas.openxmlformats.org/spreadsheetml/2006/main" xmlns:xlrd="http://schemas.microsoft.com/office/spreadsheetml/2017/richdata" xmlns:xda="http://schemas.microsoft.com/office/spreadsheetml/2017/dynamicarray">
  <metadataTypes count="1">
    <metadataType name="XLDAPR" minSupportedVersion="120000" copy="1" pasteAll="1" pasteValues="1" merge="1" splitFirst="1" rowColShift="1" clearFormats="1" clearComments="1" assign="1" coerce="1" cellMeta="1"/>
  </metadataTypes>
  <futureMetadata name="XLDAPR" count="1">
    <bk>
      <extLst>
        <ext uri="{bdbb8cdc-fa1e-496e-a857-3c3f30c029c3}">
          <xda:dynamicArrayProperties fDynamic="1" fCollapsed="0"/>
        </ext>
      </extLst>
    </bk>
  </futureMetadata>
  <cellMetadata count="1">
    <bk>
      <rc t="1" v="0"/>
    </bk>
  </cellMetadata>
</metadata>`),e.join("")}function f$(e){var t=[];if(!e)return t;var n=1;return(e.match(gr)||[]).forEach(function(r){var i=it(r);switch(i[0]){case"<?xml":break;case"<calcChain":case"<calcChain>":case"</calcChain>":break;case"<c":delete i[0],i.i?n=i.i:i.i=n,t.push(i);break}}),t}function d$(e){var t={};t.i=e.read_shift(4);var n={};n.r=e.read_shift(4),n.c=e.read_shift(4),t.r=nt(n);var r=e.read_shift(1);return r&2&&(t.l="1"),r&8&&(t.a="1"),t}function h$(e,t,n){var r=[];return zs(e,function(s,a,o){switch(o){case 63:r.push(s);break;default:if(!a.T)throw new Error("Unexpected record 0x"+o.toString(16))}}),r}function p$(e,t,n,r){if(!e)return e;var i=r||{},s=!1;zs(e,function(o,l,u){switch(u){case 359:case 363:case 364:case 366:case 367:case 368:case 369:case 370:case 371:case 472:case 577:case 578:case 579:case 580:case 581:case 582:case 583:case 584:case 585:case 586:case 587:break;case 35:s=!0;break;case 36:s=!1;break;default:if(!l.T){if(!s||i.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}},i)}function m$(e,t){if(!e)return"??";var n=(e.match(/<c:chart [^>]*r:id="([^"]*)"/)||["",""])[1];return t["!id"][n].Target}var Ml=1024;function hD(e,t){for(var n=[21600,21600],r=["m0,0l0",n[1],n[0],n[1],n[0],"0xe"].join(","),i=[Pe("xml",null,{"xmlns:v":zr.v,"xmlns:o":zr.o,"xmlns:x":zr.x,"xmlns:mv":zr.mv}).replace(/\/>/,">"),Pe("o:shapelayout",Pe("o:idmap",null,{"v:ext":"edit",data:e}),{"v:ext":"edit"}),Pe("v:shapetype",[Pe("v:stroke",null,{joinstyle:"miter"}),Pe("v:path",null,{gradientshapeok:"t","o:connecttype":"rect"})].join(""),{id:"_x0000_t202","o:spt":202,coordsize:n.join(","),path:r})];Ml<e*1e3;)Ml+=1e3;return t.forEach(function(s){var a=ln(s[0]),o={color2:"#BEFF82",type:"gradient"};o.type=="gradient"&&(o.angle="-180");var l=o.type=="gradient"?Pe("o:fill",null,{type:"gradientUnscaled","v:ext":"view"}):null,u=Pe("v:fill",l,o),c={on:"t",obscured:"t"};++Ml,i=i.concat(["<v:shape"+pf({id:"_x0000_s"+Ml,type:"#_x0000_t202",style:"position:absolute; margin-left:80pt;margin-top:5pt;width:104pt;height:64pt;z-index:10"+(s[1].hidden?";visibility:hidden":""),fillcolor:"#ECFAD4",strokecolor:"#edeaa1"})+">",u,Pe("v:shadow",null,c),Pe("v:path",null,{"o:connecttype":"none"}),'<v:textbox><div style="text-align:left"></div></v:textbox>','<x:ClientData ObjectType="Note">',"<x:MoveWithCells/>","<x:SizeWithCells/>",Qn("x:Anchor",[a.c+1,0,a.r+1,0,a.c+3,20,a.r+5,20].join(",")),Qn("x:AutoFill","False"),Qn("x:Row",String(a.r)),Qn("x:Column",String(a.c)),s[1].hidden?"":"<x:Visible/>","</x:ClientData>","</v:shape>"])}),i.push("</xml>"),i.join("")}function CE(e,t,n,r){var i=Array.isArray(e),s;t.forEach(function(a){var o=ln(a.ref);if(i?(e[o.r]||(e[o.r]=[]),s=e[o.r][o.c]):s=e[a.ref],!s){s={t:"z"},i?e[o.r][o.c]=s:e[a.ref]=s;var l=At(e["!ref"]||"BDWGO1000001:A1");l.s.r>o.r&&(l.s.r=o.r),l.e.r<o.r&&(l.e.r=o.r),l.s.c>o.c&&(l.s.c=o.c),l.e.c<o.c&&(l.e.c=o.c);var u=lt(l);u!==e["!ref"]&&(e["!ref"]=u)}s.c||(s.c=[]);var c={a:a.author,t:a.t,r:a.r,T:n};a.h&&(c.h=a.h);for(var h=s.c.length-1;h>=0;--h){if(!n&&s.c[h].T)return;n&&!s.c[h].T&&s.c.splice(h,1)}if(n&&r){for(h=0;h<r.length;++h)if(c.a==r[h].id){c.a=r[h].name||c.a;break}}s.c.push(c)})}function g$(e,t){if(e.match(/<(?:\w+:)?comments *\/>/))return[];var n=[],r=[],i=e.match(/<(?:\w+:)?authors>([\s\S]*)<\/(?:\w+:)?authors>/);i&&i[1]&&i[1].split(/<\/\w*:?author>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?author[^>]*>(.*)/);o&&n.push(o[1])}});var s=e.match(/<(?:\w+:)?commentList>([\s\S]*)<\/(?:\w+:)?commentList>/);return s&&s[1]&&s[1].split(/<\/\w*:?comment>/).forEach(function(a){if(!(a===""||a.trim()==="")){var o=a.match(/<(?:\w+:)?comment[^>]*>/);if(o){var l=it(o[0]),u={author:l.authorId&&n[l.authorId]||"sheetjsghost",ref:l.ref,guid:l.guid},c=ln(l.ref);if(!(t.sheetRows&&t.sheetRows<=c.r)){var h=a.match(/<(?:\w+:)?text>([\s\S]*)<\/(?:\w+:)?text>/),p=!!h&&!!h[1]&&W1(h[1])||{r:"",t:"",h:""};u.r=p.r,p.r=="<t></t>"&&(p.t=p.h=""),u.t=(p.t||"").replace(/\r\n/g,`
`).replace(/\r/g,`
`),t.cellHTML&&(u.h=p.h),r.push(u)}}}}),r}function pD(e){var t=[En,Pe("comments",null,{xmlns:Yo[0]})],n=[];return t.push("<authors>"),e.forEach(function(r){r[1].forEach(function(i){var s=$t(i.a);n.indexOf(s)==-1&&(n.push(s),t.push("<author>"+s+"</author>")),i.T&&i.ID&&n.indexOf("tc="+i.ID)==-1&&(n.push("tc="+i.ID),t.push("<author>tc="+i.ID+"</author>"))})}),n.length==0&&(n.push("SheetJ5"),t.push("<author>SheetJ5</author>")),t.push("</authors>"),t.push("<commentList>"),e.forEach(function(r){var i=0,s=[];if(r[1][0]&&r[1][0].T&&r[1][0].ID?i=n.indexOf("tc="+r[1][0].ID):r[1].forEach(function(l){l.a&&(i=n.indexOf($t(l.a))),s.push(l.t||"")}),t.push('<comment ref="'+r[0]+'" authorId="'+i+'"><text>'),s.length<=1)t.push(Qn("t",$t(s[0]||"")));else{for(var a=`Comment:
    `+s[0]+`
`,o=1;o<s.length;++o)a+=`Reply:
    `+s[o]+`
`;t.push(Qn("t",$t(a)))}t.push("</text></comment>")}),t.push("</commentList>"),t.length>2&&(t[t.length]="</comments>",t[1]=t[1].replace("/>",">")),t.join("")}function v$(e,t){var n=[],r=!1,i={},s=0;return e.replace(gr,function(o,l){var u=it(o);switch(hs(u[0])){case"<?xml":break;case"<ThreadedComments":break;case"</ThreadedComments>":break;case"<threadedComment":i={author:u.personId,guid:u.id,ref:u.ref,T:1};break;case"</threadedComment>":i.t!=null&&n.push(i);break;case"<text>":case"<text":s=l+o.length;break;case"</text>":i.t=e.slice(s,l).replace(/\r\n/g,`
`).replace(/\r/g,`
`);break;case"<mentions":case"<mentions>":r=!0;break;case"</mentions>":r=!1;break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+u[0]+" in threaded comments")}return o}),n}function x$(e,t,n){var r=[En,Pe("ThreadedComments",null,{xmlns:Pn.TCMNT}).replace(/[\/]>/,">")];return e.forEach(function(i){var s="";(i[1]||[]).forEach(function(a,o){if(!a.T){delete a.ID;return}a.a&&t.indexOf(a.a)==-1&&t.push(a.a);var l={ref:i[0],id:"{54EE7951-7262-4200-6969-"+("000000000000"+n.tcid++).slice(-12)+"}"};o==0?s=l.id:l.parentId=s,a.ID=l.id,a.a&&(l.personId="{54EE7950-7262-4200-6969-"+("000000000000"+t.indexOf(a.a)).slice(-12)+"}"),r.push(Pe("threadedComment",Qn("text",a.t||""),l))})}),r.push("</ThreadedComments>"),r.join("")}function y$(e,t){var n=[],r=!1;return e.replace(gr,function(s){var a=it(s);switch(hs(a[0])){case"<?xml":break;case"<personList":break;case"</personList>":break;case"<person":n.push({name:a.displayname,id:a.id});break;case"</person>":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;default:if(!r&&t.WTF)throw new Error("unrecognized "+a[0]+" in threaded comments")}return s}),n}function w$(e){var t=[En,Pe("personList",null,{xmlns:Pn.TCMNT,"xmlns:x":Yo[0]}).replace(/[\/]>/,">")];return e.forEach(function(n,r){t.push(Pe("person",null,{displayName:n,id:"{54EE7950-7262-4200-6969-"+("000000000000"+r).slice(-12)+"}",userId:n,providerId:"None"}))}),t.push("</personList>"),t.join("")}function T$(e){var t={};t.iauthor=e.read_shift(4);var n=jo(e);return t.rfx=n.s,t.ref=nt(n.s),e.l+=16,t}function S$(e,t){return t==null&&(t=me(36)),t.write_shift(4,e[1].iauthor),Mu(e[0],t),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t.write_shift(4,0),t}var E$=hr;function _$(e){return $n(e.slice(0,54))}function C$(e,t){var n=[],r=[],i={},s=!1;return zs(e,function(o,l,u){switch(u){case 632:r.push(o);break;case 635:i=o;break;case 637:i.t=o.t,i.h=o.h,i.r=o.r;break;case 636:if(i.author=r[i.iauthor],delete i.iauthor,t.sheetRows&&i.rfx&&t.sheetRows<=i.rfx.r)break;i.t||(i.t=""),delete i.rfx,n.push(i);break;case 3072:break;case 35:s=!0;break;case 36:s=!1;break;case 37:break;case 38:break;default:if(!l.T){if(!s||t.WTF)throw new Error("Unexpected record 0x"+u.toString(16))}}}),n}function k$(e){var t=Or(),n=[];return _e(t,628),_e(t,630),e.forEach(function(r){r[1].forEach(function(i){n.indexOf(i.a)>-1||(n.push(i.a.slice(0,54)),_e(t,632,_$(i.a)))})}),_e(t,631),_e(t,633),e.forEach(function(r){r[1].forEach(function(i){i.iauthor=n.indexOf(i.a);var s={s:ln(r[0]),e:ln(r[0])};_e(t,635,S$([s,i])),i.t&&i.t.length>0&&_e(t,637,YU(i)),_e(t,636),delete i.iauthor})}),_e(t,634),_e(t,629),t.end()}var A$="application/vnd.ms-office.vbaProject";function R$(e){var t=Ke.utils.cfb_new({root:"R"});return e.FullPaths.forEach(function(n,r){if(!(n.slice(-1)==="/"||!n.match(/_VBA_PROJECT_CUR/))){var i=n.replace(/^[^\/]*/,"R").replace(/\/_VBA_PROJECT_CUR\u0000*/,"");Ke.utils.cfb_add(t,i,e.FileIndex[r].content)}}),Ke.write(t)}function M$(e,t){t.FullPaths.forEach(function(n,r){if(r!=0){var i=n.replace(/[^\/]*[\/]/,"/_VBA_PROJECT_CUR/");i.slice(-1)!=="/"&&Ke.utils.cfb_add(e,i,t.FileIndex[r].content)}})}var mD=["xlsb","xlsm","xlam","biff8","xla"];function F$(){return{"!type":"dialog"}}function D$(){return{"!type":"dialog"}}function P$(){return{"!type":"macro"}}function I$(){return{"!type":"macro"}}var Vl=function(){var e=/(^|[^A-Za-z_])R(\[?-?\d+\]|[1-9]\d*|)C(\[?-?\d+\]|[1-9]\d*|)(?![A-Za-z0-9_])/g,t={r:0,c:0};function n(r,i,s,a){var o=!1,l=!1;s.length==0?l=!0:s.charAt(0)=="["&&(l=!0,s=s.slice(1,-1)),a.length==0?o=!0:a.charAt(0)=="["&&(o=!0,a=a.slice(1,-1));var u=s.length>0?parseInt(s,10)|0:0,c=a.length>0?parseInt(a,10)|0:0;return o?c+=t.c:--c,l?u+=t.r:--u,i+(o?"":"$")+on(c)+(l?"":"$")+Sn(u)}return function(i,s){return t=s,i.replace(e,n)}}(),Y1=/(^|[^._A-Z0-9])([$]?)([A-Z]{1,2}|[A-W][A-Z]{2}|X[A-E][A-Z]|XF[A-D])([$]?)(10[0-3]\d{4}|104[0-7]\d{3}|1048[0-4]\d{2}|10485[0-6]\d|104857[0-6]|[1-9]\d{0,5})(?![_.\(A-Za-z0-9])/g,X1=function(){return function(t,n){return t.replace(Y1,function(r,i,s,a,o,l){var u=b1(a)-(s?0:n.c),c=N1(l)-(o?0:n.r),h=c==0?"":o?c+1:"["+c+"]",p=u==0?"":s?u+1:"["+u+"]";return i+"R"+h+"C"+p})}}();function gD(e,t){return e.replace(Y1,function(n,r,i,s,a,o){return r+(i=="$"?i+s:on(b1(s)+t.c))+(a=="$"?a+o:Sn(N1(o)+t.r))})}function N$(e,t,n){var r=Br(t),i=r.s,s=ln(n),a={r:s.r-i.r,c:s.c-i.c};return gD(e,a)}function b$(e){return e.length!=1}function kE(e){return e.replace(/_xlfn\./g,"")}function _n(e){e.l+=1}function La(e,t){var n=e.read_shift(2);return[n&16383,n>>14&1,n>>15&1]}function vD(e,t,n){var r=2;if(n){if(n.biff>=2&&n.biff<=5)return xD(e);n.biff==12&&(r=4)}var i=e.read_shift(r),s=e.read_shift(r),a=La(e),o=La(e);return{s:{r:i,c:a[0],cRel:a[1],rRel:a[2]},e:{r:s,c:o[0],cRel:o[1],rRel:o[2]}}}function xD(e){var t=La(e),n=La(e),r=e.read_shift(1),i=e.read_shift(1);return{s:{r:t[0],c:r,cRel:t[1],rRel:t[2]},e:{r:n[0],c:i,cRel:n[1],rRel:n[2]}}}function L$(e,t,n){if(n.biff<8)return xD(e);var r=e.read_shift(n.biff==12?4:2),i=e.read_shift(n.biff==12?4:2),s=La(e),a=La(e);return{s:{r,c:s[0],cRel:s[1],rRel:s[2]},e:{r:i,c:a[0],cRel:a[1],rRel:a[2]}}}function yD(e,t,n){if(n&&n.biff>=2&&n.biff<=5)return O$(e);var r=e.read_shift(n&&n.biff==12?4:2),i=La(e);return{r,c:i[0],cRel:i[1],rRel:i[2]}}function O$(e){var t=La(e),n=e.read_shift(1);return{r:t[0],c:n,cRel:t[1],rRel:t[2]}}function B$(e){var t=e.read_shift(2),n=e.read_shift(2);return{r:t,c:n&255,fQuoted:!!(n&16384),cRel:n>>15,rRel:n>>15}}function U$(e,t,n){var r=n&&n.biff?n.biff:8;if(r>=2&&r<=5)return V$(e);var i=e.read_shift(r>=12?4:2),s=e.read_shift(2),a=(s&16384)>>14,o=(s&32768)>>15;if(s&=16383,o==1)for(;i>524287;)i-=1048576;if(a==1)for(;s>8191;)s=s-16384;return{r:i,c:s,cRel:a,rRel:o}}function V$(e){var t=e.read_shift(2),n=e.read_shift(1),r=(t&32768)>>15,i=(t&16384)>>14;return t&=16383,r==1&&t>=8192&&(t=t-16384),i==1&&n>=128&&(n=n-256),{r:t,c:n,cRel:i,rRel:r}}function H$(e,t,n){var r=(e[e.l++]&96)>>5,i=vD(e,n.biff>=2&&n.biff<=5?6:8,n);return[r,i]}function $$(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2,"i"),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}var a=vD(e,s,n);return[r,i,a]}function z$(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n&&n.biff>8?12:n.biff<8?6:8,[r]}function W$(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=8;if(n)switch(n.biff){case 5:e.l+=12,s=6;break;case 12:s=12;break}return e.l+=s,[r,i]}function G$(e,t,n){var r=(e[e.l++]&96)>>5,i=L$(e,t-1,n);return[r,i]}function q$(e,t,n){var r=(e[e.l++]&96)>>5;return e.l+=n.biff==2?6:n.biff==12?14:7,[r]}function AE(e){var t=e[e.l+1]&1,n=1;return e.l+=4,[t,n]}function K$(e,t,n){e.l+=2;for(var r=e.read_shift(n&&n.biff==2?1:2),i=[],s=0;s<=r;++s)i.push(e.read_shift(n&&n.biff==2?1:2));return i}function Y$(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function X$(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=2,[r,e.read_shift(n&&n.biff==2?1:2)]}function J$(e){var t=e[e.l+1]&255?1:0;return e.l+=2,[t,e.read_shift(2)]}function Q$(e,t,n){var r=e[e.l+1]&255?1:0;return e.l+=n&&n.biff==2?3:4,[r]}function wD(e){var t=e.read_shift(1),n=e.read_shift(1);return[t,n]}function j$(e){return e.read_shift(2),wD(e)}function Z$(e){return e.read_shift(2),wD(e)}function ez(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=yD(e,0,n);return[r,i]}function tz(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=U$(e,0,n);return[r,i]}function nz(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(2);n&&n.biff==5&&(e.l+=12);var s=yD(e,0,n);return[r,i,s]}function rz(e,t,n){var r=(e[e.l]&96)>>5;e.l+=1;var i=e.read_shift(n&&n.biff<=3?1:2);return[aW[i],ED[i],r]}function iz(e,t,n){var r=e[e.l++],i=e.read_shift(1),s=n&&n.biff<=3?[r==88?-1:0,e.read_shift(1)]:sz(e);return[i,(s[0]===0?ED:sW)[s[1]]]}function sz(e){return[e[e.l+1]>>7,e.read_shift(2)&32767]}function az(e,t,n){e.l+=n&&n.biff==2?3:4}function oz(e,t,n){if(e.l++,n&&n.biff==12)return[e.read_shift(4,"i"),0];var r=e.read_shift(2),i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function lz(e){return e.l++,Ws[e.read_shift(1)]}function uz(e){return e.l++,e.read_shift(2)}function cz(e){return e.l++,e.read_shift(1)!==0}function fz(e){return e.l++,ur(e)}function dz(e,t,n){return e.l++,Kf(e,t-1,n)}function hz(e,t){var n=[e.read_shift(1)];if(t==12)switch(n[0]){case 2:n[0]=4;break;case 4:n[0]=16;break;case 0:n[0]=1;break;case 1:n[0]=2;break}switch(n[0]){case 4:n[1]=yn(e,1)?"TRUE":"FALSE",t!=12&&(e.l+=7);break;case 37:case 16:n[1]=Ws[e[e.l]],e.l+=t==12?4:8;break;case 0:e.l+=8;break;case 1:n[1]=ur(e);break;case 2:n[1]=Zo(e,0,{biff:t>0&&t<8?2:t});break;default:throw new Error("Bad SerAr: "+n[0])}return n}function pz(e,t,n){for(var r=e.read_shift(n.biff==12?4:2),i=[],s=0;s!=r;++s)i.push((n.biff==12?jo:tp)(e));return i}function mz(e,t,n){var r=0,i=0;n.biff==12?(r=e.read_shift(4),i=e.read_shift(4)):(i=1+e.read_shift(1),r=1+e.read_shift(2)),n.biff>=2&&n.biff<8&&(--r,--i==0&&(i=256));for(var s=0,a=[];s!=r&&(a[s]=[]);++s)for(var o=0;o!=i;++o)a[s][o]=hz(e,n.biff);return a}function gz(e,t,n){var r=e.read_shift(1)>>>5&3,i=!n||n.biff>=8?4:2,s=e.read_shift(i);switch(n.biff){case 2:e.l+=5;break;case 3:case 4:e.l+=8;break;case 5:e.l+=12;break}return[r,0,s]}function vz(e,t,n){if(n.biff==5)return xz(e);var r=e.read_shift(1)>>>5&3,i=e.read_shift(2),s=e.read_shift(4);return[r,i,s]}function xz(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2,"i");e.l+=8;var r=e.read_shift(2);return e.l+=12,[t,n,r]}function yz(e,t,n){var r=e.read_shift(1)>>>5&3;e.l+=n&&n.biff==2?3:4;var i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function wz(e,t,n){var r=e.read_shift(1)>>>5&3,i=e.read_shift(n&&n.biff==2?1:2);return[r,i]}function Tz(e,t,n){var r=e.read_shift(1)>>>5&3;return e.l+=4,n.biff<8&&e.l--,n.biff==12&&(e.l+=2),[r]}function Sz(e,t,n){var r=(e[e.l++]&96)>>5,i=e.read_shift(2),s=4;if(n)switch(n.biff){case 5:s=15;break;case 12:s=6;break}return e.l+=s,[r,i]}var Ez=mr,_z=mr,Cz=mr;function Xf(e,t,n){return e.l+=2,[B$(e)]}function J1(e){return e.l+=6,[]}var kz=Xf,Az=J1,Rz=J1,Mz=Xf;function TD(e){return e.l+=2,[kn(e),e.read_shift(2)&1]}var Fz=Xf,Dz=TD,Pz=J1,Iz=Xf,Nz=Xf,bz=["Data","All","Headers","??","?Data2","??","?DataHeaders","??","Totals","??","??","??","?DataTotals","??","??","??","?Current"];function Lz(e){e.l+=2;var t=e.read_shift(2),n=e.read_shift(2),r=e.read_shift(4),i=e.read_shift(2),s=e.read_shift(2),a=bz[n>>2&31];return{ixti:t,coltype:n&3,rt:a,idx:r,c:i,C:s}}function Oz(e){return e.l+=2,[e.read_shift(4)]}function Bz(e,t,n){return e.l+=5,e.l+=2,e.l+=n.biff==2?1:4,["PTGSHEET"]}function Uz(e,t,n){return e.l+=n.biff==2?4:5,["PTGENDSHEET"]}function Vz(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function Hz(e){var t=e.read_shift(1)>>>5&3,n=e.read_shift(2);return[t,n]}function $z(e){return e.l+=4,[0,0]}var RE={1:{n:"PtgExp",f:oz},2:{n:"PtgTbl",f:Cz},3:{n:"PtgAdd",f:_n},4:{n:"PtgSub",f:_n},5:{n:"PtgMul",f:_n},6:{n:"PtgDiv",f:_n},7:{n:"PtgPower",f:_n},8:{n:"PtgConcat",f:_n},9:{n:"PtgLt",f:_n},10:{n:"PtgLe",f:_n},11:{n:"PtgEq",f:_n},12:{n:"PtgGe",f:_n},13:{n:"PtgGt",f:_n},14:{n:"PtgNe",f:_n},15:{n:"PtgIsect",f:_n},16:{n:"PtgUnion",f:_n},17:{n:"PtgRange",f:_n},18:{n:"PtgUplus",f:_n},19:{n:"PtgUminus",f:_n},20:{n:"PtgPercent",f:_n},21:{n:"PtgParen",f:_n},22:{n:"PtgMissArg",f:_n},23:{n:"PtgStr",f:dz},26:{n:"PtgSheet",f:Bz},27:{n:"PtgEndSheet",f:Uz},28:{n:"PtgErr",f:lz},29:{n:"PtgBool",f:cz},30:{n:"PtgInt",f:uz},31:{n:"PtgNum",f:fz},32:{n:"PtgArray",f:q$},33:{n:"PtgFunc",f:rz},34:{n:"PtgFuncVar",f:iz},35:{n:"PtgName",f:gz},36:{n:"PtgRef",f:ez},37:{n:"PtgArea",f:H$},38:{n:"PtgMemArea",f:yz},39:{n:"PtgMemErr",f:Ez},40:{n:"PtgMemNoMem",f:_z},41:{n:"PtgMemFunc",f:wz},42:{n:"PtgRefErr",f:Tz},43:{n:"PtgAreaErr",f:z$},44:{n:"PtgRefN",f:tz},45:{n:"PtgAreaN",f:G$},46:{n:"PtgMemAreaN",f:Vz},47:{n:"PtgMemNoMemN",f:Hz},57:{n:"PtgNameX",f:vz},58:{n:"PtgRef3d",f:nz},59:{n:"PtgArea3d",f:$$},60:{n:"PtgRefErr3d",f:Sz},61:{n:"PtgAreaErr3d",f:W$},255:{}},zz={64:32,96:32,65:33,97:33,66:34,98:34,67:35,99:35,68:36,100:36,69:37,101:37,70:38,102:38,71:39,103:39,72:40,104:40,73:41,105:41,74:42,106:42,75:43,107:43,76:44,108:44,77:45,109:45,78:46,110:46,79:47,111:47,88:34,120:34,89:57,121:57,90:58,122:58,91:59,123:59,92:60,124:60,93:61,125:61},Wz={1:{n:"PtgElfLel",f:TD},2:{n:"PtgElfRw",f:Iz},3:{n:"PtgElfCol",f:kz},6:{n:"PtgElfRwV",f:Nz},7:{n:"PtgElfColV",f:Mz},10:{n:"PtgElfRadical",f:Fz},11:{n:"PtgElfRadicalS",f:Pz},13:{n:"PtgElfColS",f:Az},15:{n:"PtgElfColSV",f:Rz},16:{n:"PtgElfRadicalLel",f:Dz},25:{n:"PtgList",f:Lz},29:{n:"PtgSxName",f:Oz},255:{}},Gz={0:{n:"PtgAttrNoop",f:$z},1:{n:"PtgAttrSemi",f:Q$},2:{n:"PtgAttrIf",f:X$},4:{n:"PtgAttrChoose",f:K$},8:{n:"PtgAttrGoto",f:Y$},16:{n:"PtgAttrSum",f:az},32:{n:"PtgAttrBaxcel",f:AE},33:{n:"PtgAttrBaxcel",f:AE},64:{n:"PtgAttrSpace",f:j$},65:{n:"PtgAttrSpaceSemi",f:Z$},128:{n:"PtgAttrIfError",f:J$},255:{}};function Jf(e,t,n,r){if(r.biff<8)return mr(e,t);for(var i=e.l+t,s=[],a=0;a!==n.length;++a)switch(n[a][0]){case"PtgArray":n[a][1]=mz(e,0,r),s.push(n[a][1]);break;case"PtgMemArea":n[a][2]=pz(e,n[a][1],r),s.push(n[a][2]);break;case"PtgExp":r&&r.biff==12&&(n[a][1][1]=e.read_shift(4),s.push(n[a][1]));break;case"PtgList":case"PtgElfRadicalS":case"PtgElfColS":case"PtgElfColSV":throw"Unsupported "+n[a][0]}return t=i-e.l,t!==0&&s.push(mr(e,t)),s}function Qf(e,t,n){for(var r=e.l+t,i,s,a=[];r!=e.l;)t=r-e.l,s=e[e.l],i=RE[s]||RE[zz[s]],(s===24||s===25)&&(i=(s===24?Wz:Gz)[e[e.l+1]]),!i||!i.f?mr(e,t):a.push([i.n,i.f(e,t,n)]);return a}function qz(e){for(var t=[],n=0;n<e.length;++n){for(var r=e[n],i=[],s=0;s<r.length;++s){var a=r[s];if(a)switch(a[0]){case 2:i.push('"'+a[1].replace(/"/g,'""')+'"');break;default:i.push(a[1])}else i.push("")}t.push(i.join(","))}return t.join(";")}var Kz={PtgAdd:"+",PtgConcat:"&",PtgDiv:"/",PtgEq:"=",PtgGe:">=",PtgGt:">",PtgLe:"<=",PtgLt:"<",PtgMul:"*",PtgNe:"<>",PtgPower:"^",PtgSub:"-"};function Yz(e,t){if(!e&&!(t&&t.biff<=5&&t.biff>=2))throw new Error("empty sheet name");return/[^\w\u4E00-\u9FFF\u3040-\u30FF]/.test(e)?"'"+e+"'":e}function SD(e,t,n){if(!e)return"SH33TJSERR0";if(n.biff>8&&(!e.XTI||!e.XTI[t]))return e.SheetNames[t];if(!e.XTI)return"SH33TJSERR6";var r=e.XTI[t];if(n.biff<8)return t>1e4&&(t-=65536),t<0&&(t=-t),t==0?"":e.XTI[t-1];if(!r)return"SH33TJSERR1";var i="";if(n.biff>8)switch(e[r[0]][0]){case 357:return i=r[1]==-1?"#REF":e.SheetNames[r[1]],r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 358:return n.SID!=null?e.SheetNames[n.SID]:"SH33TJSSAME"+e[r[0]][0];case 355:default:return"SH33TJSSRC"+e[r[0]][0]}switch(e[r[0]][0][0]){case 1025:return i=r[1]==-1?"#REF":e.SheetNames[r[1]]||"SH33TJSERR3",r[1]==r[2]?i:i+":"+e.SheetNames[r[2]];case 14849:return e[r[0]].slice(1).map(function(s){return s.Name}).join(";;");default:return e[r[0]][0][3]?(i=r[1]==-1?"#REF":e[r[0]][0][3][r[1]]||"SH33TJSERR4",r[1]==r[2]?i:i+":"+e[r[0]][0][3][r[2]]):"SH33TJSERR2"}}function ME(e,t,n){var r=SD(e,t,n);return r=="#REF"?r:Yz(r,n)}function ar(e,t,n,r,i){var s=i&&i.biff||8,a={s:{c:0,r:0}},o=[],l,u,c,h=0,p=0,m,v="";if(!e[0]||!e[0][0])return"";for(var g=-1,w="",x=0,T=e[0].length;x<T;++x){var y=e[0][x];switch(y[0]){case"PtgUminus":o.push("-"+o.pop());break;case"PtgUplus":o.push("+"+o.pop());break;case"PtgPercent":o.push(o.pop()+"%");break;case"PtgAdd":case"PtgConcat":case"PtgDiv":case"PtgEq":case"PtgGe":case"PtgGt":case"PtgLe":case"PtgLt":case"PtgMul":case"PtgNe":case"PtgPower":case"PtgSub":if(l=o.pop(),u=o.pop(),g>=0){switch(e[0][g][1][0]){case 0:w=mn(" ",e[0][g][1][1]);break;case 1:w=mn("\r",e[0][g][1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}u=u+w,g=-1}o.push(u+Kz[y[0]]+l);break;case"PtgIsect":l=o.pop(),u=o.pop(),o.push(u+" "+l);break;case"PtgUnion":l=o.pop(),u=o.pop(),o.push(u+","+l);break;case"PtgRange":l=o.pop(),u=o.pop(),o.push(u+":"+l);break;case"PtgAttrChoose":break;case"PtgAttrGoto":break;case"PtgAttrIf":break;case"PtgAttrIfError":break;case"PtgRef":c=Ac(y[1][1],a,i),o.push(Rc(c,s));break;case"PtgRefN":c=n?Ac(y[1][1],n,i):y[1][1],o.push(Rc(c,s));break;case"PtgRef3d":h=y[1][1],c=Ac(y[1][2],a,i),v=ME(r,h,i),o.push(v+"!"+Rc(c,s));break;case"PtgFunc":case"PtgFuncVar":var _=y[1][0],k=y[1][1];_||(_=0),_&=127;var S=_==0?[]:o.slice(-_);o.length-=_,k==="User"&&(k=S.shift()),o.push(k+"("+S.join(",")+")");break;case"PtgBool":o.push(y[1]?"TRUE":"FALSE");break;case"PtgInt":o.push(y[1]);break;case"PtgNum":o.push(String(y[1]));break;case"PtgStr":o.push('"'+y[1].replace(/"/g,'""')+'"');break;case"PtgErr":o.push(y[1]);break;case"PtgAreaN":m=iE(y[1][1],n?{s:n}:a,i),o.push(om(m,i));break;case"PtgArea":m=iE(y[1][1],a,i),o.push(om(m,i));break;case"PtgArea3d":h=y[1][1],m=y[1][2],v=ME(r,h,i),o.push(v+"!"+om(m,i));break;case"PtgAttrSum":o.push("SUM("+o.pop()+")");break;case"PtgAttrBaxcel":case"PtgAttrSemi":break;case"PtgName":p=y[1][2];var C=(r.names||[])[p-1]||(r[0]||[])[p],M=C?C.Name:"SH33TJSNAME"+String(p);M&&M.slice(0,6)=="_xlfn."&&!i.xlfn&&(M=M.slice(6)),o.push(M);break;case"PtgNameX":var F=y[1][1];p=y[1][2];var b;if(i.biff<=5)F<0&&(F=-F),r[F]&&(b=r[F][p]);else{var V="";if(((r[F]||[])[0]||[])[0]==14849||(((r[F]||[])[0]||[])[0]==1025?r[F][p]&&r[F][p].itab>0&&(V=r.SheetNames[r[F][p].itab-1]+"!"):V=r.SheetNames[p-1]+"!"),r[F]&&r[F][p])V+=r[F][p].Name;else if(r[0]&&r[0][p])V+=r[0][p].Name;else{var z=(SD(r,F,i)||"").split(";;");z[p-1]?V=z[p-1]:V+="SH33TJSERRX"}o.push(V);break}b||(b={Name:"SH33TJSERRY"}),o.push(b.Name);break;case"PtgParen":var ie="(",Q=")";if(g>=0){switch(w="",e[0][g][1][0]){case 2:ie=mn(" ",e[0][g][1][1])+ie;break;case 3:ie=mn("\r",e[0][g][1][1])+ie;break;case 4:Q=mn(" ",e[0][g][1][1])+Q;break;case 5:Q=mn("\r",e[0][g][1][1])+Q;break;default:if(i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+e[0][g][1][0])}g=-1}o.push(ie+o.pop()+Q);break;case"PtgRefErr":o.push("#REF!");break;case"PtgRefErr3d":o.push("#REF!");break;case"PtgExp":c={c:y[1][1],r:y[1][0]};var se={c:n.c,r:n.r};if(r.sharedf[nt(c)]){var de=r.sharedf[nt(c)];o.push(ar(de,a,se,r,i))}else{var ae=!1;for(l=0;l!=r.arrayf.length;++l)if(u=r.arrayf[l],!(c.c<u[0].s.c||c.c>u[0].e.c)&&!(c.r<u[0].s.r||c.r>u[0].e.r)){o.push(ar(u[1],a,se,r,i)),ae=!0;break}ae||o.push(y[1])}break;case"PtgArray":o.push("{"+qz(y[1])+"}");break;case"PtgMemArea":break;case"PtgAttrSpace":case"PtgAttrSpaceSemi":g=x;break;case"PtgTbl":break;case"PtgMemErr":break;case"PtgMissArg":o.push("");break;case"PtgAreaErr":o.push("#REF!");break;case"PtgAreaErr3d":o.push("#REF!");break;case"PtgList":o.push("Table"+y[1].idx+"[#"+y[1].rt+"]");break;case"PtgMemAreaN":case"PtgMemNoMemN":case"PtgAttrNoop":case"PtgSheet":case"PtgEndSheet":break;case"PtgMemFunc":break;case"PtgMemNoMem":break;case"PtgElfCol":case"PtgElfColS":case"PtgElfColSV":case"PtgElfColV":case"PtgElfLel":case"PtgElfRadical":case"PtgElfRadicalLel":case"PtgElfRadicalS":case"PtgElfRw":case"PtgElfRwV":throw new Error("Unsupported ELFs");case"PtgSxName":throw new Error("Unrecognized Formula Token: "+String(y));default:throw new Error("Unrecognized Formula Token: "+String(y))}var ne=["PtgAttrSpace","PtgAttrSpaceSemi","PtgAttrGoto"];if(i.biff!=3&&g>=0&&ne.indexOf(e[0][x][0])==-1){y=e[0][g];var H=!0;switch(y[1][0]){case 4:H=!1;case 0:w=mn(" ",y[1][1]);break;case 5:H=!1;case 1:w=mn("\r",y[1][1]);break;default:if(w="",i.WTF)throw new Error("Unexpected PtgAttrSpaceType "+y[1][0])}o.push((H?w:"")+o.pop()+(H?"":w)),g=-1}}if(o.length>1&&i.WTF)throw new Error("bad formula stack");return o[0]}function Xz(e,t,n){var r=e.l+t,i=n.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],mr(e,t-2)];var o=Qf(e,a,n);return t!==a+i&&(s=Jf(e,t-a-i,o,n)),e.l=r,[o,s]}function Jz(e,t,n){var r=e.l+t,i=n.biff==2?1:2,s,a=e.read_shift(i);if(a==65535)return[[],mr(e,t-2)];var o=Qf(e,a,n);return t!==a+i&&(s=Jf(e,t-a-i,o,n)),e.l=r,[o,s]}function Qz(e,t,n,r){var i=e.l+t,s=Qf(e,r,n),a;return i!==e.l&&(a=Jf(e,i-e.l,s,n)),[s,a]}function jz(e,t,n){var r=e.l+t,i,s=e.read_shift(2),a=Qf(e,s,n);return s==65535?[[],mr(e,t-2)]:(t!==s+2&&(i=Jf(e,r-s-2,a,n)),[a,i])}function Zz(e){var t;if(_s(e,e.l+6)!==65535)return[ur(e),"n"];switch(e[e.l]){case 0:return e.l+=8,["String","s"];case 1:return t=e[e.l+2]===1,e.l+=8,[t,"b"];case 2:return t=e[e.l+2],e.l+=8,[t,"e"];case 3:return e.l+=8,["","s"]}return[]}function eW(e){if(e==null){var t=me(8);return t.write_shift(1,3),t.write_shift(1,0),t.write_shift(2,0),t.write_shift(2,0),t.write_shift(2,65535),t}else if(typeof e=="number")return Io(e);return Io(0)}function dm(e,t,n){var r=e.l+t,i=ps(e);n.biff==2&&++e.l;var s=Zz(e),a=e.read_shift(1);n.biff!=2&&(e.read_shift(1),n.biff>=5&&e.read_shift(4));var o=Jz(e,r-e.l,n);return{cell:i,val:s[0],formula:o,shared:a>>3&1,tt:s[1]}}function tW(e,t,n,r,i){var s=bo(t,n,i),a=eW(e.v),o=me(6),l=33;o.write_shift(2,l),o.write_shift(4,0);for(var u=me(e.bf.length),c=0;c<e.bf.length;++c)u[c]=e.bf[c];var h=Hn([s,a,o,u]);return h}function np(e,t,n){var r=e.read_shift(4),i=Qf(e,r,n),s=e.read_shift(4),a=s>0?Jf(e,s,i,n):null;return[i,a]}var nW=np,rp=np,rW=np,iW=np,sW={0:"BEEP",1:"OPEN",2:"OPEN.LINKS",3:"CLOSE.ALL",4:"SAVE",5:"SAVE.AS",6:"FILE.DELETE",7:"PAGE.SETUP",8:"PRINT",9:"PRINTER.SETUP",10:"QUIT",11:"NEW.WINDOW",12:"ARRANGE.ALL",13:"WINDOW.SIZE",14:"WINDOW.MOVE",15:"FULL",16:"CLOSE",17:"RUN",22:"SET.PRINT.AREA",23:"SET.PRINT.TITLES",24:"SET.PAGE.BREAK",25:"REMOVE.PAGE.BREAK",26:"FONT",27:"DISPLAY",28:"PROTECT.DOCUMENT",29:"PRECISION",30:"A1.R1C1",31:"CALCULATE.NOW",32:"CALCULATION",34:"DATA.FIND",35:"EXTRACT",36:"DATA.DELETE",37:"SET.DATABASE",38:"SET.CRITERIA",39:"SORT",40:"DATA.SERIES",41:"TABLE",42:"FORMAT.NUMBER",43:"ALIGNMENT",44:"STYLE",45:"BORDER",46:"CELL.PROTECTION",47:"COLUMN.WIDTH",48:"UNDO",49:"CUT",50:"COPY",51:"PASTE",52:"CLEAR",53:"PASTE.SPECIAL",54:"EDIT.DELETE",55:"INSERT",56:"FILL.RIGHT",57:"FILL.DOWN",61:"DEFINE.NAME",62:"CREATE.NAMES",63:"FORMULA.GOTO",64:"FORMULA.FIND",65:"SELECT.LAST.CELL",66:"SHOW.ACTIVE.CELL",67:"GALLERY.AREA",68:"GALLERY.BAR",69:"GALLERY.COLUMN",70:"GALLERY.LINE",71:"GALLERY.PIE",72:"GALLERY.SCATTER",73:"COMBINATION",74:"PREFERRED",75:"ADD.OVERLAY",76:"GRIDLINES",77:"SET.PREFERRED",78:"AXES",79:"LEGEND",80:"ATTACH.TEXT",81:"ADD.ARROW",82:"SELECT.CHART",83:"SELECT.PLOT.AREA",84:"PATTERNS",85:"MAIN.CHART",86:"OVERLAY",87:"SCALE",88:"FORMAT.LEGEND",89:"FORMAT.TEXT",90:"EDIT.REPEAT",91:"PARSE",92:"JUSTIFY",93:"HIDE",94:"UNHIDE",95:"WORKSPACE",96:"FORMULA",97:"FORMULA.FILL",98:"FORMULA.ARRAY",99:"DATA.FIND.NEXT",100:"DATA.FIND.PREV",101:"FORMULA.FIND.NEXT",102:"FORMULA.FIND.PREV",103:"ACTIVATE",104:"ACTIVATE.NEXT",105:"ACTIVATE.PREV",106:"UNLOCKED.NEXT",107:"UNLOCKED.PREV",108:"COPY.PICTURE",109:"SELECT",110:"DELETE.NAME",111:"DELETE.FORMAT",112:"VLINE",113:"HLINE",114:"VPAGE",115:"HPAGE",116:"VSCROLL",117:"HSCROLL",118:"ALERT",119:"NEW",120:"CANCEL.COPY",121:"SHOW.CLIPBOARD",122:"MESSAGE",124:"PASTE.LINK",125:"APP.ACTIVATE",126:"DELETE.ARROW",127:"ROW.HEIGHT",128:"FORMAT.MOVE",129:"FORMAT.SIZE",130:"FORMULA.REPLACE",131:"SEND.KEYS",132:"SELECT.SPECIAL",133:"APPLY.NAMES",134:"REPLACE.FONT",135:"FREEZE.PANES",136:"SHOW.INFO",137:"SPLIT",138:"ON.WINDOW",139:"ON.DATA",140:"DISABLE.INPUT",142:"OUTLINE",143:"LIST.NAMES",144:"FILE.CLOSE",145:"SAVE.WORKBOOK",146:"DATA.FORM",147:"COPY.CHART",148:"ON.TIME",149:"WAIT",150:"FORMAT.FONT",151:"FILL.UP",152:"FILL.LEFT",153:"DELETE.OVERLAY",155:"SHORT.MENUS",159:"SET.UPDATE.STATUS",161:"COLOR.PALETTE",162:"DELETE.STYLE",163:"WINDOW.RESTORE",164:"WINDOW.MAXIMIZE",166:"CHANGE.LINK",167:"CALCULATE.DOCUMENT",168:"ON.KEY",169:"APP.RESTORE",170:"APP.MOVE",171:"APP.SIZE",172:"APP.MINIMIZE",173:"APP.MAXIMIZE",174:"BRING.TO.FRONT",175:"SEND.TO.BACK",185:"MAIN.CHART.TYPE",186:"OVERLAY.CHART.TYPE",187:"SELECT.END",188:"OPEN.MAIL",189:"SEND.MAIL",190:"STANDARD.FONT",191:"CONSOLIDATE",192:"SORT.SPECIAL",193:"GALLERY.3D.AREA",194:"GALLERY.3D.COLUMN",195:"GALLERY.3D.LINE",196:"GALLERY.3D.PIE",197:"VIEW.3D",198:"GOAL.SEEK",199:"WORKGROUP",200:"FILL.GROUP",201:"UPDATE.LINK",202:"PROMOTE",203:"DEMOTE",204:"SHOW.DETAIL",206:"UNGROUP",207:"OBJECT.PROPERTIES",208:"SAVE.NEW.OBJECT",209:"SHARE",210:"SHARE.NAME",211:"DUPLICATE",212:"APPLY.STYLE",213:"ASSIGN.TO.OBJECT",214:"OBJECT.PROTECTION",215:"HIDE.OBJECT",216:"SET.EXTRACT",217:"CREATE.PUBLISHER",218:"SUBSCRIBE.TO",219:"ATTRIBUTES",220:"SHOW.TOOLBAR",222:"PRINT.PREVIEW",223:"EDIT.COLOR",224:"SHOW.LEVELS",225:"FORMAT.MAIN",226:"FORMAT.OVERLAY",227:"ON.RECALC",228:"EDIT.SERIES",229:"DEFINE.STYLE",240:"LINE.PRINT",243:"ENTER.DATA",249:"GALLERY.RADAR",250:"MERGE.STYLES",251:"EDITION.OPTIONS",252:"PASTE.PICTURE",253:"PASTE.PICTURE.LINK",254:"SPELLING",256:"ZOOM",259:"INSERT.OBJECT",260:"WINDOW.MINIMIZE",265:"SOUND.NOTE",266:"SOUND.PLAY",267:"FORMAT.SHAPE",268:"EXTEND.POLYGON",269:"FORMAT.AUTO",272:"GALLERY.3D.BAR",273:"GALLERY.3D.SURFACE",274:"FILL.AUTO",276:"CUSTOMIZE.TOOLBAR",277:"ADD.TOOL",278:"EDIT.OBJECT",279:"ON.DOUBLECLICK",280:"ON.ENTRY",281:"WORKBOOK.ADD",282:"WORKBOOK.MOVE",283:"WORKBOOK.COPY",284:"WORKBOOK.OPTIONS",285:"SAVE.WORKSPACE",288:"CHART.WIZARD",289:"DELETE.TOOL",290:"MOVE.TOOL",291:"WORKBOOK.SELECT",292:"WORKBOOK.ACTIVATE",293:"ASSIGN.TO.TOOL",295:"COPY.TOOL",296:"RESET.TOOL",297:"CONSTRAIN.NUMERIC",298:"PASTE.TOOL",302:"WORKBOOK.NEW",305:"SCENARIO.CELLS",306:"SCENARIO.DELETE",307:"SCENARIO.ADD",308:"SCENARIO.EDIT",309:"SCENARIO.SHOW",310:"SCENARIO.SHOW.NEXT",311:"SCENARIO.SUMMARY",312:"PIVOT.TABLE.WIZARD",313:"PIVOT.FIELD.PROPERTIES",314:"PIVOT.FIELD",315:"PIVOT.ITEM",316:"PIVOT.ADD.FIELDS",318:"OPTIONS.CALCULATION",319:"OPTIONS.EDIT",320:"OPTIONS.VIEW",321:"ADDIN.MANAGER",322:"MENU.EDITOR",323:"ATTACH.TOOLBARS",324:"VBAActivate",325:"OPTIONS.CHART",328:"VBA.INSERT.FILE",330:"VBA.PROCEDURE.DEFINITION",336:"ROUTING.SLIP",338:"ROUTE.DOCUMENT",339:"MAIL.LOGON",342:"INSERT.PICTURE",343:"EDIT.TOOL",344:"GALLERY.DOUGHNUT",350:"CHART.TREND",352:"PIVOT.ITEM.PROPERTIES",354:"WORKBOOK.INSERT",355:"OPTIONS.TRANSITION",356:"OPTIONS.GENERAL",370:"FILTER.ADVANCED",373:"MAIL.ADD.MAILER",374:"MAIL.DELETE.MAILER",375:"MAIL.REPLY",376:"MAIL.REPLY.ALL",377:"MAIL.FORWARD",378:"MAIL.NEXT.LETTER",379:"DATA.LABEL",380:"INSERT.TITLE",381:"FONT.PROPERTIES",382:"MACRO.OPTIONS",383:"WORKBOOK.HIDE",384:"WORKBOOK.UNHIDE",385:"WORKBOOK.DELETE",386:"WORKBOOK.NAME",388:"GALLERY.CUSTOM",390:"ADD.CHART.AUTOFORMAT",391:"DELETE.CHART.AUTOFORMAT",392:"CHART.ADD.DATA",393:"AUTO.OUTLINE",394:"TAB.ORDER",395:"SHOW.DIALOG",396:"SELECT.ALL",397:"UNGROUP.SHEETS",398:"SUBTOTAL.CREATE",399:"SUBTOTAL.REMOVE",400:"RENAME.OBJECT",412:"WORKBOOK.SCROLL",413:"WORKBOOK.NEXT",414:"WORKBOOK.PREV",415:"WORKBOOK.TAB.SPLIT",416:"FULL.SCREEN",417:"WORKBOOK.PROTECT",420:"SCROLLBAR.PROPERTIES",421:"PIVOT.SHOW.PAGES",422:"TEXT.TO.COLUMNS",423:"FORMAT.CHARTTYPE",424:"LINK.FORMAT",425:"TRACER.DISPLAY",430:"TRACER.NAVIGATE",431:"TRACER.CLEAR",432:"TRACER.ERROR",433:"PIVOT.FIELD.GROUP",434:"PIVOT.FIELD.UNGROUP",435:"CHECKBOX.PROPERTIES",436:"LABEL.PROPERTIES",437:"LISTBOX.PROPERTIES",438:"EDITBOX.PROPERTIES",439:"PIVOT.REFRESH",440:"LINK.COMBO",441:"OPEN.TEXT",442:"HIDE.DIALOG",443:"SET.DIALOG.FOCUS",444:"ENABLE.OBJECT",445:"PUSHBUTTON.PROPERTIES",446:"SET.DIALOG.DEFAULT",447:"FILTER",448:"FILTER.SHOW.ALL",449:"CLEAR.OUTLINE",450:"FUNCTION.WIZARD",451:"ADD.LIST.ITEM",452:"SET.LIST.ITEM",453:"REMOVE.LIST.ITEM",454:"SELECT.LIST.ITEM",455:"SET.CONTROL.VALUE",456:"SAVE.COPY.AS",458:"OPTIONS.LISTS.ADD",459:"OPTIONS.LISTS.DELETE",460:"SERIES.AXES",461:"SERIES.X",462:"SERIES.Y",463:"ERRORBAR.X",464:"ERRORBAR.Y",465:"FORMAT.CHART",466:"SERIES.ORDER",467:"MAIL.LOGOFF",468:"CLEAR.ROUTING.SLIP",469:"APP.ACTIVATE.MICROSOFT",470:"MAIL.EDIT.MAILER",471:"ON.SHEET",472:"STANDARD.WIDTH",473:"SCENARIO.MERGE",474:"SUMMARY.INFO",475:"FIND.FILE",476:"ACTIVE.CELL.FONT",477:"ENABLE.TIPWIZARD",478:"VBA.MAKE.ADDIN",480:"INSERTDATATABLE",481:"WORKGROUP.OPTIONS",482:"MAIL.SEND.MAILER",485:"AUTOCORRECT",489:"POST.DOCUMENT",491:"PICKLIST",493:"VIEW.SHOW",494:"VIEW.DEFINE",495:"VIEW.DELETE",509:"SHEET.BACKGROUND",510:"INSERT.MAP.OBJECT",511:"OPTIONS.MENONO",517:"MSOCHECKS",518:"NORMAL",519:"LAYOUT",520:"RM.PRINT.AREA",521:"CLEAR.PRINT.AREA",522:"ADD.PRINT.AREA",523:"MOVE.BRK",545:"HIDECURR.NOTE",546:"HIDEALL.NOTES",547:"DELETE.NOTE",548:"TRAVERSE.NOTES",549:"ACTIVATE.NOTES",620:"PROTECT.REVISIONS",621:"UNPROTECT.REVISIONS",647:"OPTIONS.ME",653:"WEB.PUBLISH",667:"NEWWEBQUERY",673:"PIVOT.TABLE.CHART",753:"OPTIONS.SAVE",755:"OPTIONS.SPELL",808:"HIDEALL.INKANNOTS"},ED={0:"COUNT",1:"IF",2:"ISNA",3:"ISERROR",4:"SUM",5:"AVERAGE",6:"MIN",7:"MAX",8:"ROW",9:"COLUMN",10:"NA",11:"NPV",12:"STDEV",13:"DOLLAR",14:"FIXED",15:"SIN",16:"COS",17:"TAN",18:"ATAN",19:"PI",20:"SQRT",21:"EXP",22:"LN",23:"LOG10",24:"ABS",25:"INT",26:"SIGN",27:"ROUND",28:"LOOKUP",29:"INDEX",30:"REPT",31:"MID",32:"LEN",33:"VALUE",34:"TRUE",35:"FALSE",36:"AND",37:"OR",38:"NOT",39:"MOD",40:"DCOUNT",41:"DSUM",42:"DAVERAGE",43:"DMIN",44:"DMAX",45:"DSTDEV",46:"VAR",47:"DVAR",48:"TEXT",49:"LINEST",50:"TREND",51:"LOGEST",52:"GROWTH",53:"GOTO",54:"HALT",55:"RETURN",56:"PV",57:"FV",58:"NPER",59:"PMT",60:"RATE",61:"MIRR",62:"IRR",63:"RAND",64:"MATCH",65:"DATE",66:"TIME",67:"DAY",68:"MONTH",69:"YEAR",70:"WEEKDAY",71:"HOUR",72:"MINUTE",73:"SECOND",74:"NOW",75:"AREAS",76:"ROWS",77:"COLUMNS",78:"OFFSET",79:"ABSREF",80:"RELREF",81:"ARGUMENT",82:"SEARCH",83:"TRANSPOSE",84:"ERROR",85:"STEP",86:"TYPE",87:"ECHO",88:"SET.NAME",89:"CALLER",90:"DEREF",91:"WINDOWS",92:"SERIES",93:"DOCUMENTS",94:"ACTIVE.CELL",95:"SELECTION",96:"RESULT",97:"ATAN2",98:"ASIN",99:"ACOS",100:"CHOOSE",101:"HLOOKUP",102:"VLOOKUP",103:"LINKS",104:"INPUT",105:"ISREF",106:"GET.FORMULA",107:"GET.NAME",108:"SET.VALUE",109:"LOG",110:"EXEC",111:"CHAR",112:"LOWER",113:"UPPER",114:"PROPER",115:"LEFT",116:"RIGHT",117:"EXACT",118:"TRIM",119:"REPLACE",120:"SUBSTITUTE",121:"CODE",122:"NAMES",123:"DIRECTORY",124:"FIND",125:"CELL",126:"ISERR",127:"ISTEXT",128:"ISNUMBER",129:"ISBLANK",130:"T",131:"N",132:"FOPEN",133:"FCLOSE",134:"FSIZE",135:"FREADLN",136:"FREAD",137:"FWRITELN",138:"FWRITE",139:"FPOS",140:"DATEVALUE",141:"TIMEVALUE",142:"SLN",143:"SYD",144:"DDB",145:"GET.DEF",146:"REFTEXT",147:"TEXTREF",148:"INDIRECT",149:"REGISTER",150:"CALL",151:"ADD.BAR",152:"ADD.MENU",153:"ADD.COMMAND",154:"ENABLE.COMMAND",155:"CHECK.COMMAND",156:"RENAME.COMMAND",157:"SHOW.BAR",158:"DELETE.MENU",159:"DELETE.COMMAND",160:"GET.CHART.ITEM",161:"DIALOG.BOX",162:"CLEAN",163:"MDETERM",164:"MINVERSE",165:"MMULT",166:"FILES",167:"IPMT",168:"PPMT",169:"COUNTA",170:"CANCEL.KEY",171:"FOR",172:"WHILE",173:"BREAK",174:"NEXT",175:"INITIATE",176:"REQUEST",177:"POKE",178:"EXECUTE",179:"TERMINATE",180:"RESTART",181:"HELP",182:"GET.BAR",183:"PRODUCT",184:"FACT",185:"GET.CELL",186:"GET.WORKSPACE",187:"GET.WINDOW",188:"GET.DOCUMENT",189:"DPRODUCT",190:"ISNONTEXT",191:"GET.NOTE",192:"NOTE",193:"STDEVP",194:"VARP",195:"DSTDEVP",196:"DVARP",197:"TRUNC",198:"ISLOGICAL",199:"DCOUNTA",200:"DELETE.BAR",201:"UNREGISTER",204:"USDOLLAR",205:"FINDB",206:"SEARCHB",207:"REPLACEB",208:"LEFTB",209:"RIGHTB",210:"MIDB",211:"LENB",212:"ROUNDUP",213:"ROUNDDOWN",214:"ASC",215:"DBCS",216:"RANK",219:"ADDRESS",220:"DAYS360",221:"TODAY",222:"VDB",223:"ELSE",224:"ELSE.IF",225:"END.IF",226:"FOR.CELL",227:"MEDIAN",228:"SUMPRODUCT",229:"SINH",230:"COSH",231:"TANH",232:"ASINH",233:"ACOSH",234:"ATANH",235:"DGET",236:"CREATE.OBJECT",237:"VOLATILE",238:"LAST.ERROR",239:"CUSTOM.UNDO",240:"CUSTOM.REPEAT",241:"FORMULA.CONVERT",242:"GET.LINK.INFO",243:"TEXT.BOX",244:"INFO",245:"GROUP",246:"GET.OBJECT",247:"DB",248:"PAUSE",251:"RESUME",252:"FREQUENCY",253:"ADD.TOOLBAR",254:"DELETE.TOOLBAR",255:"User",256:"RESET.TOOLBAR",257:"EVALUATE",258:"GET.TOOLBAR",259:"GET.TOOL",260:"SPELLING.CHECK",261:"ERROR.TYPE",262:"APP.TITLE",263:"WINDOW.TITLE",264:"SAVE.TOOLBAR",265:"ENABLE.TOOL",266:"PRESS.TOOL",267:"REGISTER.ID",268:"GET.WORKBOOK",269:"AVEDEV",270:"BETADIST",271:"GAMMALN",272:"BETAINV",273:"BINOMDIST",274:"CHIDIST",275:"CHIINV",276:"COMBIN",277:"CONFIDENCE",278:"CRITBINOM",279:"EVEN",280:"EXPONDIST",281:"FDIST",282:"FINV",283:"FISHER",284:"FISHERINV",285:"FLOOR",286:"GAMMADIST",287:"GAMMAINV",288:"CEILING",289:"HYPGEOMDIST",290:"LOGNORMDIST",291:"LOGINV",292:"NEGBINOMDIST",293:"NORMDIST",294:"NORMSDIST",295:"NORMINV",296:"NORMSINV",297:"STANDARDIZE",298:"ODD",299:"PERMUT",300:"POISSON",301:"TDIST",302:"WEIBULL",303:"SUMXMY2",304:"SUMX2MY2",305:"SUMX2PY2",306:"CHITEST",307:"CORREL",308:"COVAR",309:"FORECAST",310:"FTEST",311:"INTERCEPT",312:"PEARSON",313:"RSQ",314:"STEYX",315:"SLOPE",316:"TTEST",317:"PROB",318:"DEVSQ",319:"GEOMEAN",320:"HARMEAN",321:"SUMSQ",322:"KURT",323:"SKEW",324:"ZTEST",325:"LARGE",326:"SMALL",327:"QUARTILE",328:"PERCENTILE",329:"PERCENTRANK",330:"MODE",331:"TRIMMEAN",332:"TINV",334:"MOVIE.COMMAND",335:"GET.MOVIE",336:"CONCATENATE",337:"POWER",338:"PIVOT.ADD.DATA",339:"GET.PIVOT.TABLE",340:"GET.PIVOT.FIELD",341:"GET.PIVOT.ITEM",342:"RADIANS",343:"DEGREES",344:"SUBTOTAL",345:"SUMIF",346:"COUNTIF",347:"COUNTBLANK",348:"SCENARIO.GET",349:"OPTIONS.LISTS.GET",350:"ISPMT",351:"DATEDIF",352:"DATESTRING",353:"NUMBERSTRING",354:"ROMAN",355:"OPEN.DIALOG",356:"SAVE.DIALOG",357:"VIEW.GET",358:"GETPIVOTDATA",359:"HYPERLINK",360:"PHONETIC",361:"AVERAGEA",362:"MAXA",363:"MINA",364:"STDEVPA",365:"VARPA",366:"STDEVA",367:"VARA",368:"BAHTTEXT",369:"THAIDAYOFWEEK",370:"THAIDIGIT",371:"THAIMONTHOFYEAR",372:"THAINUMSOUND",373:"THAINUMSTRING",374:"THAISTRINGLENGTH",375:"ISTHAIDIGIT",376:"ROUNDBAHTDOWN",377:"ROUNDBAHTUP",378:"THAIYEAR",379:"RTD",380:"CUBEVALUE",381:"CUBEMEMBER",382:"CUBEMEMBERPROPERTY",383:"CUBERANKEDMEMBER",384:"HEX2BIN",385:"HEX2DEC",386:"HEX2OCT",387:"DEC2BIN",388:"DEC2HEX",389:"DEC2OCT",390:"OCT2BIN",391:"OCT2HEX",392:"OCT2DEC",393:"BIN2DEC",394:"BIN2OCT",395:"BIN2HEX",396:"IMSUB",397:"IMDIV",398:"IMPOWER",399:"IMABS",400:"IMSQRT",401:"IMLN",402:"IMLOG2",403:"IMLOG10",404:"IMSIN",405:"IMCOS",406:"IMEXP",407:"IMARGUMENT",408:"IMCONJUGATE",409:"IMAGINARY",410:"IMREAL",411:"COMPLEX",412:"IMSUM",413:"IMPRODUCT",414:"SERIESSUM",415:"FACTDOUBLE",416:"SQRTPI",417:"QUOTIENT",418:"DELTA",419:"GESTEP",420:"ISEVEN",421:"ISODD",422:"MROUND",423:"ERF",424:"ERFC",425:"BESSELJ",426:"BESSELK",427:"BESSELY",428:"BESSELI",429:"XIRR",430:"XNPV",431:"PRICEMAT",432:"YIELDMAT",433:"INTRATE",434:"RECEIVED",435:"DISC",436:"PRICEDISC",437:"YIELDDISC",438:"TBILLEQ",439:"TBILLPRICE",440:"TBILLYIELD",441:"PRICE",442:"YIELD",443:"DOLLARDE",444:"DOLLARFR",445:"NOMINAL",446:"EFFECT",447:"CUMPRINC",448:"CUMIPMT",449:"EDATE",450:"EOMONTH",451:"YEARFRAC",452:"COUPDAYBS",453:"COUPDAYS",454:"COUPDAYSNC",455:"COUPNCD",456:"COUPNUM",457:"COUPPCD",458:"DURATION",459:"MDURATION",460:"ODDLPRICE",461:"ODDLYIELD",462:"ODDFPRICE",463:"ODDFYIELD",464:"RANDBETWEEN",465:"WEEKNUM",466:"AMORDEGRC",467:"AMORLINC",468:"CONVERT",724:"SHEETJS",469:"ACCRINT",470:"ACCRINTM",471:"WORKDAY",472:"NETWORKDAYS",473:"GCD",474:"MULTINOMIAL",475:"LCM",476:"FVSCHEDULE",477:"CUBEKPIMEMBER",478:"CUBESET",479:"CUBESETCOUNT",480:"IFERROR",481:"COUNTIFS",482:"SUMIFS",483:"AVERAGEIF",484:"AVERAGEIFS"},aW={2:1,3:1,10:0,15:1,16:1,17:1,18:1,19:0,20:1,21:1,22:1,23:1,24:1,25:1,26:1,27:2,30:2,31:3,32:1,33:1,34:0,35:0,38:1,39:2,40:3,41:3,42:3,43:3,44:3,45:3,47:3,48:2,53:1,61:3,63:0,65:3,66:3,67:1,68:1,69:1,70:1,71:1,72:1,73:1,74:0,75:1,76:1,77:1,79:2,80:2,83:1,85:0,86:1,89:0,90:1,94:0,95:0,97:2,98:1,99:1,101:3,102:3,105:1,106:1,108:2,111:1,112:1,113:1,114:1,117:2,118:1,119:4,121:1,126:1,127:1,128:1,129:1,130:1,131:1,133:1,134:1,135:1,136:2,137:2,138:2,140:1,141:1,142:3,143:4,144:4,161:1,162:1,163:1,164:1,165:2,172:1,175:2,176:2,177:3,178:2,179:1,184:1,186:1,189:3,190:1,195:3,196:3,197:1,198:1,199:3,201:1,207:4,210:3,211:1,212:2,213:2,214:1,215:1,225:0,229:1,230:1,231:1,232:1,233:1,234:1,235:3,244:1,247:4,252:2,257:1,261:1,271:1,273:4,274:2,275:2,276:2,277:3,278:3,279:1,280:3,281:3,282:3,283:1,284:1,285:2,286:4,287:3,288:2,289:4,290:3,291:3,292:3,293:4,294:1,295:3,296:1,297:3,298:1,299:2,300:3,301:3,302:4,303:2,304:2,305:2,306:2,307:2,308:2,309:3,310:2,311:2,312:2,313:2,314:2,315:2,316:4,325:2,326:2,327:2,328:2,331:2,332:2,337:2,342:1,343:1,346:2,347:1,350:4,351:3,352:1,353:2,360:1,368:1,369:1,370:1,371:1,372:1,373:1,374:1,375:1,376:1,377:1,378:1,382:3,385:1,392:1,393:1,396:2,397:2,398:2,399:1,400:1,401:1,402:1,403:1,404:1,405:1,406:1,407:1,408:1,409:1,410:1,414:4,415:1,416:1,417:2,420:1,421:1,422:2,424:1,425:2,426:2,427:2,428:2,430:3,438:3,439:3,440:3,443:2,444:2,445:2,446:2,447:6,448:6,449:2,450:2,464:2,468:3,476:2,479:1,480:2,65535:0};function FE(e){return e.slice(0,3)=="of:"&&(e=e.slice(3)),e.charCodeAt(0)==61&&(e=e.slice(1),e.charCodeAt(0)==61&&(e=e.slice(1))),e=e.replace(/COM\.MICROSOFT\./g,""),e=e.replace(/\[((?:\.[A-Z]+[0-9]+)(?::\.[A-Z]+[0-9]+)?)\]/g,function(t,n){return n.replace(/\./g,"")}),e=e.replace(/\[.(#[A-Z]*[?!])\]/g,"$1"),e.replace(/[;~]/g,",").replace(/\|/g,";")}function oW(e){var t="of:="+e.replace(Y1,"$1[.$2$3$4$5]").replace(/\]:\[/g,":");return t.replace(/;/g,"|").replace(/,/g,";")}function hm(e){var t=e.split(":"),n=t[0].split(".")[0];return[n,t[0].split(".")[1]+(t.length>1?":"+(t[1].split(".")[1]||t[1].split(".")[0]):"")]}function lW(e){return e.replace(/\./,"!")}var Fc={},Hl={},Dc=typeof Map<"u";function Q1(e,t,n){var r=0,i=e.length;if(n){if(Dc?n.has(t):Object.prototype.hasOwnProperty.call(n,t)){for(var s=Dc?n.get(t):n[t];r<s.length;++r)if(e[s[r]].t===t)return e.Count++,s[r]}}else for(;r<i;++r)if(e[r].t===t)return e.Count++,r;return e[i]={t},e.Count++,e.Unique++,n&&(Dc?(n.has(t)||n.set(t,[]),n.get(t).push(i)):(Object.prototype.hasOwnProperty.call(n,t)||(n[t]=[]),n[t].push(i))),i}function ip(e,t){var n={min:e+1,max:e+1},r=-1;return t.MDW&&(lr=t.MDW),t.width!=null?n.customWidth=1:t.wpx!=null?r=yf(t.wpx):t.wch!=null&&(r=t.wch),r>-1?(n.width=ch(r),n.customWidth=1):t.width!=null&&(n.width=t.width),t.hidden&&(n.hidden=!0),t.level!=null&&(n.outlineLevel=n.level=t.level),n}function Eo(e,t){if(e){var n=[.7,.7,.75,.75,.3,.3];t=="xlml"&&(n=[1,1,1,1,.5,.5]),e.left==null&&(e.left=n[0]),e.right==null&&(e.right=n[1]),e.top==null&&(e.top=n[2]),e.bottom==null&&(e.bottom=n[3]),e.header==null&&(e.header=n[4]),e.footer==null&&(e.footer=n[5])}}function qa(e,t,n){var r=n.revssf[t.z!=null?t.z:"General"],i=60,s=e.length;if(r==null&&n.ssf){for(;i<392;++i)if(n.ssf[i]==null){Ds(t.z,i),n.ssf[i]=t.z,n.revssf[t.z]=r=i;break}}for(i=0;i!=s;++i)if(e[i].numFmtId===r)return i;return e[s]={numFmtId:r,fontId:0,fillId:0,borderId:0,xfId:0,applyNumberFormat:1},s}function _D(e,t,n,r,i,s){try{r.cellNF&&(e.z=et[t])}catch(o){if(r.WTF)throw o}if(!(e.t==="z"&&!r.cellStyles)){if(e.t==="d"&&typeof e.v=="string"&&(e.v=tn(e.v)),(!r||r.cellText!==!1)&&e.t!=="z")try{if(et[t]==null&&Ds(sU[t]||"General",t),e.t==="e")e.w=e.w||Ws[e.v];else if(t===0)if(e.t==="n")(e.v|0)===e.v?e.w=e.v.toString(10):e.w=df(e.v);else if(e.t==="d"){var a=Nn(e.v);(a|0)===a?e.w=a.toString(10):e.w=df(a)}else{if(e.v===void 0)return"";e.w=Do(e.v,Hl)}else e.t==="d"?e.w=_i(t,Nn(e.v),Hl):e.w=_i(t,e.v,Hl)}catch(o){if(r.WTF)throw o}if(r.cellStyles&&n!=null)try{e.s=s.Fills[n],e.s.fgColor&&e.s.fgColor.theme&&!e.s.fgColor.rgb&&(e.s.fgColor.rgb=uh(i.themeElements.clrScheme[e.s.fgColor.theme].rgb,e.s.fgColor.tint||0),r.WTF&&(e.s.fgColor.raw_rgb=i.themeElements.clrScheme[e.s.fgColor.theme].rgb)),e.s.bgColor&&e.s.bgColor.theme&&(e.s.bgColor.rgb=uh(i.themeElements.clrScheme[e.s.bgColor.theme].rgb,e.s.bgColor.tint||0),r.WTF&&(e.s.bgColor.raw_rgb=i.themeElements.clrScheme[e.s.bgColor.theme].rgb))}catch(o){if(r.WTF&&s.Fills)throw o}}}function uW(e,t,n){if(e&&e["!ref"]){var r=At(e["!ref"]);if(r.e.c<r.s.c||r.e.r<r.s.r)throw new Error("Bad range ("+n+"): "+e["!ref"])}}function cW(e,t){var n=At(t);n.s.r<=n.e.r&&n.s.c<=n.e.c&&n.s.r>=0&&n.s.c>=0&&(e["!ref"]=lt(n))}var fW=/<(?:\w:)?mergeCell ref="[A-Z0-9:]+"\s*[\/]?>/g,dW=/<(?:\w+:)?sheetData[^>]*>([\s\S]*)<\/(?:\w+:)?sheetData>/,hW=/<(?:\w:)?hyperlink [^>]*>/mg,pW=/"(\w*:\w*)"/,mW=/<(?:\w:)?col\b[^>]*[\/]?>/g,gW=/<(?:\w:)?autoFilter[^>]*([\/]|>([\s\S]*)<\/(?:\w:)?autoFilter)>/g,vW=/<(?:\w:)?pageMargins[^>]*\/>/g,CD=/<(?:\w:)?sheetPr\b(?:[^>a-z][^>]*)?\/>/,xW=/<(?:\w:)?sheetPr[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetPr)>/,yW=/<(?:\w:)?sheetViews[^>]*(?:[\/]|>([\s\S]*)<\/(?:\w:)?sheetViews)>/;function wW(e,t,n,r,i,s,a){if(!e)return e;r||(r={"!id":{}});var o=t.dense?[]:{},l={s:{r:2e6,c:2e6},e:{r:0,c:0}},u="",c="",h=e.match(dW);h?(u=e.slice(0,h.index),c=e.slice(h.index+h[0].length)):u=c=e;var p=u.match(CD);p?j1(p[0],o,i,n):(p=u.match(xW))&&SW(p[0],p[1]||"",o,i,n);var m=(u.match(/<(?:\w*:)?dimension/)||{index:-1}).index;if(m>0){var v=u.slice(m,m+50).match(pW);v&&cW(o,v[1])}var g=u.match(yW);g&&g[1]&&bW(g[1],i);var w=[];if(t.cellStyles){var x=u.match(mW);x&&FW(w,x)}h&&BW(h[1],o,t,l,s,a);var T=c.match(gW);T&&(o["!autofilter"]=PW(T[0]));var y=[],_=c.match(fW);if(_)for(m=0;m!=_.length;++m)y[m]=At(_[m].slice(_[m].indexOf('"')+1));var k=c.match(hW);k&&AW(o,k,r);var S=c.match(vW);if(S&&(o["!margins"]=RW(it(S[0]))),!o["!ref"]&&l.e.c>=l.s.c&&l.e.r>=l.s.r&&(o["!ref"]=lt(l)),t.sheetRows>0&&o["!ref"]){var C=At(o["!ref"]);t.sheetRows<=+C.e.r&&(C.e.r=t.sheetRows-1,C.e.r>l.e.r&&(C.e.r=l.e.r),C.e.r<C.s.r&&(C.s.r=C.e.r),C.e.c>l.e.c&&(C.e.c=l.e.c),C.e.c<C.s.c&&(C.s.c=C.e.c),o["!fullref"]=o["!ref"],o["!ref"]=lt(C))}return w.length>0&&(o["!cols"]=w),y.length>0&&(o["!merges"]=y),o}function TW(e){if(e.length===0)return"";for(var t='<mergeCells count="'+e.length+'">',n=0;n!=e.length;++n)t+='<mergeCell ref="'+lt(e[n])+'"/>';return t+"</mergeCells>"}function j1(e,t,n,r){var i=it(e);n.Sheets[r]||(n.Sheets[r]={}),i.codeName&&(n.Sheets[r].CodeName=kt(qt(i.codeName)))}function SW(e,t,n,r,i){j1(e.slice(0,e.indexOf(">")),n,r,i)}function EW(e,t,n,r,i){var s=!1,a={},o=null;if(r.bookType!=="xlsx"&&t.vbaraw){var l=t.SheetNames[n];try{t.Workbook&&(l=t.Workbook.Sheets[n].CodeName||l)}catch{}s=!0,a.codeName=ns($t(l))}if(e&&e["!outline"]){var u={summaryBelow:1,summaryRight:1};e["!outline"].above&&(u.summaryBelow=0),e["!outline"].left&&(u.summaryRight=0),o=(o||"")+Pe("outlinePr",null,u)}!s&&!o||(i[i.length]=Pe("sheetPr",o,a))}var _W=["objects","scenarios","selectLockedCells","selectUnlockedCells"],CW=["formatColumns","formatRows","formatCells","insertColumns","insertRows","insertHyperlinks","deleteColumns","deleteRows","sort","autoFilter","pivotTables"];function kW(e){var t={sheet:1};return _W.forEach(function(n){e[n]!=null&&e[n]&&(t[n]="1")}),CW.forEach(function(n){e[n]!=null&&!e[n]&&(t[n]="0")}),e.password&&(t.password=G1(e.password).toString(16).toUpperCase()),Pe("sheetProtection",null,t)}function AW(e,t,n){for(var r=Array.isArray(e),i=0;i!=t.length;++i){var s=it(qt(t[i]),!0);if(!s.ref)return;var a=((n||{})["!id"]||[])[s.id];a?(s.Target=a.Target,s.location&&(s.Target+="#"+kt(s.location))):(s.Target="#"+kt(s.location),a={Target:s.Target,TargetMode:"Internal"}),s.Rel=a,s.tooltip&&(s.Tooltip=s.tooltip,delete s.tooltip);for(var o=At(s.ref),l=o.s.r;l<=o.e.r;++l)for(var u=o.s.c;u<=o.e.c;++u){var c=nt({c:u,r:l});r?(e[l]||(e[l]=[]),e[l][u]||(e[l][u]={t:"z",v:void 0}),e[l][u].l=s):(e[c]||(e[c]={t:"z",v:void 0}),e[c].l=s)}}}function RW(e){var t={};return["left","right","top","bottom","header","footer"].forEach(function(n){e[n]&&(t[n]=parseFloat(e[n]))}),t}function MW(e){return Eo(e),Pe("pageMargins",null,e)}function FW(e,t){for(var n=!1,r=0;r!=t.length;++r){var i=it(t[r],!0);i.hidden&&(i.hidden=jt(i.hidden));var s=parseInt(i.min,10)-1,a=parseInt(i.max,10)-1;for(i.outlineLevel&&(i.level=+i.outlineLevel||0),delete i.min,delete i.max,i.width=+i.width,!n&&i.width&&(n=!0,q1(i.width)),ba(i);s<=a;)e[s++]=nn(i)}}function DW(e,t){for(var n=["<cols>"],r,i=0;i!=t.length;++i)(r=t[i])&&(n[n.length]=Pe("col",null,ip(i,r)));return n[n.length]="</cols>",n.join("")}function PW(e){var t={ref:(e.match(/ref="([^"]*)"/)||[])[1]};return t}function IW(e,t,n,r){var i=typeof e.ref=="string"?e.ref:lt(e.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var s=n.Workbook.Names,a=Br(i);a.s.r==a.e.r&&(a.e.r=Br(t["!ref"]).e.r,i=lt(a));for(var o=0;o<s.length;++o){var l=s[o];if(l.Name=="_xlnm._FilterDatabase"&&l.Sheet==r){l.Ref="'"+n.SheetNames[r]+"'!"+i;break}}return o==s.length&&s.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+i}),Pe("autoFilter",null,{ref:i})}var NW=/<(?:\w:)?sheetView(?:[^>a-z][^>]*)?\/?>/;function bW(e,t){t.Views||(t.Views=[{}]),(e.match(NW)||[]).forEach(function(n,r){var i=it(n);t.Views[r]||(t.Views[r]={}),+i.zoomScale&&(t.Views[r].zoom=+i.zoomScale),jt(i.rightToLeft)&&(t.Views[r].RTL=!0)})}function LW(e,t,n,r){var i={workbookViewId:"0"};return(((r||{}).Workbook||{}).Views||[])[0]&&(i.rightToLeft=r.Workbook.Views[0].RTL?"1":"0"),Pe("sheetViews",Pe("sheetView",null,i),{})}function OW(e,t,n,r){if(e.c&&n["!comments"].push([t,e.c]),e.v===void 0&&typeof e.f!="string"||e.t==="z"&&!e.f)return"";var i="",s=e.t,a=e.v;if(e.t!=="z")switch(e.t){case"b":i=e.v?"1":"0";break;case"n":i=""+e.v;break;case"e":i=Ws[e.v];break;case"d":r&&r.cellDates?i=tn(e.v,-1).toISOString():(e=nn(e),e.t="n",i=""+(e.v=Nn(tn(e.v)))),typeof e.z>"u"&&(e.z=et[14]);break;default:i=e.v;break}var o=Qn("v",$t(i)),l={r:t},u=qa(r.cellXfs,e,r);switch(u!==0&&(l.s=u),e.t){case"n":break;case"d":l.t="d";break;case"b":l.t="b";break;case"e":l.t="e";break;case"z":break;default:if(e.v==null){delete e.t;break}if(e.v.length>32767)throw new Error("Text length must not exceed 32767 characters");if(r&&r.bookSST){o=Qn("v",""+Q1(r.Strings,e.v,r.revStrings)),l.t="s";break}l.t="str";break}if(e.t!=s&&(e.t=s,e.v=a),typeof e.f=="string"&&e.f){var c=e.F&&e.F.slice(0,t.length)==t?{t:"array",ref:e.F}:null;o=Pe("f",$t(e.f),c)+(e.v!=null?o:"")}return e.l&&n["!links"].push([t,e.l]),e.D&&(l.cm=1),Pe("c",o,l)}var BW=function(){var e=/<(?:\w+:)?c[ \/>]/,t=/<\/(?:\w+:)?row>/,n=/r=["']([^"']*)["']/,r=/<(?:\w+:)?is>([\S\s]*?)<\/(?:\w+:)?is>/,i=/ref=["']([^"']*)["']/,s=hf("v"),a=hf("f");return function(l,u,c,h,p,m){for(var v=0,g="",w=[],x=[],T=0,y=0,_=0,k="",S,C,M=0,F=0,b,V,z=0,ie=0,Q=Array.isArray(m.CellXf),se,de=[],ae=[],ne=Array.isArray(u),H=[],fe={},xe=!1,L=!!c.sheetStubs,q=l.split(t),W=0,G=q.length;W!=G;++W){g=q[W].trim();var ee=g.length;if(ee!==0){var Se=0;e:for(v=0;v<ee;++v)switch(g[v]){case">":if(g[v-1]!="/"){++v;break e}if(c&&c.cellStyles){if(C=it(g.slice(Se,v),!0),M=C.r!=null?parseInt(C.r,10):M+1,F=-1,c.sheetRows&&c.sheetRows<M)continue;fe={},xe=!1,C.ht&&(xe=!0,fe.hpt=parseFloat(C.ht),fe.hpx=xu(fe.hpt)),C.hidden=="1"&&(xe=!0,fe.hidden=!0),C.outlineLevel!=null&&(xe=!0,fe.level=+C.outlineLevel),xe&&(H[M-1]=fe)}break;case"<":Se=v;break}if(Se>=v)break;if(C=it(g.slice(Se,v),!0),M=C.r!=null?parseInt(C.r,10):M+1,F=-1,!(c.sheetRows&&c.sheetRows<M)){h.s.r>M-1&&(h.s.r=M-1),h.e.r<M-1&&(h.e.r=M-1),c&&c.cellStyles&&(fe={},xe=!1,C.ht&&(xe=!0,fe.hpt=parseFloat(C.ht),fe.hpx=xu(fe.hpt)),C.hidden=="1"&&(xe=!0,fe.hidden=!0),C.outlineLevel!=null&&(xe=!0,fe.level=+C.outlineLevel),xe&&(H[M-1]=fe)),w=g.slice(v).split(e);for(var we=0;we!=w.length&&w[we].trim().charAt(0)=="<";++we);for(w=w.slice(we),v=0;v!=w.length;++v)if(g=w[v].trim(),g.length!==0){if(x=g.match(n),T=v,y=0,_=0,g="<c "+(g.slice(0,1)=="<"?">":"")+g,x!=null&&x.length===2){for(T=0,k=x[1],y=0;y!=k.length&&!((_=k.charCodeAt(y)-64)<1||_>26);++y)T=26*T+_;--T,F=T}else++F;for(y=0;y!=g.length&&g.charCodeAt(y)!==62;++y);if(++y,C=it(g.slice(0,y),!0),C.r||(C.r=nt({r:M-1,c:F})),k=g.slice(y),S={t:""},(x=k.match(s))!=null&&x[1]!==""&&(S.v=kt(x[1])),c.cellFormula){if((x=k.match(a))!=null&&x[1]!==""){if(S.f=kt(qt(x[1])).replace(/\r\n/g,`
`),c.xlfn||(S.f=kE(S.f)),x[0].indexOf('t="array"')>-1)S.F=(k.match(i)||[])[1],S.F.indexOf(":")>-1&&de.push([At(S.F),S.F]);else if(x[0].indexOf('t="shared"')>-1){V=it(x[0]);var pe=kt(qt(x[1]));c.xlfn||(pe=kE(pe)),ae[parseInt(V.si,10)]=[V,pe,C.r]}}else(x=k.match(/<f[^>]*\/>/))&&(V=it(x[0]),ae[V.si]&&(S.f=N$(ae[V.si][1],ae[V.si][2],C.r)));var oe=ln(C.r);for(y=0;y<de.length;++y)oe.r>=de[y][0].s.r&&oe.r<=de[y][0].e.r&&oe.c>=de[y][0].s.c&&oe.c<=de[y][0].e.c&&(S.F=de[y][1])}if(C.t==null&&S.v===void 0)if(S.f||S.F)S.v=0,S.t="n";else if(L)S.t="z";else continue;else S.t=C.t||"n";switch(h.s.c>F&&(h.s.c=F),h.e.c<F&&(h.e.c=F),S.t){case"n":if(S.v==""||S.v==null){if(!L)continue;S.t="z"}else S.v=parseFloat(S.v);break;case"s":if(typeof S.v>"u"){if(!L)continue;S.t="z"}else b=Fc[parseInt(S.v,10)],S.v=b.t,S.r=b.r,c.cellHTML&&(S.h=b.h);break;case"str":S.t="s",S.v=S.v!=null?qt(S.v):"",c.cellHTML&&(S.h=F1(S.v));break;case"inlineStr":x=k.match(r),S.t="s",x!=null&&(b=W1(x[1]))?(S.v=b.t,c.cellHTML&&(S.h=b.h)):S.v="";break;case"b":S.v=jt(S.v);break;case"d":c.cellDates?S.v=tn(S.v,1):(S.v=Nn(tn(S.v,1)),S.t="n");break;case"e":(!c||c.cellText!==!1)&&(S.w=S.v),S.v=AF[S.v];break}if(z=ie=0,se=null,Q&&C.s!==void 0&&(se=m.CellXf[C.s],se!=null&&(se.numFmtId!=null&&(z=se.numFmtId),c.cellStyles&&se.fillId!=null&&(ie=se.fillId))),_D(S,z,ie,c,p,m),c.cellDates&&Q&&S.t=="n"&&ku(et[z])&&(S.t="d",S.v=ep(S.v)),C.cm&&c.xlmeta){var Le=(c.xlmeta.Cell||[])[+C.cm-1];Le&&Le.type=="XLDAPR"&&(S.D=!0)}if(ne){var B=ln(C.r);u[B.r]||(u[B.r]=[]),u[B.r][B.c]=S}else u[C.r]=S}}}}H.length>0&&(u["!rows"]=H)}}();function UW(e,t,n,r){var i=[],s=[],a=At(e["!ref"]),o="",l,u="",c=[],h=0,p=0,m=e["!rows"],v=Array.isArray(e),g={r:u},w,x=-1;for(p=a.s.c;p<=a.e.c;++p)c[p]=on(p);for(h=a.s.r;h<=a.e.r;++h){for(s=[],u=Sn(h),p=a.s.c;p<=a.e.c;++p){l=c[p]+u;var T=v?(e[h]||[])[p]:e[l];T!==void 0&&(o=OW(T,l,e,t))!=null&&s.push(o)}(s.length>0||m&&m[h])&&(g={r:u},m&&m[h]&&(w=m[h],w.hidden&&(g.hidden=1),x=-1,w.hpx?x=wf(w.hpx):w.hpt&&(x=w.hpt),x>-1&&(g.ht=x,g.customHeight=1),w.level&&(g.outlineLevel=w.level)),i[i.length]=Pe("row",s.join(""),g))}if(m)for(;h<m.length;++h)m&&m[h]&&(g={r:h+1},w=m[h],w.hidden&&(g.hidden=1),x=-1,w.hpx?x=wf(w.hpx):w.hpt&&(x=w.hpt),x>-1&&(g.ht=x,g.customHeight=1),w.level&&(g.outlineLevel=w.level),i[i.length]=Pe("row","",g));return i.join("")}function kD(e,t,n,r){var i=[En,Pe("worksheet",null,{xmlns:Yo[0],"xmlns:r":Pn.r})],s=n.SheetNames[e],a=0,o="",l=n.Sheets[s];l==null&&(l={});var u=l["!ref"]||"A1",c=At(u);if(c.e.c>16383||c.e.r>1048575){if(t.WTF)throw new Error("Range "+u+" exceeds format limit A1:XFD1048576");c.e.c=Math.min(c.e.c,16383),c.e.r=Math.min(c.e.c,1048575),u=lt(c)}r||(r={}),l["!comments"]=[];var h=[];EW(l,n,e,t,i),i[i.length]=Pe("dimension",null,{ref:u}),i[i.length]=LW(l,t,e,n),t.sheetFormat&&(i[i.length]=Pe("sheetFormatPr",null,{defaultRowHeight:t.sheetFormat.defaultRowHeight||"16",baseColWidth:t.sheetFormat.baseColWidth||"10",outlineLevelRow:t.sheetFormat.outlineLevelRow||"7"})),l["!cols"]!=null&&l["!cols"].length>0&&(i[i.length]=DW(l,l["!cols"])),i[a=i.length]="<sheetData/>",l["!links"]=[],l["!ref"]!=null&&(o=UW(l,t),o.length>0&&(i[i.length]=o)),i.length>a+1&&(i[i.length]="</sheetData>",i[a]=i[a].replace("/>",">")),l["!protect"]&&(i[i.length]=kW(l["!protect"])),l["!autofilter"]!=null&&(i[i.length]=IW(l["!autofilter"],l,n,e)),l["!merges"]!=null&&l["!merges"].length>0&&(i[i.length]=TW(l["!merges"]));var p=-1,m,v=-1;return l["!links"].length>0&&(i[i.length]="<hyperlinks>",l["!links"].forEach(function(g){g[1].Target&&(m={ref:g[0]},g[1].Target.charAt(0)!="#"&&(v=Ht(r,-1,$t(g[1].Target).replace(/#.*$/,""),pt.HLINK),m["r:id"]="rId"+v),(p=g[1].Target.indexOf("#"))>-1&&(m.location=$t(g[1].Target.slice(p+1))),g[1].Tooltip&&(m.tooltip=$t(g[1].Tooltip)),i[i.length]=Pe("hyperlink",null,m))}),i[i.length]="</hyperlinks>"),delete l["!links"],l["!margins"]!=null&&(i[i.length]=MW(l["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&(i[i.length]=Qn("ignoredErrors",Pe("ignoredError",null,{numberStoredAsText:1,sqref:u}))),h.length>0&&(v=Ht(r,-1,"../drawings/drawing"+(e+1)+".xml",pt.DRAW),i[i.length]=Pe("drawing",null,{"r:id":"rId"+v}),l["!drawing"]=h),l["!comments"].length>0&&(v=Ht(r,-1,"../drawings/vmlDrawing"+(e+1)+".vml",pt.VML),i[i.length]=Pe("legacyDrawing",null,{"r:id":"rId"+v}),l["!legacy"]=v),i.length>1&&(i[i.length]="</worksheet>",i[1]=i[1].replace("/>",">")),i.join("")}function VW(e,t){var n={},r=e.l+t;n.r=e.read_shift(4),e.l+=4;var i=e.read_shift(2);e.l+=1;var s=e.read_shift(1);return e.l=r,s&7&&(n.level=s&7),s&16&&(n.hidden=!0),s&32&&(n.hpt=i/20),n}function HW(e,t,n){var r=me(145),i=(n["!rows"]||[])[e]||{};r.write_shift(4,e),r.write_shift(4,0);var s=320;i.hpx?s=wf(i.hpx)*20:i.hpt&&(s=i.hpt*20),r.write_shift(2,s),r.write_shift(1,0);var a=0;i.level&&(a|=i.level),i.hidden&&(a|=16),(i.hpx||i.hpt)&&(a|=32),r.write_shift(1,a),r.write_shift(1,0);var o=0,l=r.l;r.l+=4;for(var u={r:e,c:0},c=0;c<16;++c)if(!(t.s.c>c+1<<10||t.e.c<c<<10)){for(var h=-1,p=-1,m=c<<10;m<c+1<<10;++m){u.c=m;var v=Array.isArray(n)?(n[u.r]||[])[u.c]:n[nt(u)];v&&(h<0&&(h=m),p=m)}h<0||(++o,r.write_shift(4,h),r.write_shift(4,p))}var g=r.l;return r.l=l,r.write_shift(4,o),r.l=g,r.length>r.l?r.slice(0,r.l):r}function $W(e,t,n,r){var i=HW(r,n,t);(i.length>17||(t["!rows"]||[])[r])&&_e(e,0,i)}var zW=jo,WW=Mu;function GW(){}function qW(e,t){var n={},r=e[e.l];return++e.l,n.above=!(r&64),n.left=!(r&128),e.l+=18,n.name=XU(e),n}function KW(e,t,n){n==null&&(n=me(84+4*e.length));var r=192;t&&(t.above&&(r&=-65),t.left&&(r&=-129)),n.write_shift(1,r);for(var i=1;i<3;++i)n.write_shift(1,0);return ah({auto:1},n),n.write_shift(-4,-1),n.write_shift(-4,-1),SF(e,n),n.slice(0,n.l)}function YW(e){var t=Ci(e);return[t]}function XW(e,t,n){return n==null&&(n=me(8)),Xo(t,n)}function JW(e){var t=Jo(e);return[t]}function QW(e,t,n){return n==null&&(n=me(4)),Qo(t,n)}function jW(e){var t=Ci(e),n=e.read_shift(1);return[t,n,"b"]}function ZW(e,t,n){return n==null&&(n=me(9)),Xo(t,n),n.write_shift(1,e.v?1:0),n}function eG(e){var t=Jo(e),n=e.read_shift(1);return[t,n,"b"]}function tG(e,t,n){return n==null&&(n=me(5)),Qo(t,n),n.write_shift(1,e.v?1:0),n}function nG(e){var t=Ci(e),n=e.read_shift(1);return[t,n,"e"]}function rG(e,t,n){return n==null&&(n=me(9)),Xo(t,n),n.write_shift(1,e.v),n}function iG(e){var t=Jo(e),n=e.read_shift(1);return[t,n,"e"]}function sG(e,t,n){return n==null&&(n=me(8)),Qo(t,n),n.write_shift(1,e.v),n.write_shift(2,0),n.write_shift(1,0),n}function aG(e){var t=Ci(e),n=e.read_shift(4);return[t,n,"s"]}function oG(e,t,n){return n==null&&(n=me(12)),Xo(t,n),n.write_shift(4,t.v),n}function lG(e){var t=Jo(e),n=e.read_shift(4);return[t,n,"s"]}function uG(e,t,n){return n==null&&(n=me(8)),Qo(t,n),n.write_shift(4,t.v),n}function cG(e){var t=Ci(e),n=ur(e);return[t,n,"n"]}function fG(e,t,n){return n==null&&(n=me(16)),Xo(t,n),Io(e.v,n),n}function AD(e){var t=Jo(e),n=ur(e);return[t,n,"n"]}function dG(e,t,n){return n==null&&(n=me(12)),Qo(t,n),Io(e.v,n),n}function hG(e){var t=Ci(e),n=U1(e);return[t,n,"n"]}function pG(e,t,n){return n==null&&(n=me(12)),Xo(t,n),EF(e.v,n),n}function mG(e){var t=Jo(e),n=U1(e);return[t,n,"n"]}function gG(e,t,n){return n==null&&(n=me(8)),Qo(t,n),EF(e.v,n),n}function vG(e){var t=Ci(e),n=L1(e);return[t,n,"is"]}function xG(e){var t=Ci(e),n=hr(e);return[t,n,"str"]}function yG(e,t,n){return n==null&&(n=me(12+4*e.v.length)),Xo(t,n),$n(e.v,n),n.length>n.l?n.slice(0,n.l):n}function wG(e){var t=Jo(e),n=hr(e);return[t,n,"str"]}function TG(e,t,n){return n==null&&(n=me(8+4*e.v.length)),Qo(t,n),$n(e.v,n),n.length>n.l?n.slice(0,n.l):n}function SG(e,t,n){var r=e.l+t,i=Ci(e);i.r=n["!row"];var s=e.read_shift(1),a=[i,s,"b"];if(n.cellFormula){e.l+=2;var o=rp(e,r-e.l,n);a[3]=ar(o,null,i,n.supbooks,n)}else e.l=r;return a}function EG(e,t,n){var r=e.l+t,i=Ci(e);i.r=n["!row"];var s=e.read_shift(1),a=[i,s,"e"];if(n.cellFormula){e.l+=2;var o=rp(e,r-e.l,n);a[3]=ar(o,null,i,n.supbooks,n)}else e.l=r;return a}function _G(e,t,n){var r=e.l+t,i=Ci(e);i.r=n["!row"];var s=ur(e),a=[i,s,"n"];if(n.cellFormula){e.l+=2;var o=rp(e,r-e.l,n);a[3]=ar(o,null,i,n.supbooks,n)}else e.l=r;return a}function CG(e,t,n){var r=e.l+t,i=Ci(e);i.r=n["!row"];var s=hr(e),a=[i,s,"str"];if(n.cellFormula){e.l+=2;var o=rp(e,r-e.l,n);a[3]=ar(o,null,i,n.supbooks,n)}else e.l=r;return a}var kG=jo,AG=Mu;function RG(e,t){return t==null&&(t=me(4)),t.write_shift(4,e),t}function MG(e,t){var n=e.l+t,r=jo(e),i=O1(e),s=hr(e),a=hr(e),o=hr(e);e.l=n;var l={rfx:r,relId:i,loc:s,display:o};return a&&(l.Tooltip=a),l}function FG(e,t){var n=me(50+4*(e[1].Target.length+(e[1].Tooltip||"").length));Mu({s:ln(e[0]),e:ln(e[0])},n),B1("rId"+t,n);var r=e[1].Target.indexOf("#"),i=r==-1?"":e[1].Target.slice(r+1);return $n(i||"",n),$n(e[1].Tooltip||"",n),$n("",n),n.slice(0,n.l)}function DG(){}function PG(e,t,n){var r=e.l+t,i=_F(e),s=e.read_shift(1),a=[i];if(a[2]=s,n.cellFormula){var o=nW(e,r-e.l,n);a[1]=o}else e.l=r;return a}function IG(e,t,n){var r=e.l+t,i=jo(e),s=[i];if(n.cellFormula){var a=iW(e,r-e.l,n);s[1]=a,e.l=r}else e.l=r;return s}function NG(e,t,n){n==null&&(n=me(18));var r=ip(e,t);n.write_shift(-4,e),n.write_shift(-4,e),n.write_shift(4,(r.width||10)*256),n.write_shift(4,0);var i=0;return t.hidden&&(i|=1),typeof r.width=="number"&&(i|=2),t.level&&(i|=t.level<<8),n.write_shift(2,i),n}var RD=["left","right","top","bottom","header","footer"];function bG(e){var t={};return RD.forEach(function(n){t[n]=ur(e)}),t}function LG(e,t){return t==null&&(t=me(6*8)),Eo(e),RD.forEach(function(n){Io(e[n],t)}),t}function OG(e){var t=e.read_shift(2);return e.l+=28,{RTL:t&32}}function BG(e,t,n){n==null&&(n=me(30));var r=924;return(((t||{}).Views||[])[0]||{}).RTL&&(r|=32),n.write_shift(2,r),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(1,0),n.write_shift(1,0),n.write_shift(2,0),n.write_shift(2,100),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(2,0),n.write_shift(4,0),n}function UG(e){var t=me(24);return t.write_shift(4,4),t.write_shift(4,1),Mu(e,t),t}function VG(e,t){return t==null&&(t=me(16*4+2)),t.write_shift(2,e.password?G1(e.password):0),t.write_shift(4,1),[["objects",!1],["scenarios",!1],["formatCells",!0],["formatColumns",!0],["formatRows",!0],["insertColumns",!0],["insertRows",!0],["insertHyperlinks",!0],["deleteColumns",!0],["deleteRows",!0],["selectLockedCells",!1],["sort",!0],["autoFilter",!0],["pivotTables",!0],["selectUnlockedCells",!1]].forEach(function(n){n[1]?t.write_shift(4,e[n[0]]!=null&&!e[n[0]]?1:0):t.write_shift(4,e[n[0]]!=null&&e[n[0]]?0:1)}),t}function HG(){}function $G(){}function zG(e,t,n,r,i,s,a){if(!e)return e;var o=t||{};r||(r={"!id":{}});var l=o.dense?[]:{},u,c={s:{r:2e6,c:2e6},e:{r:0,c:0}},h=!1,p=!1,m,v,g,w,x,T,y,_,k,S=[];o.biff=12,o["!row"]=0;var C=0,M=!1,F=[],b={},V=o.supbooks||i.supbooks||[[]];if(V.sharedf=b,V.arrayf=F,V.SheetNames=i.SheetNames||i.Sheets.map(function(ne){return ne.name}),!o.supbooks&&(o.supbooks=V,i.Names))for(var z=0;z<i.Names.length;++z)V[0][z+1]=i.Names[z];var ie=[],Q=[],se=!1;Tf[16]={n:"BrtShortReal",f:AD};var de;if(zs(e,function(H,fe,xe){if(!p)switch(xe){case 148:u=H;break;case 0:m=H,o.sheetRows&&o.sheetRows<=m.r&&(p=!0),_=Sn(w=m.r),o["!row"]=m.r,(H.hidden||H.hpt||H.level!=null)&&(H.hpt&&(H.hpx=xu(H.hpt)),Q[H.r]=H);break;case 2:case 3:case 4:case 5:case 6:case 7:case 8:case 9:case 10:case 11:case 13:case 14:case 15:case 16:case 17:case 18:case 62:switch(v={t:H[2]},H[2]){case"n":v.v=H[1];break;case"s":y=Fc[H[1]],v.v=y.t,v.r=y.r;break;case"b":v.v=!!H[1];break;case"e":v.v=H[1],o.cellText!==!1&&(v.w=Ws[v.v]);break;case"str":v.t="s",v.v=H[1];break;case"is":v.t="s",v.v=H[1].t;break}if((g=a.CellXf[H[0].iStyleRef])&&_D(v,g.numFmtId,null,o,s,a),x=H[0].c==-1?x+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][x]=v):l[on(x)+_]=v,o.cellFormula){for(M=!1,C=0;C<F.length;++C){var L=F[C];m.r>=L[0].s.r&&m.r<=L[0].e.r&&x>=L[0].s.c&&x<=L[0].e.c&&(v.F=lt(L[0]),M=!0)}!M&&H.length>3&&(v.f=H[3])}if(c.s.r>m.r&&(c.s.r=m.r),c.s.c>x&&(c.s.c=x),c.e.r<m.r&&(c.e.r=m.r),c.e.c<x&&(c.e.c=x),o.cellDates&&g&&v.t=="n"&&ku(et[g.numFmtId])){var q=oo(v.v);q&&(v.t="d",v.v=new Date(q.y,q.m-1,q.d,q.H,q.M,q.S,q.u))}de&&(de.type=="XLDAPR"&&(v.D=!0),de=void 0);break;case 1:case 12:if(!o.sheetStubs||h)break;v={t:"z",v:void 0},x=H[0].c==-1?x+1:H[0].c,o.dense?(l[w]||(l[w]=[]),l[w][x]=v):l[on(x)+_]=v,c.s.r>m.r&&(c.s.r=m.r),c.s.c>x&&(c.s.c=x),c.e.r<m.r&&(c.e.r=m.r),c.e.c<x&&(c.e.c=x),de&&(de.type=="XLDAPR"&&(v.D=!0),de=void 0);break;case 176:S.push(H);break;case 49:de=((o.xlmeta||{}).Cell||[])[H-1];break;case 494:var W=r["!id"][H.relId];for(W?(H.Target=W.Target,H.loc&&(H.Target+="#"+H.loc),H.Rel=W):H.relId==""&&(H.Target="#"+H.loc),w=H.rfx.s.r;w<=H.rfx.e.r;++w)for(x=H.rfx.s.c;x<=H.rfx.e.c;++x)o.dense?(l[w]||(l[w]=[]),l[w][x]||(l[w][x]={t:"z",v:void 0}),l[w][x].l=H):(T=nt({c:x,r:w}),l[T]||(l[T]={t:"z",v:void 0}),l[T].l=H);break;case 426:if(!o.cellFormula)break;F.push(H),k=o.dense?l[w][x]:l[on(x)+_],k.f=ar(H[1],c,{r:m.r,c:x},V,o),k.F=lt(H[0]);break;case 427:if(!o.cellFormula)break;b[nt(H[0].s)]=H[1],k=o.dense?l[w][x]:l[on(x)+_],k.f=ar(H[1],c,{r:m.r,c:x},V,o);break;case 60:if(!o.cellStyles)break;for(;H.e>=H.s;)ie[H.e--]={width:H.w/256,hidden:!!(H.flags&1),level:H.level},se||(se=!0,q1(H.w/256)),ba(ie[H.e+1]);break;case 161:l["!autofilter"]={ref:lt(H)};break;case 476:l["!margins"]=H;break;case 147:i.Sheets[n]||(i.Sheets[n]={}),H.name&&(i.Sheets[n].CodeName=H.name),(H.above||H.left)&&(l["!outline"]={above:H.above,left:H.left});break;case 137:i.Views||(i.Views=[{}]),i.Views[0]||(i.Views[0]={}),H.RTL&&(i.Views[0].RTL=!0);break;case 485:break;case 64:case 1053:break;case 151:break;case 152:case 175:case 644:case 625:case 562:case 396:case 1112:case 1146:case 471:case 1050:case 649:case 1105:case 589:case 607:case 564:case 1055:case 168:case 174:case 1180:case 499:case 507:case 550:case 171:case 167:case 1177:case 169:case 1181:case 551:case 552:case 661:case 639:case 478:case 537:case 477:case 536:case 1103:case 680:case 1104:case 1024:case 663:case 535:case 678:case 504:case 1043:case 428:case 170:case 3072:case 50:case 2070:case 1045:break;case 35:h=!0;break;case 36:h=!1;break;case 37:h=!0;break;case 38:h=!1;break;default:if(!fe.T){if(!h||o.WTF)throw new Error("Unexpected record 0x"+xe.toString(16))}}},o),delete o.supbooks,delete o["!row"],!l["!ref"]&&(c.s.r<2e6||u&&(u.e.r>0||u.e.c>0||u.s.r>0||u.s.c>0))&&(l["!ref"]=lt(u||c)),o.sheetRows&&l["!ref"]){var ae=At(l["!ref"]);o.sheetRows<=+ae.e.r&&(ae.e.r=o.sheetRows-1,ae.e.r>c.e.r&&(ae.e.r=c.e.r),ae.e.r<ae.s.r&&(ae.s.r=ae.e.r),ae.e.c>c.e.c&&(ae.e.c=c.e.c),ae.e.c<ae.s.c&&(ae.s.c=ae.e.c),l["!fullref"]=l["!ref"],l["!ref"]=lt(ae))}return S.length>0&&(l["!merges"]=S),ie.length>0&&(l["!cols"]=ie),Q.length>0&&(l["!rows"]=Q),l}function WG(e,t,n,r,i,s,a){if(t.v===void 0)return!1;var o="";switch(t.t){case"b":o=t.v?"1":"0";break;case"d":t=nn(t),t.z=t.z||et[14],t.v=Nn(tn(t.v)),t.t="n";break;case"n":case"e":o=""+t.v;break;default:o=t.v;break}var l={r:n,c:r};switch(l.s=qa(i.cellXfs,t,i),t.l&&s["!links"].push([nt(l),t.l]),t.c&&s["!comments"].push([nt(l),t.c]),t.t){case"s":case"str":return i.bookSST?(o=Q1(i.Strings,t.v,i.revStrings),l.t="s",l.v=o,a?_e(e,18,uG(t,l)):_e(e,7,oG(t,l))):(l.t="str",a?_e(e,17,TG(t,l)):_e(e,6,yG(t,l))),!0;case"n":return t.v==(t.v|0)&&t.v>-1e3&&t.v<1e3?a?_e(e,13,gG(t,l)):_e(e,2,pG(t,l)):a?_e(e,16,dG(t,l)):_e(e,5,fG(t,l)),!0;case"b":return l.t="b",a?_e(e,15,tG(t,l)):_e(e,4,ZW(t,l)),!0;case"e":return l.t="e",a?_e(e,14,sG(t,l)):_e(e,3,rG(t,l)),!0}return a?_e(e,12,QW(t,l)):_e(e,1,XW(t,l)),!0}function GG(e,t,n,r){var i=At(t["!ref"]||"A1"),s,a="",o=[];_e(e,145);var l=Array.isArray(t),u=i.e.r;t["!rows"]&&(u=Math.max(i.e.r,t["!rows"].length-1));for(var c=i.s.r;c<=u;++c){a=Sn(c),$W(e,t,i,c);var h=!1;if(c<=i.e.r)for(var p=i.s.c;p<=i.e.c;++p){c===i.s.r&&(o[p]=on(p)),s=o[p]+a;var m=l?(t[c]||[])[p]:t[s];if(!m){h=!1;continue}h=WG(e,m,c,p,r,t,h)}}_e(e,146)}function qG(e,t){!t||!t["!merges"]||(_e(e,177,RG(t["!merges"].length)),t["!merges"].forEach(function(n){_e(e,176,AG(n))}),_e(e,178))}function KG(e,t){!t||!t["!cols"]||(_e(e,390),t["!cols"].forEach(function(n,r){n&&_e(e,60,NG(r,n))}),_e(e,391))}function YG(e,t){!t||!t["!ref"]||(_e(e,648),_e(e,649,UG(At(t["!ref"]))),_e(e,650))}function XG(e,t,n){t["!links"].forEach(function(r){if(r[1].Target){var i=Ht(n,-1,r[1].Target.replace(/#.*$/,""),pt.HLINK);_e(e,494,FG(r,i))}}),delete t["!links"]}function JG(e,t,n,r){if(t["!comments"].length>0){var i=Ht(r,-1,"../drawings/vmlDrawing"+(n+1)+".vml",pt.VML);_e(e,551,B1("rId"+i)),t["!legacy"]=i}}function QG(e,t,n,r){if(t["!autofilter"]){var i=t["!autofilter"],s=typeof i.ref=="string"?i.ref:lt(i.ref);n.Workbook||(n.Workbook={Sheets:[]}),n.Workbook.Names||(n.Workbook.Names=[]);var a=n.Workbook.Names,o=Br(s);o.s.r==o.e.r&&(o.e.r=Br(t["!ref"]).e.r,s=lt(o));for(var l=0;l<a.length;++l){var u=a[l];if(u.Name=="_xlnm._FilterDatabase"&&u.Sheet==r){u.Ref="'"+n.SheetNames[r]+"'!"+s;break}}l==a.length&&a.push({Name:"_xlnm._FilterDatabase",Sheet:r,Ref:"'"+n.SheetNames[r]+"'!"+s}),_e(e,161,Mu(At(s))),_e(e,162)}}function jG(e,t,n){_e(e,133),_e(e,137,BG(t,n)),_e(e,138),_e(e,134)}function ZG(e,t){t["!protect"]&&_e(e,535,VG(t["!protect"]))}function eq(e,t,n,r){var i=Or(),s=n.SheetNames[e],a=n.Sheets[s]||{},o=s;try{n&&n.Workbook&&(o=n.Workbook.Sheets[e].CodeName||o)}catch{}var l=At(a["!ref"]||"A1");if(l.e.c>16383||l.e.r>1048575){if(t.WTF)throw new Error("Range "+(a["!ref"]||"A1")+" exceeds format limit A1:XFD1048576");l.e.c=Math.min(l.e.c,16383),l.e.r=Math.min(l.e.c,1048575)}return a["!links"]=[],a["!comments"]=[],_e(i,129),(n.vbaraw||a["!outline"])&&_e(i,147,KW(o,a["!outline"])),_e(i,148,WW(l)),jG(i,a,n.Workbook),KG(i,a),GG(i,a,e,t),ZG(i,a),QG(i,a,n,e),qG(i,a),XG(i,a,r),a["!margins"]&&_e(i,476,LG(a["!margins"])),(!t||t.ignoreEC||t.ignoreEC==null)&&YG(i,a),JG(i,a,e,r),_e(i,130),i.end()}function tq(e){var t=[],n=e.match(/^<c:numCache>/),r;(e.match(/<c:pt idx="(\d*)">(.*?)<\/c:pt>/mg)||[]).forEach(function(s){var a=s.match(/<c:pt idx="(\d*?)"><c:v>(.*)<\/c:v><\/c:pt>/);a&&(t[+a[1]]=n?+a[2]:a[2])});var i=kt((e.match(/<c:formatCode>([\s\S]*?)<\/c:formatCode>/)||["","General"])[1]);return(e.match(/<c:f>(.*?)<\/c:f>/mg)||[]).forEach(function(s){r=s.replace(/<.*?>/g,"")}),[t,i,r]}function nq(e,t,n,r,i,s){var a=s||{"!type":"chart"};if(!e)return s;var o=0,l=0,u="A",c={s:{r:2e6,c:2e6},e:{r:0,c:0}};return(e.match(/<c:numCache>[\s\S]*?<\/c:numCache>/gm)||[]).forEach(function(h){var p=tq(h);c.s.r=c.s.c=0,c.e.c=o,u=on(o),p[0].forEach(function(m,v){a[u+Sn(v)]={t:"n",v:m,z:p[1]},l=v}),c.e.r<l&&(c.e.r=l),++o}),o>0&&(a["!ref"]=lt(c)),a}function rq(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a,o=e.match(CD);return o&&j1(o[0],s,i,n),(a=e.match(/drawing r:id="(.*?)"/))&&(s["!rel"]=a[1]),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}function iq(e,t){e.l+=10;var n=hr(e);return{name:n}}function sq(e,t,n,r,i){if(!e)return e;r||(r={"!id":{}});var s={"!type":"chart","!drawel":null,"!rel":""},a=!1;return zs(e,function(l,u,c){switch(c){case 550:s["!rel"]=l;break;case 651:i.Sheets[n]||(i.Sheets[n]={}),l.name&&(i.Sheets[n].CodeName=l.name);break;case 562:case 652:case 669:case 679:case 551:case 552:case 476:case 3072:break;case 35:a=!0;break;case 36:a=!1;break;case 37:break;case 38:break;default:if(!(u.T>0)){if(!(u.T<0)){if(!a||t.WTF)throw new Error("Unexpected record 0x"+c.toString(16))}}}},t),r["!id"][s["!rel"]]&&(s["!drawel"]=r["!id"][s["!rel"]]),s}var Z1=[["allowRefreshQuery",!1,"bool"],["autoCompressPictures",!0,"bool"],["backupFile",!1,"bool"],["checkCompatibility",!1,"bool"],["CodeName",""],["date1904",!1,"bool"],["defaultThemeVersion",0,"int"],["filterPrivacy",!1,"bool"],["hidePivotFieldList",!1,"bool"],["promptedSolutions",!1,"bool"],["publishItems",!1,"bool"],["refreshAllConnections",!1,"bool"],["saveExternalLinkValues",!0,"bool"],["showBorderUnselectedTables",!0,"bool"],["showInkAnnotation",!0,"bool"],["showObjects","all"],["showPivotChartFilter",!1,"bool"],["updateLinks","userSet"]],aq=[["activeTab",0,"int"],["autoFilterDateGrouping",!0,"bool"],["firstSheet",0,"int"],["minimized",!1,"bool"],["showHorizontalScroll",!0,"bool"],["showSheetTabs",!0,"bool"],["showVerticalScroll",!0,"bool"],["tabRatio",600,"int"],["visibility","visible"]],oq=[],lq=[["calcCompleted","true"],["calcMode","auto"],["calcOnSave","true"],["concurrentCalc","true"],["fullCalcOnLoad","false"],["fullPrecision","true"],["iterate","false"],["iterateCount","100"],["iterateDelta","0.001"],["refMode","A1"]];function DE(e,t){for(var n=0;n!=e.length;++n)for(var r=e[n],i=0;i!=t.length;++i){var s=t[i];if(r[s[0]]==null)r[s[0]]=s[1];else switch(s[2]){case"bool":typeof r[s[0]]=="string"&&(r[s[0]]=jt(r[s[0]]));break;case"int":typeof r[s[0]]=="string"&&(r[s[0]]=parseInt(r[s[0]],10));break}}}function PE(e,t){for(var n=0;n!=t.length;++n){var r=t[n];if(e[r[0]]==null)e[r[0]]=r[1];else switch(r[2]){case"bool":typeof e[r[0]]=="string"&&(e[r[0]]=jt(e[r[0]]));break;case"int":typeof e[r[0]]=="string"&&(e[r[0]]=parseInt(e[r[0]],10));break}}}function MD(e){PE(e.WBProps,Z1),PE(e.CalcPr,lq),DE(e.WBView,aq),DE(e.Sheets,oq),Hl.date1904=jt(e.WBProps.date1904)}function uq(e){return!e.Workbook||!e.Workbook.WBProps?"false":jt(e.Workbook.WBProps.date1904)?"true":"false"}var cq="][*?/\\".split("");function FD(e,t){if(e.length>31)throw new Error("Sheet names cannot exceed 31 chars");var n=!0;return cq.forEach(function(r){if(e.indexOf(r)!=-1)throw new Error("Sheet name cannot contain : \\ / ? * [ ]")}),n}function fq(e,t,n){e.forEach(function(r,i){FD(r);for(var s=0;s<i;++s)if(r==e[s])throw new Error("Duplicate Sheet Name: "+r);if(n){var a=t&&t[i]&&t[i].CodeName||r;if(a.charCodeAt(0)==95&&a.length>22)throw new Error("Bad Code Name: Worksheet"+a)}})}function dq(e){if(!e||!e.SheetNames||!e.Sheets)throw new Error("Invalid Workbook");if(!e.SheetNames.length)throw new Error("Workbook is empty");var t=e.Workbook&&e.Workbook.Sheets||[];fq(e.SheetNames,t,!!e.vbaraw);for(var n=0;n<e.SheetNames.length;++n)uW(e.Sheets[e.SheetNames[n]],e.SheetNames[n],n)}var hq=/<\w+:workbook/;function pq(e,t){if(!e)throw new Error("Could not find file");var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},Names:[],xmlns:""},r=!1,i="xmlns",s={},a=0;if(e.replace(gr,function(l,u){var c=it(l);switch(hs(c[0])){case"<?xml":break;case"<workbook":l.match(hq)&&(i="xmlns"+l.match(/<(\w+):/)[1]),n.xmlns=c[i];break;case"</workbook>":break;case"<fileVersion":delete c[0],n.AppVersion=c;break;case"<fileVersion/>":case"</fileVersion>":break;case"<fileSharing":break;case"<fileSharing/>":break;case"<workbookPr":case"<workbookPr/>":Z1.forEach(function(h){if(c[h[0]]!=null)switch(h[2]){case"bool":n.WBProps[h[0]]=jt(c[h[0]]);break;case"int":n.WBProps[h[0]]=parseInt(c[h[0]],10);break;default:n.WBProps[h[0]]=c[h[0]]}}),c.codeName&&(n.WBProps.CodeName=qt(c.codeName));break;case"</workbookPr>":break;case"<workbookProtection":break;case"<workbookProtection/>":break;case"<bookViews":case"<bookViews>":case"</bookViews>":break;case"<workbookView":case"<workbookView/>":delete c[0],n.WBView.push(c);break;case"</workbookView>":break;case"<sheets":case"<sheets>":case"</sheets>":break;case"<sheet":switch(c.state){case"hidden":c.Hidden=1;break;case"veryHidden":c.Hidden=2;break;default:c.Hidden=0}delete c.state,c.name=kt(qt(c.name)),delete c[0],n.Sheets.push(c);break;case"</sheet>":break;case"<functionGroups":case"<functionGroups/>":break;case"<functionGroup":break;case"<externalReferences":case"</externalReferences>":case"<externalReferences>":break;case"<externalReference":break;case"<definedNames/>":break;case"<definedNames>":case"<definedNames":r=!0;break;case"</definedNames>":r=!1;break;case"<definedName":s={},s.Name=qt(c.name),c.comment&&(s.Comment=c.comment),c.localSheetId&&(s.Sheet=+c.localSheetId),jt(c.hidden||"0")&&(s.Hidden=!0),a=u+l.length;break;case"</definedName>":s.Ref=kt(qt(e.slice(a,u))),n.Names.push(s);break;case"<definedName/>":break;case"<calcPr":delete c[0],n.CalcPr=c;break;case"<calcPr/>":delete c[0],n.CalcPr=c;break;case"</calcPr>":break;case"<oleSize":break;case"<customWorkbookViews>":case"</customWorkbookViews>":case"<customWorkbookViews":break;case"<customWorkbookView":case"</customWorkbookView>":break;case"<pivotCaches>":case"</pivotCaches>":case"<pivotCaches":break;case"<pivotCache":break;case"<smartTagPr":case"<smartTagPr/>":break;case"<smartTagTypes":case"<smartTagTypes>":case"</smartTagTypes>":break;case"<smartTagType":break;case"<webPublishing":case"<webPublishing/>":break;case"<fileRecoveryPr":case"<fileRecoveryPr/>":break;case"<webPublishObjects>":case"<webPublishObjects":case"</webPublishObjects>":break;case"<webPublishObject":break;case"<extLst":case"<extLst>":case"</extLst>":case"<extLst/>":break;case"<ext":r=!0;break;case"</ext>":r=!1;break;case"<ArchID":break;case"<AlternateContent":case"<AlternateContent>":r=!0;break;case"</AlternateContent>":r=!1;break;case"<revisionPtr":break;default:if(!r&&t.WTF)throw new Error("unrecognized "+c[0]+" in workbook")}return l}),Yo.indexOf(n.xmlns)===-1)throw new Error("Unknown Namespace: "+n.xmlns);return MD(n),n}function DD(e){var t=[En];t[t.length]=Pe("workbook",null,{xmlns:Yo[0],"xmlns:r":Pn.r});var n=e.Workbook&&(e.Workbook.Names||[]).length>0,r={codeName:"ThisWorkbook"};e.Workbook&&e.Workbook.WBProps&&(Z1.forEach(function(o){e.Workbook.WBProps[o[0]]!=null&&e.Workbook.WBProps[o[0]]!=o[1]&&(r[o[0]]=e.Workbook.WBProps[o[0]])}),e.Workbook.WBProps.CodeName&&(r.codeName=e.Workbook.WBProps.CodeName,delete r.CodeName)),t[t.length]=Pe("workbookPr",null,r);var i=e.Workbook&&e.Workbook.Sheets||[],s=0;if(i&&i[0]&&i[0].Hidden){for(t[t.length]="<bookViews>",s=0;s!=e.SheetNames.length&&!(!i[s]||!i[s].Hidden);++s);s==e.SheetNames.length&&(s=0),t[t.length]='<workbookView firstSheet="'+s+'" activeTab="'+s+'"/>',t[t.length]="</bookViews>"}for(t[t.length]="<sheets>",s=0;s!=e.SheetNames.length;++s){var a={name:$t(e.SheetNames[s].slice(0,31))};if(a.sheetId=""+(s+1),a["r:id"]="rId"+(s+1),i[s])switch(i[s].Hidden){case 1:a.state="hidden";break;case 2:a.state="veryHidden";break}t[t.length]=Pe("sheet",null,a)}return t[t.length]="</sheets>",n&&(t[t.length]="<definedNames>",e.Workbook&&e.Workbook.Names&&e.Workbook.Names.forEach(function(o){var l={name:o.Name};o.Comment&&(l.comment=o.Comment),o.Sheet!=null&&(l.localSheetId=""+o.Sheet),o.Hidden&&(l.hidden="1"),o.Ref&&(t[t.length]=Pe("definedName",$t(o.Ref),l))}),t[t.length]="</definedNames>"),t.length>2&&(t[t.length]="</workbook>",t[1]=t[1].replace("/>",">")),t.join("")}function mq(e,t){var n={};return n.Hidden=e.read_shift(4),n.iTabID=e.read_shift(4),n.strRelID=Vg(e),n.name=hr(e),n}function gq(e,t){return t||(t=me(127)),t.write_shift(4,e.Hidden),t.write_shift(4,e.iTabID),B1(e.strRelID,t),$n(e.name.slice(0,31),t),t.length>t.l?t.slice(0,t.l):t}function vq(e,t){var n={},r=e.read_shift(4);n.defaultThemeVersion=e.read_shift(4);var i=t>8?hr(e):"";return i.length>0&&(n.CodeName=i),n.autoCompressPictures=!!(r&65536),n.backupFile=!!(r&64),n.checkCompatibility=!!(r&4096),n.date1904=!!(r&1),n.filterPrivacy=!!(r&8),n.hidePivotFieldList=!!(r&1024),n.promptedSolutions=!!(r&16),n.publishItems=!!(r&2048),n.refreshAllConnections=!!(r&262144),n.saveExternalLinkValues=!!(r&128),n.showBorderUnselectedTables=!!(r&4),n.showInkAnnotation=!!(r&32),n.showObjects=["all","placeholders","none"][r>>13&3],n.showPivotChartFilter=!!(r&32768),n.updateLinks=["userSet","never","always"][r>>8&3],n}function xq(e,t){t||(t=me(72));var n=0;return e&&e.filterPrivacy&&(n|=8),t.write_shift(4,n),t.write_shift(4,0),SF(e&&e.CodeName||"ThisWorkbook",t),t.slice(0,t.l)}function yq(e,t){var n={};return e.read_shift(4),n.ArchID=e.read_shift(4),e.l+=t-8,n}function wq(e,t,n){var r=e.l+t;e.l+=4,e.l+=1;var i=e.read_shift(4),s=JU(e),a=rW(e,0,n),o=O1(e);e.l=r;var l={Name:s,Ptg:a};return i<268435455&&(l.Sheet=i),o&&(l.Comment=o),l}function Tq(e,t){var n={AppVersion:{},WBProps:{},WBView:[],Sheets:[],CalcPr:{},xmlns:""},r=[],i=!1;t||(t={}),t.biff=12;var s=[],a=[[]];return a.SheetNames=[],a.XTI=[],Tf[16]={n:"BrtFRTArchID$",f:yq},zs(e,function(l,u,c){switch(c){case 156:a.SheetNames.push(l.name),n.Sheets.push(l);break;case 153:n.WBProps=l;break;case 39:l.Sheet!=null&&(t.SID=l.Sheet),l.Ref=ar(l.Ptg,null,null,a,t),delete t.SID,delete l.Ptg,s.push(l);break;case 1036:break;case 357:case 358:case 355:case 667:a[0].length?a.push([c,l]):a[0]=[c,l],a[a.length-1].XTI=[];break;case 362:a.length===0&&(a[0]=[],a[0].XTI=[]),a[a.length-1].XTI=a[a.length-1].XTI.concat(l),a.XTI=a.XTI.concat(l);break;case 361:break;case 2071:case 158:case 143:case 664:case 353:break;case 3072:case 3073:case 534:case 677:case 157:case 610:case 2050:case 155:case 548:case 676:case 128:case 665:case 2128:case 2125:case 549:case 2053:case 596:case 2076:case 2075:case 2082:case 397:case 154:case 1117:case 553:case 2091:break;case 35:r.push(c),i=!0;break;case 36:r.pop(),i=!1;break;case 37:r.push(c),i=!0;break;case 38:r.pop(),i=!1;break;case 16:break;default:if(!u.T){if(!i||t.WTF&&r[r.length-1]!=37&&r[r.length-1]!=35)throw new Error("Unexpected record 0x"+c.toString(16))}}},t),MD(n),n.Names=s,n.supbooks=a,n}function Sq(e,t){_e(e,143);for(var n=0;n!=t.SheetNames.length;++n){var r=t.Workbook&&t.Workbook.Sheets&&t.Workbook.Sheets[n]&&t.Workbook.Sheets[n].Hidden||0,i={Hidden:r,iTabID:n+1,strRelID:"rId"+(n+1),name:t.SheetNames[n]};_e(e,156,gq(i))}_e(e,144)}function Eq(e,t){t||(t=me(127));for(var n=0;n!=4;++n)t.write_shift(4,0);return $n("SheetJS",t),$n(Z0.version,t),$n(Z0.version,t),$n("7262",t),t.length>t.l?t.slice(0,t.l):t}function _q(e,t){t||(t=me(29)),t.write_shift(-4,0),t.write_shift(-4,460),t.write_shift(4,28800),t.write_shift(4,17600),t.write_shift(4,500),t.write_shift(4,e),t.write_shift(4,e);var n=120;return t.write_shift(1,n),t.length>t.l?t.slice(0,t.l):t}function Cq(e,t){if(!(!t.Workbook||!t.Workbook.Sheets)){for(var n=t.Workbook.Sheets,r=0,i=-1,s=-1;r<n.length;++r)!n[r]||!n[r].Hidden&&i==-1?i=r:n[r].Hidden==1&&s==-1&&(s=r);s>i||(_e(e,135),_e(e,158,_q(i)),_e(e,136))}}function kq(e,t){var n=Or();return _e(n,131),_e(n,128,Eq()),_e(n,153,xq(e.Workbook&&e.Workbook.WBProps||null)),Cq(n,e),Sq(n,e),_e(n,132),n.end()}function Aq(e,t,n){return t.slice(-4)===".bin"?Tq(e,n):pq(e,n)}function Rq(e,t,n,r,i,s,a,o){return t.slice(-4)===".bin"?zG(e,r,n,i,s,a,o):wW(e,r,n,i,s,a,o)}function Mq(e,t,n,r,i,s,a,o){return t.slice(-4)===".bin"?sq(e,r,n,i,s):rq(e,r,n,i,s)}function Fq(e,t,n,r,i,s,a,o){return t.slice(-4)===".bin"?P$():I$()}function Dq(e,t,n,r,i,s,a,o){return t.slice(-4)===".bin"?F$():D$()}function Pq(e,t,n,r){return t.slice(-4)===".bin"?AH(e,n,r):mH(e,n,r)}function Iq(e,t,n){return fD(e,n)}function Nq(e,t,n){return t.slice(-4)===".bin"?N7(e,n):D7(e,n)}function bq(e,t,n){return t.slice(-4)===".bin"?C$(e,n):g$(e,n)}function Lq(e,t,n){return t.slice(-4)===".bin"?h$(e):f$(e)}function Oq(e,t,n,r){return n.slice(-4)===".bin"?p$(e,t,n,r):void 0}function Bq(e,t,n){return t.slice(-4)===".bin"?l$(e,t,n):c$(e,t,n)}function Uq(e,t,n){return(t.slice(-4)===".bin"?kq:DD)(e)}function Vq(e,t,n,r,i){return(t.slice(-4)===".bin"?eq:kD)(e,n,r,i)}function Hq(e,t,n){return(t.slice(-4)===".bin"?OH:uD)(e,n)}function $q(e,t,n){return(t.slice(-4)===".bin"?O7:tD)(e,n)}function zq(e,t,n){return(t.slice(-4)===".bin"?k$:pD)(e)}function Wq(e){return(e.slice(-4)===".bin"?u$:dD)()}var PD=/([\w:]+)=((?:")([^"]*)(?:")|(?:')([^']*)(?:'))/g,ID=/([\w:]+)=((?:")(?:[^"]*)(?:")|(?:')(?:[^']*)(?:'))/;function Mi(e,t){var n=e.split(/\s+/),r=[];if(r[0]=n[0],n.length===1)return r;var i=e.match(PD),s,a,o,l;if(i)for(l=0;l!=i.length;++l)s=i[l].match(ID),(a=s[1].indexOf(":"))===-1?r[s[1]]=s[2].slice(1,s[2].length-1):(s[1].slice(0,6)==="xmlns:"?o="xmlns"+s[1].slice(6):o=s[1].slice(a+1),r[o]=s[2].slice(1,s[2].length-1));return r}function Gq(e){var t=e.split(/\s+/),n={};if(t.length===1)return n;var r=e.match(PD),i,s,a,o;if(r)for(o=0;o!=r.length;++o)i=r[o].match(ID),(s=i[1].indexOf(":"))===-1?n[i[1]]=i[2].slice(1,i[2].length-1):(i[1].slice(0,6)==="xmlns:"?a="xmlns"+i[1].slice(6):a=i[1].slice(s+1),n[a]=i[2].slice(1,i[2].length-1));return n}var Pc;function qq(e,t){var n=Pc[e]||kt(e);return n==="General"?Do(t):_i(n,t)}function Kq(e,t,n,r){var i=r;switch((n[0].match(/dt:dt="([\w.]+)"/)||["",""])[1]){case"boolean":i=jt(r);break;case"i2":case"int":i=parseInt(r,10);break;case"r4":case"float":i=parseFloat(r);break;case"date":case"dateTime.tz":i=tn(r);break;case"i8":case"string":case"fixed":case"uuid":case"bin.base64":break;default:throw new Error("bad custprop:"+n[0])}e[kt(t)]=i}function Yq(e,t,n){if(e.t!=="z"){if(!n||n.cellText!==!1)try{e.t==="e"?e.w=e.w||Ws[e.v]:t==="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=df(e.v):e.w=Do(e.v):e.w=qq(t||"General",e.v)}catch(s){if(n.WTF)throw s}try{var r=Pc[t]||t||"General";if(n.cellNF&&(e.z=r),n.cellDates&&e.t=="n"&&ku(r)){var i=oo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}catch(s){if(n.WTF)throw s}}}function Xq(e,t,n){if(n.cellStyles&&t.Interior){var r=t.Interior;r.Pattern&&(r.patternType=oH[r.Pattern]||r.Pattern)}e[t.ID]=t}function Jq(e,t,n,r,i,s,a,o,l,u){var c="General",h=r.StyleID,p={};u=u||{};var m=[],v=0;for(h===void 0&&o&&(h=o.StyleID),h===void 0&&a&&(h=a.StyleID);s[h]!==void 0&&(s[h].nf&&(c=s[h].nf),s[h].Interior&&m.push(s[h].Interior),!!s[h].Parent);)h=s[h].Parent;switch(n.Type){case"Boolean":r.t="b",r.v=jt(e);break;case"String":r.t="s",r.r=XS(kt(e)),r.v=e.indexOf("<")>-1?kt(t||e).replace(/<.*?>/g,""):r.r;break;case"DateTime":e.slice(-1)!="Z"&&(e+="Z"),r.v=(tn(e)-new Date(Date.UTC(1899,11,30)))/(24*60*60*1e3),r.v!==r.v?r.v=kt(e):r.v<60&&(r.v=r.v-1),(!c||c=="General")&&(c="yyyy-mm-dd");case"Number":r.v===void 0&&(r.v=+e),r.t||(r.t="n");break;case"Error":r.t="e",r.v=AF[e],u.cellText!==!1&&(r.w=e);break;default:e==""&&t==""?r.t="z":(r.t="s",r.v=XS(t||e));break}if(Yq(r,c,u),u.cellFormula!==!1)if(r.Formula){var g=kt(r.Formula);g.charCodeAt(0)==61&&(g=g.slice(1)),r.f=Vl(g,i),delete r.Formula,r.ArrayRange=="RC"?r.F=Vl("RC:RC",i):r.ArrayRange&&(r.F=Vl(r.ArrayRange,i),l.push([At(r.F),r.F]))}else for(v=0;v<l.length;++v)i.r>=l[v][0].s.r&&i.r<=l[v][0].e.r&&i.c>=l[v][0].s.c&&i.c<=l[v][0].e.c&&(r.F=l[v][1]);u.cellStyles&&(m.forEach(function(w){!p.patternType&&w.patternType&&(p.patternType=w.patternType)}),r.s=p),r.StyleID!==void 0&&(r.ixfe=r.StyleID)}function Qq(e){e.t=e.v||"",e.t=e.t.replace(/\r\n/g,`
`).replace(/\r/g,`
`),e.v=e.w=e.ixfe=void 0}function pm(e,t){var n=t||{};Au();var r=uc(D1(e));(n.type=="binary"||n.type=="array"||n.type=="base64")&&(r=qt(r));var i=r.slice(0,1024).toLowerCase(),s=!1;if(i=i.replace(/".*?"/g,""),(i.indexOf(">")&1023)>Math.min(i.indexOf(",")&1023,i.indexOf(";")&1023)){var a=nn(n);return a.type="string",vu.to_workbook(r,a)}if(i.indexOf("<?xml")==-1&&["html","table","head","meta","script","style","div"].forEach(function(ht){i.indexOf("<"+ht)>=0&&(s=!0)}),s)return LK(r,n);Pc={"General Number":"General","General Date":et[22],"Long Date":"dddd, mmmm dd, yyyy","Medium Date":et[15],"Short Date":et[14],"Long Time":et[19],"Medium Time":et[18],"Short Time":et[20],Currency:'"$"#,##0.00_);[Red]\\("$"#,##0.00\\)',Fixed:et[2],Standard:et[4],Percent:et[10],Scientific:et[11],"Yes/No":'"Yes";"Yes";"No";@',"True/False":'"True";"True";"False";@',"On/Off":'"Yes";"Yes";"No";@'};var o,l=[],u,c={},h=[],p=n.dense?[]:{},m="",v={},g={},w=Mi('<Data ss:Type="String">'),x=0,T=0,y=0,_={s:{r:2e6,c:2e6},e:{r:0,c:0}},k={},S={},C="",M=0,F=[],b={},V={},z=0,ie=[],Q=[],se={},de=[],ae,ne=!1,H=[],fe=[],xe={},L=0,q=0,W={Sheets:[],WBProps:{date1904:!1}},G={};mf.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"");for(var ee="";o=mf.exec(r);)switch(o[3]=(ee=o[3]).toLowerCase()){case"data":if(ee=="data"){if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break}if(l[l.length-1][1])break;o[1]==="/"?Jq(r.slice(x,o.index),C,w,l[l.length-1][0]=="comment"?se:v,{c:T,r:y},k,de[T],g,H,n):(C="",w=Mi(o[0]),x=o.index+o[0].length);break;case"cell":if(o[1]==="/")if(Q.length>0&&(v.c=Q),(!n.sheetRows||n.sheetRows>y)&&v.v!==void 0&&(n.dense?(p[y]||(p[y]=[]),p[y][T]=v):p[on(T)+Sn(y)]=v),v.HRef&&(v.l={Target:kt(v.HRef)},v.HRefScreenTip&&(v.l.Tooltip=v.HRefScreenTip),delete v.HRef,delete v.HRefScreenTip),(v.MergeAcross||v.MergeDown)&&(L=T+(parseInt(v.MergeAcross,10)|0),q=y+(parseInt(v.MergeDown,10)|0),F.push({s:{c:T,r:y},e:{c:L,r:q}})),!n.sheetStubs)v.MergeAcross?T=L+1:++T;else if(v.MergeAcross||v.MergeDown){for(var Se=T;Se<=L;++Se)for(var we=y;we<=q;++we)(Se>T||we>y)&&(n.dense?(p[we]||(p[we]=[]),p[we][Se]={t:"z"}):p[on(Se)+Sn(we)]={t:"z"});T=L+1}else++T;else v=Gq(o[0]),v.Index&&(T=+v.Index-1),T<_.s.c&&(_.s.c=T),T>_.e.c&&(_.e.c=T),o[0].slice(-2)==="/>"&&++T,Q=[];break;case"row":o[1]==="/"||o[0].slice(-2)==="/>"?(y<_.s.r&&(_.s.r=y),y>_.e.r&&(_.e.r=y),o[0].slice(-2)==="/>"&&(g=Mi(o[0]),g.Index&&(y=+g.Index-1)),T=0,++y):(g=Mi(o[0]),g.Index&&(y=+g.Index-1),xe={},(g.AutoFitHeight=="0"||g.Height)&&(xe.hpx=parseInt(g.Height,10),xe.hpt=wf(xe.hpx),fe[y]=xe),g.Hidden=="1"&&(xe.hidden=!0,fe[y]=xe));break;case"worksheet":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));h.push(m),_.s.r<=_.e.r&&_.s.c<=_.e.c&&(p["!ref"]=lt(_),n.sheetRows&&n.sheetRows<=_.e.r&&(p["!fullref"]=p["!ref"],_.e.r=n.sheetRows-1,p["!ref"]=lt(_))),F.length&&(p["!merges"]=F),de.length>0&&(p["!cols"]=de),fe.length>0&&(p["!rows"]=fe),c[m]=p}else _={s:{r:2e6,c:2e6},e:{r:0,c:0}},y=T=0,l.push([o[3],!1]),u=Mi(o[0]),m=kt(u.Name),p=n.dense?[]:{},F=[],H=[],fe=[],G={name:m,Hidden:0},W.Sheets.push(G);break;case"table":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else{if(o[0].slice(-2)=="/>")break;l.push([o[3],!1]),de=[],ne=!1}break;case"style":o[1]==="/"?Xq(k,S,n):S=Mi(o[0]);break;case"numberformat":S.nf=kt(Mi(o[0]).Format||"General"),Pc[S.nf]&&(S.nf=Pc[S.nf]);for(var pe=0;pe!=392&&et[pe]!=S.nf;++pe);if(pe==392){for(pe=57;pe!=392;++pe)if(et[pe]==null){Ds(S.nf,pe);break}}break;case"column":if(l[l.length-1][0]!=="table")break;if(ae=Mi(o[0]),ae.Hidden&&(ae.hidden=!0,delete ae.Hidden),ae.Width&&(ae.wpx=parseInt(ae.Width,10)),!ne&&ae.wpx>10){ne=!0,lr=oD;for(var oe=0;oe<de.length;++oe)de[oe]&&ba(de[oe])}ne&&ba(ae),de[ae.Index-1||de.length]=ae;for(var Le=0;Le<+ae.Span;++Le)de[de.length]=nn(ae);break;case"namedrange":if(o[1]==="/")break;W.Names||(W.Names=[]);var B=it(o[0]),st={Name:B.Name,Ref:Vl(B.RefersTo.slice(1),{r:0,c:0})};W.Sheets.length>0&&(st.Sheet=W.Sheets.length-1),W.Names.push(st);break;case"namedcell":break;case"b":break;case"i":break;case"u":break;case"s":break;case"em":break;case"h2":break;case"h3":break;case"sub":break;case"sup":break;case"span":break;case"alignment":break;case"borders":break;case"border":break;case"font":if(o[0].slice(-2)==="/>")break;o[1]==="/"?C+=r.slice(M,o.index):M=o.index+o[0].length;break;case"interior":if(!n.cellStyles)break;S.Interior=Mi(o[0]);break;case"protection":break;case"author":case"title":case"description":case"created":case"keywords":case"subject":case"category":case"company":case"lastauthor":case"lastsaved":case"lastprinted":case"version":case"revision":case"totaltime":case"hyperlinkbase":case"manager":case"contentstatus":case"identifier":case"language":case"appname":if(o[0].slice(-2)==="/>")break;o[1]==="/"?TV(b,ee,r.slice(z,o.index)):z=o.index+o[0].length;break;case"paragraphs":break;case"styles":case"workbook":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else l.push([o[3],!1]);break;case"comment":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"));Qq(se),Q.push(se)}else l.push([o[3],!1]),u=Mi(o[0]),se={a:u.Author};break;case"autofilter":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else if(o[0].charAt(o[0].length-2)!=="/"){var Ue=Mi(o[0]);p["!autofilter"]={ref:Vl(Ue.Range).replace(/\$/g,"")},l.push([o[3],!0])}break;case"name":break;case"datavalidation":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"pixelsperinch":break;case"componentoptions":case"documentproperties":case"customdocumentproperties":case"officedocumentsettings":case"pivottable":case"pivotcache":case"names":case"mapinfo":case"pagebreaks":case"querytable":case"sorting":case"schema":case"conditionalformatting":case"smarttagtype":case"smarttags":case"excelworkbook":case"workbookoptions":case"worksheetoptions":if(o[1]==="/"){if((u=l.pop())[0]!==o[3])throw new Error("Bad state: "+u.join("|"))}else o[0].charAt(o[0].length-2)!=="/"&&l.push([o[3],!0]);break;case"null":break;default:if(l.length==0&&o[3]=="document"||l.length==0&&o[3]=="uof")return OE(r,n);var at=!0;switch(l[l.length-1][0]){case"officedocumentsettings":switch(o[3]){case"allowpng":break;case"removepersonalinformation":break;case"downloadcomponents":break;case"locationofcomponents":break;case"colors":break;case"color":break;case"index":break;case"rgb":break;case"targetscreensize":break;case"readonlyrecommended":break;default:at=!1}break;case"componentoptions":switch(o[3]){case"toolbar":break;case"hideofficelogo":break;case"spreadsheetautofit":break;case"label":break;case"caption":break;case"maxheight":break;case"maxwidth":break;case"nextsheetnumber":break;default:at=!1}break;case"excelworkbook":switch(o[3]){case"date1904":W.WBProps.date1904=!0;break;case"windowheight":break;case"windowwidth":break;case"windowtopx":break;case"windowtopy":break;case"tabratio":break;case"protectstructure":break;case"protectwindow":break;case"protectwindows":break;case"activesheet":break;case"displayinknotes":break;case"firstvisiblesheet":break;case"supbook":break;case"sheetname":break;case"sheetindex":break;case"sheetindexfirst":break;case"sheetindexlast":break;case"dll":break;case"acceptlabelsinformulas":break;case"donotsavelinkvalues":break;case"iteration":break;case"maxiterations":break;case"maxchange":break;case"path":break;case"xct":break;case"count":break;case"selectedsheets":break;case"calculation":break;case"uncalced":break;case"startupprompt":break;case"crn":break;case"externname":break;case"formula":break;case"colfirst":break;case"collast":break;case"wantadvise":break;case"boolean":break;case"error":break;case"text":break;case"ole":break;case"noautorecover":break;case"publishobjects":break;case"donotcalculatebeforesave":break;case"number":break;case"refmoder1c1":break;case"embedsavesmarttags":break;default:at=!1}break;case"workbookoptions":switch(o[3]){case"owcversion":break;case"height":break;case"width":break;default:at=!1}break;case"worksheetoptions":switch(o[3]){case"visible":if(o[0].slice(-2)!=="/>")if(o[1]==="/")switch(r.slice(z,o.index)){case"SheetHidden":G.Hidden=1;break;case"SheetVeryHidden":G.Hidden=2;break}else z=o.index+o[0].length;break;case"header":p["!margins"]||Eo(p["!margins"]={},"xlml"),isNaN(+it(o[0]).Margin)||(p["!margins"].header=+it(o[0]).Margin);break;case"footer":p["!margins"]||Eo(p["!margins"]={},"xlml"),isNaN(+it(o[0]).Margin)||(p["!margins"].footer=+it(o[0]).Margin);break;case"pagemargins":var $e=it(o[0]);p["!margins"]||Eo(p["!margins"]={},"xlml"),isNaN(+$e.Top)||(p["!margins"].top=+$e.Top),isNaN(+$e.Left)||(p["!margins"].left=+$e.Left),isNaN(+$e.Right)||(p["!margins"].right=+$e.Right),isNaN(+$e.Bottom)||(p["!margins"].bottom=+$e.Bottom);break;case"displayrighttoleft":W.Views||(W.Views=[]),W.Views[0]||(W.Views[0]={}),W.Views[0].RTL=!0;break;case"freezepanes":break;case"frozennosplit":break;case"splithorizontal":case"splitvertical":break;case"donotdisplaygridlines":break;case"activerow":break;case"activecol":break;case"toprowbottompane":break;case"leftcolumnrightpane":break;case"unsynced":break;case"print":break;case"printerrors":break;case"panes":break;case"scale":break;case"pane":break;case"number":break;case"layout":break;case"pagesetup":break;case"selected":break;case"protectobjects":break;case"enableselection":break;case"protectscenarios":break;case"validprinterinfo":break;case"horizontalresolution":break;case"verticalresolution":break;case"numberofcopies":break;case"activepane":break;case"toprowvisible":break;case"leftcolumnvisible":break;case"fittopage":break;case"rangeselection":break;case"papersizeindex":break;case"pagelayoutzoom":break;case"pagebreakzoom":break;case"filteron":break;case"fitwidth":break;case"fitheight":break;case"commentslayout":break;case"zoom":break;case"lefttoright":break;case"gridlines":break;case"allowsort":break;case"allowfilter":break;case"allowinsertrows":break;case"allowdeleterows":break;case"allowinsertcols":break;case"allowdeletecols":break;case"allowinserthyperlinks":break;case"allowformatcells":break;case"allowsizecols":break;case"allowsizerows":break;case"nosummaryrowsbelowdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].above=!0;break;case"tabcolorindex":break;case"donotdisplayheadings":break;case"showpagelayoutzoom":break;case"nosummarycolumnsrightdetail":p["!outline"]||(p["!outline"]={}),p["!outline"].left=!0;break;case"blackandwhite":break;case"donotdisplayzeros":break;case"displaypagebreak":break;case"rowcolheadings":break;case"donotdisplayoutline":break;case"noorientation":break;case"allowusepivottables":break;case"zeroheight":break;case"viewablerange":break;case"selection":break;case"protectcontents":break;default:at=!1}break;case"pivottable":case"pivotcache":switch(o[3]){case"immediateitemsondrop":break;case"showpagemultipleitemlabel":break;case"compactrowindent":break;case"location":break;case"pivotfield":break;case"orientation":break;case"layoutform":break;case"layoutsubtotallocation":break;case"layoutcompactrow":break;case"position":break;case"pivotitem":break;case"datatype":break;case"datafield":break;case"sourcename":break;case"parentfield":break;case"ptlineitems":break;case"ptlineitem":break;case"countofsameitems":break;case"item":break;case"itemtype":break;case"ptsource":break;case"cacheindex":break;case"consolidationreference":break;case"filename":break;case"reference":break;case"nocolumngrand":break;case"norowgrand":break;case"blanklineafteritems":break;case"hidden":break;case"subtotal":break;case"basefield":break;case"mapchilditems":break;case"function":break;case"refreshonfileopen":break;case"printsettitles":break;case"mergelabels":break;case"defaultversion":break;case"refreshname":break;case"refreshdate":break;case"refreshdatecopy":break;case"versionlastrefresh":break;case"versionlastupdate":break;case"versionupdateablemin":break;case"versionrefreshablemin":break;case"calculation":break;default:at=!1}break;case"pagebreaks":switch(o[3]){case"colbreaks":break;case"colbreak":break;case"rowbreaks":break;case"rowbreak":break;case"colstart":break;case"colend":break;case"rowend":break;default:at=!1}break;case"autofilter":switch(o[3]){case"autofiltercolumn":break;case"autofiltercondition":break;case"autofilterand":break;case"autofilteror":break;default:at=!1}break;case"querytable":switch(o[3]){case"id":break;case"autoformatfont":break;case"autoformatpattern":break;case"querysource":break;case"querytype":break;case"enableredirections":break;case"refreshedinxl9":break;case"urlstring":break;case"htmltables":break;case"connection":break;case"commandtext":break;case"refreshinfo":break;case"notitles":break;case"nextid":break;case"columninfo":break;case"overwritecells":break;case"donotpromptforfile":break;case"textwizardsettings":break;case"source":break;case"number":break;case"decimal":break;case"thousandseparator":break;case"trailingminusnumbers":break;case"formatsettings":break;case"fieldtype":break;case"delimiters":break;case"tab":break;case"comma":break;case"autoformatname":break;case"versionlastedit":break;case"versionlastrefresh":break;default:at=!1}break;case"datavalidation":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;case"cellrangelist":break;default:at=!1}break;case"sorting":case"conditionalformatting":switch(o[3]){case"range":break;case"type":break;case"min":break;case"max":break;case"sort":break;case"descending":break;case"order":break;case"casesensitive":break;case"value":break;case"errorstyle":break;case"errormessage":break;case"errortitle":break;case"cellrangelist":break;case"inputmessage":break;case"inputtitle":break;case"combohide":break;case"inputhide":break;case"condition":break;case"qualifier":break;case"useblank":break;case"value1":break;case"value2":break;case"format":break;default:at=!1}break;case"mapinfo":case"schema":case"data":switch(o[3]){case"map":break;case"entry":break;case"range":break;case"xpath":break;case"field":break;case"xsdtype":break;case"filteron":break;case"aggregate":break;case"elementtype":break;case"attributetype":break;case"schema":case"element":case"complextype":case"datatype":case"all":case"attribute":case"extends":break;case"row":break;default:at=!1}break;case"smarttags":break;default:at=!1;break}if(at||o[3].match(/!\[CDATA/))break;if(!l[l.length-1][1])throw"Unrecognized tag: "+o[3]+"|"+l.join("|");if(l[l.length-1][0]==="customdocumentproperties"){if(o[0].slice(-2)==="/>")break;o[1]==="/"?Kq(V,ee,ie,r.slice(z,o.index)):(ie=o,z=o.index+o[0].length);break}if(n.WTF)throw"Unrecognized tag: "+o[3]+"|"+l.join("|")}var Re={};return!n.bookSheets&&!n.bookProps&&(Re.Sheets=c),Re.SheetNames=h,Re.Workbook=W,Re.SSF=nn(et),Re.Props=b,Re.Custprops=V,Re}function Kg(e,t){switch(ty(t=t||{}),t.type||"base64"){case"base64":return pm(Zr(e),t);case"binary":case"buffer":case"file":return pm(e,t);case"array":return pm(Wa(e),t)}}function jq(e,t){var n=[];return e.Props&&n.push(SV(e.Props,t)),e.Custprops&&n.push(EV(e.Props,e.Custprops)),n.join("")}function Zq(){return""}function eK(e,t){var n=['<Style ss:ID="Default" ss:Name="Normal"><NumberFormat/></Style>'];return t.cellXfs.forEach(function(r,i){var s=[];s.push(Pe("NumberFormat",null,{"ss:Format":$t(et[r.numFmtId])}));var a={"ss:ID":"s"+(21+i)};n.push(Pe("Style",s.join(""),a))}),Pe("Styles",n.join(""))}function ND(e){return Pe("NamedRange",null,{"ss:Name":e.Name,"ss:RefersTo":"="+X1(e.Ref,{r:0,c:0})})}function tK(e){if(!((e||{}).Workbook||{}).Names)return"";for(var t=e.Workbook.Names,n=[],r=0;r<t.length;++r){var i=t[r];i.Sheet==null&&(i.Name.match(/^_xlfn\./)||n.push(ND(i)))}return Pe("Names",n.join(""))}function nK(e,t,n,r){if(!e||!((r||{}).Workbook||{}).Names)return"";for(var i=r.Workbook.Names,s=[],a=0;a<i.length;++a){var o=i[a];o.Sheet==n&&(o.Name.match(/^_xlfn\./)||s.push(ND(o)))}return s.join("")}function rK(e,t,n,r){if(!e)return"";var i=[];if(e["!margins"]&&(i.push("<PageSetup>"),e["!margins"].header&&i.push(Pe("Header",null,{"x:Margin":e["!margins"].header})),e["!margins"].footer&&i.push(Pe("Footer",null,{"x:Margin":e["!margins"].footer})),i.push(Pe("PageMargins",null,{"x:Bottom":e["!margins"].bottom||"0.75","x:Left":e["!margins"].left||"0.7","x:Right":e["!margins"].right||"0.7","x:Top":e["!margins"].top||"0.75"})),i.push("</PageSetup>")),r&&r.Workbook&&r.Workbook.Sheets&&r.Workbook.Sheets[n])if(r.Workbook.Sheets[n].Hidden)i.push(Pe("Visible",r.Workbook.Sheets[n].Hidden==1?"SheetHidden":"SheetVeryHidden",{}));else{for(var s=0;s<n&&!(r.Workbook.Sheets[s]&&!r.Workbook.Sheets[s].Hidden);++s);s==n&&i.push("<Selected/>")}return((((r||{}).Workbook||{}).Views||[])[0]||{}).RTL&&i.push("<DisplayRightToLeft/>"),e["!protect"]&&(i.push(Qn("ProtectContents","True")),e["!protect"].objects&&i.push(Qn("ProtectObjects","True")),e["!protect"].scenarios&&i.push(Qn("ProtectScenarios","True")),e["!protect"].selectLockedCells!=null&&!e["!protect"].selectLockedCells?i.push(Qn("EnableSelection","NoSelection")):e["!protect"].selectUnlockedCells!=null&&!e["!protect"].selectUnlockedCells&&i.push(Qn("EnableSelection","UnlockedCells")),[["formatCells","AllowFormatCells"],["formatColumns","AllowSizeCols"],["formatRows","AllowSizeRows"],["insertColumns","AllowInsertCols"],["insertRows","AllowInsertRows"],["insertHyperlinks","AllowInsertHyperlinks"],["deleteColumns","AllowDeleteCols"],["deleteRows","AllowDeleteRows"],["sort","AllowSort"],["autoFilter","AllowFilter"],["pivotTables","AllowUsePivotTables"]].forEach(function(a){e["!protect"][a[0]]&&i.push("<"+a[1]+"/>")})),i.length==0?"":Pe("WorksheetOptions",i.join(""),{xmlns:zr.x})}function iK(e){return e.map(function(t){var n=CU(t.t||""),r=Pe("ss:Data",n,{xmlns:"http://www.w3.org/TR/REC-html40"});return Pe("Comment",r,{"ss:Author":t.a})}).join("")}function sK(e,t,n,r,i,s,a){if(!e||e.v==null&&e.f==null)return"";var o={};if(e.f&&(o["ss:Formula"]="="+$t(X1(e.f,a))),e.F&&e.F.slice(0,t.length)==t){var l=ln(e.F.slice(t.length+1));o["ss:ArrayRange"]="RC:R"+(l.r==a.r?"":"["+(l.r-a.r)+"]")+"C"+(l.c==a.c?"":"["+(l.c-a.c)+"]")}if(e.l&&e.l.Target&&(o["ss:HRef"]=$t(e.l.Target),e.l.Tooltip&&(o["x:HRefScreenTip"]=$t(e.l.Tooltip))),n["!merges"])for(var u=n["!merges"],c=0;c!=u.length;++c)u[c].s.c!=a.c||u[c].s.r!=a.r||(u[c].e.c>u[c].s.c&&(o["ss:MergeAcross"]=u[c].e.c-u[c].s.c),u[c].e.r>u[c].s.r&&(o["ss:MergeDown"]=u[c].e.r-u[c].s.r));var h="",p="";switch(e.t){case"z":if(!r.sheetStubs)return"";break;case"n":h="Number",p=String(e.v);break;case"b":h="Boolean",p=e.v?"1":"0";break;case"e":h="Error",p=Ws[e.v];break;case"d":h="DateTime",p=new Date(e.v).toISOString(),e.z==null&&(e.z=e.z||et[14]);break;case"s":h="String",p=_U(e.v||"");break}var m=qa(r.cellXfs,e,r);o["ss:StyleID"]="s"+(21+m),o["ss:Index"]=a.c+1;var v=e.v!=null?p:"",g=e.t=="z"?"":'<Data ss:Type="'+h+'">'+v+"</Data>";return(e.c||[]).length>0&&(g+=iK(e.c)),Pe("Cell",g,o)}function aK(e,t){var n='<Row ss:Index="'+(e+1)+'"';return t&&(t.hpt&&!t.hpx&&(t.hpx=xu(t.hpt)),t.hpx&&(n+=' ss:AutoFitHeight="0" ss:Height="'+t.hpx+'"'),t.hidden&&(n+=' ss:Hidden="1"')),n+">"}function oK(e,t,n,r){if(!e["!ref"])return"";var i=At(e["!ref"]),s=e["!merges"]||[],a=0,o=[];e["!cols"]&&e["!cols"].forEach(function(w,x){ba(w);var T=!!w.width,y=ip(x,w),_={"ss:Index":x+1};T&&(_["ss:Width"]=xf(y.width)),w.hidden&&(_["ss:Hidden"]="1"),o.push(Pe("Column",null,_))});for(var l=Array.isArray(e),u=i.s.r;u<=i.e.r;++u){for(var c=[aK(u,(e["!rows"]||[])[u])],h=i.s.c;h<=i.e.c;++h){var p=!1;for(a=0;a!=s.length;++a)if(!(s[a].s.c>h)&&!(s[a].s.r>u)&&!(s[a].e.c<h)&&!(s[a].e.r<u)){(s[a].s.c!=h||s[a].s.r!=u)&&(p=!0);break}if(!p){var m={r:u,c:h},v=nt(m),g=l?(e[u]||[])[h]:e[v];c.push(sK(g,v,e,t,n,r,m))}}c.push("</Row>"),c.length>2&&o.push(c.join(""))}return o.join("")}function lK(e,t,n){var r=[],i=n.SheetNames[e],s=n.Sheets[i],a=s?nK(s,t,e,n):"";return a.length>0&&r.push("<Names>"+a+"</Names>"),a=s?oK(s,t,e,n):"",a.length>0&&r.push("<Table>"+a+"</Table>"),r.push(rK(s,t,e,n)),r.join("")}function uK(e,t){t||(t={}),e.SSF||(e.SSF=nn(et)),e.SSF&&(Au(),Qh(e.SSF),t.revssf=Zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF,t.cellXfs=[],qa(t.cellXfs,{},{revssf:{General:0}}));var n=[];n.push(jq(e,t)),n.push(Zq()),n.push(""),n.push("");for(var r=0;r<e.SheetNames.length;++r)n.push(Pe("Worksheet",lK(r,t,e),{"ss:Name":$t(e.SheetNames[r])}));return n[2]=eK(e,t),n[3]=tK(e),En+Pe("Workbook",n.join(""),{xmlns:zr.ss,"xmlns:o":zr.o,"xmlns:x":zr.x,"xmlns:ss":zr.ss,"xmlns:dt":zr.dt,"xmlns:html":zr.html})}function cK(e){var t={},n=e.content;if(n.l=28,t.AnsiUserType=n.read_shift(0,"lpstr-ansi"),t.AnsiClipboardFormat=tV(n),n.length-n.l<=4)return t;var r=n.read_shift(4);if(r==0||r>40||(n.l-=4,t.Reserved1=n.read_shift(0,"lpstr-ansi"),n.length-n.l<=4)||(r=n.read_shift(4),r!==1907505652)||(t.UnicodeClipboardFormat=nV(n),r=n.read_shift(4),r==0||r>40))return t;n.l-=4,t.Reserved2=n.read_shift(0,"lpwstr")}var fK=[60,1084,2066,2165,2175];function dK(e,t,n,r,i){var s=r,a=[],o=n.slice(n.l,n.l+s);if(i&&i.enc&&i.enc.insitu&&o.length>0)switch(e){case 9:case 521:case 1033:case 2057:case 47:case 405:case 225:case 406:case 312:case 404:case 10:break;case 133:break;default:i.enc.insitu(o)}a.push(o),n.l+=s;for(var l=_s(n,n.l),u=Yg[l],c=0;u!=null&&fK.indexOf(l)>-1;)s=_s(n,n.l+2),c=n.l+4,l==2066?c+=4:(l==2165||l==2175)&&(c+=12),o=n.slice(c,n.l+4+s),a.push(o),n.l+=4+s,u=Yg[l=_s(n,n.l)];var h=Hn(a);Jn(h,0);var p=0;h.lens=[];for(var m=0;m<a.length;++m)h.lens.push(p),p+=a[m].length;if(h.length<r)throw"XLS Record 0x"+e.toString(16)+" Truncated: "+h.length+" < "+r;return t.f(h,h.length,i)}function Yi(e,t,n){if(e.t!=="z"&&e.XF){var r=0;try{r=e.z||e.XF.numFmtId||0,t.cellNF&&(e.z=et[r])}catch(s){if(t.WTF)throw s}if(!t||t.cellText!==!1)try{e.t==="e"?e.w=e.w||Ws[e.v]:r===0||r=="General"?e.t==="n"?(e.v|0)===e.v?e.w=e.v.toString(10):e.w=df(e.v):e.w=Do(e.v):e.w=_i(r,e.v,{date1904:!!n,dateNF:t&&t.dateNF})}catch(s){if(t.WTF)throw s}if(t.cellDates&&r&&e.t=="n"&&ku(et[r]||String(r))){var i=oo(e.v);i&&(e.t="d",e.v=new Date(i.y,i.m-1,i.d,i.H,i.M,i.S,i.u))}}}function Hd(e,t,n){return{v:e,ixfe:t,t:n}}function hK(e,t){var n={opts:{}},r={},i=t.dense?[]:{},s={},a={},o=null,l=[],u="",c={},h,p="",m,v,g,w,x={},T=[],y,_,k=[],S=[],C={Sheets:[],WBProps:{date1904:!1},Views:[{}]},M={},F=function(We){return We<8?wo[We]:We<64&&S[We-8]||wo[We]},b=function(We,Xe,Rt){var yt=Xe.XF.data;if(!(!yt||!yt.patternType||!Rt||!Rt.cellStyles)){Xe.s={},Xe.s.patternType=yt.patternType;var It;(It=vf(F(yt.icvFore)))&&(Xe.s.fgColor={rgb:It}),(It=vf(F(yt.icvBack)))&&(Xe.s.bgColor={rgb:It})}},V=function(We,Xe,Rt){if(!(xe>1)&&!(Rt.sheetRows&&We.r>=Rt.sheetRows)){if(Rt.cellStyles&&Xe.XF&&Xe.XF.data&&b(We,Xe,Rt),delete Xe.ixfe,delete Xe.XF,h=We,p=nt(We),(!a||!a.s||!a.e)&&(a={s:{r:0,c:0},e:{r:0,c:0}}),We.r<a.s.r&&(a.s.r=We.r),We.c<a.s.c&&(a.s.c=We.c),We.r+1>a.e.r&&(a.e.r=We.r+1),We.c+1>a.e.c&&(a.e.c=We.c+1),Rt.cellFormula&&Xe.f){for(var yt=0;yt<T.length;++yt)if(!(T[yt][0].s.c>We.c||T[yt][0].s.r>We.r)&&!(T[yt][0].e.c<We.c||T[yt][0].e.r<We.r)){Xe.F=lt(T[yt][0]),(T[yt][0].s.c!=We.c||T[yt][0].s.r!=We.r)&&delete Xe.f,Xe.f&&(Xe.f=""+ar(T[yt][1],a,We,H,z));break}}Rt.dense?(i[We.r]||(i[We.r]=[]),i[We.r][We.c]=Xe):i[p]=Xe}},z={enc:!1,sbcch:0,snames:[],sharedf:x,arrayf:T,rrtabid:[],lastuser:"",biff:8,codepage:0,winlocked:0,cellStyles:!!t&&!!t.cellStyles,WTF:!!t&&!!t.wtf};t.password&&(z.password=t.password);var ie,Q=[],se=[],de=[],ae=[],ne=!1,H=[];H.SheetNames=z.snames,H.sharedf=z.sharedf,H.arrayf=z.arrayf,H.names=[],H.XTI=[];var fe=0,xe=0,L=0,q=[],W=[],G;z.codepage=1200,Li(1200);for(var ee=!1;e.l<e.length-1;){var Se=e.l,we=e.read_shift(2);if(we===0&&fe===10)break;var pe=e.l===e.length?0:e.read_shift(2),oe=Yg[we];if(oe&&oe.f){if(t.bookSheets&&fe===133&&we!==133)break;if(fe=we,oe.r===2||oe.r==12){var Le=e.read_shift(2);if(pe-=2,!z.enc&&Le!==we&&((Le&255)<<8|Le>>8)!==we)throw new Error("rt mismatch: "+Le+"!="+we);oe.r==12&&(e.l+=10,pe-=10)}var B={};if(we===10?B=oe.f(e,pe,z):B=dK(we,oe,e,pe,z),xe==0&&[9,521,1033,2057].indexOf(fe)===-1)continue;switch(we){case 34:n.opts.Date1904=C.WBProps.date1904=B;break;case 134:n.opts.WriteProtect=!0;break;case 47:if(z.enc||(e.l=0),z.enc=B,!t.password)throw new Error("File is password-protected");if(B.valid==null)throw new Error("Encryption scheme unsupported");if(!B.valid)throw new Error("Password is incorrect");break;case 92:z.lastuser=B;break;case 66:var st=Number(B);switch(st){case 21010:st=1200;break;case 32768:st=1e4;break;case 32769:st=1252;break}Li(z.codepage=st),ee=!0;break;case 317:z.rrtabid=B;break;case 25:z.winlocked=B;break;case 439:n.opts.RefreshAll=B;break;case 12:n.opts.CalcCount=B;break;case 16:n.opts.CalcDelta=B;break;case 17:n.opts.CalcIter=B;break;case 13:n.opts.CalcMode=B;break;case 14:n.opts.CalcPrecision=B;break;case 95:n.opts.CalcSaveRecalc=B;break;case 15:z.CalcRefMode=B;break;case 2211:n.opts.FullCalc=B;break;case 129:B.fDialog&&(i["!type"]="dialog"),B.fBelow||((i["!outline"]||(i["!outline"]={})).above=!0),B.fRight||((i["!outline"]||(i["!outline"]={})).left=!0);break;case 224:k.push(B);break;case 430:H.push([B]),H[H.length-1].XTI=[];break;case 35:case 547:H[H.length-1].push(B);break;case 24:case 536:G={Name:B.Name,Ref:ar(B.rgce,a,null,H,z)},B.itab>0&&(G.Sheet=B.itab-1),H.names.push(G),H[0]||(H[0]=[],H[0].XTI=[]),H[H.length-1].push(B),B.Name=="_xlnm._FilterDatabase"&&B.itab>0&&B.rgce&&B.rgce[0]&&B.rgce[0][0]&&B.rgce[0][0][0]=="PtgArea3d"&&(W[B.itab-1]={ref:lt(B.rgce[0][0][1][2])});break;case 22:z.ExternCount=B;break;case 23:H.length==0&&(H[0]=[],H[0].XTI=[]),H[H.length-1].XTI=H[H.length-1].XTI.concat(B),H.XTI=H.XTI.concat(B);break;case 2196:if(z.biff<8)break;G!=null&&(G.Comment=B[1]);break;case 18:i["!protect"]=B;break;case 19:B!==0&&z.WTF&&console.error("Password verifier: "+B);break;case 133:s[B.pos]=B,z.snames.push(B.name);break;case 10:{if(--xe)break;if(a.e){if(a.e.r>0&&a.e.c>0){if(a.e.r--,a.e.c--,i["!ref"]=lt(a),t.sheetRows&&t.sheetRows<=a.e.r){var Ue=a.e.r;a.e.r=t.sheetRows-1,i["!fullref"]=i["!ref"],i["!ref"]=lt(a),a.e.r=Ue}a.e.r++,a.e.c++}Q.length>0&&(i["!merges"]=Q),se.length>0&&(i["!objects"]=se),de.length>0&&(i["!cols"]=de),ae.length>0&&(i["!rows"]=ae),C.Sheets.push(M)}u===""?c=i:r[u]=i,i=t.dense?[]:{}}break;case 9:case 521:case 1033:case 2057:{if(z.biff===8&&(z.biff={9:2,521:3,1033:4}[we]||{512:2,768:3,1024:4,1280:5,1536:8,2:2,7:2}[B.BIFFVer]||8),z.biffguess=B.BIFFVer==0,B.BIFFVer==0&&B.dt==4096&&(z.biff=5,ee=!0,Li(z.codepage=28591)),z.biff==8&&B.BIFFVer==0&&B.dt==16&&(z.biff=2),xe++)break;if(i=t.dense?[]:{},z.biff<8&&!ee&&(ee=!0,Li(z.codepage=t.codepage||1252)),z.biff<5||B.BIFFVer==0&&B.dt==4096){u===""&&(u="Sheet1"),a={s:{r:0,c:0},e:{r:0,c:0}};var at={pos:e.l-pe,name:u};s[at.pos]=at,z.snames.push(u)}else u=(s[Se]||{name:""}).name;B.dt==32&&(i["!type"]="chart"),B.dt==64&&(i["!type"]="macro"),Q=[],se=[],z.arrayf=T=[],de=[],ae=[],ne=!1,M={Hidden:(s[Se]||{hs:0}).hs,name:u}}break;case 515:case 3:case 2:i["!type"]=="chart"&&(t.dense?(i[B.r]||[])[B.c]:i[nt({c:B.c,r:B.r})])&&++B.c,y={ixfe:B.ixfe,XF:k[B.ixfe]||{},v:B.val,t:"n"},L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:B.c,r:B.r},y,t);break;case 5:case 517:y={ixfe:B.ixfe,XF:k[B.ixfe],v:B.val,t:B.t},L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:B.c,r:B.r},y,t);break;case 638:y={ixfe:B.ixfe,XF:k[B.ixfe],v:B.rknum,t:"n"},L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:B.c,r:B.r},y,t);break;case 189:for(var $e=B.c;$e<=B.C;++$e){var Re=B.rkrec[$e-B.c][0];y={ixfe:Re,XF:k[Re],v:B.rkrec[$e-B.c][1],t:"n"},L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:$e,r:B.r},y,t)}break;case 6:case 518:case 1030:{if(B.val=="String"){o=B;break}if(y=Hd(B.val,B.cell.ixfe,B.tt),y.XF=k[y.ixfe],t.cellFormula){var ht=B.formula;if(ht&&ht[0]&&ht[0][0]&&ht[0][0][0]=="PtgExp"){var Dt=ht[0][0][1][0],tt=ht[0][0][1][1],Kt=nt({r:Dt,c:tt});x[Kt]?y.f=""+ar(B.formula,a,B.cell,H,z):y.F=((t.dense?(i[Dt]||[])[tt]:i[Kt])||{}).F}else y.f=""+ar(B.formula,a,B.cell,H,z)}L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V(B.cell,y,t),o=B}break;case 7:case 519:if(o)o.val=B,y=Hd(B,o.cell.ixfe,"s"),y.XF=k[y.ixfe],t.cellFormula&&(y.f=""+ar(o.formula,a,o.cell,H,z)),L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V(o.cell,y,t),o=null;else throw new Error("String record expects Formula");break;case 33:case 545:{T.push(B);var ve=nt(B[0].s);if(m=t.dense?(i[B[0].s.r]||[])[B[0].s.c]:i[ve],t.cellFormula&&m){if(!o||!ve||!m)break;m.f=""+ar(B[1],a,B[0],H,z),m.F=lt(B[0])}}break;case 1212:{if(!t.cellFormula)break;if(p){if(!o)break;x[nt(o.cell)]=B[0],m=t.dense?(i[o.cell.r]||[])[o.cell.c]:i[nt(o.cell)],(m||{}).f=""+ar(B[0],a,h,H,z)}}break;case 253:y=Hd(l[B.isst].t,B.ixfe,"s"),l[B.isst].h&&(y.h=l[B.isst].h),y.XF=k[y.ixfe],L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:B.c,r:B.r},y,t);break;case 513:t.sheetStubs&&(y={ixfe:B.ixfe,XF:k[B.ixfe],t:"z"},L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:B.c,r:B.r},y,t));break;case 190:if(t.sheetStubs)for(var Ce=B.c;Ce<=B.C;++Ce){var Ne=B.ixfe[Ce-B.c];y={ixfe:Ne,XF:k[Ne],t:"z"},L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:Ce,r:B.r},y,t)}break;case 214:case 516:case 4:y=Hd(B.val,B.ixfe,"s"),y.XF=k[y.ixfe],L>0&&(y.z=q[y.ixfe>>8&63]),Yi(y,t,n.opts.Date1904),V({c:B.c,r:B.r},y,t);break;case 0:case 512:xe===1&&(a=B);break;case 252:l=B;break;case 1054:if(z.biff==4){q[L++]=B[1];for(var Oe=0;Oe<L+163&&et[Oe]!=B[1];++Oe);Oe>=163&&Ds(B[1],L+163)}else Ds(B[1],B[0]);break;case 30:{q[L++]=B;for(var He=0;He<L+163&&et[He]!=B;++He);He>=163&&Ds(B,L+163)}break;case 229:Q=Q.concat(B);break;case 93:se[B.cmo[0]]=z.lastobj=B;break;case 438:z.lastobj.TxO=B;break;case 127:z.lastobj.ImData=B;break;case 440:for(w=B[0].s.r;w<=B[0].e.r;++w)for(g=B[0].s.c;g<=B[0].e.c;++g)m=t.dense?(i[w]||[])[g]:i[nt({c:g,r:w})],m&&(m.l=B[1]);break;case 2048:for(w=B[0].s.r;w<=B[0].e.r;++w)for(g=B[0].s.c;g<=B[0].e.c;++g)m=t.dense?(i[w]||[])[g]:i[nt({c:g,r:w})],m&&m.l&&(m.l.Tooltip=B[1]);break;case 28:{if(z.biff<=5&&z.biff>=2)break;m=t.dense?(i[B[0].r]||[])[B[0].c]:i[nt(B[0])];var Je=se[B[2]];m||(t.dense?(i[B[0].r]||(i[B[0].r]=[]),m=i[B[0].r][B[0].c]={t:"z"}):m=i[nt(B[0])]={t:"z"},a.e.r=Math.max(a.e.r,B[0].r),a.s.r=Math.min(a.s.r,B[0].r),a.e.c=Math.max(a.e.c,B[0].c),a.s.c=Math.min(a.s.c,B[0].c)),m.c||(m.c=[]),v={a:B[1],t:Je.TxO.t},m.c.push(v)}break;case 2173:e$(k[B.ixfe],B.ext);break;case 125:{if(!z.cellStyles)break;for(;B.e>=B.s;)de[B.e--]={width:B.w/256,level:B.level||0,hidden:!!(B.flags&1)},ne||(ne=!0,q1(B.w/256)),ba(de[B.e+1])}break;case 520:{var Qe={};B.level!=null&&(ae[B.r]=Qe,Qe.level=B.level),B.hidden&&(ae[B.r]=Qe,Qe.hidden=!0),B.hpt&&(ae[B.r]=Qe,Qe.hpt=B.hpt,Qe.hpx=xu(B.hpt))}break;case 38:case 39:case 40:case 41:i["!margins"]||Eo(i["!margins"]={}),i["!margins"][{38:"left",39:"right",40:"top",41:"bottom"}[we]]=B;break;case 161:i["!margins"]||Eo(i["!margins"]={}),i["!margins"].header=B.header,i["!margins"].footer=B.footer;break;case 574:B.RTL&&(C.Views[0].RTL=!0);break;case 146:S=B;break;case 2198:ie=B;break;case 140:_=B;break;case 442:u?M.CodeName=B||M.name:C.WBProps.CodeName=B||"ThisWorkbook";break}}else oe||console.error("Missing Info for XLS Record 0x"+we.toString(16)),e.l+=pe}return n.SheetNames=vn(s).sort(function(mt,We){return Number(mt)-Number(We)}).map(function(mt){return s[mt].name}),t.bookSheets||(n.Sheets=r),!n.SheetNames.length&&c["!ref"]?(n.SheetNames.push("Sheet1"),n.Sheets&&(n.Sheets.Sheet1=c)):n.Preamble=c,n.Sheets&&W.forEach(function(mt,We){n.Sheets[n.SheetNames[We]]["!autofilter"]=mt}),n.Strings=l,n.SSF=nn(et),z.enc&&(n.Encryption=z.enc),ie&&(n.Themes=ie),n.Metadata={},_!==void 0&&(n.Metadata.Country=_),H.names.length>0&&(C.Names=H.names),n.Workbook=C,n}var Ic={SI:"e0859ff2f94f6810ab9108002b27b3d9",DSI:"02d5cdd59c2e1b10939708002b2cf9ae",UDI:"05d5cdd59c2e1b10939708002b2cf9ae"};function pK(e,t,n){var r=Ke.find(e,"/!DocumentSummaryInformation");if(r&&r.size>0)try{var i=hE(r,Hg,Ic.DSI);for(var s in i)t[s]=i[s]}catch(u){if(n.WTF)throw u}var a=Ke.find(e,"/!SummaryInformation");if(a&&a.size>0)try{var o=hE(a,$g,Ic.SI);for(var l in o)t[l]==null&&(t[l]=o[l])}catch(u){if(n.WTF)throw u}t.HeadingPairs&&t.TitlesOfParts&&(IF(t.HeadingPairs,t.TitlesOfParts,t,n),delete t.HeadingPairs,delete t.TitlesOfParts)}function mK(e,t){var n=[],r=[],i=[],s=0,a,o=zS(Hg,"n"),l=zS($g,"n");if(e.Props)for(a=vn(e.Props),s=0;s<a.length;++s)(Object.prototype.hasOwnProperty.call(o,a[s])?n:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],e.Props[a[s]]]);if(e.Custprops)for(a=vn(e.Custprops),s=0;s<a.length;++s)Object.prototype.hasOwnProperty.call(e.Props||{},a[s])||(Object.prototype.hasOwnProperty.call(o,a[s])?n:Object.prototype.hasOwnProperty.call(l,a[s])?r:i).push([a[s],e.Custprops[a[s]]]);var u=[];for(s=0;s<i.length;++s)VF.indexOf(i[s][0])>-1||PF.indexOf(i[s][0])>-1||i[s][1]!=null&&u.push(i[s]);r.length&&Ke.utils.cfb_add(t,"/SummaryInformation",pE(r,Ic.SI,l,$g)),(n.length||u.length)&&Ke.utils.cfb_add(t,"/DocumentSummaryInformation",pE(n,Ic.DSI,o,Hg,u.length?u:null,Ic.UDI))}function bD(e,t){t||(t={}),ty(t),S1(),t.codepage&&T1(t.codepage);var n,r;if(e.FullPaths){if(Ke.find(e,"/encryption"))throw new Error("File is password-protected");n=Ke.find(e,"!CompObj"),r=Ke.find(e,"/Workbook")||Ke.find(e,"/Book")}else{switch(t.type){case"base64":e=Gr(Zr(e));break;case"binary":e=Gr(e);break;case"buffer":break;case"array":Array.isArray(e)||(e=Array.prototype.slice.call(e));break}Jn(e,0),r={content:e}}var i,s;if(n&&cK(n),t.bookProps&&!t.bookSheets)i={};else{var a=dt?"buffer":"array";if(r&&r.content)i=hK(r.content,t);else if((s=Ke.find(e,"PerfectOffice_MAIN"))&&s.content)i=So.to_workbook(s.content,(t.type=a,t));else if((s=Ke.find(e,"NativeContent_MAIN"))&&s.content)i=So.to_workbook(s.content,(t.type=a,t));else throw(s=Ke.find(e,"MN0"))&&s.content?new Error("Unsupported Works 4 for Mac file"):new Error("Cannot find Workbook stream");t.bookVBA&&e.FullPaths&&Ke.find(e,"/_VBA_PROJECT_CUR/VBA/dir")&&(i.vbaraw=R$(e))}var o={};return e.FullPaths&&pK(e,o,t),i.Props=i.Custprops=o,t.bookFiles&&(i.cfb=e),i}function gK(e,t){var n=t||{},r=Ke.utils.cfb_new({root:"R"}),i="/Workbook";switch(n.bookType||"xls"){case"xls":n.bookType="biff8";case"xla":n.bookType||(n.bookType="xla");case"biff8":i="/Workbook",n.biff=8;break;case"biff5":i="/Book",n.biff=5;break;default:throw new Error("invalid type "+n.bookType+" for XLS CFB")}return Ke.utils.cfb_add(r,i,LD(e,n)),n.biff==8&&(e.Props||e.Custprops)&&mK(e,r),n.biff==8&&e.vbaraw&&M$(r,Ke.read(e.vbaraw,{type:typeof e.vbaraw=="string"?"binary":"buffer"})),r}var Tf={0:{f:VW},1:{f:YW},2:{f:hG},3:{f:nG},4:{f:jW},5:{f:cG},6:{f:xG},7:{f:aG},8:{f:CG},9:{f:_G},10:{f:SG},11:{f:EG},12:{f:JW},13:{f:mG},14:{f:iG},15:{f:eG},16:{f:AD},17:{f:wG},18:{f:lG},19:{f:L1},20:{},21:{},22:{},23:{},24:{},25:{},26:{},27:{},28:{},29:{},30:{},31:{},32:{},33:{},34:{},35:{T:1},36:{T:-1},37:{T:1},38:{T:-1},39:{f:wq},40:{},42:{},43:{f:xH},44:{f:gH},45:{f:TH},46:{f:EH},47:{f:SH},48:{},49:{f:zU},50:{},51:{f:r$},52:{T:1},53:{T:-1},54:{T:1},55:{T:-1},56:{T:1},57:{T:-1},58:{},59:{},60:{f:QF},62:{f:vG},63:{f:d$},64:{f:HG},65:{},66:{},67:{},68:{},69:{},70:{},128:{},129:{T:1},130:{T:-1},131:{T:1,f:mr,p:0},132:{T:-1},133:{T:1},134:{T:-1},135:{T:1},136:{T:-1},137:{T:1,f:OG},138:{T:-1},139:{T:1},140:{T:-1},141:{T:1},142:{T:-1},143:{T:1},144:{T:-1},145:{T:1},146:{T:-1},147:{f:qW},148:{f:zW,p:16},151:{f:DG},152:{},153:{f:vq},154:{},155:{},156:{f:mq},157:{},158:{},159:{T:1,f:I7},160:{T:-1},161:{T:1,f:jo},162:{T:-1},163:{T:1},164:{T:-1},165:{T:1},166:{T:-1},167:{},168:{},169:{},170:{},171:{},172:{T:1},173:{T:-1},174:{},175:{},176:{f:kG},177:{T:1},178:{T:-1},179:{T:1},180:{T:-1},181:{T:1},182:{T:-1},183:{T:1},184:{T:-1},185:{T:1},186:{T:-1},187:{T:1},188:{T:-1},189:{T:1},190:{T:-1},191:{T:1},192:{T:-1},193:{T:1},194:{T:-1},195:{T:1},196:{T:-1},197:{T:1},198:{T:-1},199:{T:1},200:{T:-1},201:{T:1},202:{T:-1},203:{T:1},204:{T:-1},205:{T:1},206:{T:-1},207:{T:1},208:{T:-1},209:{T:1},210:{T:-1},211:{T:1},212:{T:-1},213:{T:1},214:{T:-1},215:{T:1},216:{T:-1},217:{T:1},218:{T:-1},219:{T:1},220:{T:-1},221:{T:1},222:{T:-1},223:{T:1},224:{T:-1},225:{T:1},226:{T:-1},227:{T:1},228:{T:-1},229:{T:1},230:{T:-1},231:{T:1},232:{T:-1},233:{T:1},234:{T:-1},235:{T:1},236:{T:-1},237:{T:1},238:{T:-1},239:{T:1},240:{T:-1},241:{T:1},242:{T:-1},243:{T:1},244:{T:-1},245:{T:1},246:{T:-1},247:{T:1},248:{T:-1},249:{T:1},250:{T:-1},251:{T:1},252:{T:-1},253:{T:1},254:{T:-1},255:{T:1},256:{T:-1},257:{T:1},258:{T:-1},259:{T:1},260:{T:-1},261:{T:1},262:{T:-1},263:{T:1},264:{T:-1},265:{T:1},266:{T:-1},267:{T:1},268:{T:-1},269:{T:1},270:{T:-1},271:{T:1},272:{T:-1},273:{T:1},274:{T:-1},275:{T:1},276:{T:-1},277:{},278:{T:1},279:{T:-1},280:{T:1},281:{T:-1},282:{T:1},283:{T:1},284:{T:-1},285:{T:1},286:{T:-1},287:{T:1},288:{T:-1},289:{T:1},290:{T:-1},291:{T:1},292:{T:-1},293:{T:1},294:{T:-1},295:{T:1},296:{T:-1},297:{T:1},298:{T:-1},299:{T:1},300:{T:-1},301:{T:1},302:{T:-1},303:{T:1},304:{T:-1},305:{T:1},306:{T:-1},307:{T:1},308:{T:-1},309:{T:1},310:{T:-1},311:{T:1},312:{T:-1},313:{T:-1},314:{T:1},315:{T:-1},316:{T:1},317:{T:-1},318:{T:1},319:{T:-1},320:{T:1},321:{T:-1},322:{T:1},323:{T:-1},324:{T:1},325:{T:-1},326:{T:1},327:{T:-1},328:{T:1},329:{T:-1},330:{T:1},331:{T:-1},332:{T:1},333:{T:-1},334:{T:1},335:{f:t$},336:{T:-1},337:{f:a$,T:1},338:{T:-1},339:{T:1},340:{T:-1},341:{T:1},342:{T:-1},343:{T:1},344:{T:-1},345:{T:1},346:{T:-1},347:{T:1},348:{T:-1},349:{T:1},350:{T:-1},351:{},352:{},353:{T:1},354:{T:-1},355:{f:Vg},357:{},358:{},359:{},360:{T:1},361:{},362:{f:JF},363:{},364:{},366:{},367:{},368:{},369:{},370:{},371:{},372:{T:1},373:{T:-1},374:{T:1},375:{T:-1},376:{T:1},377:{T:-1},378:{T:1},379:{T:-1},380:{T:1},381:{T:-1},382:{T:1},383:{T:-1},384:{T:1},385:{T:-1},386:{T:1},387:{T:-1},388:{T:1},389:{T:-1},390:{T:1},391:{T:-1},392:{T:1},393:{T:-1},394:{T:1},395:{T:-1},396:{},397:{},398:{},399:{},400:{},401:{T:1},403:{},404:{},405:{},406:{},407:{},408:{},409:{},410:{},411:{},412:{},413:{},414:{},415:{},416:{},417:{},418:{},419:{},420:{},421:{},422:{T:1},423:{T:1},424:{T:-1},425:{T:-1},426:{f:PG},427:{f:IG},428:{},429:{T:1},430:{T:-1},431:{T:1},432:{T:-1},433:{T:1},434:{T:-1},435:{T:1},436:{T:-1},437:{T:1},438:{T:-1},439:{T:1},440:{T:-1},441:{T:1},442:{T:-1},443:{T:1},444:{T:-1},445:{T:1},446:{T:-1},447:{T:1},448:{T:-1},449:{T:1},450:{T:-1},451:{T:1},452:{T:-1},453:{T:1},454:{T:-1},455:{T:1},456:{T:-1},457:{T:1},458:{T:-1},459:{T:1},460:{T:-1},461:{T:1},462:{T:-1},463:{T:1},464:{T:-1},465:{T:1},466:{T:-1},467:{T:1},468:{T:-1},469:{T:1},470:{T:-1},471:{},472:{},473:{T:1},474:{T:-1},475:{},476:{f:bG},477:{},478:{},479:{T:1},480:{T:-1},481:{T:1},482:{T:-1},483:{T:1},484:{T:-1},485:{f:GW},486:{T:1},487:{T:-1},488:{T:1},489:{T:-1},490:{T:1},491:{T:-1},492:{T:1},493:{T:-1},494:{f:MG},495:{T:1},496:{T:-1},497:{T:1},498:{T:-1},499:{},500:{T:1},501:{T:-1},502:{T:1},503:{T:-1},504:{},505:{T:1},506:{T:-1},507:{},508:{T:1},509:{T:-1},510:{T:1},511:{T:-1},512:{},513:{},514:{T:1},515:{T:-1},516:{T:1},517:{T:-1},518:{T:1},519:{T:-1},520:{T:1},521:{T:-1},522:{},523:{},524:{},525:{},526:{},527:{},528:{T:1},529:{T:-1},530:{T:1},531:{T:-1},532:{T:1},533:{T:-1},534:{},535:{},536:{},537:{},538:{T:1},539:{T:-1},540:{T:1},541:{T:-1},542:{T:1},548:{},549:{},550:{f:Vg},551:{},552:{},553:{},554:{T:1},555:{T:-1},556:{T:1},557:{T:-1},558:{T:1},559:{T:-1},560:{T:1},561:{T:-1},562:{},564:{},565:{T:1},566:{T:-1},569:{T:1},570:{T:-1},572:{},573:{T:1},574:{T:-1},577:{},578:{},579:{},580:{},581:{},582:{},583:{},584:{},585:{},586:{},587:{},588:{T:-1},589:{},590:{T:1},591:{T:-1},592:{T:1},593:{T:-1},594:{T:1},595:{T:-1},596:{},597:{T:1},598:{T:-1},599:{T:1},600:{T:-1},601:{T:1},602:{T:-1},603:{T:1},604:{T:-1},605:{T:1},606:{T:-1},607:{},608:{T:1},609:{T:-1},610:{},611:{T:1},612:{T:-1},613:{T:1},614:{T:-1},615:{T:1},616:{T:-1},617:{T:1},618:{T:-1},619:{T:1},620:{T:-1},625:{},626:{T:1},627:{T:-1},628:{T:1},629:{T:-1},630:{T:1},631:{T:-1},632:{f:E$},633:{T:1},634:{T:-1},635:{T:1,f:T$},636:{T:-1},637:{f:KU},638:{T:1},639:{},640:{T:-1},641:{T:1},642:{T:-1},643:{T:1},644:{},645:{T:-1},646:{T:1},648:{T:1},649:{},650:{T:-1},651:{f:iq},652:{},653:{T:1},654:{T:-1},655:{T:1},656:{T:-1},657:{T:1},658:{T:-1},659:{},660:{T:1},661:{},662:{T:-1},663:{},664:{T:1},665:{},666:{T:-1},667:{},668:{},669:{},671:{T:1},672:{T:-1},673:{T:1},674:{T:-1},675:{},676:{},677:{},678:{},679:{},680:{},681:{},1024:{},1025:{},1026:{T:1},1027:{T:-1},1028:{T:1},1029:{T:-1},1030:{},1031:{T:1},1032:{T:-1},1033:{T:1},1034:{T:-1},1035:{},1036:{},1037:{},1038:{T:1},1039:{T:-1},1040:{},1041:{T:1},1042:{T:-1},1043:{},1044:{},1045:{},1046:{T:1},1047:{T:-1},1048:{T:1},1049:{T:-1},1050:{},1051:{T:1},1052:{T:1},1053:{f:$G},1054:{T:1},1055:{},1056:{T:1},1057:{T:-1},1058:{T:1},1059:{T:-1},1061:{},1062:{T:1},1063:{T:-1},1064:{T:1},1065:{T:-1},1066:{T:1},1067:{T:-1},1068:{T:1},1069:{T:-1},1070:{T:1},1071:{T:-1},1072:{T:1},1073:{T:-1},1075:{T:1},1076:{T:-1},1077:{T:1},1078:{T:-1},1079:{T:1},1080:{T:-1},1081:{T:1},1082:{T:-1},1083:{T:1},1084:{T:-1},1085:{},1086:{T:1},1087:{T:-1},1088:{T:1},1089:{T:-1},1090:{T:1},1091:{T:-1},1092:{T:1},1093:{T:-1},1094:{T:1},1095:{T:-1},1096:{},1097:{T:1},1098:{},1099:{T:-1},1100:{T:1},1101:{T:-1},1102:{},1103:{},1104:{},1105:{},1111:{},1112:{},1113:{T:1},1114:{T:-1},1115:{T:1},1116:{T:-1},1117:{},1118:{T:1},1119:{T:-1},1120:{T:1},1121:{T:-1},1122:{T:1},1123:{T:-1},1124:{T:1},1125:{T:-1},1126:{},1128:{T:1},1129:{T:-1},1130:{},1131:{T:1},1132:{T:-1},1133:{T:1},1134:{T:-1},1135:{T:1},1136:{T:-1},1137:{T:1},1138:{T:-1},1139:{T:1},1140:{T:-1},1141:{},1142:{T:1},1143:{T:-1},1144:{T:1},1145:{T:-1},1146:{},1147:{T:1},1148:{T:-1},1149:{T:1},1150:{T:-1},1152:{T:1},1153:{T:-1},1154:{T:-1},1155:{T:-1},1156:{T:-1},1157:{T:1},1158:{T:-1},1159:{T:1},1160:{T:-1},1161:{T:1},1162:{T:-1},1163:{T:1},1164:{T:-1},1165:{T:1},1166:{T:-1},1167:{T:1},1168:{T:-1},1169:{T:1},1170:{T:-1},1171:{},1172:{T:1},1173:{T:-1},1177:{},1178:{T:1},1180:{},1181:{},1182:{},2048:{T:1},2049:{T:-1},2050:{},2051:{T:1},2052:{T:-1},2053:{},2054:{},2055:{T:1},2056:{T:-1},2057:{T:1},2058:{T:-1},2060:{},2067:{},2068:{T:1},2069:{T:-1},2070:{},2071:{},2072:{T:1},2073:{T:-1},2075:{},2076:{},2077:{T:1},2078:{T:-1},2079:{},2080:{T:1},2081:{T:-1},2082:{},2083:{T:1},2084:{T:-1},2085:{T:1},2086:{T:-1},2087:{T:1},2088:{T:-1},2089:{T:1},2090:{T:-1},2091:{},2092:{},2093:{T:1},2094:{T:-1},2095:{},2096:{T:1},2097:{T:-1},2098:{T:1},2099:{T:-1},2100:{T:1},2101:{T:-1},2102:{},2103:{T:1},2104:{T:-1},2105:{},2106:{T:1},2107:{T:-1},2108:{},2109:{T:1},2110:{T:-1},2111:{T:1},2112:{T:-1},2113:{T:1},2114:{T:-1},2115:{},2116:{},2117:{},2118:{T:1},2119:{T:-1},2120:{},2121:{T:1},2122:{T:-1},2123:{T:1},2124:{T:-1},2125:{},2126:{T:1},2127:{T:-1},2128:{},2129:{T:1},2130:{T:-1},2131:{T:1},2132:{T:-1},2133:{T:1},2134:{},2135:{},2136:{},2137:{T:1},2138:{T:-1},2139:{T:1},2140:{T:-1},2141:{},3072:{},3073:{},4096:{T:1},4097:{T:-1},5002:{T:1},5003:{T:-1},5081:{T:1},5082:{T:-1},5083:{},5084:{T:1},5085:{T:-1},5086:{T:1},5087:{T:-1},5088:{},5089:{},5090:{},5092:{T:1},5093:{T:-1},5094:{},5095:{T:1},5096:{T:-1},5097:{},5099:{},65535:{n:""}},Yg={6:{f:dm},10:{f:Ks},12:{f:kn},13:{f:kn},14:{f:yn},15:{f:yn},16:{f:ur},17:{f:yn},18:{f:yn},19:{f:kn},20:{f:wE},21:{f:wE},23:{f:JF},24:{f:SE},25:{f:yn},26:{},27:{},28:{f:$9},29:{},34:{f:yn},35:{f:TE},38:{f:ur},39:{f:ur},40:{f:ur},41:{f:ur},42:{f:yn},43:{f:yn},47:{f:eH},49:{f:m9},51:{f:kn},60:{},61:{f:c9},64:{f:yn},65:{f:p9},66:{f:kn},77:{},80:{},81:{},82:{},85:{f:kn},89:{},90:{},91:{},92:{f:ZV},93:{f:G9},94:{},95:{f:yn},96:{},97:{},99:{f:yn},125:{f:QF},128:{f:F9},129:{f:t9},130:{f:kn},131:{f:yn},132:{f:yn},133:{f:n9},134:{},140:{f:Z9},141:{f:kn},144:{},146:{f:n7},151:{},152:{},153:{},154:{},155:{},156:{f:kn},157:{},158:{},160:{f:u7},161:{f:s7},174:{},175:{},176:{},177:{},178:{},180:{},181:{},182:{},184:{},185:{},189:{f:k9},190:{f:A9},193:{f:Ks},197:{},198:{},199:{},200:{},201:{},202:{f:yn},203:{},204:{},205:{},206:{},207:{},208:{},209:{},210:{},211:{},213:{},215:{},216:{},217:{},218:{f:kn},220:{},221:{f:yn},222:{},224:{f:M9},225:{f:jV},226:{f:Ks},227:{},229:{f:z9},233:{},235:{},236:{},237:{},239:{},240:{},241:{},242:{},244:{},245:{},246:{},247:{},248:{},249:{},251:{},252:{f:i9},253:{f:v9},255:{f:a9},256:{},259:{},290:{},311:{},312:{},315:{},317:{f:HF},318:{},319:{},320:{},330:{},331:{},333:{},334:{},335:{},336:{},337:{},338:{},339:{},340:{},351:{},352:{f:yn},353:{f:Ks},401:{},402:{},403:{},404:{},405:{},406:{},407:{},408:{},425:{},426:{},427:{},428:{},429:{},430:{f:b9},431:{f:yn},432:{},433:{},434:{},437:{},438:{f:Y9},439:{f:yn},440:{f:X9},441:{},442:{f:Yf},443:{},444:{f:kn},445:{},446:{},448:{f:Ks},449:{f:u9,r:2},450:{f:Ks},512:{f:vE},513:{f:l7},515:{f:I9},516:{f:y9},517:{f:yE},519:{f:c7},520:{f:o9},523:{},545:{f:EE},549:{f:gE},566:{},574:{f:d9},638:{f:C9},659:{},1048:{},1054:{f:T9},1084:{},1212:{f:U9},2048:{f:Q9},2049:{},2050:{},2051:{},2052:{},2053:{},2054:{},2055:{},2056:{},2057:{f:Bd},2058:{},2059:{},2060:{},2061:{},2062:{},2063:{},2064:{},2066:{},2067:{},2128:{},2129:{},2130:{},2131:{},2132:{},2133:{},2134:{},2135:{},2136:{},2137:{},2138:{},2146:{},2147:{r:12},2148:{},2149:{},2150:{},2151:{f:Ks},2152:{},2154:{},2155:{},2156:{},2161:{},2162:{},2164:{},2165:{},2166:{},2167:{},2168:{},2169:{},2170:{},2171:{},2172:{f:r7,r:12},2173:{f:ZH,r:12},2174:{},2175:{},2180:{},2181:{},2182:{},2183:{},2184:{},2185:{},2186:{},2187:{},2188:{f:yn,r:12},2189:{},2190:{r:12},2191:{},2192:{},2194:{},2195:{},2196:{f:B9,r:12},2197:{},2198:{f:KH,r:12},2199:{},2200:{},2201:{},2202:{f:V9,r:12},2203:{f:Ks},2204:{},2205:{},2206:{},2207:{},2211:{f:l9},2212:{},2213:{},2214:{},2215:{},4097:{},4098:{},4099:{},4102:{},4103:{},4105:{},4106:{},4107:{},4108:{},4109:{},4116:{},4117:{},4118:{},4119:{},4120:{},4121:{},4122:{},4123:{},4124:{},4125:{},4126:{},4127:{},4128:{},4129:{},4130:{},4132:{},4133:{},4134:{f:kn},4135:{},4146:{},4147:{},4148:{},4149:{},4154:{},4156:{},4157:{},4158:{},4159:{},4160:{},4161:{},4163:{},4164:{f:a7},4165:{},4166:{},4168:{},4170:{},4171:{},4174:{},4175:{},4176:{},4177:{},4187:{},4188:{f:t7},4189:{},4191:{},4192:{},4193:{},4194:{},4195:{},4196:{},4197:{},4198:{},4199:{},4200:{},0:{f:vE},1:{},2:{f:m7},3:{f:h7},4:{f:d7},5:{f:yE},7:{f:v7},8:{},9:{f:Bd},11:{},22:{f:kn},30:{f:E9},31:{},32:{},33:{f:EE},36:{},37:{f:gE},50:{f:x7},62:{},52:{},67:{},68:{f:kn},69:{},86:{},126:{},127:{f:f7},135:{},136:{},137:{},145:{},148:{},149:{},150:{},169:{},171:{},188:{},191:{},192:{},194:{},195:{},214:{f:y7},223:{},234:{},354:{},421:{},518:{f:dm},521:{f:Bd},536:{f:SE},547:{f:TE},561:{},579:{},1030:{f:dm},1033:{f:Bd},1091:{},2157:{},2163:{},2177:{},2240:{},2241:{},2242:{},2243:{},2244:{},2245:{},2246:{},2247:{},2248:{},2249:{},2250:{},2251:{},2262:{r:12},29282:{}};function Ie(e,t,n,r){var i=t;if(!isNaN(i)){var s=r||(n||[]).length||0,a=e.next(4);a.write_shift(2,i),a.write_shift(2,s),s>0&&I1(n)&&e.push(n)}}function vK(e,t,n,r){var i=(n||[]).length||0;if(i<=8224)return Ie(e,t,n,i);var s=t;if(!isNaN(s)){for(var a=n.parts||[],o=0,l=0,u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;var c=e.next(4);for(c.write_shift(2,s),c.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u;l<i;){for(c=e.next(4),c.write_shift(2,60),u=0;u+(a[o]||8224)<=8224;)u+=a[o]||8224,o++;c.write_shift(2,u),e.push(n.slice(l,l+u)),l+=u}}}function jf(e,t,n){return e||(e=me(7)),e.write_shift(2,t),e.write_shift(2,n),e.write_shift(2,0),e.write_shift(1,0),e}function xK(e,t,n,r){var i=me(9);return jf(i,e,t),$F(n,r||"b",i),i}function yK(e,t,n){var r=me(8+2*n.length);return jf(r,e,t),r.write_shift(1,n.length),r.write_shift(n.length,n,"sbcs"),r.l<r.length?r.slice(0,r.l):r}function wK(e,t,n,r){if(t.v!=null)switch(t.t){case"d":case"n":var i=t.t=="d"?Nn(tn(t.v)):t.v;i==(i|0)&&i>=0&&i<65536?Ie(e,2,g7(n,r,i)):Ie(e,3,p7(n,r,i));return;case"b":case"e":Ie(e,5,xK(n,r,t.v,t.t));return;case"s":case"str":Ie(e,4,yK(n,r,(t.v||"").slice(0,255)));return}Ie(e,1,jf(null,n,r))}function TK(e,t,n,r){var i=Array.isArray(t),s=At(t["!ref"]||"A1"),a,o="",l=[];if(s.e.c>255||s.e.r>16383){if(r.WTF)throw new Error("Range "+(t["!ref"]||"A1")+" exceeds format limit A1:IV16384");s.e.c=Math.min(s.e.c,255),s.e.r=Math.min(s.e.c,16383),a=lt(s)}for(var u=s.s.r;u<=s.e.r;++u){o=Sn(u);for(var c=s.s.c;c<=s.e.c;++c){u===s.s.r&&(l[c]=on(c)),a=l[c]+o;var h=i?(t[u]||[])[c]:t[a];h&&wK(e,h,u,c)}}}function SK(e,t){for(var n=t||{},r=Or(),i=0,s=0;s<e.SheetNames.length;++s)e.SheetNames[s]==n.sheet&&(i=s);if(i==0&&n.sheet&&e.SheetNames[0]!=n.sheet)throw new Error("Sheet not found: "+n.sheet);return Ie(r,n.biff==4?1033:n.biff==3?521:9,z1(e,16,n)),TK(r,e.Sheets[e.SheetNames[i]],i,n),Ie(r,10),r.end()}function EK(e,t,n){Ie(e,49,g9({sz:12,name:"Arial"},n))}function _K(e,t,n){t&&[[5,8],[23,26],[41,44],[50,392]].forEach(function(r){for(var i=r[0];i<=r[1];++i)t[i]!=null&&Ie(e,1054,S9(i,t[i],n))})}function CK(e,t){var n=me(19);n.write_shift(4,2151),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,1),n.write_shift(4,0),Ie(e,2151,n),n=me(39),n.write_shift(4,2152),n.write_shift(4,0),n.write_shift(4,0),n.write_shift(2,3),n.write_shift(1,0),n.write_shift(4,0),n.write_shift(2,1),n.write_shift(4,4),n.write_shift(2,0),KF(At(t["!ref"]||"A1"),n),n.write_shift(4,4),Ie(e,2152,n)}function kK(e,t){for(var n=0;n<16;++n)Ie(e,224,xE({numFmtId:0,style:!0},0,t));t.cellXfs.forEach(function(r){Ie(e,224,xE(r,0,t))})}function AK(e,t){for(var n=0;n<t["!links"].length;++n){var r=t["!links"][n];Ie(e,440,J9(r)),r[1].Tooltip&&Ie(e,2048,j9(r))}delete t["!links"]}function RK(e,t){if(t){var n=0;t.forEach(function(r,i){++n<=256&&r&&Ie(e,125,i7(ip(i,r),i))})}}function MK(e,t,n,r,i){var s=16+qa(i.cellXfs,t,i);if(t.v==null&&!t.bf){Ie(e,513,bo(n,r,s));return}if(t.bf)Ie(e,6,tW(t,n,r,i,s));else switch(t.t){case"d":case"n":var a=t.t=="d"?Nn(tn(t.v)):t.v;Ie(e,515,N9(n,r,a,s));break;case"b":case"e":Ie(e,517,P9(n,r,t.v,s,i,t.t));break;case"s":case"str":if(i.bookSST){var o=Q1(i.Strings,t.v,i.revStrings);Ie(e,253,x9(n,r,o,s))}else Ie(e,516,w9(n,r,(t.v||"").slice(0,255),s,i));break;default:Ie(e,513,bo(n,r,s))}}function FK(e,t,n){var r=Or(),i=n.SheetNames[e],s=n.Sheets[i]||{},a=(n||{}).Workbook||{},o=(a.Sheets||[])[e]||{},l=Array.isArray(s),u=t.biff==8,c,h="",p=[],m=At(s["!ref"]||"A1"),v=u?65536:16384;if(m.e.c>255||m.e.r>=v){if(t.WTF)throw new Error("Range "+(s["!ref"]||"A1")+" exceeds format limit A1:IV16384");m.e.c=Math.min(m.e.c,255),m.e.r=Math.min(m.e.c,v-1)}Ie(r,2057,z1(n,16,t)),Ie(r,13,di(1)),Ie(r,12,di(100)),Ie(r,15,Tr(!0)),Ie(r,17,Tr(!1)),Ie(r,16,Io(.001)),Ie(r,95,Tr(!0)),Ie(r,42,Tr(!1)),Ie(r,43,Tr(!1)),Ie(r,130,di(1)),Ie(r,128,D9()),Ie(r,131,Tr(!1)),Ie(r,132,Tr(!1)),u&&RK(r,s["!cols"]),Ie(r,512,_9(m,t)),u&&(s["!links"]=[]);for(var g=m.s.r;g<=m.e.r;++g){h=Sn(g);for(var w=m.s.c;w<=m.e.c;++w){g===m.s.r&&(p[w]=on(w)),c=p[w]+h;var x=l?(s[g]||[])[w]:s[c];x&&(MK(r,x,g,w,t),u&&x.l&&s["!links"].push([c,x.l]))}}var T=o.CodeName||o.name||i;return u&&Ie(r,574,h9((a.Views||[])[0])),u&&(s["!merges"]||[]).length&&Ie(r,229,W9(s["!merges"])),u&&AK(r,s),Ie(r,442,zF(T)),u&&CK(r,s),Ie(r,10),r.end()}function DK(e,t,n){var r=Or(),i=(e||{}).Workbook||{},s=i.Sheets||[],a=i.WBProps||{},o=n.biff==8,l=n.biff==5;if(Ie(r,2057,z1(e,5,n)),n.bookType=="xla"&&Ie(r,135),Ie(r,225,o?di(1200):null),Ie(r,193,PV(2)),l&&Ie(r,191),l&&Ie(r,192),Ie(r,226),Ie(r,92,e9("SheetJS",n)),Ie(r,66,di(o?1200:1252)),o&&Ie(r,353,di(0)),o&&Ie(r,448),Ie(r,317,o7(e.SheetNames.length)),o&&e.vbaraw&&Ie(r,211),o&&e.vbaraw){var u=a.CodeName||"ThisWorkbook";Ie(r,442,zF(u))}Ie(r,156,di(17)),Ie(r,25,Tr(!1)),Ie(r,18,Tr(!1)),Ie(r,19,di(0)),o&&Ie(r,431,Tr(!1)),o&&Ie(r,444,di(0)),Ie(r,61,f9()),Ie(r,64,Tr(!1)),Ie(r,141,di(0)),Ie(r,34,Tr(uq(e)=="true")),Ie(r,14,Tr(!0)),o&&Ie(r,439,Tr(!1)),Ie(r,218,di(0)),EK(r,e,n),_K(r,e.SSF,n),kK(r,n),o&&Ie(r,352,Tr(!1));var c=r.end(),h=Or();o&&Ie(h,140,e7()),o&&n.Strings&&vK(h,252,s9(n.Strings)),Ie(h,10);var p=h.end(),m=Or(),v=0,g=0;for(g=0;g<e.SheetNames.length;++g)v+=(o?12:11)+(o?2:1)*e.SheetNames[g].length;var w=c.length+v+p.length;for(g=0;g<e.SheetNames.length;++g){var x=s[g]||{};Ie(m,133,r9({pos:w,hs:x.Hidden||0,dt:0,name:e.SheetNames[g]},n)),w+=t[g].length}var T=m.end();if(v!=T.length)throw new Error("BS8 "+v+" != "+T.length);var y=[];return c.length&&y.push(c),T.length&&y.push(T),p.length&&y.push(p),Hn(y)}function PK(e,t){var n=t||{},r=[];e&&!e.SSF&&(e.SSF=nn(et)),e&&e.SSF&&(Au(),Qh(e.SSF),n.revssf=Zh(e.SSF),n.revssf[e.SSF[65535]]=0,n.ssf=e.SSF),n.Strings=[],n.Strings.Count=0,n.Strings.Unique=0,ny(n),n.cellXfs=[],qa(n.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={});for(var i=0;i<e.SheetNames.length;++i)r[r.length]=FK(i,n,e);return r.unshift(DK(e,r,n)),Hn(r)}function LD(e,t){for(var n=0;n<=e.SheetNames.length;++n){var r=e.Sheets[e.SheetNames[n]];if(!(!r||!r["!ref"])){var i=Br(r["!ref"]);i.e.c>255&&typeof console<"u"&&console.error&&console.error("Worksheet '"+e.SheetNames[n]+"' extends beyond column IV (255).  Data may be lost.")}}var s=t||{};switch(s.biff||2){case 8:case 5:return PK(e,t);case 4:case 3:case 2:return SK(e,t)}throw new Error("invalid type "+s.bookType+" for BIFF")}function IE(e,t){var n=t||{},r=n.dense?[]:{};e=e.replace(/<!--.*?-->/g,"");var i=e.match(/<table/i);if(!i)throw new Error("Invalid HTML: could not find <table>");var s=e.match(/<\/table/i),a=i.index,o=s&&s.index||e.length,l=gU(e.slice(a,o),/(:?<tr[^>]*>)/i,"<tr>"),u=-1,c=0,h=0,p=0,m={s:{r:1e7,c:1e7},e:{r:0,c:0}},v=[];for(a=0;a<l.length;++a){var g=l[a].trim(),w=g.slice(0,3).toLowerCase();if(w=="<tr"){if(++u,n.sheetRows&&n.sheetRows<=u){--u;break}c=0;continue}if(!(w!="<td"&&w!="<th")){var x=g.split(/<\/t[dh]>/i);for(o=0;o<x.length;++o){var T=x[o].trim();if(T.match(/<t[dh]/i)){for(var y=T,_=0;y.charAt(0)=="<"&&(_=y.indexOf(">"))>-1;)y=y.slice(_+1);for(var k=0;k<v.length;++k){var S=v[k];S.s.c==c&&S.s.r<u&&u<=S.e.r&&(c=S.e.c+1,k=-1)}var C=it(T.slice(0,T.indexOf(">")));p=C.colspan?+C.colspan:1,((h=+C.rowspan)>1||p>1)&&v.push({s:{r:u,c},e:{r:u+(h||1)-1,c:c+p-1}});var M=C.t||C["data-t"]||"";if(!y.length){c+=p;continue}if(y=aF(y),m.s.r>u&&(m.s.r=u),m.e.r<u&&(m.e.r=u),m.s.c>c&&(m.s.c=c),m.e.c<c&&(m.e.c=c),!y.length){c+=p;continue}var F={t:"s",v:y};n.raw||!y.trim().length||M=="s"||(y==="TRUE"?F={t:"b",v:!0}:y==="FALSE"?F={t:"b",v:!1}:isNaN(Vi(y))?isNaN(gu(y).getDate())||(F={t:"d",v:tn(y)},n.cellDates||(F={t:"n",v:Nn(F.v)}),F.z=n.dateNF||et[14]):F={t:"n",v:Vi(y)}),n.dense?(r[u]||(r[u]=[]),r[u][c]=F):r[nt({r:u,c})]=F,c+=p}}}}return r["!ref"]=lt(m),v.length&&(r["!merges"]=v),r}function IK(e,t,n,r){for(var i=e["!merges"]||[],s=[],a=t.s.c;a<=t.e.c;++a){for(var o=0,l=0,u=0;u<i.length;++u)if(!(i[u].s.r>n||i[u].s.c>a)&&!(i[u].e.r<n||i[u].e.c<a)){if(i[u].s.r<n||i[u].s.c<a){o=-1;break}o=i[u].e.r-i[u].s.r+1,l=i[u].e.c-i[u].s.c+1;break}if(!(o<0)){var c=nt({r:n,c:a}),h=r.dense?(e[n]||[])[a]:e[c],p=h&&h.v!=null&&(h.h||F1(h.w||(Us(h),h.w)||""))||"",m={};o>1&&(m.rowspan=o),l>1&&(m.colspan=l),r.editable?p='<span contenteditable="true">'+p+"</span>":h&&(m["data-t"]=h&&h.t||"z",h.v!=null&&(m["data-v"]=h.v),h.z!=null&&(m["data-z"]=h.z),h.l&&(h.l.Target||"#").charAt(0)!="#"&&(p='<a href="'+h.l.Target+'">'+p+"</a>")),m.id=(r.id||"sjs")+"-"+c,s.push(Pe("td",p,m))}}var v="<tr>";return v+s.join("")+"</tr>"}var NK='<html><head><meta charset="utf-8"/><title>SheetJS Table Export</title></head><body>',bK="</body></html>";function LK(e,t){var n=e.match(/<table[\s\S]*?>[\s\S]*?<\/table>/gi);if(!n||n.length==0)throw new Error("Invalid HTML: could not find <table>");if(n.length==1)return Ga(IE(n[0],t),t);var r=sy();return n.forEach(function(i,s){ay(r,IE(i,t),"Sheet"+(s+1))}),r}function OK(e,t,n){var r=[];return r.join("")+"<table"+(n&&n.id?' id="'+n.id+'"':"")+">"}function OD(e,t){var n=t||{},r=n.header!=null?n.header:NK,i=n.footer!=null?n.footer:bK,s=[r],a=Br(e["!ref"]);n.dense=Array.isArray(e),s.push(OK(e,a,n));for(var o=a.s.r;o<=a.e.r;++o)s.push(IK(e,a,o,n));return s.push("</table>"+i),s.join("")}function BD(e,t,n){var r=n||{},i=0,s=0;if(r.origin!=null)if(typeof r.origin=="number")i=r.origin;else{var a=typeof r.origin=="string"?ln(r.origin):r.origin;i=a.r,s=a.c}var o=t.getElementsByTagName("tr"),l=Math.min(r.sheetRows||1e7,o.length),u={s:{r:0,c:0},e:{r:i,c:s}};if(e["!ref"]){var c=Br(e["!ref"]);u.s.r=Math.min(u.s.r,c.s.r),u.s.c=Math.min(u.s.c,c.s.c),u.e.r=Math.max(u.e.r,c.e.r),u.e.c=Math.max(u.e.c,c.e.c),i==-1&&(u.e.r=i=c.e.r+1)}var h=[],p=0,m=e["!rows"]||(e["!rows"]=[]),v=0,g=0,w=0,x=0,T=0,y=0;for(e["!cols"]||(e["!cols"]=[]);v<o.length&&g<l;++v){var _=o[v];if(NE(_)){if(r.display)continue;m[g]={hidden:!0}}var k=_.children;for(w=x=0;w<k.length;++w){var S=k[w];if(!(r.display&&NE(S))){var C=S.hasAttribute("data-v")?S.getAttribute("data-v"):S.hasAttribute("v")?S.getAttribute("v"):aF(S.innerHTML),M=S.getAttribute("data-z")||S.getAttribute("z");for(p=0;p<h.length;++p){var F=h[p];F.s.c==x+s&&F.s.r<g+i&&g+i<=F.e.r&&(x=F.e.c+1-s,p=-1)}y=+S.getAttribute("colspan")||1,((T=+S.getAttribute("rowspan")||1)>1||y>1)&&h.push({s:{r:g+i,c:x+s},e:{r:g+i+(T||1)-1,c:x+s+(y||1)-1}});var b={t:"s",v:C},V=S.getAttribute("data-t")||S.getAttribute("t")||"";C!=null&&(C.length==0?b.t=V||"z":r.raw||C.trim().length==0||V=="s"||(C==="TRUE"?b={t:"b",v:!0}:C==="FALSE"?b={t:"b",v:!1}:isNaN(Vi(C))?isNaN(gu(C).getDate())||(b={t:"d",v:tn(C)},r.cellDates||(b={t:"n",v:Nn(b.v)}),b.z=r.dateNF||et[14]):b={t:"n",v:Vi(C)})),b.z===void 0&&M!=null&&(b.z=M);var z="",ie=S.getElementsByTagName("A");if(ie&&ie.length)for(var Q=0;Q<ie.length&&!(ie[Q].hasAttribute("href")&&(z=ie[Q].getAttribute("href"),z.charAt(0)!="#"));++Q);z&&z.charAt(0)!="#"&&(b.l={Target:z}),r.dense?(e[g+i]||(e[g+i]=[]),e[g+i][x+s]=b):e[nt({c:x+s,r:g+i})]=b,u.e.c<x+s&&(u.e.c=x+s),x+=y}}++g}return h.length&&(e["!merges"]=(e["!merges"]||[]).concat(h)),u.e.r=Math.max(u.e.r,g-1+i),e["!ref"]=lt(u),g>=l&&(e["!fullref"]=lt((u.e.r=o.length-v+g-1+i,u))),e}function UD(e,t){var n=t||{},r=n.dense?[]:{};return BD(r,e,t)}function BK(e,t){return Ga(UD(e,t),t)}function NE(e){var t="",n=UK(e);return n&&(t=n(e).getPropertyValue("display")),t||(t=e.style&&e.style.display),t==="none"}function UK(e){return e.ownerDocument.defaultView&&typeof e.ownerDocument.defaultView.getComputedStyle=="function"?e.ownerDocument.defaultView.getComputedStyle:typeof getComputedStyle=="function"?getComputedStyle:null}function VK(e){var t=e.replace(/[\t\r\n]/g," ").trim().replace(/ +/g," ").replace(/<text:s\/>/g," ").replace(/<text:s text:c="(\d+)"\/>/g,function(r,i){return Array(parseInt(i,10)+1).join(" ")}).replace(/<text:tab[^>]*\/>/g,"	").replace(/<text:line-break\/>/g,`
`),n=kt(t.replace(/<[^>]*>/g,""));return[n]}var bE={day:["d","dd"],month:["m","mm"],year:["y","yy"],hours:["h","hh"],minutes:["m","mm"],seconds:["s","ss"],"am-pm":["A/P","AM/PM"],"day-of-week":["ddd","dddd"],era:["e","ee"],quarter:["\\Qm",'m\\"th quarter"']};function VD(e,t){var n=t||{},r=D1(e),i=[],s,a,o={name:""},l="",u=0,c,h,p={},m=[],v=n.dense?[]:{},g,w,x={value:""},T="",y=0,_=[],k=-1,S=-1,C={s:{r:1e6,c:1e7},e:{r:0,c:0}},M=0,F={},b=[],V={},z=0,ie=0,Q=[],se=1,de=1,ae=[],ne={Names:[]},H={},fe=["",""],xe=[],L={},q="",W=0,G=!1,ee=!1,Se=0;for(mf.lastIndex=0,r=r.replace(/<!--([\s\S]*?)-->/mg,"").replace(/<!DOCTYPE[^\[]*\[[^\]]*\]>/gm,"");g=mf.exec(r);)switch(g[3]=g[3].replace(/_.*$/,"")){case"table":case"":g[1]==="/"?(C.e.c>=C.s.c&&C.e.r>=C.s.r?v["!ref"]=lt(C):v["!ref"]="A1:A1",n.sheetRows>0&&n.sheetRows<=C.e.r&&(v["!fullref"]=v["!ref"],C.e.r=n.sheetRows-1,v["!ref"]=lt(C)),b.length&&(v["!merges"]=b),Q.length&&(v["!rows"]=Q),c.name=c.||c.name,typeof JSON<"u"&&JSON.stringify(c),m.push(c.name),p[c.name]=v,ee=!1):g[0].charAt(g[0].length-2)!=="/"&&(c=it(g[0],!1),k=S=-1,C.s.r=C.s.c=1e7,C.e.r=C.e.c=0,v=n.dense?[]:{},b=[],Q=[],ee=!0);break;case"table-row-group":g[1]==="/"?--M:++M;break;case"table-row":case"":if(g[1]==="/"){k+=se,se=1;break}if(h=it(g[0],!1),h.?k=h.-1:k==-1&&(k=0),se=+h["number-rows-repeated"]||1,se<10)for(Se=0;Se<se;++Se)M>0&&(Q[k+Se]={level:M});S=-1;break;case"covered-table-cell":g[1]!=="/"&&++S,n.sheetStubs&&(n.dense?(v[k]||(v[k]=[]),v[k][S]={t:"z"}):v[nt({r:k,c:S})]={t:"z"}),T="",_=[];break;case"table-cell":case"":if(g[0].charAt(g[0].length-2)==="/")++S,x=it(g[0],!1),de=parseInt(x["number-columns-repeated"]||"1",10),w={t:"z",v:null},x.formula&&n.cellFormula!=!1&&(w.f=FE(kt(x.formula))),(x.||x["value-type"])=="string"&&(w.t="s",w.v=kt(x["string-value"]||""),n.dense?(v[k]||(v[k]=[]),v[k][S]=w):v[nt({r:k,c:S})]=w),S+=de-1;else if(g[1]!=="/"){++S,T="",y=0,_=[],de=1;var we=se?k+se-1:k;if(S>C.e.c&&(C.e.c=S),S<C.s.c&&(C.s.c=S),k<C.s.r&&(C.s.r=k),we>C.e.r&&(C.e.r=we),x=it(g[0],!1),xe=[],L={},w={t:x.||x["value-type"],v:null},n.cellFormula)if(x.formula&&(x.formula=kt(x.formula)),x["number-matrix-columns-spanned"]&&x["number-matrix-rows-spanned"]&&(z=parseInt(x["number-matrix-rows-spanned"],10)||0,ie=parseInt(x["number-matrix-columns-spanned"],10)||0,V={s:{r:k,c:S},e:{r:k+z-1,c:S+ie-1}},w.F=lt(V),ae.push([V,w.F])),x.formula)w.f=FE(x.formula);else for(Se=0;Se<ae.length;++Se)k>=ae[Se][0].s.r&&k<=ae[Se][0].e.r&&S>=ae[Se][0].s.c&&S<=ae[Se][0].e.c&&(w.F=ae[Se][1]);switch((x["number-columns-spanned"]||x["number-rows-spanned"])&&(z=parseInt(x["number-rows-spanned"],10)||0,ie=parseInt(x["number-columns-spanned"],10)||0,V={s:{r:k,c:S},e:{r:k+z-1,c:S+ie-1}},b.push(V)),x["number-columns-repeated"]&&(de=parseInt(x["number-columns-repeated"],10)),w.t){case"boolean":w.t="b",w.v=jt(x["boolean-value"]);break;case"float":w.t="n",w.v=parseFloat(x.value);break;case"percentage":w.t="n",w.v=parseFloat(x.value);break;case"currency":w.t="n",w.v=parseFloat(x.value);break;case"date":w.t="d",w.v=tn(x["date-value"]),n.cellDates||(w.t="n",w.v=Nn(w.v)),w.z="m/d/yy";break;case"time":w.t="n",w.v=hU(x["time-value"])/86400,n.cellDates&&(w.t="d",w.v=ep(w.v)),w.z="HH:MM:SS";break;case"number":w.t="n",w.v=parseFloat(x.);break;default:if(w.t==="string"||w.t==="text"||!w.t)w.t="s",x["string-value"]!=null&&(T=kt(x["string-value"]),_=[]);else throw new Error("Unsupported value type "+w.t)}}else{if(G=!1,w.t==="s"&&(w.v=T||"",_.length&&(w.R=_),G=y==0),H.Target&&(w.l=H),xe.length>0&&(w.c=xe,xe=[]),T&&n.cellText!==!1&&(w.w=T),G&&(w.t="z",delete w.v),(!G||n.sheetStubs)&&!(n.sheetRows&&n.sheetRows<=k))for(var pe=0;pe<se;++pe){if(de=parseInt(x["number-columns-repeated"]||"1",10),n.dense)for(v[k+pe]||(v[k+pe]=[]),v[k+pe][S]=pe==0?w:nn(w);--de>0;)v[k+pe][S+de]=nn(w);else for(v[nt({r:k+pe,c:S})]=w;--de>0;)v[nt({r:k+pe,c:S+de})]=nn(w);C.e.c<=S&&(C.e.c=S)}de=parseInt(x["number-columns-repeated"]||"1",10),S+=de-1,de=0,w={},T="",_=[]}H={};break;case"document":case"document-content":case"":case"spreadsheet":case"":case"scripts":case"styles":case"font-face-decls":case"master-styles":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!0]);break;case"annotation":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s;L.t=T,_.length&&(L.R=_),L.a=q,xe.push(L)}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);q="",W=0,T="",y=0,_=[];break;case"creator":g[1]==="/"?q=r.slice(W,g.index):W=g.index+g[0].length;break;case"meta":case"":case"settings":case"config-item-set":case"config-item-map-indexed":case"config-item-map-entry":case"config-item-map-named":case"shapes":case"frame":case"text-box":case"image":case"data-pilot-tables":case"list-style":case"form":case"dde-links":case"event-listeners":case"chart":if(g[1]==="/"){if((s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&i.push([g[3],!1]);T="",y=0,_=[];break;case"scientific-number":break;case"currency-symbol":break;case"currency-style":break;case"number-style":case"percentage-style":case"date-style":case"time-style":if(g[1]==="/"){if(F[o.name]=l,(s=i.pop())[0]!==g[3])throw"Bad state: "+s}else g[0].charAt(g[0].length-2)!=="/"&&(l="",o=it(g[0],!1),i.push([g[3],!0]));break;case"script":break;case"libraries":break;case"automatic-styles":break;case"default-style":case"page-layout":break;case"style":break;case"map":break;case"font-face":break;case"paragraph-properties":break;case"table-properties":break;case"table-column-properties":break;case"table-row-properties":break;case"table-cell-properties":break;case"number":switch(i[i.length-1][0]){case"time-style":case"date-style":a=it(g[0],!1),l+=bE[g[3]][a.style==="long"?1:0];break}break;case"fraction":break;case"day":case"month":case"year":case"era":case"day-of-week":case"week-of-year":case"quarter":case"hours":case"minutes":case"seconds":case"am-pm":switch(i[i.length-1][0]){case"time-style":case"date-style":a=it(g[0],!1),l+=bE[g[3]][a.style==="long"?1:0];break}break;case"boolean-style":break;case"boolean":break;case"text-style":break;case"text":if(g[0].slice(-2)==="/>")break;if(g[1]==="/")switch(i[i.length-1][0]){case"number-style":case"date-style":case"time-style":l+=r.slice(u,g.index);break}else u=g.index+g[0].length;break;case"named-range":a=it(g[0],!1),fe=hm(a["cell-range-address"]);var oe={Name:a.name,Ref:fe[0]+"!"+fe[1]};ee&&(oe.Sheet=m.length),ne.Names.push(oe);break;case"text-content":break;case"text-properties":break;case"embedded-text":break;case"body":case"":break;case"forms":break;case"table-column":break;case"table-header-rows":break;case"table-rows":break;case"table-column-group":break;case"table-header-columns":break;case"table-columns":break;case"null-date":break;case"graphic-properties":break;case"calculation-settings":break;case"named-expressions":break;case"label-range":break;case"label-ranges":break;case"named-expression":break;case"sort":break;case"sort-by":break;case"sort-groups":break;case"tab":break;case"line-break":break;case"span":break;case"p":case"":if(["master-styles"].indexOf(i[i.length-1][0])>-1)break;if(g[1]==="/"&&(!x||!x["string-value"])){var Le=VK(r.slice(y,g.index));T=(T.length>0?T+`
`:"")+Le[0]}else it(g[0],!1),y=g.index+g[0].length;break;case"s":break;case"database-range":if(g[1]==="/")break;try{fe=hm(it(g[0])["target-range-address"]),p[fe[0]]["!autofilter"]={ref:fe[1]}}catch{}break;case"date":break;case"object":break;case"title":case"":break;case"desc":break;case"binary-data":break;case"table-source":break;case"scenario":break;case"iteration":break;case"content-validations":break;case"content-validation":break;case"help-message":break;case"error-message":break;case"database-ranges":break;case"filter":break;case"filter-and":break;case"filter-or":break;case"filter-condition":break;case"list-level-style-bullet":break;case"list-level-style-number":break;case"list-level-properties":break;case"sender-firstname":case"sender-lastname":case"sender-initials":case"sender-title":case"sender-position":case"sender-email":case"sender-phone-private":case"sender-fax":case"sender-company":case"sender-phone-work":case"sender-street":case"sender-city":case"sender-postal-code":case"sender-country":case"sender-state-or-province":case"author-name":case"author-initials":case"chapter":case"file-name":case"template-name":case"sheet-name":break;case"event-listener":break;case"initial-creator":case"creation-date":case"print-date":case"generator":case"document-statistic":case"user-defined":case"editing-duration":case"editing-cycles":break;case"config-item":break;case"page-number":break;case"page-count":break;case"time":break;case"cell-range-source":break;case"detective":break;case"operation":break;case"highlighted-range":break;case"data-pilot-table":case"source-cell-range":case"source-service":case"data-pilot-field":case"data-pilot-level":case"data-pilot-subtotals":case"data-pilot-subtotal":case"data-pilot-members":case"data-pilot-member":case"data-pilot-display-info":case"data-pilot-sort-info":case"data-pilot-layout-info":case"data-pilot-field-reference":case"data-pilot-groups":case"data-pilot-group":case"data-pilot-group-member":break;case"rect":break;case"dde-connection-decls":case"dde-connection-decl":case"dde-link":case"dde-source":break;case"properties":break;case"property":break;case"a":if(g[1]!=="/"){if(H=it(g[0],!1),!H.href)break;H.Target=kt(H.href),delete H.href,H.Target.charAt(0)=="#"&&H.Target.indexOf(".")>-1?(fe=hm(H.Target.slice(1)),H.Target="#"+fe[0]+"!"+fe[1]):H.Target.match(/^\.\.[\\\/]/)&&(H.Target=H.Target.slice(3))}break;case"table-protection":break;case"data-pilot-grand-total":break;case"office-document-common-attrs":break;default:switch(g[2]){case"dc:":case"calcext:":case"loext:":case"ooo:":case"chartooo:":case"draw:":case"style:":case"chart:":case"form:":case"uof:":case":":case":":break;default:if(n.WTF)throw new Error(g)}}var B={Sheets:p,SheetNames:m,Workbook:ne};return n.bookSheets&&delete B.Sheets,B}function LE(e,t){t=t||{},ui(e,"META-INF/manifest.xml")&&hV(Cn(e,"META-INF/manifest.xml"),t);var n=qr(e,"content.xml");if(!n)throw new Error("Missing content.xml in ODS / UOF file");var r=VD(qt(n),t);return ui(e,"meta.xml")&&(r.Props=FF(Cn(e,"meta.xml"))),r}function OE(e,t){return VD(e,t)}var HK=function(){var e=["<office:master-styles>",'<style:master-page style:name="mp1" style:page-layout-name="mp1">',"<style:header/>",'<style:header-left style:display="false"/>',"<style:footer/>",'<style:footer-left style:display="false"/>',"</style:master-page>","</office:master-styles>"].join(""),t="<office:document-styles "+pf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","office:version":"1.2"})+">"+e+"</office:document-styles>";return function(){return En+t}}(),BE=function(){var e=function(s){return $t(s).replace(/  +/g,function(a){return'<text:s text:c="'+a.length+'"/>'}).replace(/\t/g,"<text:tab/>").replace(/\n/g,"</text:p><text:p>").replace(/^ /,"<text:s/>").replace(/ $/,"<text:s/>")},t=`          <table:table-cell />
`,n=`          <table:covered-table-cell/>
`,r=function(s,a,o){var l=[];l.push('      <table:table table:name="'+$t(a.SheetNames[o])+`" table:style-name="ta1">
`);var u=0,c=0,h=Br(s["!ref"]||"A1"),p=s["!merges"]||[],m=0,v=Array.isArray(s);if(s["!cols"])for(c=0;c<=h.e.c;++c)l.push("        <table:table-column"+(s["!cols"][c]?' table:style-name="co'+s["!cols"][c].ods+'"':"")+`></table:table-column>
`);var g="",w=s["!rows"]||[];for(u=0;u<h.s.r;++u)g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`></table:table-row>
`);for(;u<=h.e.r;++u){for(g=w[u]?' table:style-name="ro'+w[u].ods+'"':"",l.push("        <table:table-row"+g+`>
`),c=0;c<h.s.c;++c)l.push(t);for(;c<=h.e.c;++c){var x=!1,T={},y="";for(m=0;m!=p.length;++m)if(!(p[m].s.c>c)&&!(p[m].s.r>u)&&!(p[m].e.c<c)&&!(p[m].e.r<u)){(p[m].s.c!=c||p[m].s.r!=u)&&(x=!0),T["table:number-columns-spanned"]=p[m].e.c-p[m].s.c+1,T["table:number-rows-spanned"]=p[m].e.r-p[m].s.r+1;break}if(x){l.push(n);continue}var _=nt({r:u,c}),k=v?(s[u]||[])[c]:s[_];if(k&&k.f&&(T["table:formula"]=$t(oW(k.f)),k.F&&k.F.slice(0,_.length)==_)){var S=Br(k.F);T["table:number-matrix-columns-spanned"]=S.e.c-S.s.c+1,T["table:number-matrix-rows-spanned"]=S.e.r-S.s.r+1}if(!k){l.push(t);continue}switch(k.t){case"b":y=k.v?"TRUE":"FALSE",T["office:value-type"]="boolean",T["office:boolean-value"]=k.v?"true":"false";break;case"n":y=k.w||String(k.v||0),T["office:value-type"]="float",T["office:value"]=k.v||0;break;case"s":case"str":y=k.v==null?"":k.v,T["office:value-type"]="string";break;case"d":y=k.w||tn(k.v).toISOString(),T["office:value-type"]="date",T["office:date-value"]=tn(k.v).toISOString(),T["table:style-name"]="ce1";break;default:l.push(t);continue}var C=e(y);if(k.l&&k.l.Target){var M=k.l.Target;M=M.charAt(0)=="#"?"#"+lW(M.slice(1)):M,M.charAt(0)!="#"&&!M.match(/^\w+:/)&&(M="../"+M),C=Pe("text:a",C,{"xlink:href":M.replace(/&/g,"&amp;")})}l.push("          "+Pe("table:table-cell",Pe("text:p",C,{}),T)+`
`)}l.push(`        </table:table-row>
`)}return l.push(`      </table:table>
`),l.join("")},i=function(s,a){s.push(` <office:automatic-styles>
`),s.push(`  <number:date-style style:name="N37" number:automatic-order="true">
`),s.push(`   <number:month number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:day number:style="long"/>
`),s.push(`   <number:text>/</number:text>
`),s.push(`   <number:year/>
`),s.push(`  </number:date-style>
`);var o=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!cols"]){for(var c=0;c<u["!cols"].length;++c)if(u["!cols"][c]){var h=u["!cols"][c];if(h.width==null&&h.wpx==null&&h.wch==null)continue;ba(h),h.ods=o;var p=u["!cols"][c].wpx+"px";s.push('  <style:style style:name="co'+o+`" style:family="table-column">
`),s.push('   <style:table-column-properties fo:break-before="auto" style:column-width="'+p+`"/>
`),s.push(`  </style:style>
`),++o}}});var l=0;a.SheetNames.map(function(u){return a.Sheets[u]}).forEach(function(u){if(u&&u["!rows"]){for(var c=0;c<u["!rows"].length;++c)if(u["!rows"][c]){u["!rows"][c].ods=l;var h=u["!rows"][c].hpx+"px";s.push('  <style:style style:name="ro'+l+`" style:family="table-row">
`),s.push('   <style:table-row-properties fo:break-before="auto" style:row-height="'+h+`"/>
`),s.push(`  </style:style>
`),++l}}}),s.push(`  <style:style style:name="ta1" style:family="table" style:master-page-name="mp1">
`),s.push(`   <style:table-properties table:display="true" style:writing-mode="lr-tb"/>
`),s.push(`  </style:style>
`),s.push(`  <style:style style:name="ce1" style:family="table-cell" style:parent-style-name="Default" style:data-style-name="N37"/>
`),s.push(` </office:automatic-styles>
`)};return function(a,o){var l=[En],u=pf({"xmlns:office":"urn:oasis:names:tc:opendocument:xmlns:office:1.0","xmlns:table":"urn:oasis:names:tc:opendocument:xmlns:table:1.0","xmlns:style":"urn:oasis:names:tc:opendocument:xmlns:style:1.0","xmlns:text":"urn:oasis:names:tc:opendocument:xmlns:text:1.0","xmlns:draw":"urn:oasis:names:tc:opendocument:xmlns:drawing:1.0","xmlns:fo":"urn:oasis:names:tc:opendocument:xmlns:xsl-fo-compatible:1.0","xmlns:xlink":"http://www.w3.org/1999/xlink","xmlns:dc":"http://purl.org/dc/elements/1.1/","xmlns:meta":"urn:oasis:names:tc:opendocument:xmlns:meta:1.0","xmlns:number":"urn:oasis:names:tc:opendocument:xmlns:datastyle:1.0","xmlns:presentation":"urn:oasis:names:tc:opendocument:xmlns:presentation:1.0","xmlns:svg":"urn:oasis:names:tc:opendocument:xmlns:svg-compatible:1.0","xmlns:chart":"urn:oasis:names:tc:opendocument:xmlns:chart:1.0","xmlns:dr3d":"urn:oasis:names:tc:opendocument:xmlns:dr3d:1.0","xmlns:math":"http://www.w3.org/1998/Math/MathML","xmlns:form":"urn:oasis:names:tc:opendocument:xmlns:form:1.0","xmlns:script":"urn:oasis:names:tc:opendocument:xmlns:script:1.0","xmlns:ooo":"http://openoffice.org/2004/office","xmlns:ooow":"http://openoffice.org/2004/writer","xmlns:oooc":"http://openoffice.org/2004/calc","xmlns:dom":"http://www.w3.org/2001/xml-events","xmlns:xforms":"http://www.w3.org/2002/xforms","xmlns:xsd":"http://www.w3.org/2001/XMLSchema","xmlns:xsi":"http://www.w3.org/2001/XMLSchema-instance","xmlns:sheet":"urn:oasis:names:tc:opendocument:sh33tjs:1.0","xmlns:rpt":"http://openoffice.org/2005/report","xmlns:of":"urn:oasis:names:tc:opendocument:xmlns:of:1.2","xmlns:xhtml":"http://www.w3.org/1999/xhtml","xmlns:grddl":"http://www.w3.org/2003/g/data-view#","xmlns:tableooo":"http://openoffice.org/2009/table","xmlns:drawooo":"http://openoffice.org/2010/draw","xmlns:calcext":"urn:org:documentfoundation:names:experimental:calc:xmlns:calcext:1.0","xmlns:loext":"urn:org:documentfoundation:names:experimental:office:xmlns:loext:1.0","xmlns:field":"urn:openoffice:names:experimental:ooo-ms-interop:xmlns:field:1.0","xmlns:formx":"urn:openoffice:names:experimental:ooxml-odf-interop:xmlns:form:1.0","xmlns:css3t":"http://www.w3.org/TR/css3-text/","office:version":"1.2"}),c=pf({"xmlns:config":"urn:oasis:names:tc:opendocument:xmlns:config:1.0","office:mimetype":"application/vnd.oasis.opendocument.spreadsheet"});o.bookType=="fods"?(l.push("<office:document"+u+c+`>
`),l.push(MF().replace(/office:document-meta/g,"office:meta"))):l.push("<office:document-content"+u+`>
`),i(l,a),l.push(`  <office:body>
`),l.push(`    <office:spreadsheet>
`);for(var h=0;h!=a.SheetNames.length;++h)l.push(r(a.Sheets[a.SheetNames[h]],a,h));return l.push(`    </office:spreadsheet>
`),l.push(`  </office:body>
`),o.bookType=="fods"?l.push("</office:document>"):l.push("</office:document-content>"),l.join("")}}();function HD(e,t){if(t.bookType=="fods")return BE(e,t);var n=A1(),r="",i=[],s=[];return r="mimetype",ut(n,r,"application/vnd.oasis.opendocument.spreadsheet"),r="content.xml",ut(n,r,BE(e,t)),i.push([r,"text/xml"]),s.push([r,"ContentFile"]),r="styles.xml",ut(n,r,HK(e,t)),i.push([r,"text/xml"]),s.push([r,"StylesFile"]),r="meta.xml",ut(n,r,En+MF()),i.push([r,"text/xml"]),s.push([r,"MetadataFile"]),r="manifest.rdf",ut(n,r,gV(s)),i.push([r,"application/rdf+xml"]),r="META-INF/manifest.xml",ut(n,r,pV(i)),n}/*! sheetjs (C) 2013-present SheetJS -- http://sheetjs.com */function Lo(e){return new DataView(e.buffer,e.byteOffset,e.byteLength)}function Xg(e){return typeof TextDecoder<"u"?new TextDecoder().decode(e):qt(Wa(e))}function $K(e){return typeof TextEncoder<"u"?new TextEncoder().encode(e):Gr(ns(e))}function zK(e,t){e:for(var n=0;n<=e.length-t.length;++n){for(var r=0;r<t.length;++r)if(e[n+r]!=t[r])continue e;return!0}return!1}function Oa(e){var t=e.reduce(function(i,s){return i+s.length},0),n=new Uint8Array(t),r=0;return e.forEach(function(i){n.set(i,r),r+=i.length}),n}function UE(e){return e-=e>>1&1431655765,e=(e&858993459)+(e>>2&858993459),(e+(e>>4)&252645135)*16843009>>>24}function WK(e,t){for(var n=(e[t+15]&127)<<7|e[t+14]>>1,r=e[t+14]&1,i=t+13;i>=t;--i)r=r*256+e[i];return(e[t+15]&128?-r:r)*Math.pow(10,n-6176)}function GK(e,t,n){var r=Math.floor(n==0?0:Math.LOG10E*Math.log(Math.abs(n)))+6176-20,i=n/Math.pow(10,r-6176);e[t+15]|=r>>7,e[t+14]|=(r&127)<<1;for(var s=0;i>=1;++s,i/=256)e[t+s]=i&255;e[t+15]|=n>=0?0:128}function Sf(e,t){var n=t?t[0]:0,r=e[n]&127;e:if(e[n++]>=128&&(r|=(e[n]&127)<<7,e[n++]<128||(r|=(e[n]&127)<<14,e[n++]<128)||(r|=(e[n]&127)<<21,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,28),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,35),++n,e[n++]<128)||(r+=(e[n]&127)*Math.pow(2,42),++n,e[n++]<128)))break e;return t&&(t[0]=n),r}function Vt(e){var t=new Uint8Array(7);t[0]=e&127;var n=1;e:if(e>127){if(t[n-1]|=128,t[n]=e>>7&127,++n,e<=16383||(t[n-1]|=128,t[n]=e>>14&127,++n,e<=2097151)||(t[n-1]|=128,t[n]=e>>21&127,++n,e<=268435455)||(t[n-1]|=128,t[n]=e/256>>>21&127,++n,e<=34359738367)||(t[n-1]|=128,t[n]=e/65536>>>21&127,++n,e<=4398046511103))break e;t[n-1]|=128,t[n]=e/16777216>>>21&127,++n}return t.slice(0,n)}function gn(e){var t=0,n=e[t]&127;e:if(e[t++]>=128){if(n|=(e[t]&127)<<7,e[t++]<128||(n|=(e[t]&127)<<14,e[t++]<128)||(n|=(e[t]&127)<<21,e[t++]<128))break e;n|=(e[t]&127)<<28}return n}function Ft(e){for(var t=[],n=[0];n[0]<e.length;){var r=n[0],i=Sf(e,n),s=i&7;i=Math.floor(i/8);var a=0,o;if(i==0)break;switch(s){case 0:{for(var l=n[0];e[n[0]++]>=128;);o=e.slice(l,n[0])}break;case 5:a=4,o=e.slice(n[0],n[0]+a),n[0]+=a;break;case 1:a=8,o=e.slice(n[0],n[0]+a),n[0]+=a;break;case 2:a=Sf(e,n),o=e.slice(n[0],n[0]+a),n[0]+=a;break;case 3:case 4:default:throw new Error("PB Type ".concat(s," for Field ").concat(i," at offset ").concat(r))}var u={data:o,type:s};t[i]==null?t[i]=[u]:t[i].push(u)}return t}function Kn(e){var t=[];return e.forEach(function(n,r){n.forEach(function(i){i.data&&(t.push(Vt(r*8+i.type)),i.type==2&&t.push(Vt(i.data.length)),t.push(i.data))})}),Oa(t)}function ey(e,t){return(e==null?void 0:e.map(function(n){return t(n.data)}))||[]}function ai(e){for(var t,n=[],r=[0];r[0]<e.length;){var i=Sf(e,r),s=Ft(e.slice(r[0],r[0]+i));r[0]+=i;var a={id:gn(s[1][0].data),messages:[]};s[2].forEach(function(o){var l=Ft(o.data),u=gn(l[3][0].data);a.messages.push({meta:l,data:e.slice(r[0],r[0]+u)}),r[0]+=u}),(t=s[3])!=null&&t[0]&&(a.merge=gn(s[3][0].data)>>>0>0),n.push(a)}return n}function sl(e){var t=[];return e.forEach(function(n){var r=[];r[1]=[{data:Vt(n.id),type:0}],r[2]=[],n.merge!=null&&(r[3]=[{data:Vt(+!!n.merge),type:0}]);var i=[];n.messages.forEach(function(a){i.push(a.data),a.meta[3]=[{type:0,data:Vt(a.data.length)}],r[2].push({data:Kn(a.meta),type:2})});var s=Kn(r);t.push(Vt(s.length)),t.push(s),i.forEach(function(a){return t.push(a)})}),Oa(t)}function qK(e,t){if(e!=0)throw new Error("Unexpected Snappy chunk type ".concat(e));for(var n=[0],r=Sf(t,n),i=[];n[0]<t.length;){var s=t[n[0]]&3;if(s==0){var a=t[n[0]++]>>2;if(a<60)++a;else{var o=a-59;a=t[n[0]],o>1&&(a|=t[n[0]+1]<<8),o>2&&(a|=t[n[0]+2]<<16),o>3&&(a|=t[n[0]+3]<<24),a>>>=0,a++,n[0]+=o}i.push(t.slice(n[0],n[0]+a)),n[0]+=a;continue}else{var l=0,u=0;if(s==1?(u=(t[n[0]]>>2&7)+4,l=(t[n[0]++]&224)<<3,l|=t[n[0]++]):(u=(t[n[0]++]>>2)+1,s==2?(l=t[n[0]]|t[n[0]+1]<<8,n[0]+=2):(l=(t[n[0]]|t[n[0]+1]<<8|t[n[0]+2]<<16|t[n[0]+3]<<24)>>>0,n[0]+=4)),i=[Oa(i)],l==0)throw new Error("Invalid offset 0");if(l>i[0].length)throw new Error("Invalid offset beyond length");if(u>=l)for(i.push(i[0].slice(-l)),u-=l;u>=i[i.length-1].length;)i.push(i[i.length-1]),u-=i[i.length-1].length;i.push(i[0].slice(-l,-l+u))}}var c=Oa(i);if(c.length!=r)throw new Error("Unexpected length: ".concat(c.length," != ").concat(r));return c}function oi(e){for(var t=[],n=0;n<e.length;){var r=e[n++],i=e[n]|e[n+1]<<8|e[n+2]<<16;n+=3,t.push(qK(r,e.slice(n,n+i))),n+=i}if(n!==e.length)throw new Error("data is not a valid framed stream!");return Oa(t)}function al(e){for(var t=[],n=0;n<e.length;){var r=Math.min(e.length-n,268435455),i=new Uint8Array(4);t.push(i);var s=Vt(r),a=s.length;t.push(s),r<=60?(a++,t.push(new Uint8Array([r-1<<2]))):r<=256?(a+=2,t.push(new Uint8Array([240,r-1&255]))):r<=65536?(a+=3,t.push(new Uint8Array([244,r-1&255,r-1>>8&255]))):r<=16777216?(a+=4,t.push(new Uint8Array([248,r-1&255,r-1>>8&255,r-1>>16&255]))):r<=4294967296&&(a+=5,t.push(new Uint8Array([252,r-1&255,r-1>>8&255,r-1>>16&255,r-1>>>24&255]))),t.push(e.slice(n,n+r)),a+=r,i[0]=0,i[1]=a&255,i[2]=a>>8&255,i[3]=a>>16&255,n+=r}return Oa(t)}function KK(e,t,n,r){var i=Lo(e),s=i.getUint32(4,!0),a=(r>1?12:8)+UE(s&(r>1?3470:398))*4,o=-1,l=-1,u=NaN,c=new Date(2001,0,1);s&512&&(o=i.getUint32(a,!0),a+=4),a+=UE(s&(r>1?12288:4096))*4,s&16&&(l=i.getUint32(a,!0),a+=4),s&32&&(u=i.getFloat64(a,!0),a+=8),s&64&&(c.setTime(c.getTime()+i.getFloat64(a,!0)*1e3),a+=8);var h;switch(e[2]){case 0:break;case 2:h={t:"n",v:u};break;case 3:h={t:"s",v:t[l]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(o>-1)h={t:"s",v:n[o]};else if(l>-1)h={t:"s",v:t[l]};else if(!isNaN(u))h={t:"n",v:u};else throw new Error("Unsupported cell type ".concat(e.slice(0,4)));break;default:throw new Error("Unsupported cell type ".concat(e.slice(0,4)))}return h}function YK(e,t,n){var r=Lo(e),i=r.getUint32(8,!0),s=12,a=-1,o=-1,l=NaN,u=NaN,c=new Date(2001,0,1);i&1&&(l=WK(e,s),s+=16),i&2&&(u=r.getFloat64(s,!0),s+=8),i&4&&(c.setTime(c.getTime()+r.getFloat64(s,!0)*1e3),s+=8),i&8&&(o=r.getUint32(s,!0),s+=4),i&16&&(a=r.getUint32(s,!0),s+=4);var h;switch(e[1]){case 0:break;case 2:h={t:"n",v:l};break;case 3:h={t:"s",v:t[o]};break;case 5:h={t:"d",v:c};break;case 6:h={t:"b",v:u>0};break;case 7:h={t:"n",v:u/86400};break;case 8:h={t:"e",v:0};break;case 9:if(a>-1)h={t:"s",v:n[a]};else throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)));break;case 10:h={t:"n",v:l};break;default:throw new Error("Unsupported cell type ".concat(e[1]," : ").concat(i&31," : ").concat(e.slice(0,4)))}return h}function mm(e,t){var n=new Uint8Array(32),r=Lo(n),i=12,s=0;switch(n[0]=5,e.t){case"n":n[1]=2,GK(n,i,e.v),s|=1,i+=16;break;case"b":n[1]=6,r.setFloat64(i,e.v?1:0,!0),s|=2,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[1]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=8,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(8,s,!0),n.slice(0,i)}function gm(e,t){var n=new Uint8Array(32),r=Lo(n),i=12,s=0;switch(n[0]=3,e.t){case"n":n[2]=2,r.setFloat64(i,e.v,!0),s|=32,i+=8;break;case"b":n[2]=6,r.setFloat64(i,e.v?1:0,!0),s|=32,i+=8;break;case"s":if(t.indexOf(e.v)==-1)throw new Error("Value ".concat(e.v," missing from SST!"));n[2]=3,r.setUint32(i,t.indexOf(e.v),!0),s|=16,i+=4;break;default:throw"unsupported cell type "+e.t}return r.setUint32(4,s,!0),n.slice(0,i)}function XK(e,t,n){switch(e[0]){case 0:case 1:case 2:case 3:return KK(e,t,n,e[0]);case 5:return YK(e,t,n);default:throw new Error("Unsupported payload version ".concat(e[0]))}}function sr(e){var t=Ft(e);return Sf(t[1][0].data)}function VE(e,t){var n=Ft(t.data),r=gn(n[1][0].data),i=n[3],s=[];return(i||[]).forEach(function(a){var o=Ft(a.data),l=gn(o[1][0].data)>>>0;switch(r){case 1:s[l]=Xg(o[3][0].data);break;case 8:{var u=e[sr(o[9][0].data)][0],c=Ft(u.data),h=e[sr(c[1][0].data)][0],p=gn(h.meta[1][0].data);if(p!=2001)throw new Error("2000 unexpected reference to ".concat(p));var m=Ft(h.data);s[l]=m[3].map(function(v){return Xg(v.data)}).join("")}break}}),s}function JK(e,t){var n,r,i,s,a,o,l,u,c,h,p,m,v,g,w=Ft(e),x=gn(w[1][0].data)>>>0,T=gn(w[2][0].data)>>>0,y=((r=(n=w[8])==null?void 0:n[0])==null?void 0:r.data)&&gn(w[8][0].data)>0||!1,_,k;if((s=(i=w[7])==null?void 0:i[0])!=null&&s.data&&t!=0)_=(o=(a=w[7])==null?void 0:a[0])==null?void 0:o.data,k=(u=(l=w[6])==null?void 0:l[0])==null?void 0:u.data;else if((h=(c=w[4])==null?void 0:c[0])!=null&&h.data&&t!=1)_=(m=(p=w[4])==null?void 0:p[0])==null?void 0:m.data,k=(g=(v=w[3])==null?void 0:v[0])==null?void 0:g.data;else throw"NUMBERS Tile missing ".concat(t," cell storage");for(var S=y?4:1,C=Lo(_),M=[],F=0;F<_.length/2;++F){var b=C.getUint16(F*2,!0);b<65535&&M.push([F,b])}if(M.length!=T)throw"Expected ".concat(T," cells, found ").concat(M.length);var V=[];for(F=0;F<M.length-1;++F)V[M[F][0]]=k.subarray(M[F][1]*S,M[F+1][1]*S);return M.length>=1&&(V[M[M.length-1][0]]=k.subarray(M[M.length-1][1]*S)),{R:x,cells:V}}function QK(e,t){var n,r=Ft(t.data),i=(n=r==null?void 0:r[7])!=null&&n[0]?gn(r[7][0].data)>>>0>0?1:0:-1,s=ey(r[5],function(a){return JK(a,i)});return{nrows:gn(r[4][0].data)>>>0,data:s.reduce(function(a,o){return a[o.R]||(a[o.R]=[]),o.cells.forEach(function(l,u){if(a[o.R][u])throw new Error("Duplicate cell r=".concat(o.R," c=").concat(u));a[o.R][u]=l}),a},[])}}function jK(e,t,n){var r,i=Ft(t.data),s={s:{r:0,c:0},e:{r:0,c:0}};if(s.e.r=(gn(i[6][0].data)>>>0)-1,s.e.r<0)throw new Error("Invalid row varint ".concat(i[6][0].data));if(s.e.c=(gn(i[7][0].data)>>>0)-1,s.e.c<0)throw new Error("Invalid col varint ".concat(i[7][0].data));n["!ref"]=lt(s);var a=Ft(i[4][0].data),o=VE(e,e[sr(a[4][0].data)][0]),l=(r=a[17])!=null&&r[0]?VE(e,e[sr(a[17][0].data)][0]):[],u=Ft(a[3][0].data),c=0;u[1].forEach(function(h){var p=Ft(h.data),m=e[sr(p[2][0].data)][0],v=gn(m.meta[1][0].data);if(v!=6002)throw new Error("6001 unexpected reference to ".concat(v));var g=QK(e,m);g.data.forEach(function(w,x){w.forEach(function(T,y){var _=nt({r:c+x,c:y}),k=XK(T,o,l);k&&(n[_]=k)})}),c+=g.nrows})}function ZK(e,t){var n=Ft(t.data),r={"!ref":"A1"},i=e[sr(n[2][0].data)],s=gn(i[0].meta[1][0].data);if(s!=6001)throw new Error("6000 unexpected reference to ".concat(s));return jK(e,i[0],r),r}function eY(e,t){var n,r=Ft(t.data),i={name:(n=r[1])!=null&&n[0]?Xg(r[1][0].data):"",sheets:[]},s=ey(r[2],sr);return s.forEach(function(a){e[a].forEach(function(o){var l=gn(o.meta[1][0].data);l==6e3&&i.sheets.push(ZK(e,o))})}),i}function tY(e,t){var n=sy(),r=Ft(t.data),i=ey(r[1],sr);if(i.forEach(function(s){e[s].forEach(function(a){var o=gn(a.meta[1][0].data);if(o==2){var l=eY(e,a);l.sheets.forEach(function(u,c){ay(n,u,c==0?l.name:l.name+"_"+c,!0)})}})}),n.SheetNames.length==0)throw new Error("Empty NUMBERS file");return n}function vm(e){var t,n,r,i,s={},a=[];if(e.FullPaths.forEach(function(l){if(l.match(/\.iwpv2/))throw new Error("Unsupported password protection")}),e.FileIndex.forEach(function(l){if(l.name.match(/\.iwa$/)){var u;try{u=oi(l.content)}catch(h){return console.log("?? "+l.content.length+" "+(h.message||h))}var c;try{c=ai(u)}catch(h){return console.log("## "+(h.message||h))}c.forEach(function(h){s[h.id]=h.messages,a.push(h.id)})}}),!a.length)throw new Error("File has no messages");var o=((i=(r=(n=(t=s==null?void 0:s[1])==null?void 0:t[0])==null?void 0:n.meta)==null?void 0:r[1])==null?void 0:i[0].data)&&gn(s[1][0].meta[1][0].data)==1&&s[1][0];if(o||a.forEach(function(l){s[l].forEach(function(u){var c=gn(u.meta[1][0].data)>>>0;if(c==1)if(!o)o=u;else throw new Error("Document has multiple roots")})}),!o)throw new Error("Cannot find Document root");return tY(s,o)}function nY(e,t,n){var r,i,s,a;if(!((r=e[6])!=null&&r[0])||!((i=e[7])!=null&&i[0]))throw"Mutation only works on post-BNC storages!";var o=((a=(s=e[8])==null?void 0:s[0])==null?void 0:a.data)&&gn(e[8][0].data)>0||!1;if(o)throw"Math only works with normal offsets";for(var l=0,u=Lo(e[7][0].data),c=0,h=[],p=Lo(e[4][0].data),m=0,v=[],g=0;g<t.length;++g){if(t[g]==null){u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535);continue}u.setUint16(g*2,c,!0),p.setUint16(g*2,m,!0);var w,x;switch(typeof t[g]){case"string":w=mm({t:"s",v:t[g]},n),x=gm({t:"s",v:t[g]},n);break;case"number":w=mm({t:"n",v:t[g]},n),x=gm({t:"n",v:t[g]},n);break;case"boolean":w=mm({t:"b",v:t[g]},n),x=gm({t:"b",v:t[g]},n);break;default:throw new Error("Unsupported value "+t[g])}h.push(w),c+=w.length,v.push(x),m+=x.length,++l}for(e[2][0].data=Vt(l);g<e[7][0].data.length/2;++g)u.setUint16(g*2,65535,!0),p.setUint16(g*2,65535,!0);return e[6][0].data=Oa(h),e[3][0].data=Oa(v),l}function rY(e,t){if(!t||!t.numbers)throw new Error("Must pass a `numbers` option -- check the README");var n=e.Sheets[e.SheetNames[0]];e.SheetNames.length>1&&console.error("The Numbers writer currently writes only the first table");var r=Br(n["!ref"]);r.s.r=r.s.c=0;var i=!1;r.e.c>9&&(i=!0,r.e.c=9),r.e.r>49&&(i=!0,r.e.r=49),i&&console.error("The Numbers writer is currently limited to ".concat(lt(r)));var s=fh(n,{range:r,header:1}),a=["~Sh33tJ5~"];s.forEach(function(q){return q.forEach(function(W){typeof W=="string"&&a.push(W)})});var o={},l=[],u=Ke.read(t.numbers,{type:"base64"});u.FileIndex.map(function(q,W){return[q,u.FullPaths[W]]}).forEach(function(q){var W=q[0],G=q[1];if(W.type==2&&W.name.match(/\.iwa/)){var ee=W.content,Se=oi(ee),we=ai(Se);we.forEach(function(pe){l.push(pe.id),o[pe.id]={deps:[],location:G,type:gn(pe.messages[0].meta[1][0].data)}})}}),l.sort(function(q,W){return q-W});var c=l.filter(function(q){return q>1}).map(function(q){return[q,Vt(q)]});u.FileIndex.map(function(q,W){return[q,u.FullPaths[W]]}).forEach(function(q){var W=q[0];if(q[1],!!W.name.match(/\.iwa/)){var G=ai(oi(W.content));G.forEach(function(ee){ee.messages.forEach(function(Se){c.forEach(function(we){ee.messages.some(function(pe){return gn(pe.meta[1][0].data)!=11006&&zK(pe.data,we[1])})&&o[we[0]].deps.push(ee.id)})})})}});for(var h=Ke.find(u,o[1].location),p=ai(oi(h.content)),m,v=0;v<p.length;++v){var g=p[v];g.id==1&&(m=g)}var w=sr(Ft(m.messages[0].data)[1][0].data);for(h=Ke.find(u,o[w].location),p=ai(oi(h.content)),v=0;v<p.length;++v)g=p[v],g.id==w&&(m=g);for(w=sr(Ft(m.messages[0].data)[2][0].data),h=Ke.find(u,o[w].location),p=ai(oi(h.content)),v=0;v<p.length;++v)g=p[v],g.id==w&&(m=g);for(w=sr(Ft(m.messages[0].data)[2][0].data),h=Ke.find(u,o[w].location),p=ai(oi(h.content)),v=0;v<p.length;++v)g=p[v],g.id==w&&(m=g);var x=Ft(m.messages[0].data);{x[6][0].data=Vt(r.e.r+1),x[7][0].data=Vt(r.e.c+1);var T=sr(x[46][0].data),y=Ke.find(u,o[T].location),_=ai(oi(y.content));{for(var k=0;k<_.length&&_[k].id!=T;++k);if(_[k].id!=T)throw"Bad ColumnRowUIDMapArchive";var S=Ft(_[k].messages[0].data);S[1]=[],S[2]=[],S[3]=[];for(var C=0;C<=r.e.c;++C){var M=[];M[1]=M[2]=[{type:0,data:Vt(C+420690)}],S[1].push({type:2,data:Kn(M)}),S[2].push({type:0,data:Vt(C)}),S[3].push({type:0,data:Vt(C)})}S[4]=[],S[5]=[],S[6]=[];for(var F=0;F<=r.e.r;++F)M=[],M[1]=M[2]=[{type:0,data:Vt(F+726270)}],S[4].push({type:2,data:Kn(M)}),S[5].push({type:0,data:Vt(F)}),S[6].push({type:0,data:Vt(F)});_[k].messages[0].data=Kn(S)}y.content=al(sl(_)),y.size=y.content.length,delete x[46];var b=Ft(x[4][0].data);{b[7][0].data=Vt(r.e.r+1);var V=Ft(b[1][0].data),z=sr(V[2][0].data);y=Ke.find(u,o[z].location),_=ai(oi(y.content));{if(_[0].id!=z)throw"Bad HeaderStorageBucket";var ie=Ft(_[0].messages[0].data);for(F=0;F<s.length;++F){var Q=Ft(ie[2][0].data);Q[1][0].data=Vt(F),Q[4][0].data=Vt(s[F].length),ie[2][F]={type:ie[2][0].type,data:Kn(Q)}}_[0].messages[0].data=Kn(ie)}y.content=al(sl(_)),y.size=y.content.length;var se=sr(b[2][0].data);y=Ke.find(u,o[se].location),_=ai(oi(y.content));{if(_[0].id!=se)throw"Bad HeaderStorageBucket";for(ie=Ft(_[0].messages[0].data),C=0;C<=r.e.c;++C)Q=Ft(ie[2][0].data),Q[1][0].data=Vt(C),Q[4][0].data=Vt(r.e.r+1),ie[2][C]={type:ie[2][0].type,data:Kn(Q)};_[0].messages[0].data=Kn(ie)}y.content=al(sl(_)),y.size=y.content.length;var de=sr(b[4][0].data);(function(){for(var q=Ke.find(u,o[de].location),W=ai(oi(q.content)),G,ee=0;ee<W.length;++ee){var Se=W[ee];Se.id==de&&(G=Se)}var we=Ft(G.messages[0].data);{we[3]=[];var pe=[];a.forEach(function(B,st){pe[1]=[{type:0,data:Vt(st)}],pe[2]=[{type:0,data:Vt(1)}],pe[3]=[{type:2,data:$K(B)}],we[3].push({type:2,data:Kn(pe)})})}G.messages[0].data=Kn(we);var oe=sl(W),Le=al(oe);q.content=Le,q.size=q.content.length})();var ae=Ft(b[3][0].data);{var ne=ae[1][0];delete ae[2];var H=Ft(ne.data);{var fe=sr(H[2][0].data);(function(){for(var q=Ke.find(u,o[fe].location),W=ai(oi(q.content)),G,ee=0;ee<W.length;++ee){var Se=W[ee];Se.id==fe&&(G=Se)}var we=Ft(G.messages[0].data);{delete we[6],delete ae[7];var pe=new Uint8Array(we[5][0].data);we[5]=[];for(var oe=0,Le=0;Le<=r.e.r;++Le){var B=Ft(pe);oe+=nY(B,s[Le],a),B[1][0].data=Vt(Le),we[5].push({data:Kn(B),type:2})}we[1]=[{type:0,data:Vt(r.e.c+1)}],we[2]=[{type:0,data:Vt(r.e.r+1)}],we[3]=[{type:0,data:Vt(oe)}],we[4]=[{type:0,data:Vt(r.e.r+1)}]}G.messages[0].data=Kn(we);var st=sl(W),Ue=al(st);q.content=Ue,q.size=q.content.length})()}ne.data=Kn(H)}b[3][0].data=Kn(ae)}x[4][0].data=Kn(b)}m.messages[0].data=Kn(x);var xe=sl(p),L=al(xe);return h.content=L,h.size=h.content.length,u}function $D(e){return function(n){for(var r=0;r!=e.length;++r){var i=e[r];n[i[0]]===void 0&&(n[i[0]]=i[1]),i[2]==="n"&&(n[i[0]]=Number(n[i[0]]))}}}function ty(e){$D([["cellNF",!1],["cellHTML",!0],["cellFormula",!0],["cellStyles",!1],["cellText",!0],["cellDates",!1],["sheetStubs",!1],["sheetRows",0,"n"],["bookDeps",!1],["bookSheets",!1],["bookProps",!1],["bookFiles",!1],["bookVBA",!1],["password",""],["WTF",!1]])(e)}function ny(e){$D([["cellDates",!1],["bookSST",!1],["bookType","xlsx"],["compression",!1],["WTF",!1]])(e)}function iY(e){return pt.WS.indexOf(e)>-1?"sheet":e==pt.CS?"chart":e==pt.DS?"dialog":e==pt.MS?"macro":e&&e.length?e:"sheet"}function sY(e,t){if(!e)return 0;try{e=t.map(function(r){return r.id||(r.id=r.strRelID),[r.name,e["!id"][r.id].Target,iY(e["!id"][r.id].Type)]})}catch{return null}return!e||e.length===0?null:e}function aY(e,t,n,r,i,s,a,o,l,u,c,h){try{s[r]=Mc(qr(e,n,!0),t);var p=Cn(e,t),m;switch(o){case"sheet":m=Rq(p,t,i,l,s[r],u,c,h);break;case"chart":if(m=Mq(p,t,i,l,s[r],u,c,h),!m||!m["!drawel"])break;var v=fc(m["!drawel"].Target,t),g=gf(v),w=m$(qr(e,v,!0),Mc(qr(e,g,!0),v)),x=fc(w,v),T=gf(x);m=nq(qr(e,x,!0),x,l,Mc(qr(e,T,!0),x),u,m);break;case"macro":m=Fq(p,t,i,l,s[r],u,c,h);break;case"dialog":m=Dq(p,t,i,l,s[r],u,c,h);break;default:throw new Error("Unrecognized sheet type "+o)}a[r]=m;var y=[];s&&s[r]&&vn(s[r]).forEach(function(_){var k="";if(s[r][_].Type==pt.CMNT){k=fc(s[r][_].Target,t);var S=bq(Cn(e,k,!0),k,l);if(!S||!S.length)return;CE(m,S,!1)}s[r][_].Type==pt.TCMNT&&(k=fc(s[r][_].Target,t),y=y.concat(v$(Cn(e,k,!0),l)))}),y&&y.length&&CE(m,y,!0,l.people||[])}catch(_){if(l.WTF)throw _}}function ri(e){return e.charAt(0)=="/"?e.slice(1):e}function oY(e,t){if(Au(),t=t||{},ty(t),ui(e,"META-INF/manifest.xml")||ui(e,"objectdata.xml"))return LE(e,t);if(ui(e,"Index/Document.iwa")){if(typeof Uint8Array>"u")throw new Error("NUMBERS file parsing requires Uint8Array support");if(typeof vm<"u"){if(e.FileIndex)return vm(e);var n=Ke.utils.cfb_new();return qS(e).forEach(function(Q){ut(n,Q,xU(e,Q))}),vm(n)}throw new Error("Unsupported NUMBERS file")}if(!ui(e,"[Content_Types].xml"))throw ui(e,"index.xml.gz")?new Error("Unsupported NUMBERS 08 file"):ui(e,"index.xml")?new Error("Unsupported NUMBERS 09 file"):new Error("Unsupported ZIP file");var r=qS(e),i=fV(qr(e,"[Content_Types].xml")),s=!1,a,o;if(i.workbooks.length===0&&(o="xl/workbook.xml",Cn(e,o,!0)&&i.workbooks.push(o)),i.workbooks.length===0){if(o="xl/workbook.bin",!Cn(e,o,!0))throw new Error("Could not find workbook");i.workbooks.push(o),s=!0}i.workbooks[0].slice(-3)=="bin"&&(s=!0);var l={},u={};if(!t.bookSheets&&!t.bookProps){if(Fc=[],i.sst)try{Fc=Nq(Cn(e,ri(i.sst)),i.sst,t)}catch(Q){if(t.WTF)throw Q}t.cellStyles&&i.themes.length&&(l=Iq(qr(e,i.themes[0].replace(/^\//,""),!0)||"",i.themes[0],t)),i.style&&(u=Pq(Cn(e,ri(i.style)),i.style,l,t))}i.links.map(function(Q){try{var se=Mc(qr(e,gf(ri(Q))),Q);return Oq(Cn(e,ri(Q)),se,Q,t)}catch{}});var c=Aq(Cn(e,ri(i.workbooks[0])),i.workbooks[0],t),h={},p="";i.coreprops.length&&(p=Cn(e,ri(i.coreprops[0]),!0),p&&(h=FF(p)),i.extprops.length!==0&&(p=Cn(e,ri(i.extprops[0]),!0),p&&xV(p,h,t)));var m={};(!t.bookSheets||t.bookProps)&&i.custprops.length!==0&&(p=qr(e,ri(i.custprops[0]),!0),p&&(m=wV(p,t)));var v={};if((t.bookSheets||t.bookProps)&&(c.Sheets?a=c.Sheets.map(function(se){return se.name}):h.Worksheets&&h.SheetNames.length>0&&(a=h.SheetNames),t.bookProps&&(v.Props=h,v.Custprops=m),t.bookSheets&&typeof a<"u"&&(v.SheetNames=a),t.bookSheets?v.SheetNames:t.bookProps))return v;a={};var g={};t.bookDeps&&i.calcchain&&(g=Lq(Cn(e,ri(i.calcchain)),i.calcchain));var w=0,x={},T,y;{var _=c.Sheets;h.Worksheets=_.length,h.SheetNames=[];for(var k=0;k!=_.length;++k)h.SheetNames[k]=_[k].name}var S=s?"bin":"xml",C=i.workbooks[0].lastIndexOf("/"),M=(i.workbooks[0].slice(0,C+1)+"_rels/"+i.workbooks[0].slice(C+1)+".rels").replace(/^\//,"");ui(e,M)||(M="xl/_rels/workbook."+S+".rels");var F=Mc(qr(e,M,!0),M.replace(/_rels.*/,"s5s"));(i.metadata||[]).length>=1&&(t.xlmeta=Bq(Cn(e,ri(i.metadata[0])),i.metadata[0],t)),(i.people||[]).length>=1&&(t.people=y$(Cn(e,ri(i.people[0])),t)),F&&(F=sY(F,c.Sheets));var b=Cn(e,"xl/worksheets/sheet.xml",!0)?1:0;e:for(w=0;w!=h.Worksheets;++w){var V="sheet";if(F&&F[w]?(T="xl/"+F[w][1].replace(/[\/]?xl\//,""),ui(e,T)||(T=F[w][1]),ui(e,T)||(T=M.replace(/_rels\/.*$/,"")+F[w][1]),V=F[w][2]):(T="xl/worksheets/sheet"+(w+1-b)+"."+S,T=T.replace(/sheet0\./,"sheet.")),y=T.replace(/^(.*)(\/)([^\/]*)$/,"$1/_rels/$3.rels"),t&&t.sheets!=null)switch(typeof t.sheets){case"number":if(w!=t.sheets)continue e;break;case"string":if(h.SheetNames[w].toLowerCase()!=t.sheets.toLowerCase())continue e;break;default:if(Array.isArray&&Array.isArray(t.sheets)){for(var z=!1,ie=0;ie!=t.sheets.length;++ie)typeof t.sheets[ie]=="number"&&t.sheets[ie]==w&&(z=1),typeof t.sheets[ie]=="string"&&t.sheets[ie].toLowerCase()==h.SheetNames[w].toLowerCase()&&(z=1);if(!z)continue e}}aY(e,T,y,h.SheetNames[w],w,x,a,V,t,c,l,u)}return v={Directory:i,Workbook:c,Props:h,Custprops:m,Deps:g,Sheets:a,SheetNames:h.SheetNames,Strings:Fc,Styles:u,Themes:l,SSF:nn(et)},t&&t.bookFiles&&(e.files?(v.keys=r,v.files=e.files):(v.keys=[],v.files={},e.FullPaths.forEach(function(Q,se){Q=Q.replace(/^Root Entry[\/]/,""),v.keys.push(Q),v.files[Q]=e.FileIndex[se]}))),t&&t.bookVBA&&(i.vba.length>0?v.vbaraw=Cn(e,ri(i.vba[0]),!0):i.defaults&&i.defaults.bin===A$&&(v.vbaraw=Cn(e,"xl/vbaProject.bin",!0))),v}function lY(e,t){var n=t||{},r="Workbook",i=Ke.find(e,r);try{if(r="/!DataSpaces/Version",i=Ke.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(B7(i.content),r="/!DataSpaces/DataSpaceMap",i=Ke.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var s=V7(i.content);if(s.length!==1||s[0].comps.length!==1||s[0].comps[0].t!==0||s[0].name!=="StrongEncryptionDataSpace"||s[0].comps[0].v!=="EncryptedPackage")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/DataSpaceInfo/StrongEncryptionDataSpace",i=Ke.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var a=H7(i.content);if(a.length!=1||a[0]!="StrongEncryptionTransform")throw new Error("ECMA-376 Encrypted file bad "+r);if(r="/!DataSpaces/TransformInfo/StrongEncryptionTransform/!Primary",i=Ke.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);z7(i.content)}catch{}if(r="/EncryptionInfo",i=Ke.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);var o=W7(i.content);if(r="/EncryptedPackage",i=Ke.find(e,r),!i||!i.content)throw new Error("ECMA-376 Encrypted file missing "+r);if(o[0]==4&&typeof decrypt_agile<"u")return decrypt_agile(o[1],i.content,n.password||"",n);if(o[0]==2&&typeof decrypt_std76<"u")return decrypt_std76(o[1],i.content,n.password||"",n);throw new Error("File is password-protected")}function uY(e,t){return t.bookType=="ods"?HD(e,t):t.bookType=="numbers"?rY(e,t):t.bookType=="xlsb"?cY(e,t):fY(e,t)}function cY(e,t){Ml=1024,e&&!e.SSF&&(e.SSF=nn(et)),e&&e.SSF&&(Au(),Qh(e.SSF),t.revssf=Zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Dc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n=t.bookType=="xlsb"?"bin":"xml",r=mD.indexOf(t.bookType)>-1,i=H1();ny(t=t||{});var s=A1(),a="",o=0;if(t.cellXfs=[],qa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",ut(s,a,DF(e.Props,t)),i.coreprops.push(a),Ht(t.rels,2,a,pt.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}for(e.Props.Worksheets=e.Props.SheetNames.length,ut(s,a,NF(e.Props)),i.extprops.push(a),Ht(t.rels,3,a,pt.EXT_PROPS),e.Custprops!==e.Props&&vn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",ut(s,a,bF(e.Custprops)),i.custprops.push(a),Ht(t.rels,4,a,pt.CUST_PROPS)),o=1;o<=e.SheetNames.length;++o){var c={"!id":{}},h=e.Sheets[e.SheetNames[o-1]],p=(h||{})["!type"]||"sheet";switch(p){case"chart":default:a="xl/worksheets/sheet"+o+"."+n,ut(s,a,Vq(o-1,a,t,e,c)),i.sheets.push(a),Ht(t.wbrels,-1,"worksheets/sheet"+o+"."+n,pt.WS[0])}if(h){var m=h["!comments"],v=!1,g="";m&&m.length>0&&(g="xl/comments"+o+"."+n,ut(s,g,zq(m,g)),i.comments.push(g),Ht(c,-1,"../comments"+o+"."+n,pt.CMNT),v=!0),h["!legacy"]&&v&&ut(s,"xl/drawings/vmlDrawing"+o+".vml",hD(o,h["!comments"])),delete h["!comments"],delete h["!legacy"]}c["!id"].rId1&&ut(s,gf(a),Ul(c))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+n,ut(s,a,$q(t.Strings,a,t)),i.strs.push(a),Ht(t.wbrels,-1,"sharedStrings."+n,pt.SST)),a="xl/workbook."+n,ut(s,a,Uq(e,a)),i.workbooks.push(a),Ht(t.rels,1,a,pt.WB),a="xl/theme/theme1.xml",ut(s,a,K1(e.Themes,t)),i.themes.push(a),Ht(t.wbrels,-1,"theme/theme1.xml",pt.THEME),a="xl/styles."+n,ut(s,a,Hq(e,a,t)),i.styles.push(a),Ht(t.wbrels,-1,"styles."+n,pt.STY),e.vbaraw&&r&&(a="xl/vbaProject.bin",ut(s,a,e.vbaraw),i.vba.push(a),Ht(t.wbrels,-1,"vbaProject.bin",pt.VBA)),a="xl/metadata."+n,ut(s,a,Wq(a)),i.metadata.push(a),Ht(t.wbrels,-1,"metadata."+n,pt.XLMETA),ut(s,"[Content_Types].xml",RF(i,t)),ut(s,"_rels/.rels",Ul(t.rels)),ut(s,"xl/_rels/workbook."+n+".rels",Ul(t.wbrels)),delete t.revssf,delete t.ssf,s}function fY(e,t){Ml=1024,e&&!e.SSF&&(e.SSF=nn(et)),e&&e.SSF&&(Au(),Qh(e.SSF),t.revssf=Zh(e.SSF),t.revssf[e.SSF[65535]]=0,t.ssf=e.SSF),t.rels={},t.wbrels={},t.Strings=[],t.Strings.Count=0,t.Strings.Unique=0,Dc?t.revStrings=new Map:(t.revStrings={},t.revStrings.foo=[],delete t.revStrings.foo);var n="xml",r=mD.indexOf(t.bookType)>-1,i=H1();ny(t=t||{});var s=A1(),a="",o=0;if(t.cellXfs=[],qa(t.cellXfs,{},{revssf:{General:0}}),e.Props||(e.Props={}),a="docProps/core.xml",ut(s,a,DF(e.Props,t)),i.coreprops.push(a),Ht(t.rels,2,a,pt.CORE_PROPS),a="docProps/app.xml",!(e.Props&&e.Props.SheetNames))if(!e.Workbook||!e.Workbook.Sheets)e.Props.SheetNames=e.SheetNames;else{for(var l=[],u=0;u<e.SheetNames.length;++u)(e.Workbook.Sheets[u]||{}).Hidden!=2&&l.push(e.SheetNames[u]);e.Props.SheetNames=l}e.Props.Worksheets=e.Props.SheetNames.length,ut(s,a,NF(e.Props)),i.extprops.push(a),Ht(t.rels,3,a,pt.EXT_PROPS),e.Custprops!==e.Props&&vn(e.Custprops||{}).length>0&&(a="docProps/custom.xml",ut(s,a,bF(e.Custprops)),i.custprops.push(a),Ht(t.rels,4,a,pt.CUST_PROPS));var c=["SheetJ5"];for(t.tcid=0,o=1;o<=e.SheetNames.length;++o){var h={"!id":{}},p=e.Sheets[e.SheetNames[o-1]],m=(p||{})["!type"]||"sheet";switch(m){case"chart":default:a="xl/worksheets/sheet"+o+"."+n,ut(s,a,kD(o-1,t,e,h)),i.sheets.push(a),Ht(t.wbrels,-1,"worksheets/sheet"+o+"."+n,pt.WS[0])}if(p){var v=p["!comments"],g=!1,w="";if(v&&v.length>0){var x=!1;v.forEach(function(T){T[1].forEach(function(y){y.T==!0&&(x=!0)})}),x&&(w="xl/threadedComments/threadedComment"+o+"."+n,ut(s,w,x$(v,c,t)),i.threadedcomments.push(w),Ht(h,-1,"../threadedComments/threadedComment"+o+"."+n,pt.TCMNT)),w="xl/comments"+o+"."+n,ut(s,w,pD(v)),i.comments.push(w),Ht(h,-1,"../comments"+o+"."+n,pt.CMNT),g=!0}p["!legacy"]&&g&&ut(s,"xl/drawings/vmlDrawing"+o+".vml",hD(o,p["!comments"])),delete p["!comments"],delete p["!legacy"]}h["!id"].rId1&&ut(s,gf(a),Ul(h))}return t.Strings!=null&&t.Strings.length>0&&(a="xl/sharedStrings."+n,ut(s,a,tD(t.Strings,t)),i.strs.push(a),Ht(t.wbrels,-1,"sharedStrings."+n,pt.SST)),a="xl/workbook."+n,ut(s,a,DD(e)),i.workbooks.push(a),Ht(t.rels,1,a,pt.WB),a="xl/theme/theme1.xml",ut(s,a,K1(e.Themes,t)),i.themes.push(a),Ht(t.wbrels,-1,"theme/theme1.xml",pt.THEME),a="xl/styles."+n,ut(s,a,uD(e,t)),i.styles.push(a),Ht(t.wbrels,-1,"styles."+n,pt.STY),e.vbaraw&&r&&(a="xl/vbaProject.bin",ut(s,a,e.vbaraw),i.vba.push(a),Ht(t.wbrels,-1,"vbaProject.bin",pt.VBA)),a="xl/metadata."+n,ut(s,a,dD()),i.metadata.push(a),Ht(t.wbrels,-1,"metadata."+n,pt.XLMETA),c.length>1&&(a="xl/persons/person.xml",ut(s,a,w$(c)),i.people.push(a),Ht(t.wbrels,-1,"persons/person.xml",pt.PEOPLE)),ut(s,"[Content_Types].xml",RF(i,t)),ut(s,"_rels/.rels",Ul(t.rels)),ut(s,"xl/_rels/workbook."+n+".rels",Ul(t.wbrels)),delete t.revssf,delete t.ssf,s}function ry(e,t){var n="";switch((t||{}).type||"base64"){case"buffer":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];case"base64":n=Zr(e.slice(0,12));break;case"binary":n=e;break;case"array":return[e[0],e[1],e[2],e[3],e[4],e[5],e[6],e[7]];default:throw new Error("Unrecognized type "+(t&&t.type||"undefined"))}return[n.charCodeAt(0),n.charCodeAt(1),n.charCodeAt(2),n.charCodeAt(3),n.charCodeAt(4),n.charCodeAt(5),n.charCodeAt(6),n.charCodeAt(7)]}function dY(e,t){return Ke.find(e,"EncryptedPackage")?lY(e,t):bD(e,t)}function hY(e,t){var n,r=e,i=t||{};return i.type||(i.type=dt&&Buffer.isBuffer(e)?"buffer":"base64"),n=rF(r,i),oY(n,i)}function zD(e,t){var n=0;e:for(;n<e.length;)switch(e.charCodeAt(n)){case 10:case 13:case 32:++n;break;case 60:return Kg(e.slice(n),t);default:break e}return vu.to_workbook(e,t)}function pY(e,t){var n="",r=ry(e,t);switch(t.type){case"base64":n=Zr(e);break;case"binary":n=e;break;case"buffer":n=e.toString("binary");break;case"array":n=Po(e);break;default:throw new Error("Unrecognized type "+t.type)}return r[0]==239&&r[1]==187&&r[2]==191&&(n=qt(n)),t.type="binary",zD(n,t)}function mY(e,t){var n=e;return t.type=="base64"&&(n=Zr(n)),n=cf.utils.decode(1200,n.slice(2),"str"),t.type="binary",zD(n,t)}function gY(e){return e.match(/[^\x00-\x7F]/)?ns(e):e}function xm(e,t,n,r){return r?(n.type="string",vu.to_workbook(e,n)):vu.to_workbook(t,n)}function Jg(e,t){S1();var n=t||{};if(typeof ArrayBuffer<"u"&&e instanceof ArrayBuffer)return Jg(new Uint8Array(e),(n=nn(n),n.type="array",n));typeof Uint8Array<"u"&&e instanceof Uint8Array&&!n.type&&(n.type=typeof Deno<"u"?"buffer":"array");var r=e,i=[0,0,0,0],s=!1;if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),Hl={},n.dateNF&&(Hl.dateNF=n.dateNF),n.type||(n.type=dt&&Buffer.isBuffer(e)?"buffer":"base64"),n.type=="file"&&(n.type=dt?"buffer":"binary",r=cU(e),typeof Uint8Array<"u"&&!dt&&(n.type="array")),n.type=="string"&&(s=!0,n.type="binary",n.codepage=65001,r=gY(e)),n.type=="array"&&typeof Uint8Array<"u"&&e instanceof Uint8Array&&typeof ArrayBuffer<"u"){var a=new ArrayBuffer(3),o=new Uint8Array(a);if(o.foo="bar",!o.foo)return n=nn(n),n.type="array",Jg(E1(r),n)}switch((i=ry(r,n))[0]){case 208:if(i[1]===207&&i[2]===17&&i[3]===224&&i[4]===161&&i[5]===177&&i[6]===26&&i[7]===225)return dY(Ke.read(r,n),n);break;case 9:if(i[1]<=8)return bD(r,n);break;case 60:return Kg(r,n);case 73:if(i[1]===73&&i[2]===42&&i[3]===0)throw new Error("TIFF Image File is not a spreadsheet");if(i[1]===68)return T7(r,n);break;case 84:if(i[1]===65&&i[2]===66&&i[3]===76)return ZF.to_workbook(r,n);break;case 80:return i[1]===75&&i[2]<9&&i[3]<9?hY(r,n):xm(e,r,n,s);case 239:return i[3]===60?Kg(r,n):xm(e,r,n,s);case 255:if(i[1]===254)return mY(r,n);if(i[1]===0&&i[2]===2&&i[3]===0)return So.to_workbook(r,n);break;case 0:if(i[1]===0&&(i[2]>=2&&i[3]===0||i[2]===0&&(i[3]===8||i[3]===9)))return So.to_workbook(r,n);break;case 3:case 131:case 139:case 140:return qg.to_workbook(r,n);case 123:if(i[1]===92&&i[2]===114&&i[3]===116)return aD.to_workbook(r,n);break;case 10:case 13:case 32:return pY(r,n);case 137:if(i[1]===80&&i[2]===78&&i[3]===71)throw new Error("PNG Image File is not a spreadsheet");break}return w7.indexOf(i[0])>-1&&i[2]<=12&&i[3]<=31?qg.to_workbook(r,n):xm(e,r,n,s)}function WD(e,t){switch(t.type){case"base64":case"binary":break;case"buffer":case"array":t.type="";break;case"file":return Gf(t.file,Ke.write(e,{type:dt?"buffer":""}));case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");default:throw new Error("Unrecognized type "+t.type)}return Ke.write(e,t)}function vY(e,t){var n=nn(t||{}),r=uY(e,n);return xY(r,n)}function xY(e,t){var n={},r=dt?"nodebuffer":typeof Uint8Array<"u"?"array":"string";if(t.compression&&(n.compression="DEFLATE"),t.password)n.type=r;else switch(t.type){case"base64":n.type="base64";break;case"binary":n.type="string";break;case"string":throw new Error("'string' output type invalid for '"+t.bookType+"' files");case"buffer":case"file":n.type=r;break;default:throw new Error("Unrecognized type "+t.type)}var i=e.FullPaths?Ke.write(e,{fileType:"zip",type:{nodebuffer:"buffer",string:"binary"}[n.type]||n.type,compression:!!t.compression}):e.generate(n);if(typeof Deno<"u"&&typeof i=="string"){if(t.type=="binary"||t.type=="base64")return i;i=new Uint8Array(Jh(i))}return t.password&&typeof encrypt_agile<"u"?WD(encrypt_agile(i,t.password),t):t.type==="file"?Gf(t.file,i):t.type=="string"?qt(i):i}function yY(e,t){var n=t||{},r=gK(e,n);return WD(r,n)}function Ji(e,t,n){n||(n="");var r=n+e;switch(t.type){case"base64":return ff(ns(r));case"binary":return ns(r);case"string":return e;case"file":return Gf(t.file,r,"utf8");case"buffer":return dt?$s(r,"utf8"):typeof TextEncoder<"u"?new TextEncoder().encode(r):Ji(r,{type:"binary"}).split("").map(function(i){return i.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function wY(e,t){switch(t.type){case"base64":return ff(e);case"binary":return e;case"string":return e;case"file":return Gf(t.file,e,"binary");case"buffer":return dt?$s(e,"binary"):e.split("").map(function(n){return n.charCodeAt(0)})}throw new Error("Unrecognized type "+t.type)}function $d(e,t){switch(t.type){case"string":case"base64":case"binary":for(var n="",r=0;r<e.length;++r)n+=String.fromCharCode(e[r]);return t.type=="base64"?ff(n):t.type=="string"?qt(n):n;case"file":return Gf(t.file,e);case"buffer":return e;default:throw new Error("Unrecognized type "+t.type)}}function GD(e,t){S1(),dq(e);var n=nn(t||{});if(n.cellStyles&&(n.cellNF=!0,n.sheetStubs=!0),n.type=="array"){n.type="binary";var r=GD(e,n);return n.type="array",Jh(r)}var i=0;if(n.sheet&&(typeof n.sheet=="number"?i=n.sheet:i=e.SheetNames.indexOf(n.sheet),!e.SheetNames[i]))throw new Error("Sheet not found: "+n.sheet+" : "+typeof n.sheet);switch(n.bookType||"xlsb"){case"xml":case"xlml":return Ji(uK(e,n),n);case"slk":case"sylk":return Ji(jF.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"htm":case"html":return Ji(OD(e.Sheets[e.SheetNames[i]],n),n);case"txt":return wY(qD(e.Sheets[e.SheetNames[i]],n),n);case"csv":return Ji(iy(e.Sheets[e.SheetNames[i]],n),n,"\uFEFF");case"dif":return Ji(ZF.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"dbf":return $d(qg.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"prn":return Ji(vu.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"rtf":return Ji(aD.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"eth":return Ji(eD.from_sheet(e.Sheets[e.SheetNames[i]],n),n);case"fods":return Ji(HD(e,n),n);case"wk1":return $d(So.sheet_to_wk1(e.Sheets[e.SheetNames[i]],n),n);case"wk3":return $d(So.book_to_wk3(e,n),n);case"biff2":n.biff||(n.biff=2);case"biff3":n.biff||(n.biff=3);case"biff4":return n.biff||(n.biff=4),$d(LD(e,n),n);case"biff5":n.biff||(n.biff=5);case"biff8":case"xla":case"xls":return n.biff||(n.biff=8),yY(e,n);case"xlsx":case"xlsm":case"xlam":case"xlsb":case"numbers":case"ods":return vY(e,n);default:throw new Error("Unrecognized bookType |"+n.bookType+"|")}}function TY(e){if(!e.bookType){var t={xls:"biff8",htm:"html",slk:"sylk",socialcalc:"eth",Sh33tJS:"WTF"},n=e.file.slice(e.file.lastIndexOf(".")).toLowerCase();n.match(/^\.[a-z]+$/)&&(e.bookType=n.slice(1)),e.bookType=t[e.bookType]||e.bookType}}function SY(e,t,n){var r={};return r.type="file",r.file=t,TY(r),GD(e,r)}function EY(e,t,n,r,i,s,a,o){var l=Sn(n),u=o.defval,c=o.raw||!Object.prototype.hasOwnProperty.call(o,"raw"),h=!0,p=i===1?[]:{};if(i!==1)if(Object.defineProperty)try{Object.defineProperty(p,"__rowNum__",{value:n,enumerable:!1})}catch{p.__rowNum__=n}else p.__rowNum__=n;if(!a||e[n])for(var m=t.s.c;m<=t.e.c;++m){var v=a?e[n][m]:e[r[m]+l];if(v===void 0||v.t===void 0){if(u===void 0)continue;s[m]!=null&&(p[s[m]]=u);continue}var g=v.v;switch(v.t){case"z":if(g==null)break;continue;case"e":g=g==0?null:void 0;break;case"s":case"d":case"b":case"n":break;default:throw new Error("unrecognized type "+v.t)}if(s[m]!=null){if(g==null)if(v.t=="e"&&g===null)p[s[m]]=null;else if(u!==void 0)p[s[m]]=u;else if(c&&g===null)p[s[m]]=null;else continue;else p[s[m]]=c&&(v.t!=="n"||v.t==="n"&&o.rawNumbers!==!1)?g:Us(v,g,o);g!=null&&(h=!1)}}return{row:p,isempty:h}}function fh(e,t){if(e==null||e["!ref"]==null)return[];var n={t:"n",v:0},r=0,i=1,s=[],a=0,o="",l={s:{r:0,c:0},e:{r:0,c:0}},u=t||{},c=u.range!=null?u.range:e["!ref"];switch(u.header===1?r=1:u.header==="A"?r=2:Array.isArray(u.header)?r=3:u.header==null&&(r=0),typeof c){case"string":l=At(c);break;case"number":l=At(e["!ref"]),l.s.r=c;break;default:l=c}r>0&&(i=0);var h=Sn(l.s.r),p=[],m=[],v=0,g=0,w=Array.isArray(e),x=l.s.r,T=0,y={};w&&!e[x]&&(e[x]=[]);var _=u.skipHidden&&e["!cols"]||[],k=u.skipHidden&&e["!rows"]||[];for(T=l.s.c;T<=l.e.c;++T)if(!(_[T]||{}).hidden)switch(p[T]=on(T),n=w?e[x][T]:e[p[T]+h],r){case 1:s[T]=T-l.s.c;break;case 2:s[T]=p[T];break;case 3:s[T]=u.header[T-l.s.c];break;default:if(n==null&&(n={w:"__EMPTY",t:"s"}),o=a=Us(n,null,u),g=y[a]||0,!g)y[a]=1;else{do o=a+"_"+g++;while(y[o]);y[a]=g,y[o]=1}s[T]=o}for(x=l.s.r+i;x<=l.e.r;++x)if(!(k[x]||{}).hidden){var S=EY(e,l,x,p,r,s,w,u);(S.isempty===!1||(r===1?u.blankrows!==!1:u.blankrows))&&(m[v++]=S.row)}return m.length=v,m}var HE=/"/g;function _Y(e,t,n,r,i,s,a,o){for(var l=!0,u=[],c="",h=Sn(n),p=t.s.c;p<=t.e.c;++p)if(r[p]){var m=o.dense?(e[n]||[])[p]:e[r[p]+h];if(m==null)c="";else if(m.v!=null){l=!1,c=""+(o.rawNumbers&&m.t=="n"?m.v:Us(m,null,o));for(var v=0,g=0;v!==c.length;++v)if((g=c.charCodeAt(v))===i||g===s||g===34||o.forceQuotes){c='"'+c.replace(HE,'""')+'"';break}c=="ID"&&(c='"ID"')}else m.f!=null&&!m.F?(l=!1,c="="+m.f,c.indexOf(",")>=0&&(c='"'+c.replace(HE,'""')+'"')):c="";u.push(c)}return o.blankrows===!1&&l?null:u.join(a)}function iy(e,t){var n=[],r=t??{};if(e==null||e["!ref"]==null)return"";var i=At(e["!ref"]),s=r.FS!==void 0?r.FS:",",a=s.charCodeAt(0),o=r.RS!==void 0?r.RS:`
`,l=o.charCodeAt(0),u=new RegExp((s=="|"?"\\|":s)+"+$"),c="",h=[];r.dense=Array.isArray(e);for(var p=r.skipHidden&&e["!cols"]||[],m=r.skipHidden&&e["!rows"]||[],v=i.s.c;v<=i.e.c;++v)(p[v]||{}).hidden||(h[v]=on(v));for(var g=0,w=i.s.r;w<=i.e.r;++w)(m[w]||{}).hidden||(c=_Y(e,i,w,h,a,l,s,r),c!=null&&(r.strip&&(c=c.replace(u,"")),(c||r.blankrows!==!1)&&n.push((g++?o:"")+c)));return delete r.dense,n.join("")}function qD(e,t){t||(t={}),t.FS="	",t.RS=`
`;var n=iy(e,t);return n}function CY(e){var t="",n,r="";if(e==null||e["!ref"]==null)return[];var i=At(e["!ref"]),s="",a=[],o,l=[],u=Array.isArray(e);for(o=i.s.c;o<=i.e.c;++o)a[o]=on(o);for(var c=i.s.r;c<=i.e.r;++c)for(s=Sn(c),o=i.s.c;o<=i.e.c;++o)if(t=a[o]+s,n=u?(e[c]||[])[o]:e[t],r="",n!==void 0){if(n.F!=null){if(t=n.F,!n.f)continue;r=n.f,t.indexOf(":")==-1&&(t=t+":"+t)}if(n.f!=null)r=n.f;else{if(n.t=="z")continue;if(n.t=="n"&&n.v!=null)r=""+n.v;else if(n.t=="b")r=n.v?"TRUE":"FALSE";else if(n.w!==void 0)r="'"+n.w;else{if(n.v===void 0)continue;n.t=="s"?r="'"+n.v:r=""+n.v}}l[l.length]=t+"="+r}return l}function KD(e,t,n){var r=n||{},i=+!r.skipHeader,s=e||{},a=0,o=0;if(s&&r.origin!=null)if(typeof r.origin=="number")a=r.origin;else{var l=typeof r.origin=="string"?ln(r.origin):r.origin;a=l.r,o=l.c}var u,c={s:{c:0,r:0},e:{c:o,r:a+t.length-1+i}};if(s["!ref"]){var h=At(s["!ref"]);c.e.c=Math.max(c.e.c,h.e.c),c.e.r=Math.max(c.e.r,h.e.r),a==-1&&(a=h.e.r+1,c.e.r=a+t.length-1+i)}else a==-1&&(a=0,c.e.r=t.length-1+i);var p=r.header||[],m=0;t.forEach(function(g,w){vn(g).forEach(function(x){(m=p.indexOf(x))==-1&&(p[m=p.length]=x);var T=g[x],y="z",_="",k=nt({c:o+m,r:a+w+i});u=Ef(s,k),T&&typeof T=="object"&&!(T instanceof Date)?s[k]=T:(typeof T=="number"?y="n":typeof T=="boolean"?y="b":typeof T=="string"?y="s":T instanceof Date?(y="d",r.cellDates||(y="n",T=Nn(T)),_=r.dateNF||et[14]):T===null&&r.nullError&&(y="e",T=0),u?(u.t=y,u.v=T,delete u.w,delete u.R,_&&(u.z=_)):s[k]=u={t:y,v:T},_&&(u.z=_))})}),c.e.c=Math.max(c.e.c,o+p.length-1);var v=Sn(a);if(i)for(m=0;m<p.length;++m)s[on(m+o)+v]={t:"s",v:p[m]};return s["!ref"]=lt(c),s}function kY(e,t){return KD(null,e,t)}function Ef(e,t,n){if(typeof t=="string"){if(Array.isArray(e)){var r=ln(t);return e[r.r]||(e[r.r]=[]),e[r.r][r.c]||(e[r.r][r.c]={t:"z"})}return e[t]||(e[t]={t:"z"})}return typeof t!="number"?Ef(e,nt(t)):Ef(e,nt({r:t,c:n||0}))}function AY(e,t){if(typeof t=="number"){if(t>=0&&e.SheetNames.length>t)return t;throw new Error("Cannot find sheet # "+t)}else if(typeof t=="string"){var n=e.SheetNames.indexOf(t);if(n>-1)return n;throw new Error("Cannot find sheet name |"+t+"|")}else throw new Error("Cannot find sheet |"+t+"|")}function sy(){return{SheetNames:[],Sheets:{}}}function ay(e,t,n,r){var i=1;if(!n)for(;i<=65535&&e.SheetNames.indexOf(n="Sheet"+i)!=-1;++i,n=void 0);if(!n||e.SheetNames.length>=65535)throw new Error("Too many worksheets");if(r&&e.SheetNames.indexOf(n)>=0){var s=n.match(/(^.*?)(\d+)$/);i=s&&+s[2]||0;var a=s&&s[1]||n;for(++i;i<=65535&&e.SheetNames.indexOf(n=a+i)!=-1;++i);}if(FD(n),e.SheetNames.indexOf(n)>=0)throw new Error("Worksheet with name |"+n+"| already exists!");return e.SheetNames.push(n),e.Sheets[n]=t,n}function RY(e,t,n){e.Workbook||(e.Workbook={}),e.Workbook.Sheets||(e.Workbook.Sheets=[]);var r=AY(e,t);switch(e.Workbook.Sheets[r]||(e.Workbook.Sheets[r]={}),n){case 0:case 1:case 2:break;default:throw new Error("Bad sheet visibility setting "+n)}e.Workbook.Sheets[r].Hidden=n}function MY(e,t){return e.z=t,e}function YD(e,t,n){return t?(e.l={Target:t},n&&(e.l.Tooltip=n)):delete e.l,e}function FY(e,t,n){return YD(e,"#"+t,n)}function DY(e,t,n){e.c||(e.c=[]),e.c.push({t,a:n||"SheetJS"})}function PY(e,t,n,r){for(var i=typeof t!="string"?t:At(t),s=typeof t=="string"?t:lt(t),a=i.s.r;a<=i.e.r;++a)for(var o=i.s.c;o<=i.e.c;++o){var l=Ef(e,a,o);l.t="n",l.F=s,delete l.v,a==i.s.r&&o==i.s.c&&(l.f=n,r&&(l.D=!0))}return e}var p0={encode_col:on,encode_row:Sn,encode_cell:nt,encode_range:lt,decode_col:b1,decode_row:N1,split_cell:$U,decode_cell:ln,decode_range:Br,format_cell:Us,sheet_add_aoa:TF,sheet_add_json:KD,sheet_add_dom:BD,aoa_to_sheet:Ru,json_to_sheet:kY,table_to_sheet:UD,table_to_book:BK,sheet_to_csv:iy,sheet_to_txt:qD,sheet_to_json:fh,sheet_to_html:OD,sheet_to_formulae:CY,sheet_to_row_object_array:fh,sheet_get_cell:Ef,book_new:sy,book_append_sheet:ay,book_set_sheet_visibility:RY,cell_set_number_format:MY,cell_set_hyperlink:YD,cell_set_internal_link:FY,cell_add_comment:DY,sheet_set_array_formula:PY,consts:{SHEET_VISIBLE:0,SHEET_HIDDEN:1,SHEET_VERY_HIDDEN:2}};const IY=e=>new Promise((t,n)=>{const r=new FileReader;r.onload=i=>{var s;try{const a=(s=i.target)==null?void 0:s.result;if(!a){n(new Error("File data is null"));return}const o=Jg(a,{type:"binary",cellDates:!0}),l=o.SheetNames[0],u=o.Sheets[l],c=p0.sheet_to_json(u,{raw:!1,dateNF:"dd-mmm-yyyy"});t(c)}catch(a){n(a)}},r.onerror=i=>n(i),r.readAsBinaryString(e)}),NY=e=>{if(!e||typeof e!="string")return null;const t=e.match(/^(\d+)\s*years?/i);return t?parseInt(t[1],10):null},eo=e=>{const t=e.getDate().toString().padStart(2,"0"),n=e.toLocaleString("default",{month:"short"}).toUpperCase(),r=e.getFullYear();return`${t}-${n}-${r}`},$E=(e,t,n)=>t===void 0&&n===void 0?e:e.filter(r=>{const i=NY(r.Age);if(i===null)return!0;let s=!0,a=!0;return t!==void 0&&(s=i>=t),n!==void 0&&(a=i<=n),s&&a}),gs=(e,t,n,r,i)=>{const s=eo(n),a=r.replace(/{DD-MMM-YYYY}/gi,s);return e.map((o,l)=>{var v,g;const u=!!(o["First Name"]||o.Surname);let c="";t.Title&&o.Title&&(c+=`${o.Title} `),t["First Name"]&&o["First Name"]&&(c+=`${o["First Name"]} `),t.Surname&&o.Surname&&(c+=`${o.Surname} `),t["Other Names"]&&o["Other Names"]&&(c+=`${o["Other Names"]} `),c=c.trim();let h="";if(t["Membership Number"]){const w=((v=o["Membership Number"])==null?void 0:v.trim())||"",x=((g=o["Old Membership Number"])==null?void 0:g.trim())||"";w&&x?h=`(${w}|${x})`:w?h=u?`(${w})`:w:x&&(h=`(${x})`)}let p=c;h&&(p=c?`${c} ${h}`:h),p=p.trim(),p==="()"&&!c&&!o["Membership Number"]&&!o["Old Membership Number"]&&(p="");let m="";if(i&&o[i]!==void 0&&o[i]!==null){const w=o[i];if(typeof w=="number")m=w>=0?w:"";else if(typeof w=="string"&&w.trim()!==""){const x=parseFloat(w.trim().replace(/,/g,""));m=!isNaN(x)&&x>=0?x:""}}return{"No.":o["No."]||l+1,"Transaction Type":"Individual Tithe-[Income]","Payment Source Type":"Registered Member","Membership Number":p,"Transaction Date ('DD-MMM-YYYY')":s,Currency:"GHS","Exchange Rate":1,"Payment Method":"Cash","Transaction Amount":m,"Narration/Description":a}})},bY=(e,t)=>{const n=o=>String(o["Membership Number"]||o["Old Membership Number"]||"").trim(),r=new Set(t.map(n).filter(o=>o)),i=new Set(e.map(n).filter(o=>o)),s=e.filter(o=>{const l=n(o);return l&&!r.has(l)}),a=t.filter(o=>{const l=n(o);return l&&!i.has(l)});return{newMembers:s,missingMembers:a}},LY=(e,t)=>{if(!e||e.length===0){console.error("No data provided to export.");return}const n=p0.json_to_sheet(e),r=new Set;e.forEach(a=>Object.keys(a).forEach(o=>r.add(o)));const i=Array.from(r).map(a=>{let o=a.length;return e.forEach(l=>{const u=l[a];u!=null&&String(u).length>o&&(o=String(u).length)}),{wch:o+3}});n["!cols"]=i;const s=p0.book_new();p0.book_append_sheet(s,n,"Exported Data"),SY(s,`${t}.xlsx`)};function OY(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>r=>{t.forEach(i=>i(r))},t)}const sp=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";function Fu(e){const t=Object.prototype.toString.call(e);return t==="[object Window]"||t==="[object global]"}function oy(e){return"nodeType"in e}function Ur(e){var t,n;return e?Fu(e)?e:oy(e)&&(t=(n=e.ownerDocument)==null?void 0:n.defaultView)!=null?t:window:window}function ly(e){const{Document:t}=Ur(e);return e instanceof t}function Zf(e){return Fu(e)?!1:e instanceof Ur(e).HTMLElement}function XD(e){return e instanceof Ur(e).SVGElement}function Du(e){return e?Fu(e)?e.document:oy(e)?ly(e)?e:Zf(e)||XD(e)?e.ownerDocument:document:document:document}const us=sp?E.useLayoutEffect:E.useEffect;function uy(e){const t=E.useRef(e);return us(()=>{t.current=e}),E.useCallback(function(){for(var n=arguments.length,r=new Array(n),i=0;i<n;i++)r[i]=arguments[i];return t.current==null?void 0:t.current(...r)},[])}function BY(){const e=E.useRef(null),t=E.useCallback((r,i)=>{e.current=setInterval(r,i)},[]),n=E.useCallback(()=>{e.current!==null&&(clearInterval(e.current),e.current=null)},[]);return[t,n]}function _f(e,t){t===void 0&&(t=[e]);const n=E.useRef(e);return us(()=>{n.current!==e&&(n.current=e)},t),n}function ed(e,t){const n=E.useRef();return E.useMemo(()=>{const r=e(n.current);return n.current=r,r},[...t])}function dh(e){const t=uy(e),n=E.useRef(null),r=E.useCallback(i=>{i!==n.current&&(t==null||t(i,n.current)),n.current=i},[]);return[n,r]}function Qg(e){const t=E.useRef();return E.useEffect(()=>{t.current=e},[e]),t.current}let ym={};function td(e,t){return E.useMemo(()=>{if(t)return t;const n=ym[e]==null?0:ym[e]+1;return ym[e]=n,e+"-"+n},[e,t])}function JD(e){return function(t){for(var n=arguments.length,r=new Array(n>1?n-1:0),i=1;i<n;i++)r[i-1]=arguments[i];return r.reduce((s,a)=>{const o=Object.entries(a);for(const[l,u]of o){const c=s[l];c!=null&&(s[l]=c+e*u)}return s},{...t})}}const $l=JD(1),hh=JD(-1);function UY(e){return"clientX"in e&&"clientY"in e}function cy(e){if(!e)return!1;const{KeyboardEvent:t}=Ur(e.target);return t&&e instanceof t}function VY(e){if(!e)return!1;const{TouchEvent:t}=Ur(e.target);return t&&e instanceof t}function jg(e){if(VY(e)){if(e.touches&&e.touches.length){const{clientX:t,clientY:n}=e.touches[0];return{x:t,y:n}}else if(e.changedTouches&&e.changedTouches.length){const{clientX:t,clientY:n}=e.changedTouches[0];return{x:t,y:n}}}return UY(e)?{x:e.clientX,y:e.clientY}:null}const Cf=Object.freeze({Translate:{toString(e){if(!e)return;const{x:t,y:n}=e;return"translate3d("+(t?Math.round(t):0)+"px, "+(n?Math.round(n):0)+"px, 0)"}},Scale:{toString(e){if(!e)return;const{scaleX:t,scaleY:n}=e;return"scaleX("+t+") scaleY("+n+")"}},Transform:{toString(e){if(e)return[Cf.Translate.toString(e),Cf.Scale.toString(e)].join(" ")}},Transition:{toString(e){let{property:t,duration:n,easing:r}=e;return t+" "+n+"ms "+r}}}),zE="a,frame,iframe,input:not([type=hidden]):not(:disabled),select:not(:disabled),textarea:not(:disabled),button:not(:disabled),*[tabindex]";function HY(e){return e.matches(zE)?e:e.querySelector(zE)}const $Y={display:"none"};function zY(e){let{id:t,value:n}=e;return xt.createElement("div",{id:t,style:$Y},n)}function WY(e){let{id:t,announcement:n,ariaLiveType:r="assertive"}=e;const i={position:"fixed",top:0,left:0,width:1,height:1,margin:-1,border:0,padding:0,overflow:"hidden",clip:"rect(0 0 0 0)",clipPath:"inset(100%)",whiteSpace:"nowrap"};return xt.createElement("div",{id:t,style:i,role:"status","aria-live":r,"aria-atomic":!0},n)}function GY(){const[e,t]=E.useState("");return{announce:E.useCallback(r=>{r!=null&&t(r)},[]),announcement:e}}const QD=E.createContext(null);function qY(e){const t=E.useContext(QD);E.useEffect(()=>{if(!t)throw new Error("useDndMonitor must be used within a children of <DndContext>");return t(e)},[e,t])}function KY(){const[e]=E.useState(()=>new Set),t=E.useCallback(r=>(e.add(r),()=>e.delete(r)),[e]);return[E.useCallback(r=>{let{type:i,event:s}=r;e.forEach(a=>{var o;return(o=a[i])==null?void 0:o.call(a,s)})},[e]),t]}const YY={draggable:`
    To pick up a draggable item, press the space bar.
    While dragging, use the arrow keys to move the item.
    Press space again to drop the item in its new position, or press escape to cancel.
  `},XY={onDragStart(e){let{active:t}=e;return"Picked up draggable item "+t.id+"."},onDragOver(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was moved over droppable area "+n.id+".":"Draggable item "+t.id+" is no longer over a droppable area."},onDragEnd(e){let{active:t,over:n}=e;return n?"Draggable item "+t.id+" was dropped over droppable area "+n.id:"Draggable item "+t.id+" was dropped."},onDragCancel(e){let{active:t}=e;return"Dragging was cancelled. Draggable item "+t.id+" was dropped."}};function JY(e){let{announcements:t=XY,container:n,hiddenTextDescribedById:r,screenReaderInstructions:i=YY}=e;const{announce:s,announcement:a}=GY(),o=td("DndLiveRegion"),[l,u]=E.useState(!1);if(E.useEffect(()=>{u(!0)},[]),qY(E.useMemo(()=>({onDragStart(h){let{active:p}=h;s(t.onDragStart({active:p}))},onDragMove(h){let{active:p,over:m}=h;t.onDragMove&&s(t.onDragMove({active:p,over:m}))},onDragOver(h){let{active:p,over:m}=h;s(t.onDragOver({active:p,over:m}))},onDragEnd(h){let{active:p,over:m}=h;s(t.onDragEnd({active:p,over:m}))},onDragCancel(h){let{active:p,over:m}=h;s(t.onDragCancel({active:p,over:m}))}}),[s,t])),!l)return null;const c=xt.createElement(xt.Fragment,null,xt.createElement(zY,{id:r,value:i.draggable}),xt.createElement(WY,{id:o,announcement:a}));return n?io.createPortal(c,n):c}var Fn;(function(e){e.DragStart="dragStart",e.DragMove="dragMove",e.DragEnd="dragEnd",e.DragCancel="dragCancel",e.DragOver="dragOver",e.RegisterDroppable="registerDroppable",e.SetDroppableDisabled="setDroppableDisabled",e.UnregisterDroppable="unregisterDroppable"})(Fn||(Fn={}));function ph(){}function QY(e,t){return E.useMemo(()=>({sensor:e,options:t??{}}),[e,t])}function jY(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return E.useMemo(()=>[...t].filter(r=>r!=null),[...t])}const zi=Object.freeze({x:0,y:0});function ZY(e,t){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function eX(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return n-r}function tX(e,t){let{data:{value:n}}=e,{data:{value:r}}=t;return r-n}function nX(e,t){if(!e||e.length===0)return null;const[n]=e;return n[t]}function WE(e,t,n){return t===void 0&&(t=e.left),n===void 0&&(n=e.top),{x:t+e.width*.5,y:n+e.height*.5}}const rX=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=WE(t,t.left,t.top),s=[];for(const a of r){const{id:o}=a,l=n.get(o);if(l){const u=ZY(WE(l),i);s.push({id:o,data:{droppableContainer:a,value:u}})}}return s.sort(eX)};function iX(e,t){const n=Math.max(t.top,e.top),r=Math.max(t.left,e.left),i=Math.min(t.left+t.width,e.left+e.width),s=Math.min(t.top+t.height,e.top+e.height),a=i-r,o=s-n;if(r<i&&n<s){const l=t.width*t.height,u=e.width*e.height,c=a*o,h=c/(l+u-c);return Number(h.toFixed(4))}return 0}const sX=e=>{let{collisionRect:t,droppableRects:n,droppableContainers:r}=e;const i=[];for(const s of r){const{id:a}=s,o=n.get(a);if(o){const l=iX(o,t);l>0&&i.push({id:a,data:{droppableContainer:s,value:l}})}}return i.sort(tX)};function aX(e,t,n){return{...e,scaleX:t&&n?t.width/n.width:1,scaleY:t&&n?t.height/n.height:1}}function jD(e,t){return e&&t?{x:e.left-t.left,y:e.top-t.top}:zi}function oX(e){return function(n){for(var r=arguments.length,i=new Array(r>1?r-1:0),s=1;s<r;s++)i[s-1]=arguments[s];return i.reduce((a,o)=>({...a,top:a.top+e*o.y,bottom:a.bottom+e*o.y,left:a.left+e*o.x,right:a.right+e*o.x}),{...n})}}const lX=oX(1);function uX(e){if(e.startsWith("matrix3d(")){const t=e.slice(9,-1).split(/, /);return{x:+t[12],y:+t[13],scaleX:+t[0],scaleY:+t[5]}}else if(e.startsWith("matrix(")){const t=e.slice(7,-1).split(/, /);return{x:+t[4],y:+t[5],scaleX:+t[0],scaleY:+t[3]}}return null}function cX(e,t,n){const r=uX(t);if(!r)return e;const{scaleX:i,scaleY:s,x:a,y:o}=r,l=e.left-a-(1-i)*parseFloat(n),u=e.top-o-(1-s)*parseFloat(n.slice(n.indexOf(" ")+1)),c=i?e.width/i:e.width,h=s?e.height/s:e.height;return{width:c,height:h,top:u,right:l+c,bottom:u+h,left:l}}const fX={ignoreTransform:!1};function Pu(e,t){t===void 0&&(t=fX);let n=e.getBoundingClientRect();if(t.ignoreTransform){const{transform:u,transformOrigin:c}=Ur(e).getComputedStyle(e);u&&(n=cX(n,u,c))}const{top:r,left:i,width:s,height:a,bottom:o,right:l}=n;return{top:r,left:i,width:s,height:a,bottom:o,right:l}}function GE(e){return Pu(e,{ignoreTransform:!0})}function dX(e){const t=e.innerWidth,n=e.innerHeight;return{top:0,left:0,right:t,bottom:n,width:t,height:n}}function hX(e,t){return t===void 0&&(t=Ur(e).getComputedStyle(e)),t.position==="fixed"}function pX(e,t){t===void 0&&(t=Ur(e).getComputedStyle(e));const n=/(auto|scroll|overlay)/;return["overflow","overflowX","overflowY"].some(i=>{const s=t[i];return typeof s=="string"?n.test(s):!1})}function fy(e,t){const n=[];function r(i){if(t!=null&&n.length>=t||!i)return n;if(ly(i)&&i.scrollingElement!=null&&!n.includes(i.scrollingElement))return n.push(i.scrollingElement),n;if(!Zf(i)||XD(i)||n.includes(i))return n;const s=Ur(e).getComputedStyle(i);return i!==e&&pX(i,s)&&n.push(i),hX(i,s)?n:r(i.parentNode)}return e?r(e):n}function ZD(e){const[t]=fy(e,1);return t??null}function wm(e){return!sp||!e?null:Fu(e)?e:oy(e)?ly(e)||e===Du(e).scrollingElement?window:Zf(e)?e:null:null}function eP(e){return Fu(e)?e.scrollX:e.scrollLeft}function tP(e){return Fu(e)?e.scrollY:e.scrollTop}function Zg(e){return{x:eP(e),y:tP(e)}}var Vn;(function(e){e[e.Forward=1]="Forward",e[e.Backward=-1]="Backward"})(Vn||(Vn={}));function nP(e){return!sp||!e?!1:e===document.scrollingElement}function rP(e){const t={x:0,y:0},n=nP(e)?{height:window.innerHeight,width:window.innerWidth}:{height:e.clientHeight,width:e.clientWidth},r={x:e.scrollWidth-n.width,y:e.scrollHeight-n.height},i=e.scrollTop<=t.y,s=e.scrollLeft<=t.x,a=e.scrollTop>=r.y,o=e.scrollLeft>=r.x;return{isTop:i,isLeft:s,isBottom:a,isRight:o,maxScroll:r,minScroll:t}}const mX={x:.2,y:.2};function gX(e,t,n,r,i){let{top:s,left:a,right:o,bottom:l}=n;r===void 0&&(r=10),i===void 0&&(i=mX);const{isTop:u,isBottom:c,isLeft:h,isRight:p}=rP(e),m={x:0,y:0},v={x:0,y:0},g={height:t.height*i.y,width:t.width*i.x};return!u&&s<=t.top+g.height?(m.y=Vn.Backward,v.y=r*Math.abs((t.top+g.height-s)/g.height)):!c&&l>=t.bottom-g.height&&(m.y=Vn.Forward,v.y=r*Math.abs((t.bottom-g.height-l)/g.height)),!p&&o>=t.right-g.width?(m.x=Vn.Forward,v.x=r*Math.abs((t.right-g.width-o)/g.width)):!h&&a<=t.left+g.width&&(m.x=Vn.Backward,v.x=r*Math.abs((t.left+g.width-a)/g.width)),{direction:m,speed:v}}function vX(e){if(e===document.scrollingElement){const{innerWidth:s,innerHeight:a}=window;return{top:0,left:0,right:s,bottom:a,width:s,height:a}}const{top:t,left:n,right:r,bottom:i}=e.getBoundingClientRect();return{top:t,left:n,right:r,bottom:i,width:e.clientWidth,height:e.clientHeight}}function iP(e){return e.reduce((t,n)=>$l(t,Zg(n)),zi)}function xX(e){return e.reduce((t,n)=>t+eP(n),0)}function yX(e){return e.reduce((t,n)=>t+tP(n),0)}function wX(e,t){if(t===void 0&&(t=Pu),!e)return;const{top:n,left:r,bottom:i,right:s}=t(e);ZD(e)&&(i<=0||s<=0||n>=window.innerHeight||r>=window.innerWidth)&&e.scrollIntoView({block:"center",inline:"center"})}const TX=[["x",["left","right"],xX],["y",["top","bottom"],yX]];class dy{constructor(t,n){this.rect=void 0,this.width=void 0,this.height=void 0,this.top=void 0,this.bottom=void 0,this.right=void 0,this.left=void 0;const r=fy(n),i=iP(r);this.rect={...t},this.width=t.width,this.height=t.height;for(const[s,a,o]of TX)for(const l of a)Object.defineProperty(this,l,{get:()=>{const u=o(r),c=i[s]-u;return this.rect[l]+c},enumerable:!0});Object.defineProperty(this,"rect",{enumerable:!1})}}class Nc{constructor(t){this.target=void 0,this.listeners=[],this.removeAll=()=>{this.listeners.forEach(n=>{var r;return(r=this.target)==null?void 0:r.removeEventListener(...n)})},this.target=t}add(t,n,r){var i;(i=this.target)==null||i.addEventListener(t,n,r),this.listeners.push([t,n,r])}}function SX(e){const{EventTarget:t}=Ur(e);return e instanceof t?e:Du(e)}function Tm(e,t){const n=Math.abs(e.x),r=Math.abs(e.y);return typeof t=="number"?Math.sqrt(n**2+r**2)>t:"x"in t&&"y"in t?n>t.x&&r>t.y:"x"in t?n>t.x:"y"in t?r>t.y:!1}var hi;(function(e){e.Click="click",e.DragStart="dragstart",e.Keydown="keydown",e.ContextMenu="contextmenu",e.Resize="resize",e.SelectionChange="selectionchange",e.VisibilityChange="visibilitychange"})(hi||(hi={}));function qE(e){e.preventDefault()}function EX(e){e.stopPropagation()}var Pt;(function(e){e.Space="Space",e.Down="ArrowDown",e.Right="ArrowRight",e.Left="ArrowLeft",e.Up="ArrowUp",e.Esc="Escape",e.Enter="Enter",e.Tab="Tab"})(Pt||(Pt={}));const sP={start:[Pt.Space,Pt.Enter],cancel:[Pt.Esc],end:[Pt.Space,Pt.Enter,Pt.Tab]},_X=(e,t)=>{let{currentCoordinates:n}=t;switch(e.code){case Pt.Right:return{...n,x:n.x+25};case Pt.Left:return{...n,x:n.x-25};case Pt.Down:return{...n,y:n.y+25};case Pt.Up:return{...n,y:n.y-25}}};class aP{constructor(t){this.props=void 0,this.autoScrollEnabled=!1,this.referenceCoordinates=void 0,this.listeners=void 0,this.windowListeners=void 0,this.props=t;const{event:{target:n}}=t;this.props=t,this.listeners=new Nc(Du(n)),this.windowListeners=new Nc(Ur(n)),this.handleKeyDown=this.handleKeyDown.bind(this),this.handleCancel=this.handleCancel.bind(this),this.attach()}attach(){this.handleStart(),this.windowListeners.add(hi.Resize,this.handleCancel),this.windowListeners.add(hi.VisibilityChange,this.handleCancel),setTimeout(()=>this.listeners.add(hi.Keydown,this.handleKeyDown))}handleStart(){const{activeNode:t,onStart:n}=this.props,r=t.node.current;r&&wX(r),n(zi)}handleKeyDown(t){if(cy(t)){const{active:n,context:r,options:i}=this.props,{keyboardCodes:s=sP,coordinateGetter:a=_X,scrollBehavior:o="smooth"}=i,{code:l}=t;if(s.end.includes(l)){this.handleEnd(t);return}if(s.cancel.includes(l)){this.handleCancel(t);return}const{collisionRect:u}=r.current,c=u?{x:u.left,y:u.top}:zi;this.referenceCoordinates||(this.referenceCoordinates=c);const h=a(t,{active:n,context:r.current,currentCoordinates:c});if(h){const p=hh(h,c),m={x:0,y:0},{scrollableAncestors:v}=r.current;for(const g of v){const w=t.code,{isTop:x,isRight:T,isLeft:y,isBottom:_,maxScroll:k,minScroll:S}=rP(g),C=vX(g),M={x:Math.min(w===Pt.Right?C.right-C.width/2:C.right,Math.max(w===Pt.Right?C.left:C.left+C.width/2,h.x)),y:Math.min(w===Pt.Down?C.bottom-C.height/2:C.bottom,Math.max(w===Pt.Down?C.top:C.top+C.height/2,h.y))},F=w===Pt.Right&&!T||w===Pt.Left&&!y,b=w===Pt.Down&&!_||w===Pt.Up&&!x;if(F&&M.x!==h.x){const V=g.scrollLeft+p.x,z=w===Pt.Right&&V<=k.x||w===Pt.Left&&V>=S.x;if(z&&!p.y){g.scrollTo({left:V,behavior:o});return}z?m.x=g.scrollLeft-V:m.x=w===Pt.Right?g.scrollLeft-k.x:g.scrollLeft-S.x,m.x&&g.scrollBy({left:-m.x,behavior:o});break}else if(b&&M.y!==h.y){const V=g.scrollTop+p.y,z=w===Pt.Down&&V<=k.y||w===Pt.Up&&V>=S.y;if(z&&!p.x){g.scrollTo({top:V,behavior:o});return}z?m.y=g.scrollTop-V:m.y=w===Pt.Down?g.scrollTop-k.y:g.scrollTop-S.y,m.y&&g.scrollBy({top:-m.y,behavior:o});break}}this.handleMove(t,$l(hh(h,this.referenceCoordinates),m))}}}handleMove(t,n){const{onMove:r}=this.props;t.preventDefault(),r(n)}handleEnd(t){const{onEnd:n}=this.props;t.preventDefault(),this.detach(),n()}handleCancel(t){const{onCancel:n}=this.props;t.preventDefault(),this.detach(),n()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll()}}aP.activators=[{eventName:"onKeyDown",handler:(e,t,n)=>{let{keyboardCodes:r=sP,onActivation:i}=t,{active:s}=n;const{code:a}=e.nativeEvent;if(r.start.includes(a)){const o=s.activatorNode.current;return o&&e.target!==o?!1:(e.preventDefault(),i==null||i({event:e.nativeEvent}),!0)}return!1}}];function KE(e){return!!(e&&"distance"in e)}function YE(e){return!!(e&&"delay"in e)}class hy{constructor(t,n,r){var i;r===void 0&&(r=SX(t.event.target)),this.props=void 0,this.events=void 0,this.autoScrollEnabled=!0,this.document=void 0,this.activated=!1,this.initialCoordinates=void 0,this.timeoutId=null,this.listeners=void 0,this.documentListeners=void 0,this.windowListeners=void 0,this.props=t,this.events=n;const{event:s}=t,{target:a}=s;this.props=t,this.events=n,this.document=Du(a),this.documentListeners=new Nc(this.document),this.listeners=new Nc(r),this.windowListeners=new Nc(Ur(a)),this.initialCoordinates=(i=jg(s))!=null?i:zi,this.handleStart=this.handleStart.bind(this),this.handleMove=this.handleMove.bind(this),this.handleEnd=this.handleEnd.bind(this),this.handleCancel=this.handleCancel.bind(this),this.handleKeydown=this.handleKeydown.bind(this),this.removeTextSelection=this.removeTextSelection.bind(this),this.attach()}attach(){const{events:t,props:{options:{activationConstraint:n,bypassActivationConstraint:r}}}=this;if(this.listeners.add(t.move.name,this.handleMove,{passive:!1}),this.listeners.add(t.end.name,this.handleEnd),t.cancel&&this.listeners.add(t.cancel.name,this.handleCancel),this.windowListeners.add(hi.Resize,this.handleCancel),this.windowListeners.add(hi.DragStart,qE),this.windowListeners.add(hi.VisibilityChange,this.handleCancel),this.windowListeners.add(hi.ContextMenu,qE),this.documentListeners.add(hi.Keydown,this.handleKeydown),n){if(r!=null&&r({event:this.props.event,activeNode:this.props.activeNode,options:this.props.options}))return this.handleStart();if(YE(n)){this.timeoutId=setTimeout(this.handleStart,n.delay),this.handlePending(n);return}if(KE(n)){this.handlePending(n);return}}this.handleStart()}detach(){this.listeners.removeAll(),this.windowListeners.removeAll(),setTimeout(this.documentListeners.removeAll,50),this.timeoutId!==null&&(clearTimeout(this.timeoutId),this.timeoutId=null)}handlePending(t,n){const{active:r,onPending:i}=this.props;i(r,t,this.initialCoordinates,n)}handleStart(){const{initialCoordinates:t}=this,{onStart:n}=this.props;t&&(this.activated=!0,this.documentListeners.add(hi.Click,EX,{capture:!0}),this.removeTextSelection(),this.documentListeners.add(hi.SelectionChange,this.removeTextSelection),n(t))}handleMove(t){var n;const{activated:r,initialCoordinates:i,props:s}=this,{onMove:a,options:{activationConstraint:o}}=s;if(!i)return;const l=(n=jg(t))!=null?n:zi,u=hh(i,l);if(!r&&o){if(KE(o)){if(o.tolerance!=null&&Tm(u,o.tolerance))return this.handleCancel();if(Tm(u,o.distance))return this.handleStart()}if(YE(o)&&Tm(u,o.tolerance))return this.handleCancel();this.handlePending(o,u);return}t.cancelable&&t.preventDefault(),a(l)}handleEnd(){const{onAbort:t,onEnd:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleCancel(){const{onAbort:t,onCancel:n}=this.props;this.detach(),this.activated||t(this.props.active),n()}handleKeydown(t){t.code===Pt.Esc&&this.handleCancel()}removeTextSelection(){var t;(t=this.document.getSelection())==null||t.removeAllRanges()}}const CX={cancel:{name:"pointercancel"},move:{name:"pointermove"},end:{name:"pointerup"}};class py extends hy{constructor(t){const{event:n}=t,r=Du(n.target);super(t,CX,r)}}py.activators=[{eventName:"onPointerDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return!n.isPrimary||n.button!==0?!1:(r==null||r({event:n}),!0)}}];const kX={move:{name:"mousemove"},end:{name:"mouseup"}};var ev;(function(e){e[e.RightClick=2]="RightClick"})(ev||(ev={}));class AX extends hy{constructor(t){super(t,kX,Du(t.event.target))}}AX.activators=[{eventName:"onMouseDown",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;return n.button===ev.RightClick?!1:(r==null||r({event:n}),!0)}}];const Sm={cancel:{name:"touchcancel"},move:{name:"touchmove"},end:{name:"touchend"}};class RX extends hy{constructor(t){super(t,Sm)}static setup(){return window.addEventListener(Sm.move.name,t,{capture:!1,passive:!1}),function(){window.removeEventListener(Sm.move.name,t)};function t(){}}}RX.activators=[{eventName:"onTouchStart",handler:(e,t)=>{let{nativeEvent:n}=e,{onActivation:r}=t;const{touches:i}=n;return i.length>1?!1:(r==null||r({event:n}),!0)}}];var bc;(function(e){e[e.Pointer=0]="Pointer",e[e.DraggableRect=1]="DraggableRect"})(bc||(bc={}));var mh;(function(e){e[e.TreeOrder=0]="TreeOrder",e[e.ReversedTreeOrder=1]="ReversedTreeOrder"})(mh||(mh={}));function MX(e){let{acceleration:t,activator:n=bc.Pointer,canScroll:r,draggingRect:i,enabled:s,interval:a=5,order:o=mh.TreeOrder,pointerCoordinates:l,scrollableAncestors:u,scrollableAncestorRects:c,delta:h,threshold:p}=e;const m=DX({delta:h,disabled:!s}),[v,g]=BY(),w=E.useRef({x:0,y:0}),x=E.useRef({x:0,y:0}),T=E.useMemo(()=>{switch(n){case bc.Pointer:return l?{top:l.y,bottom:l.y,left:l.x,right:l.x}:null;case bc.DraggableRect:return i}},[n,i,l]),y=E.useRef(null),_=E.useCallback(()=>{const S=y.current;if(!S)return;const C=w.current.x*x.current.x,M=w.current.y*x.current.y;S.scrollBy(C,M)},[]),k=E.useMemo(()=>o===mh.TreeOrder?[...u].reverse():u,[o,u]);E.useEffect(()=>{if(!s||!u.length||!T){g();return}for(const S of k){if((r==null?void 0:r(S))===!1)continue;const C=u.indexOf(S),M=c[C];if(!M)continue;const{direction:F,speed:b}=gX(S,M,T,t,p);for(const V of["x","y"])m[V][F[V]]||(b[V]=0,F[V]=0);if(b.x>0||b.y>0){g(),y.current=S,v(_,a),w.current=b,x.current=F;return}}w.current={x:0,y:0},x.current={x:0,y:0},g()},[t,_,r,g,s,a,JSON.stringify(T),JSON.stringify(m),v,u,k,c,JSON.stringify(p)])}const FX={x:{[Vn.Backward]:!1,[Vn.Forward]:!1},y:{[Vn.Backward]:!1,[Vn.Forward]:!1}};function DX(e){let{delta:t,disabled:n}=e;const r=Qg(t);return ed(i=>{if(n||!r||!i)return FX;const s={x:Math.sign(t.x-r.x),y:Math.sign(t.y-r.y)};return{x:{[Vn.Backward]:i.x[Vn.Backward]||s.x===-1,[Vn.Forward]:i.x[Vn.Forward]||s.x===1},y:{[Vn.Backward]:i.y[Vn.Backward]||s.y===-1,[Vn.Forward]:i.y[Vn.Forward]||s.y===1}}},[n,t,r])}function PX(e,t){const n=t!=null?e.get(t):void 0,r=n?n.node.current:null;return ed(i=>{var s;return t==null?null:(s=r??i)!=null?s:null},[r,t])}function IX(e,t){return E.useMemo(()=>e.reduce((n,r)=>{const{sensor:i}=r,s=i.activators.map(a=>({eventName:a.eventName,handler:t(a.handler,r)}));return[...n,...s]},[]),[e,t])}var kf;(function(e){e[e.Always=0]="Always",e[e.BeforeDragging=1]="BeforeDragging",e[e.WhileDragging=2]="WhileDragging"})(kf||(kf={}));var tv;(function(e){e.Optimized="optimized"})(tv||(tv={}));const XE=new Map;function NX(e,t){let{dragging:n,dependencies:r,config:i}=t;const[s,a]=E.useState(null),{frequency:o,measure:l,strategy:u}=i,c=E.useRef(e),h=w(),p=_f(h),m=E.useCallback(function(x){x===void 0&&(x=[]),!p.current&&a(T=>T===null?x:T.concat(x.filter(y=>!T.includes(y))))},[p]),v=E.useRef(null),g=ed(x=>{if(h&&!n)return XE;if(!x||x===XE||c.current!==e||s!=null){const T=new Map;for(let y of e){if(!y)continue;if(s&&s.length>0&&!s.includes(y.id)&&y.rect.current){T.set(y.id,y.rect.current);continue}const _=y.node.current,k=_?new dy(l(_),_):null;y.rect.current=k,k&&T.set(y.id,k)}return T}return x},[e,s,n,h,l]);return E.useEffect(()=>{c.current=e},[e]),E.useEffect(()=>{h||m()},[n,h]),E.useEffect(()=>{s&&s.length>0&&a(null)},[JSON.stringify(s)]),E.useEffect(()=>{h||typeof o!="number"||v.current!==null||(v.current=setTimeout(()=>{m(),v.current=null},o))},[o,h,m,...r]),{droppableRects:g,measureDroppableContainers:m,measuringScheduled:s!=null};function w(){switch(u){case kf.Always:return!1;case kf.BeforeDragging:return n;default:return!n}}}function oP(e,t){return ed(n=>e?n||(typeof t=="function"?t(e):e):null,[t,e])}function bX(e,t){return oP(e,t)}function LX(e){let{callback:t,disabled:n}=e;const r=uy(t),i=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.MutationObserver>"u")return;const{MutationObserver:s}=window;return new s(r)},[r,n]);return E.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function ap(e){let{callback:t,disabled:n}=e;const r=uy(t),i=E.useMemo(()=>{if(n||typeof window>"u"||typeof window.ResizeObserver>"u")return;const{ResizeObserver:s}=window;return new s(r)},[n]);return E.useEffect(()=>()=>i==null?void 0:i.disconnect(),[i]),i}function OX(e){return new dy(Pu(e),e)}function JE(e,t,n){t===void 0&&(t=OX);const[r,i]=E.useState(null);function s(){i(l=>{if(!e)return null;if(e.isConnected===!1){var u;return(u=l??n)!=null?u:null}const c=t(e);return JSON.stringify(l)===JSON.stringify(c)?l:c})}const a=LX({callback(l){if(e)for(const u of l){const{type:c,target:h}=u;if(c==="childList"&&h instanceof HTMLElement&&h.contains(e)){s();break}}}}),o=ap({callback:s});return us(()=>{s(),e?(o==null||o.observe(e),a==null||a.observe(document.body,{childList:!0,subtree:!0})):(o==null||o.disconnect(),a==null||a.disconnect())},[e]),r}function BX(e){const t=oP(e);return jD(e,t)}const QE=[];function UX(e){const t=E.useRef(e),n=ed(r=>e?r&&r!==QE&&e&&t.current&&e.parentNode===t.current.parentNode?r:fy(e):QE,[e]);return E.useEffect(()=>{t.current=e},[e]),n}function VX(e){const[t,n]=E.useState(null),r=E.useRef(e),i=E.useCallback(s=>{const a=wm(s.target);a&&n(o=>o?(o.set(a,Zg(a)),new Map(o)):null)},[]);return E.useEffect(()=>{const s=r.current;if(e!==s){a(s);const o=e.map(l=>{const u=wm(l);return u?(u.addEventListener("scroll",i,{passive:!0}),[u,Zg(u)]):null}).filter(l=>l!=null);n(o.length?new Map(o):null),r.current=e}return()=>{a(e),a(s)};function a(o){o.forEach(l=>{const u=wm(l);u==null||u.removeEventListener("scroll",i)})}},[i,e]),E.useMemo(()=>e.length?t?Array.from(t.values()).reduce((s,a)=>$l(s,a),zi):iP(e):zi,[e,t])}function jE(e,t){t===void 0&&(t=[]);const n=E.useRef(null);return E.useEffect(()=>{n.current=null},t),E.useEffect(()=>{const r=e!==zi;r&&!n.current&&(n.current=e),!r&&n.current&&(n.current=null)},[e]),n.current?hh(e,n.current):zi}function HX(e){E.useEffect(()=>{if(!sp)return;const t=e.map(n=>{let{sensor:r}=n;return r.setup==null?void 0:r.setup()});return()=>{for(const n of t)n==null||n()}},e.map(t=>{let{sensor:n}=t;return n}))}function $X(e,t){return E.useMemo(()=>e.reduce((n,r)=>{let{eventName:i,handler:s}=r;return n[i]=a=>{s(a,t)},n},{}),[e,t])}function lP(e){return E.useMemo(()=>e?dX(e):null,[e])}const ZE=[];function zX(e,t){t===void 0&&(t=Pu);const[n]=e,r=lP(n?Ur(n):null),[i,s]=E.useState(ZE);function a(){s(()=>e.length?e.map(l=>nP(l)?r:new dy(t(l),l)):ZE)}const o=ap({callback:a});return us(()=>{o==null||o.disconnect(),a(),e.forEach(l=>o==null?void 0:o.observe(l))},[e]),i}function WX(e){if(!e)return null;if(e.children.length>1)return e;const t=e.children[0];return Zf(t)?t:e}function GX(e){let{measure:t}=e;const[n,r]=E.useState(null),i=E.useCallback(u=>{for(const{target:c}of u)if(Zf(c)){r(h=>{const p=t(c);return h?{...h,width:p.width,height:p.height}:p});break}},[t]),s=ap({callback:i}),a=E.useCallback(u=>{const c=WX(u);s==null||s.disconnect(),c&&(s==null||s.observe(c)),r(c?t(c):null)},[t,s]),[o,l]=dh(a);return E.useMemo(()=>({nodeRef:o,rect:n,setRef:l}),[n,o,l])}const qX=[{sensor:py,options:{}},{sensor:aP,options:{}}],KX={current:{}},m0={draggable:{measure:GE},droppable:{measure:GE,strategy:kf.WhileDragging,frequency:tv.Optimized},dragOverlay:{measure:Pu}};class Lc extends Map{get(t){var n;return t!=null&&(n=super.get(t))!=null?n:void 0}toArray(){return Array.from(this.values())}getEnabled(){return this.toArray().filter(t=>{let{disabled:n}=t;return!n})}getNodeFor(t){var n,r;return(n=(r=this.get(t))==null?void 0:r.node.current)!=null?n:void 0}}const YX={activatorEvent:null,active:null,activeNode:null,activeNodeRect:null,collisions:null,containerNodeRect:null,draggableNodes:new Map,droppableRects:new Map,droppableContainers:new Lc,over:null,dragOverlay:{nodeRef:{current:null},rect:null,setRef:ph},scrollableAncestors:[],scrollableAncestorRects:[],measuringConfiguration:m0,measureDroppableContainers:ph,windowRect:null,measuringScheduled:!1},XX={activatorEvent:null,activators:[],active:null,activeNodeRect:null,ariaDescribedById:{draggable:""},dispatch:ph,draggableNodes:new Map,over:null,measureDroppableContainers:ph},op=E.createContext(XX),uP=E.createContext(YX);function JX(){return{draggable:{active:null,initialCoordinates:{x:0,y:0},nodes:new Map,translate:{x:0,y:0}},droppable:{containers:new Lc}}}function QX(e,t){switch(t.type){case Fn.DragStart:return{...e,draggable:{...e.draggable,initialCoordinates:t.initialCoordinates,active:t.active}};case Fn.DragMove:return e.draggable.active==null?e:{...e,draggable:{...e.draggable,translate:{x:t.coordinates.x-e.draggable.initialCoordinates.x,y:t.coordinates.y-e.draggable.initialCoordinates.y}}};case Fn.DragEnd:case Fn.DragCancel:return{...e,draggable:{...e.draggable,active:null,initialCoordinates:{x:0,y:0},translate:{x:0,y:0}}};case Fn.RegisterDroppable:{const{element:n}=t,{id:r}=n,i=new Lc(e.droppable.containers);return i.set(r,n),{...e,droppable:{...e.droppable,containers:i}}}case Fn.SetDroppableDisabled:{const{id:n,key:r,disabled:i}=t,s=e.droppable.containers.get(n);if(!s||r!==s.key)return e;const a=new Lc(e.droppable.containers);return a.set(n,{...s,disabled:i}),{...e,droppable:{...e.droppable,containers:a}}}case Fn.UnregisterDroppable:{const{id:n,key:r}=t,i=e.droppable.containers.get(n);if(!i||r!==i.key)return e;const s=new Lc(e.droppable.containers);return s.delete(n),{...e,droppable:{...e.droppable,containers:s}}}default:return e}}function jX(e){let{disabled:t}=e;const{active:n,activatorEvent:r,draggableNodes:i}=E.useContext(op),s=Qg(r),a=Qg(n==null?void 0:n.id);return E.useEffect(()=>{if(!t&&!r&&s&&a!=null){if(!cy(s)||document.activeElement===s.target)return;const o=i.get(a);if(!o)return;const{activatorNode:l,node:u}=o;if(!l.current&&!u.current)return;requestAnimationFrame(()=>{for(const c of[l.current,u.current]){if(!c)continue;const h=HY(c);if(h){h.focus();break}}})}},[r,t,i,a,s]),null}function ZX(e,t){let{transform:n,...r}=t;return e!=null&&e.length?e.reduce((i,s)=>s({transform:i,...r}),n):n}function eJ(e){return E.useMemo(()=>({draggable:{...m0.draggable,...e==null?void 0:e.draggable},droppable:{...m0.droppable,...e==null?void 0:e.droppable},dragOverlay:{...m0.dragOverlay,...e==null?void 0:e.dragOverlay}}),[e==null?void 0:e.draggable,e==null?void 0:e.droppable,e==null?void 0:e.dragOverlay])}function tJ(e){let{activeNode:t,measure:n,initialRect:r,config:i=!0}=e;const s=E.useRef(!1),{x:a,y:o}=typeof i=="boolean"?{x:i,y:i}:i;us(()=>{if(!a&&!o||!t){s.current=!1;return}if(s.current||!r)return;const u=t==null?void 0:t.node.current;if(!u||u.isConnected===!1)return;const c=n(u),h=jD(c,r);if(a||(h.x=0),o||(h.y=0),s.current=!0,Math.abs(h.x)>0||Math.abs(h.y)>0){const p=ZD(u);p&&p.scrollBy({top:h.y,left:h.x})}},[t,a,o,r,n])}const cP=E.createContext({...zi,scaleX:1,scaleY:1});var Zs;(function(e){e[e.Uninitialized=0]="Uninitialized",e[e.Initializing=1]="Initializing",e[e.Initialized=2]="Initialized"})(Zs||(Zs={}));const nJ=E.memo(function(t){var n,r,i,s;let{id:a,accessibility:o,autoScroll:l=!0,children:u,sensors:c=qX,collisionDetection:h=sX,measuring:p,modifiers:m,...v}=t;const g=E.useReducer(QX,void 0,JX),[w,x]=g,[T,y]=KY(),[_,k]=E.useState(Zs.Uninitialized),S=_===Zs.Initialized,{draggable:{active:C,nodes:M,translate:F},droppable:{containers:b}}=w,V=C!=null?M.get(C):null,z=E.useRef({initial:null,translated:null}),ie=E.useMemo(()=>{var Nt;return C!=null?{id:C,data:(Nt=V==null?void 0:V.data)!=null?Nt:KX,rect:z}:null},[C,V]),Q=E.useRef(null),[se,de]=E.useState(null),[ae,ne]=E.useState(null),H=_f(v,Object.values(v)),fe=td("DndDescribedBy",a),xe=E.useMemo(()=>b.getEnabled(),[b]),L=eJ(p),{droppableRects:q,measureDroppableContainers:W,measuringScheduled:G}=NX(xe,{dragging:S,dependencies:[F.x,F.y],config:L.droppable}),ee=PX(M,C),Se=E.useMemo(()=>ae?jg(ae):null,[ae]),we=fn(),pe=bX(ee,L.draggable.measure);tJ({activeNode:C!=null?M.get(C):null,config:we.layoutShiftCompensation,initialRect:pe,measure:L.draggable.measure});const oe=JE(ee,L.draggable.measure,pe),Le=JE(ee?ee.parentElement:null),B=E.useRef({activatorEvent:null,active:null,activeNode:ee,collisionRect:null,collisions:null,droppableRects:q,draggableNodes:M,draggingNode:null,draggingNodeRect:null,droppableContainers:b,over:null,scrollableAncestors:[],scrollAdjustedTranslate:null}),st=b.getNodeFor((n=B.current.over)==null?void 0:n.id),Ue=GX({measure:L.dragOverlay.measure}),at=(r=Ue.nodeRef.current)!=null?r:ee,$e=S?(i=Ue.rect)!=null?i:oe:null,Re=!!(Ue.nodeRef.current&&Ue.rect),ht=BX(Re?null:oe),Dt=lP(at?Ur(at):null),tt=UX(S?st??ee:null),Kt=zX(tt),ve=ZX(m,{transform:{x:F.x-ht.x,y:F.y-ht.y,scaleX:1,scaleY:1},activatorEvent:ae,active:ie,activeNodeRect:oe,containerNodeRect:Le,draggingNodeRect:$e,over:B.current.over,overlayNodeRect:Ue.rect,scrollableAncestors:tt,scrollableAncestorRects:Kt,windowRect:Dt}),Ce=Se?$l(Se,F):null,Ne=VX(tt),Oe=jE(Ne),He=jE(Ne,[oe]),Je=$l(ve,Oe),Qe=$e?lX($e,ve):null,mt=ie&&Qe?h({active:ie,collisionRect:Qe,droppableRects:q,droppableContainers:xe,pointerCoordinates:Ce}):null,We=nX(mt,"id"),[Xe,Rt]=E.useState(null),yt=Re?ve:$l(ve,He),It=aX(yt,(s=Xe==null?void 0:Xe.rect)!=null?s:null,oe),Mt=E.useRef(null),bn=E.useCallback((Nt,bt)=>{let{sensor:Ut,options:ot}=bt;if(Q.current==null)return;const wt=M.get(Q.current);if(!wt)return;const be=Nt.nativeEvent,U=new Ut({active:Q.current,activeNode:wt,event:be,options:ot,context:B,onAbort(te){if(!M.get(te))return;const{onDragAbort:ue}=H.current,ye={id:te};ue==null||ue(ye),T({type:"onDragAbort",event:ye})},onPending(te,j,ue,ye){if(!M.get(te))return;const{onDragPending:Me}=H.current,A={id:te,constraint:j,initialCoordinates:ue,offset:ye};Me==null||Me(A),T({type:"onDragPending",event:A})},onStart(te){const j=Q.current;if(j==null)return;const ue=M.get(j);if(!ue)return;const{onDragStart:ye}=H.current,Fe={activatorEvent:be,active:{id:j,data:ue.data,rect:z}};io.unstable_batchedUpdates(()=>{ye==null||ye(Fe),k(Zs.Initializing),x({type:Fn.DragStart,initialCoordinates:te,active:j}),T({type:"onDragStart",event:Fe}),de(Mt.current),ne(be)})},onMove(te){x({type:Fn.DragMove,coordinates:te})},onEnd:Y(Fn.DragEnd),onCancel:Y(Fn.DragCancel)});Mt.current=U;function Y(te){return async function(){const{active:ue,collisions:ye,over:Fe,scrollAdjustedTranslate:Me}=B.current;let A=null;if(ue&&Me){const{cancelDrop:I}=H.current;A={activatorEvent:be,active:ue,collisions:ye,delta:Me,over:Fe},te===Fn.DragEnd&&typeof I=="function"&&await Promise.resolve(I(A))&&(te=Fn.DragCancel)}Q.current=null,io.unstable_batchedUpdates(()=>{x({type:te}),k(Zs.Uninitialized),Rt(null),de(null),ne(null),Mt.current=null;const I=te===Fn.DragEnd?"onDragEnd":"onDragCancel";if(A){const D=H.current[I];D==null||D(A),T({type:I,event:A})}})}}},[M]),Et=E.useCallback((Nt,bt)=>(Ut,ot)=>{const wt=Ut.nativeEvent,be=M.get(ot);if(Q.current!==null||!be||wt.dndKit||wt.defaultPrevented)return;const U={active:be};Nt(Ut,bt.options,U)===!0&&(wt.dndKit={capturedBy:bt.sensor},Q.current=ot,bn(Ut,bt))},[M,bn]),xn=IX(c,Et);HX(c),us(()=>{oe&&_===Zs.Initializing&&k(Zs.Initialized)},[oe,_]),E.useEffect(()=>{const{onDragMove:Nt}=H.current,{active:bt,activatorEvent:Ut,collisions:ot,over:wt}=B.current;if(!bt||!Ut)return;const be={active:bt,activatorEvent:Ut,collisions:ot,delta:{x:Je.x,y:Je.y},over:wt};io.unstable_batchedUpdates(()=>{Nt==null||Nt(be),T({type:"onDragMove",event:be})})},[Je.x,Je.y]),E.useEffect(()=>{const{active:Nt,activatorEvent:bt,collisions:Ut,droppableContainers:ot,scrollAdjustedTranslate:wt}=B.current;if(!Nt||Q.current==null||!bt||!wt)return;const{onDragOver:be}=H.current,U=ot.get(We),Y=U&&U.rect.current?{id:U.id,rect:U.rect.current,data:U.data,disabled:U.disabled}:null,te={active:Nt,activatorEvent:bt,collisions:Ut,delta:{x:wt.x,y:wt.y},over:Y};io.unstable_batchedUpdates(()=>{Rt(Y),be==null||be(te),T({type:"onDragOver",event:te})})},[We]),us(()=>{B.current={activatorEvent:ae,active:ie,activeNode:ee,collisionRect:Qe,collisions:mt,droppableRects:q,draggableNodes:M,draggingNode:at,draggingNodeRect:$e,droppableContainers:b,over:Xe,scrollableAncestors:tt,scrollAdjustedTranslate:Je},z.current={initial:$e,translated:Qe}},[ie,ee,mt,Qe,M,at,$e,q,b,Xe,tt,Je]),MX({...we,delta:F,draggingRect:Qe,pointerCoordinates:Ce,scrollableAncestors:tt,scrollableAncestorRects:Kt});const Wn=E.useMemo(()=>({active:ie,activeNode:ee,activeNodeRect:oe,activatorEvent:ae,collisions:mt,containerNodeRect:Le,dragOverlay:Ue,draggableNodes:M,droppableContainers:b,droppableRects:q,over:Xe,measureDroppableContainers:W,scrollableAncestors:tt,scrollableAncestorRects:Kt,measuringConfiguration:L,measuringScheduled:G,windowRect:Dt}),[ie,ee,oe,ae,mt,Le,Ue,M,b,q,Xe,W,tt,Kt,L,G,Dt]),Gn=E.useMemo(()=>({activatorEvent:ae,activators:xn,active:ie,activeNodeRect:oe,ariaDescribedById:{draggable:fe},dispatch:x,draggableNodes:M,over:Xe,measureDroppableContainers:W}),[ae,xn,ie,oe,x,fe,M,Xe,W]);return xt.createElement(QD.Provider,{value:y},xt.createElement(op.Provider,{value:Gn},xt.createElement(uP.Provider,{value:Wn},xt.createElement(cP.Provider,{value:It},u)),xt.createElement(jX,{disabled:(o==null?void 0:o.restoreFocus)===!1})),xt.createElement(JY,{...o,hiddenTextDescribedById:fe}));function fn(){const Nt=(se==null?void 0:se.autoScrollEnabled)===!1,bt=typeof l=="object"?l.enabled===!1:l===!1,Ut=S&&!Nt&&!bt;return typeof l=="object"?{...l,enabled:Ut}:{enabled:Ut}}}),rJ=E.createContext(null),e_="button",iJ="Draggable";function sJ(e){let{id:t,data:n,disabled:r=!1,attributes:i}=e;const s=td(iJ),{activators:a,activatorEvent:o,active:l,activeNodeRect:u,ariaDescribedById:c,draggableNodes:h,over:p}=E.useContext(op),{role:m=e_,roleDescription:v="draggable",tabIndex:g=0}=i??{},w=(l==null?void 0:l.id)===t,x=E.useContext(w?cP:rJ),[T,y]=dh(),[_,k]=dh(),S=$X(a,t),C=_f(n);us(()=>(h.set(t,{id:t,key:s,node:T,activatorNode:_,data:C}),()=>{const F=h.get(t);F&&F.key===s&&h.delete(t)}),[h,t]);const M=E.useMemo(()=>({role:m,tabIndex:g,"aria-disabled":r,"aria-pressed":w&&m===e_?!0:void 0,"aria-roledescription":v,"aria-describedby":c.draggable}),[r,m,g,w,v,c.draggable]);return{active:l,activatorEvent:o,activeNodeRect:u,attributes:M,isDragging:w,listeners:r?void 0:S,node:T,over:p,setNodeRef:y,setActivatorNodeRef:k,transform:x}}function aJ(){return E.useContext(uP)}const oJ="Droppable",lJ={timeout:25};function uJ(e){let{data:t,disabled:n=!1,id:r,resizeObserverConfig:i}=e;const s=td(oJ),{active:a,dispatch:o,over:l,measureDroppableContainers:u}=E.useContext(op),c=E.useRef({disabled:n}),h=E.useRef(!1),p=E.useRef(null),m=E.useRef(null),{disabled:v,updateMeasurementsFor:g,timeout:w}={...lJ,...i},x=_f(g??r),T=E.useCallback(()=>{if(!h.current){h.current=!0;return}m.current!=null&&clearTimeout(m.current),m.current=setTimeout(()=>{u(Array.isArray(x.current)?x.current:[x.current]),m.current=null},w)},[w]),y=ap({callback:T,disabled:v||!a}),_=E.useCallback((M,F)=>{y&&(F&&(y.unobserve(F),h.current=!1),M&&y.observe(M))},[y]),[k,S]=dh(_),C=_f(t);return E.useEffect(()=>{!y||!k.current||(y.disconnect(),h.current=!1,y.observe(k.current))},[k,y]),E.useEffect(()=>(o({type:Fn.RegisterDroppable,element:{id:r,key:s,disabled:n,node:k,rect:p,data:C}}),()=>o({type:Fn.UnregisterDroppable,key:s,id:r})),[r]),E.useEffect(()=>{n!==c.current.disabled&&(o({type:Fn.SetDroppableDisabled,id:r,key:s,disabled:n}),c.current.disabled=n)},[r,s,n,o]),{active:a,rect:p,isOver:(l==null?void 0:l.id)===r,node:k,over:l,setNodeRef:S}}function gh(e,t,n){const r=e.slice();return r.splice(n<0?r.length+n:n,0,r.splice(t,1)[0]),r}function cJ(e,t){return e.reduce((n,r,i)=>{const s=t.get(r);return s&&(n[i]=s),n},Array(e.length))}function zd(e){return e!==null&&e>=0}function fJ(e,t){if(e===t)return!0;if(e.length!==t.length)return!1;for(let n=0;n<e.length;n++)if(e[n]!==t[n])return!1;return!0}function dJ(e){return typeof e=="boolean"?{draggable:e,droppable:e}:e}const fP=e=>{let{rects:t,activeIndex:n,overIndex:r,index:i}=e;const s=gh(t,r,n),a=t[i],o=s[i];return!o||!a?null:{x:o.left-a.left,y:o.top-a.top,scaleX:o.width/a.width,scaleY:o.height/a.height}},Wd={scaleX:1,scaleY:1},hJ=e=>{var t;let{activeIndex:n,activeNodeRect:r,index:i,rects:s,overIndex:a}=e;const o=(t=s[n])!=null?t:r;if(!o)return null;if(i===n){const u=s[a];return u?{x:0,y:n<a?u.top+u.height-(o.top+o.height):u.top-o.top,...Wd}:null}const l=pJ(s,i,n);return i>n&&i<=a?{x:0,y:-o.height-l,...Wd}:i<n&&i>=a?{x:0,y:o.height+l,...Wd}:{x:0,y:0,...Wd}};function pJ(e,t,n){const r=e[t],i=e[t-1],s=e[t+1];return r?n<t?i?r.top-(i.top+i.height):s?s.top-(r.top+r.height):0:s?s.top-(r.top+r.height):i?r.top-(i.top+i.height):0:0}const dP="Sortable",hP=xt.createContext({activeIndex:-1,containerId:dP,disableTransforms:!1,items:[],overIndex:-1,useDragOverlay:!1,sortedRects:[],strategy:fP,disabled:{draggable:!1,droppable:!1}});function mJ(e){let{children:t,id:n,items:r,strategy:i=fP,disabled:s=!1}=e;const{active:a,dragOverlay:o,droppableRects:l,over:u,measureDroppableContainers:c}=aJ(),h=td(dP,n),p=o.rect!==null,m=E.useMemo(()=>r.map(S=>typeof S=="object"&&"id"in S?S.id:S),[r]),v=a!=null,g=a?m.indexOf(a.id):-1,w=u?m.indexOf(u.id):-1,x=E.useRef(m),T=!fJ(m,x.current),y=w!==-1&&g===-1||T,_=dJ(s);us(()=>{T&&v&&c(m)},[T,m,v,c]),E.useEffect(()=>{x.current=m},[m]);const k=E.useMemo(()=>({activeIndex:g,containerId:h,disabled:_,disableTransforms:y,items:m,overIndex:w,useDragOverlay:p,sortedRects:cJ(m,l),strategy:i}),[g,h,_.draggable,_.droppable,y,m,w,l,p,i]);return xt.createElement(hP.Provider,{value:k},t)}const gJ=e=>{let{id:t,items:n,activeIndex:r,overIndex:i}=e;return gh(n,r,i).indexOf(t)},vJ=e=>{let{containerId:t,isSorting:n,wasDragging:r,index:i,items:s,newIndex:a,previousItems:o,previousContainerId:l,transition:u}=e;return!u||!r||o!==s&&i===a?!1:n?!0:a!==i&&t===l},xJ={duration:200,easing:"ease"},pP="transform",yJ=Cf.Transition.toString({property:pP,duration:0,easing:"linear"}),wJ={roleDescription:"sortable"};function TJ(e){let{disabled:t,index:n,node:r,rect:i}=e;const[s,a]=E.useState(null),o=E.useRef(n);return us(()=>{if(!t&&n!==o.current&&r.current){const l=i.current;if(l){const u=Pu(r.current,{ignoreTransform:!0}),c={x:l.left-u.left,y:l.top-u.top,scaleX:l.width/u.width,scaleY:l.height/u.height};(c.x||c.y)&&a(c)}}n!==o.current&&(o.current=n)},[t,n,r,i]),E.useEffect(()=>{s&&a(null)},[s]),s}function SJ(e){let{animateLayoutChanges:t=vJ,attributes:n,disabled:r,data:i,getNewIndex:s=gJ,id:a,strategy:o,resizeObserverConfig:l,transition:u=xJ}=e;const{items:c,containerId:h,activeIndex:p,disabled:m,disableTransforms:v,sortedRects:g,overIndex:w,useDragOverlay:x,strategy:T}=E.useContext(hP),y=EJ(r,m),_=c.indexOf(a),k=E.useMemo(()=>({sortable:{containerId:h,index:_,items:c},...i}),[h,i,_,c]),S=E.useMemo(()=>c.slice(c.indexOf(a)),[c,a]),{rect:C,node:M,isOver:F,setNodeRef:b}=uJ({id:a,data:k,disabled:y.droppable,resizeObserverConfig:{updateMeasurementsFor:S,...l}}),{active:V,activatorEvent:z,activeNodeRect:ie,attributes:Q,setNodeRef:se,listeners:de,isDragging:ae,over:ne,setActivatorNodeRef:H,transform:fe}=sJ({id:a,data:k,attributes:{...wJ,...n},disabled:y.draggable}),xe=OY(b,se),L=!!V,q=L&&!v&&zd(p)&&zd(w),W=!x&&ae,G=W&&q?fe:null,Se=q?G??(o??T)({rects:g,activeNodeRect:ie,activeIndex:p,overIndex:w,index:_}):null,we=zd(p)&&zd(w)?s({id:a,items:c,activeIndex:p,overIndex:w}):_,pe=V==null?void 0:V.id,oe=E.useRef({activeId:pe,items:c,newIndex:we,containerId:h}),Le=c!==oe.current.items,B=t({active:V,containerId:h,isDragging:ae,isSorting:L,id:a,index:_,items:c,newIndex:oe.current.newIndex,previousItems:oe.current.items,previousContainerId:oe.current.containerId,transition:u,wasDragging:oe.current.activeId!=null}),st=TJ({disabled:!B,index:_,node:M,rect:C});return E.useEffect(()=>{L&&oe.current.newIndex!==we&&(oe.current.newIndex=we),h!==oe.current.containerId&&(oe.current.containerId=h),c!==oe.current.items&&(oe.current.items=c)},[L,we,h,c]),E.useEffect(()=>{if(pe===oe.current.activeId)return;if(pe&&!oe.current.activeId){oe.current.activeId=pe;return}const at=setTimeout(()=>{oe.current.activeId=pe},50);return()=>clearTimeout(at)},[pe]),{active:V,activeIndex:p,attributes:Q,data:k,rect:C,index:_,newIndex:we,items:c,isOver:F,isSorting:L,isDragging:ae,listeners:de,node:M,overIndex:w,over:ne,setNodeRef:xe,setActivatorNodeRef:H,setDroppableNodeRef:b,setDraggableNodeRef:se,transform:st??Se,transition:Ue()};function Ue(){if(st||Le&&oe.current.newIndex===_)return yJ;if(!(W&&!cy(z)||!u)&&(L||B))return Cf.Transition.toString({...u,property:pP})}}function EJ(e,t){var n,r;return typeof e=="boolean"?{draggable:e,droppable:!1}:{draggable:(n=e==null?void 0:e.draggable)!=null?n:t.draggable,droppable:(r=e==null?void 0:e.droppable)!=null?r:t.droppable}}Pt.Down,Pt.Right,Pt.Up,Pt.Left;const _J={Title:!0,"First Name":!0,Surname:!0,"Other Names":!0,"Membership Number":!0},my=["Maranatha","Central","Ayiresu","Adatoh","Adawukwao","Larbie","Osae-Krodua","Holy-Ghost","Fante-Mayera"],t_="tactmsAutoSaveDraft",CJ=3e3,kJ=20,n_="tactms-theme",r_="tactms-accent-color",i_="tactmsDefaultConcatConfig",s_="tactmsFavorites",a_="tactmsTransactionLog",o_="tactmsColumnVisibility",l_="tactmsMemberDatabase",AJ="AIzaSyCc8wwsp9E7PuNUu20Svoc_wSaSQXtMbjM",RJ="740397119523-grs2e9os9d7f5055stvqfcg63bvim4va.apps.googleusercontent.com",MJ="https://www.googleapis.com/auth/drive.file",FJ="tactms.app.favorites.json",DJ="tactms.app.transactions.json",nv=[{name:"Default Purple",key:"purple",values:{h:262,s:83,l:58}},{name:"Ocean Blue",key:"blue",values:{h:217,s:91,l:60}},{name:"Forest Green",key:"green",values:{h:142,s:71,l:45}},{name:"Sunset Gold",key:"gold",values:{h:45,s:93,l:47}},{name:"Crimson Red",key:"red",values:{h:347,s:89,l:48}}],mP=xt.memo(({text:e,highlight:t})=>{if(!t||!e)return R.jsx(R.Fragment,{children:e});const n=t.toLowerCase().split(" ").filter(Boolean);if(n.length===0)return R.jsx(R.Fragment,{children:e});const r=new RegExp(`(${n.join("|")})`,"gi"),i=e.split(r);return R.jsx(R.Fragment,{children:i.map((s,a)=>n.includes(s.toLowerCase())?R.jsx("mark",{className:"bg-[var(--primary-accent-start)] text-[var(--text-on-accent)] px-0.5 rounded-sm",children:s},a):s)})});mP.displayName="HighlightMatches";const gP=({record:e,visualIndex:t,handleDeleteTitheRecord:n,startEditing:r,editingCell:i,editedValue:s,setEditedValue:a,saveEdit:o,cancelEdit:l,toggleRowSelection:u,isSelected:c,navigateToNextAmountCellForEditing:h,visibleTableHeaders:p,searchTerm:m})=>{const{attributes:v,listeners:g,setNodeRef:w,transform:x,transition:T,isDragging:y}=SJ({id:e["No."]}),_={transform:Cf.Transform.toString(x),transition:T,zIndex:y?10:"auto",opacity:y?.7:1},k=(C,M)=>{if((i==null?void 0:i.recordId)===e["No."]&&(i==null?void 0:i.field)===C)return C==="Transaction Date ('DD-MMM-YYYY')"?R.jsx("input",{type:"date",value:s,onChange:b=>a(b.target.value),onBlur:o,onKeyDown:b=>{b.key==="Enter"&&o(),b.key==="Escape"&&l()},autoFocus:!0,className:"form-input-light editable-cell-input text-xs p-1"}):R.jsx("input",{type:C==="Transaction Amount"?"number":"text",value:s,onChange:b=>a(b.target.value),onBlur:o,onKeyDown:b=>{b.key==="Enter"&&o(),b.key==="Escape"&&l(),C==="Transaction Amount"&&(b.key==="Tab"||b.key==="ArrowDown"?(b.preventDefault(),o(),h(e["No."],"down")):b.key==="ArrowUp"&&(b.preventDefault(),o(),h(e["No."],"up")))},autoFocus:!0,className:"form-input-light editable-cell-input text-xs p-1"});const F=String(M);return R.jsx("span",{className:"truncate block max-w-[180px]",title:F,children:R.jsx(mP,{text:F,highlight:m})})},S=["Membership Number","Transaction Date ('DD-MMM-YYYY')","Transaction Amount","Narration/Description"];return R.jsxs("tr",{ref:w,style:_,className:`${c?"selected-row":""} ${y?"shadow-lg bg-[var(--bg-card)]":""}`,id:`row-${e["No."]}`,children:[R.jsx("td",{className:"p-2 align-middle text-center",children:R.jsx("button",{...g,...v,className:"drag-handle p-1 text-[var(--text-muted)] hover:text-[var(--text-primary)] cursor-grab active:cursor-grabbing",children:R.jsx(gB,{size:16})})}),R.jsx("td",{className:"p-2 align-middle",children:R.jsx("input",{type:"checkbox",className:"form-checkbox h-4 w-4 text-[var(--primary-accent-start)] border-[var(--border-color)] rounded focus:ring-[var(--primary-accent-start)] focus:ring-offset-[var(--bg-card)]",checked:c,onChange:()=>u(e["No."]),"aria-label":`Select row ${t}`})}),R.jsx("td",{className:"p-2 align-middle text-xs text-center",children:t}),p.map(C=>R.jsx("td",{className:"p-2 align-middle text-xs",onDoubleClick:()=>S.includes(C)&&r(e["No."],C),children:k(C,e[C])},C)),R.jsx("td",{className:"p-2 align-middle text-xs",children:R.jsx("div",{className:"flex items-center justify-center gap-1",children:R.jsx(Gt,{size:"icon",variant:"ghost",onClick:()=>n(e["No."]),className:"!p-1.5",title:"Delete Record",children:R.jsx(x1,{size:16,className:"text-[var(--danger-text)]"})})})})]})};gP.displayName="TitheRecordRow";const vP=e=>{const{isOpen:t,onClose:n,titheListData:r,onSave:i,addToast:s,searchTerm:a,setSearchTerm:o,sortConfig:l,setSortConfig:u,openAddMemberToListModal:c}=e,[h,p]=E.useState([]),[m,v]=E.useState(!1),[g,w]=E.useState(null),[x,T]=E.useState(""),[y,_]=E.useState(new Set),[k,S]=E.useState(a),[C,M]=E.useState("1"),[F,b]=E.useState(null),[V,z]=E.useState(null),ie=E.useRef(null),[Q,se]=E.useState(!1),de=E.useRef(null),ae=E.useRef(null),ne=E.useRef(null),H=E.useRef(0),fe=jY(QY(py,{activationConstraint:{distance:8}}));E.useEffect(()=>{t&&(p(JSON.parse(JSON.stringify(r))),v(!1))},[t,r]);const xe=E.useMemo(()=>h[0]?Object.keys(h[0]).filter(ve=>ve!=="No."):[],[h]),[L,q]=E.useState(()=>{try{const Ce=localStorage.getItem(o_);if(Ce){const Ne=JSON.parse(Ce),Oe={};return xe.forEach(He=>{Oe[He]=Ne[He]??!1}),Oe}}catch(Ce){console.error("Failed to parse column visibility settings",Ce)}const ve={};return xe.forEach(Ce=>{ve[Ce]=["Membership Number","Transaction Date ('DD-MMM-YYYY')","Transaction Amount"].includes(Ce)}),ve}),W=E.useMemo(()=>xe.filter(ve=>L[ve]??!0),[xe,L]);E.useEffect(()=>{localStorage.setItem(o_,JSON.stringify(L))},[L]),E.useEffect(()=>{const ve=Ce=>{de.current&&!de.current.contains(Ce.target)&&ae.current&&!ae.current.contains(Ce.target)&&se(!1)};return Q&&document.addEventListener("mousedown",ve),()=>{document.removeEventListener("mousedown",ve)}},[Q]),E.useEffect(()=>{const ve=setTimeout(()=>{o(k)},300);return()=>{clearTimeout(ve)}},[k,o]);const G=E.useMemo(()=>{let ve=[...h];if(a){const Ce=a.toLowerCase().split(" ").filter(Boolean);ve=ve.filter(Ne=>{const Oe=Object.values(Ne).join(" ").toLowerCase();return Ce.every(He=>Oe.includes(He))})}if(l){const{key:Ce,direction:Ne}=l;ve.sort((Oe,He)=>{const Je=Oe[Ce],Qe=He[Ce],mt=Je===""||Je==null?Ne==="asc"?1/0:-1/0:Number(Je),We=Qe===""||Qe==null?Ne==="asc"?1/0:-1/0:Number(Qe);if(Ce==="Transaction Amount"&&!isNaN(mt)&&!isNaN(We))return Ne==="asc"?mt-We:We-mt;const Xe=String(Je).toLowerCase(),Rt=String(Qe).toLowerCase();return Xe<Rt?Ne==="asc"?-1:1:Xe>Rt?Ne==="asc"?1:-1:0})}return ve},[h,a,l]),ee=E.useMemo(()=>G,[G]),Se=E.useCallback(ve=>{const{active:Ce,over:Ne}=ve;Ne&&Ce.id!==Ne.id&&(p(Oe=>{const He=Oe.findIndex(Qe=>Qe["No."]===Ce.id),Je=Oe.findIndex(Qe=>Qe["No."]===Ne.id);return gh(Oe,He,Je)}),v(!0),l&&(u(null),s("Sorting has been cleared due to manual reordering.","info",4e3)))},[s,l,u]),we=E.useCallback((ve,Ce,Ne)=>{p(Oe=>Oe.map(He=>He["No."]===ve?{...He,[Ce]:Ne}:He)),v(!0)},[]),pe=E.useCallback(()=>{V&&(p(ve=>{const Ce=[...ve];return V.items.sort((Oe,He)=>He.index-Oe.index).forEach(({record:Oe,index:He})=>{Ce.splice(He,0,Oe)}),Ce}),v(!0),s(`${V.items.length} record(s) restored.`,"success"),z(null))},[V,s]),oe=E.useCallback(ve=>{const Ce=h.findIndex(He=>He["No."]===ve);if(Ce===-1)return;const Ne=h[Ce];z({items:[{record:Ne,index:Ce}]}),p(He=>He.filter(Je=>Je["No."]!==ve)),_(He=>{const Je=new Set(He);return Je.delete(ve),Je}),v(!0),s("Record deleted.","info",1/0,[{label:"Undo",onClick:pe,variant:"primary"}])},[h,s,pe]),Le=E.useCallback((ve,Ce)=>{const Ne=h.find(He=>He["No."]===ve);if(!Ne)return;let Oe=String(Ne[Ce]??"");if(Ce==="Transaction Date ('DD-MMM-YYYY')")try{const He=new Date(Oe);isNaN(He.getTime())?Oe=new Date().toISOString().split("T")[0]:Oe=He.toISOString().split("T")[0]}catch{Oe=new Date().toISOString().split("T")[0]}w({recordId:ve,field:Ce}),T(Oe)},[h]),B=E.useCallback(()=>{if(!g)return;const{recordId:ve,field:Ce}=g,Ne=h.find(Oe=>Oe["No."]===ve);if(!Ne){w(null);return}if(Ce==="Transaction Amount"){const Oe=parseFloat(x);if(x.trim()!==""&&(isNaN(Oe)||Oe<0)){s("Invalid amount. Must be non-negative or empty.","error");return}const He=x.trim()===""?"":Oe;we(ve,Ce,He)}else if(Ce==="Transaction Date ('DD-MMM-YYYY')")try{const Oe=new Date(x);if(isNaN(Oe.getTime()))throw new Error("Invalid date");const He=new Date(Oe.getTime()+Oe.getTimezoneOffset()*6e4),Je=eo(He),Qe=Ne["Narration/Description"].includes("{DD-MMM-YYYY}")?Ne["Narration/Description"].replace(/{DD-MMM-YYYY}/gi,Je):Ne["Narration/Description"];p(mt=>mt.map(We=>We["No."]===ve?{...We,"Transaction Date ('DD-MMM-YYYY')":Je,"Narration/Description":Qe}:We)),v(!0)}catch{s(`Invalid date format for ${x}. Use YYYY-MM-DD.`,"error");return}else we(ve,Ce,x);w(null)},[g,x,we,s,h]),st=E.useCallback(()=>w(null),[]),Ue=E.useCallback(()=>{if(!F)return;const ve=parseInt(C,10);if(isNaN(ve)||ve<1||ve>h.length+1){s("Invalid target position.","error"),b(null);return}const Ce=h.findIndex(Oe=>Oe["No."]===F["No."]),Ne=ve-1;Ce!==-1&&(p(Oe=>gh(Oe,Ce,Ne)),v(!0),s(`Moved "${F["Membership Number"]}" to position ${ve}.`,"success"),M(String(Math.min(ve+1,h.length))),S(""),b(null))},[F,C,h,s]);E.useEffect(()=>{a&&!l&&ee.length===1?b(ee[0]):b(null)},[ee,a,l]);const at=E.useCallback(ve=>{_(Ce=>{const Ne=new Set(Ce);return Ne.has(ve)?Ne.delete(ve):Ne.add(ve),Ne})},[]),$e=E.useCallback(()=>{const ve=ee;y.size===ve.length&&ve.length>0?_(new Set):_(new Set(ve.map(Ce=>Ce["No."])))},[y,ee]),Re=E.useCallback(()=>{if(y.size===0){s("No rows selected for deletion.","warning");return}const ve=[];h.forEach((Ne,Oe)=>{y.has(Ne["No."])&&ve.push({record:Ne,index:Oe})}),z({items:ve}),p(Ne=>Ne.filter(Oe=>!y.has(Oe["No."]))),v(!0);const Ce={label:"Undo",onClick:pe,variant:"primary"};s(`${y.size} record(s) deleted.`,"info",1/0,[Ce]),_(new Set)},[y,h,s,pe]),ht=E.useCallback((ve,Ce)=>{const Ne=ee.findIndex(He=>He["No."]===ve);if(Ne===-1)return;let Oe=Ce==="down"?Ne+1:Ne-1;Oe>=0&&Oe<ee.length&&Le(ee[Oe]["No."],"Transaction Amount")},[ee,Le]);E.useEffect(()=>{if(ie.current){const ve=ee,Ce=ve.filter(Oe=>y.has(Oe["No."])).length,Ne=ve.length;ie.current.indeterminate=Ne>0&&Ce>0&&Ce<Ne,ie.current.checked=Ne>0&&Ce===Ne}},[y,ee]);const Dt=ve=>{if(ve==="No.")return;let Ce="asc";(l==null?void 0:l.key)===ve&&l.direction==="asc"&&(Ce="desc"),u({key:ve,direction:Ce})};E.useEffect(()=>{if(t&&h.length>H.current){const ve=setTimeout(()=>{ne.current&&(ne.current.scrollTop=ne.current.scrollHeight)},150);return()=>clearTimeout(ve)}H.current=h.length},[t,h]),E.useEffect(()=>{t?(S(a),H.current=r.length):(_(new Set),w(null),z(null),se(!1),b(null))},[t,a,r.length]);const tt=()=>{g&&B(),i(h)},Kt=m?"Full Tithe List Preview & Edit *":"Full Tithe List Preview & Edit";return R.jsx(Ms,{isOpen:t,onClose:n,title:Kt,size:"xxl",footerContent:R.jsxs(R.Fragment,{children:[R.jsx(Gt,{onClick:n,variant:"outline",size:"md",children:"Close"}),R.jsx(Gt,{onClick:tt,variant:"primary",size:"md",disabled:!m,leftIcon:R.jsx(bM,{size:16}),children:"Save & Apply Changes"})]}),children:R.jsx(nJ,{sensors:fe,collisionDetection:rX,onDragEnd:Se,children:R.jsxs("div",{className:"space-y-4 relative",children:[R.jsxs("div",{className:"table-toolbar",children:[R.jsxs("div",{className:"actions-group",children:[R.jsx(Gt,{onClick:c,size:"sm",variant:"primary",leftIcon:R.jsx(y1,{size:16}),children:"Add Member"}),R.jsxs(Gt,{onClick:Re,size:"sm",variant:"danger",leftIcon:R.jsx(x1,{size:16}),disabled:y.size===0,children:["Del Sel (",y.size,")"]})]}),R.jsxs("div",{className:"flex items-center gap-2 flex-grow",children:[R.jsxs("div",{className:"actions-group relative",children:[R.jsx(Gt,{ref:ae,onClick:()=>se(ve=>!ve),size:"sm",variant:"subtle",leftIcon:R.jsx(hB,{size:16}),children:"Columns"}),R.jsx(ks,{children:Q&&R.jsxs(dr.div,{ref:de,initial:{opacity:0,scale:.95,y:-10},animate:{opacity:1,scale:1,y:0},exit:{opacity:0,scale:.95,y:-10},className:"absolute top-full mt-2 -right-12 w-64 bg-[var(--bg-elevated)] border border-[var(--border-color)] rounded-lg shadow-2xl z-50 p-4 origin-top-right",children:[R.jsx("h4",{className:"text-sm font-semibold mb-3 text-[var(--text-primary)]",children:"Visible Columns"}),R.jsx("div",{className:"space-y-2 max-h-60 overflow-y-auto pr-2",children:xe.map(ve=>R.jsxs("label",{className:"flex items-center space-x-3 cursor-pointer text-xs text-[var(--text-secondary)] hover:text-[var(--text-primary)]",children:[R.jsx("input",{type:"checkbox",checked:L[ve]??!0,onChange:()=>q(Ce=>({...Ce,[ve]:!(Ce[ve]??!0)})),className:"form-checkbox h-4 w-4 text-[var(--primary-accent-start)] bg-[var(--input-bg)] border-[var(--border-color)] rounded focus:ring-[var(--primary-accent-start)] focus:ring-offset-[var(--bg-elevated)]"}),R.jsx("span",{children:ve.replace(" ('DD-MMM-YYYY')","").replace("Membership Number","Member Details")})]},ve))})]})})]}),R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx("label",{htmlFor:"target-pos-input",className:"text-sm font-medium text-[var(--text-secondary)] whitespace-nowrap",children:"Target Pos:"}),R.jsx("input",{id:"target-pos-input",type:"number",min:"1",max:h.length||1,value:C,onChange:ve=>M(ve.target.value),className:"form-input-light text-sm w-20 py-1.5","aria-label":"Target position for reorder"})]}),R.jsx(Xh,{size:20,className:"text-[var(--text-muted)]"}),R.jsx("input",{type:"text",placeholder:`Search ${G.length} records...`,value:k,onChange:ve=>S(ve.target.value),onKeyDown:ve=>{ve.key==="Enter"&&F?(ve.preventDefault(),Ue()):ve.key==="Escape"&&b(null)},className:"form-input-light text-sm w-full sm:w-auto sm:flex-grow py-1.5","aria-label":"Search tithe list records"})]})]}),R.jsx(ks,{children:F&&R.jsxs(dr.div,{initial:{opacity:0,y:-10},animate:{opacity:1,y:0},exit:{opacity:0,y:-10},className:"p-2.5 bg-[var(--primary-accent-start)]/10 border border-[var(--primary-accent-start)]/30 rounded-lg text-sm text-center",children:["Move"," ",R.jsx("strong",{className:"text-[var(--text-primary)]",children:F["Membership Number"]})," ","to position"," ",R.jsx("strong",{className:"text-[var(--text-primary)]",children:C}),"? Press Enter to confirm."]})}),R.jsx("div",{className:"overflow-y-auto border border-[var(--border-color)] rounded-lg shadow-md bg-[var(--bg-elevated)] max-h-[60vh]",ref:ne,children:R.jsxs("table",{className:"min-w-full text-sm modern-table",children:[R.jsx("caption",{className:"sr-only",children:"Tithe list for editing. Can be sorted and reordered."}),R.jsx("thead",{className:"bg-[var(--bg-card-subtle-accent)] sticky top-0 z-10",children:R.jsxs("tr",{children:[R.jsx("th",{scope:"col",className:"p-2 w-10","aria-label":"Drag to reorder"}),R.jsx("th",{scope:"col",className:"p-2 w-10",children:R.jsx("input",{type:"checkbox",className:"form-checkbox",ref:ie,onChange:$e,"aria-label":"Select all rows"})}),R.jsx("th",{scope:"col",className:"p-2 w-12 text-center",onClick:()=>Dt("No."),style:{cursor:"pointer"},children:"#"}),W.map(ve=>R.jsxs("th",{scope:"col",className:"p-2 text-left",onClick:()=>Dt(ve),style:{cursor:"pointer"},children:[ve.replace(" ('DD-MMM-YYYY')","").replace("Membership Number","Member Details"),(l==null?void 0:l.key)===ve&&(l.direction==="asc"?" ":" ")]},ve)),R.jsx("th",{scope:"col",className:"p-2 text-center",children:"Actions"})]})}),R.jsx(mJ,{items:G.map(ve=>ve["No."]),strategy:hJ,children:R.jsx("tbody",{children:ee.length>0?ee.map(ve=>R.jsx(gP,{record:ve,visualIndex:h.findIndex(Ce=>Ce["No."]===ve["No."])+1,handleDeleteTitheRecord:oe,startEditing:Le,editingCell:g,editedValue:x,setEditedValue:T,saveEdit:B,cancelEdit:st,toggleRowSelection:at,isSelected:y.has(ve["No."]),navigateToNextAmountCellForEditing:ht,visibleTableHeaders:W,searchTerm:a},ve["No."])):R.jsx("tr",{children:R.jsx("td",{colSpan:W.length+5,className:"p-8 text-center text-[var(--text-muted)]",children:a?"No records match your search.":"The list is empty."})})})})]})})]})})})};vP.displayName="FullTithePreviewModal";const PJ=xt.memo(vP),ol=({name:e,label:t,value:n,onChange:r,error:i,required:s,placeholder:a})=>R.jsxs("div",{children:[R.jsxs("label",{htmlFor:`field-${String(e)}`,className:"form-label",children:[t," ",s&&"*"]}),R.jsx("input",{id:`field-${String(e)}`,name:String(e),type:"text",value:n,onChange:r,placeholder:a,className:`form-input-light ${i?"input-error":""}`}),i&&R.jsx("p",{className:"form-error-text",children:i})]}),IJ=({isOpen:e,onClose:t,onConfirm:n,onAddExistingMember:r,currentAssembly:i,memberDatabase:s,titheListData:a})=>{const[o,l]=E.useState("search"),[u,c]=E.useState(""),[h,p]=E.useState({}),[m,v]=E.useState({}),g=E.useMemo(()=>new Set(a.map(_=>_["No."])),[a]),w=E.useMemo(()=>{if(!u.trim())return[];if(!s)return[];const _=u.toLowerCase();return s.filter(k=>{if(k["No."]&&g.has(k["No."]))return!1;const S=`${k["First Name"]||""} ${k.Surname||""}`.toLowerCase(),C=(k["Membership Number"]||"").toLowerCase();return S.includes(_)||C.includes(_)}).slice(0,15)},[u,s,g]);E.useEffect(()=>{e&&(l("search"),c(""),p({}),v({}))},[e]);const x=()=>{var k,S,C;const _={};if((k=h["First Name"])!=null&&k.trim()||(_["First Name"]="First Name is required."),(S=h.Surname)!=null&&S.trim()||(_.Surname="Surname is required."),(C=h["Membership Number"])!=null&&C.trim()||(_["Membership Number"]="Membership Number is required."),v(_),Object.keys(_).length===0){const M={"No.":`new_${Date.now()}`,Title:h.Title||"","First Name":h["First Name"]||"",Surname:h.Surname||"","Other Names":h["Other Names"]||"","Membership Number":h["Membership Number"]||"","Phone Number":h["Phone Number"]||""};n(M),p({})}},T=_=>{r(_),c(k=>k+" "),setTimeout(()=>c(k=>k.trim()),0)},y=_=>{const{name:k,value:S}=_.target;p(C=>({...C,[k]:S})),m[k]&&v(C=>{const M={...C};return delete M[k],M})};return R.jsxs(Ms,{isOpen:e,onClose:t,title:`Add Member to List for ${i} Assembly`,size:"lg",footerContent:R.jsx(Gt,{variant:"primary",onClick:t,children:"Done"}),children:[R.jsxs("div",{className:"flex border-b border-[var(--border-color)] mb-4",children:[R.jsx("button",{onClick:()=>l("search"),className:`px-4 py-2 text-sm font-medium transition-colors ${o==="search"?"border-b-2 border-[var(--primary-accent-start)] text-[var(--primary-accent-start)]":"text-[var(--text-secondary)] hover:text-[var(--text-primary)]"}`,children:"Search Existing"}),R.jsx("button",{onClick:()=>l("create"),className:`px-4 py-2 text-sm font-medium transition-colors ${o==="create"?"border-b-2 border-[var(--primary-accent-start)] text-[var(--primary-accent-start)]":"text-[var(--text-secondary)] hover:text-[var(--text-primary)]"}`,children:"Create New"})]}),o==="search"&&R.jsxs("div",{className:"space-y-4 min-h-[300px]",children:[R.jsxs("div",{className:"relative",children:[R.jsx(Xh,{className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]",size:20}),R.jsx("input",{type:"text",placeholder:"Search by name or membership ID...",value:u,onChange:_=>c(_.target.value),className:"form-input-light w-full !pl-10",autoFocus:!0})]}),u&&w.length>0&&R.jsx("ul",{className:"space-y-2 max-h-64 overflow-y-auto pr-2",children:w.map(_=>R.jsxs("li",{className:"p-2 flex items-center justify-between bg-[var(--bg-elevated)] rounded-md border border-[var(--border-color)]",children:[R.jsxs("div",{children:[R.jsx("p",{className:"font-semibold text-[var(--text-primary)]",children:`${_["First Name"]||""} ${_.Surname||""}`}),R.jsxs("p",{className:"text-xs text-[var(--text-muted)]",children:["ID: ",_["Membership Number"]]})]}),R.jsx(Gt,{size:"sm",variant:"outline",onClick:()=>T(_),leftIcon:R.jsx(fB,{size:14}),children:"Add to list"})]},_["No."]))}),u&&w.length===0&&R.jsx("p",{className:"text-center text-sm text-[var(--text-muted)] pt-8",children:"No matching members found in the current workspace data, or they are already in the list. Try the 'Create New' tab."}),!u&&R.jsx("p",{className:"text-center text-sm text-[var(--text-muted)] pt-8",children:"Start typing to search for members to add."})]}),o==="create"&&R.jsxs("div",{className:"space-y-4",children:[R.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Use this form for a brand new convert not in the master database. They will be added to the database and the current tithe list."}),R.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:[R.jsx(ol,{name:"Title",label:"Title",value:String(h.Title??""),onChange:y,placeholder:"e.g., Bro, Sis, Mr, Mrs"}),R.jsx(ol,{name:"Membership Number",label:"Membership Number",value:String(h["Membership Number"]??""),onChange:y,error:m["Membership Number"],required:!0,placeholder:"e.g., JK-CEN-001"}),R.jsx(ol,{name:"First Name",label:"First Name",value:String(h["First Name"]??""),onChange:y,error:m["First Name"],required:!0}),R.jsx(ol,{name:"Surname",label:"Surname",value:String(h.Surname??""),onChange:y,error:m.Surname,required:!0}),R.jsx(ol,{name:"Other Names",label:"Other Names",value:String(h["Other Names"]??""),onChange:y}),R.jsx(ol,{name:"Phone Number",label:"Phone Number",value:String(h["Phone Number"]??""),onChange:y})]}),R.jsx("div",{className:"flex justify-end pt-2",children:R.jsx(Gt,{onClick:x,variant:"primary",leftIcon:R.jsx(y1,{size:16}),children:"Add New Member"})})]})]})},NJ=({isOpen:e,onClose:t,onConfirm:n,memberCount:r,assemblyName:i})=>e?R.jsx("div",{className:"modal-backdrop",children:R.jsxs("div",{className:"modal-content",children:[R.jsx("h2",{children:"Create Tithe List?"}),R.jsxs("p",{children:["Create a new tithe list for ",i," with ",r," members?"]}),R.jsxs("div",{className:"modal-actions",children:[R.jsx("button",{onClick:t,children:"Cancel"}),R.jsx("button",{onClick:n,children:"Confirm"})]})]})}):null,bJ=async e=>{"serviceWorker"in navigator&&navigator.serviceWorker.controller&&navigator.serviceWorker.controller.postMessage({type:"QUEUE_ANALYTICS_EVENT",payload:e})};/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */let LJ,OJ;function BJ(){return{geminiUrl:LJ,vertexUrl:OJ}}function UJ(e,t,n,r){var i,s;if(!(e!=null&&e.baseUrl)){const a=BJ();return t?(i=a.vertexUrl)!==null&&i!==void 0?i:n:(s=a.geminiUrl)!==null&&s!==void 0?s:r}return e.baseUrl}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class el{}function qe(e,t){const n=/\{([^}]+)\}/g;return e.replace(n,(r,i)=>{if(Object.prototype.hasOwnProperty.call(t,i)){const s=t[i];return s!=null?String(s):""}else throw new Error(`Key '${i}' not found in valueMap.`)})}function d(e,t,n){for(let s=0;s<t.length-1;s++){const a=t[s];if(a.endsWith("[]")){const o=a.slice(0,-2);if(!(o in e))if(Array.isArray(n))e[o]=Array.from({length:n.length},()=>({}));else throw new Error(`Value must be a list given an array path ${a}`);if(Array.isArray(e[o])){const l=e[o];if(Array.isArray(n))for(let u=0;u<l.length;u++){const c=l[u];d(c,t.slice(s+1),n[u])}else for(const u of l)d(u,t.slice(s+1),n)}return}else if(a.endsWith("[0]")){const o=a.slice(0,-3);o in e||(e[o]=[{}]);const l=e[o];d(l[0],t.slice(s+1),n);return}(!e[a]||typeof e[a]!="object")&&(e[a]={}),e=e[a]}const r=t[t.length-1],i=e[r];if(i!==void 0){if(!n||typeof n=="object"&&Object.keys(n).length===0||n===i)return;if(typeof i=="object"&&typeof n=="object"&&i!==null&&n!==null)Object.assign(i,n);else throw new Error(`Cannot set value for an existing key. Key: ${r}`)}else e[r]=n}function f(e,t){try{if(t.length===1&&t[0]==="_self")return e;for(let n=0;n<t.length;n++){if(typeof e!="object"||e===null)return;const r=t[n];if(r.endsWith("[]")){const i=r.slice(0,-2);if(i in e){const s=e[i];return Array.isArray(s)?s.map(a=>f(a,t.slice(n+1))):void 0}else return}else e=e[r]}return e}catch(n){if(n instanceof TypeError)return;throw n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rv(e){if(typeof e!="string")throw new Error("fromImageBytes must be a string");return e}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var u_;(function(e){e.OUTCOME_UNSPECIFIED="OUTCOME_UNSPECIFIED",e.OUTCOME_OK="OUTCOME_OK",e.OUTCOME_FAILED="OUTCOME_FAILED",e.OUTCOME_DEADLINE_EXCEEDED="OUTCOME_DEADLINE_EXCEEDED"})(u_||(u_={}));var c_;(function(e){e.LANGUAGE_UNSPECIFIED="LANGUAGE_UNSPECIFIED",e.PYTHON="PYTHON"})(c_||(c_={}));var xa;(function(e){e.TYPE_UNSPECIFIED="TYPE_UNSPECIFIED",e.STRING="STRING",e.NUMBER="NUMBER",e.INTEGER="INTEGER",e.BOOLEAN="BOOLEAN",e.ARRAY="ARRAY",e.OBJECT="OBJECT",e.NULL="NULL"})(xa||(xa={}));var f_;(function(e){e.HARM_CATEGORY_UNSPECIFIED="HARM_CATEGORY_UNSPECIFIED",e.HARM_CATEGORY_HATE_SPEECH="HARM_CATEGORY_HATE_SPEECH",e.HARM_CATEGORY_DANGEROUS_CONTENT="HARM_CATEGORY_DANGEROUS_CONTENT",e.HARM_CATEGORY_HARASSMENT="HARM_CATEGORY_HARASSMENT",e.HARM_CATEGORY_SEXUALLY_EXPLICIT="HARM_CATEGORY_SEXUALLY_EXPLICIT",e.HARM_CATEGORY_CIVIC_INTEGRITY="HARM_CATEGORY_CIVIC_INTEGRITY",e.HARM_CATEGORY_IMAGE_HATE="HARM_CATEGORY_IMAGE_HATE",e.HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT="HARM_CATEGORY_IMAGE_DANGEROUS_CONTENT",e.HARM_CATEGORY_IMAGE_HARASSMENT="HARM_CATEGORY_IMAGE_HARASSMENT",e.HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT="HARM_CATEGORY_IMAGE_SEXUALLY_EXPLICIT"})(f_||(f_={}));var d_;(function(e){e.HARM_BLOCK_METHOD_UNSPECIFIED="HARM_BLOCK_METHOD_UNSPECIFIED",e.SEVERITY="SEVERITY",e.PROBABILITY="PROBABILITY"})(d_||(d_={}));var h_;(function(e){e.HARM_BLOCK_THRESHOLD_UNSPECIFIED="HARM_BLOCK_THRESHOLD_UNSPECIFIED",e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE",e.OFF="OFF"})(h_||(h_={}));var p_;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(p_||(p_={}));var m_;(function(e){e.AUTH_TYPE_UNSPECIFIED="AUTH_TYPE_UNSPECIFIED",e.NO_AUTH="NO_AUTH",e.API_KEY_AUTH="API_KEY_AUTH",e.HTTP_BASIC_AUTH="HTTP_BASIC_AUTH",e.GOOGLE_SERVICE_ACCOUNT_AUTH="GOOGLE_SERVICE_ACCOUNT_AUTH",e.OAUTH="OAUTH",e.OIDC_AUTH="OIDC_AUTH"})(m_||(m_={}));var g_;(function(e){e.API_SPEC_UNSPECIFIED="API_SPEC_UNSPECIFIED",e.SIMPLE_SEARCH="SIMPLE_SEARCH",e.ELASTIC_SEARCH="ELASTIC_SEARCH"})(g_||(g_={}));var v_;(function(e){e.ENVIRONMENT_UNSPECIFIED="ENVIRONMENT_UNSPECIFIED",e.ENVIRONMENT_BROWSER="ENVIRONMENT_BROWSER"})(v_||(v_={}));var x_;(function(e){e.URL_RETRIEVAL_STATUS_UNSPECIFIED="URL_RETRIEVAL_STATUS_UNSPECIFIED",e.URL_RETRIEVAL_STATUS_SUCCESS="URL_RETRIEVAL_STATUS_SUCCESS",e.URL_RETRIEVAL_STATUS_ERROR="URL_RETRIEVAL_STATUS_ERROR"})(x_||(x_={}));var y_;(function(e){e.FINISH_REASON_UNSPECIFIED="FINISH_REASON_UNSPECIFIED",e.STOP="STOP",e.MAX_TOKENS="MAX_TOKENS",e.SAFETY="SAFETY",e.RECITATION="RECITATION",e.LANGUAGE="LANGUAGE",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.SPII="SPII",e.MALFORMED_FUNCTION_CALL="MALFORMED_FUNCTION_CALL",e.IMAGE_SAFETY="IMAGE_SAFETY",e.UNEXPECTED_TOOL_CALL="UNEXPECTED_TOOL_CALL"})(y_||(y_={}));var w_;(function(e){e.HARM_PROBABILITY_UNSPECIFIED="HARM_PROBABILITY_UNSPECIFIED",e.NEGLIGIBLE="NEGLIGIBLE",e.LOW="LOW",e.MEDIUM="MEDIUM",e.HIGH="HIGH"})(w_||(w_={}));var T_;(function(e){e.HARM_SEVERITY_UNSPECIFIED="HARM_SEVERITY_UNSPECIFIED",e.HARM_SEVERITY_NEGLIGIBLE="HARM_SEVERITY_NEGLIGIBLE",e.HARM_SEVERITY_LOW="HARM_SEVERITY_LOW",e.HARM_SEVERITY_MEDIUM="HARM_SEVERITY_MEDIUM",e.HARM_SEVERITY_HIGH="HARM_SEVERITY_HIGH"})(T_||(T_={}));var S_;(function(e){e.BLOCKED_REASON_UNSPECIFIED="BLOCKED_REASON_UNSPECIFIED",e.SAFETY="SAFETY",e.OTHER="OTHER",e.BLOCKLIST="BLOCKLIST",e.PROHIBITED_CONTENT="PROHIBITED_CONTENT",e.IMAGE_SAFETY="IMAGE_SAFETY"})(S_||(S_={}));var E_;(function(e){e.TRAFFIC_TYPE_UNSPECIFIED="TRAFFIC_TYPE_UNSPECIFIED",e.ON_DEMAND="ON_DEMAND",e.PROVISIONED_THROUGHPUT="PROVISIONED_THROUGHPUT"})(E_||(E_={}));var vh;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.AUDIO="AUDIO"})(vh||(vh={}));var __;(function(e){e.MEDIA_RESOLUTION_UNSPECIFIED="MEDIA_RESOLUTION_UNSPECIFIED",e.MEDIA_RESOLUTION_LOW="MEDIA_RESOLUTION_LOW",e.MEDIA_RESOLUTION_MEDIUM="MEDIA_RESOLUTION_MEDIUM",e.MEDIA_RESOLUTION_HIGH="MEDIA_RESOLUTION_HIGH"})(__||(__={}));var iv;(function(e){e.JOB_STATE_UNSPECIFIED="JOB_STATE_UNSPECIFIED",e.JOB_STATE_QUEUED="JOB_STATE_QUEUED",e.JOB_STATE_PENDING="JOB_STATE_PENDING",e.JOB_STATE_RUNNING="JOB_STATE_RUNNING",e.JOB_STATE_SUCCEEDED="JOB_STATE_SUCCEEDED",e.JOB_STATE_FAILED="JOB_STATE_FAILED",e.JOB_STATE_CANCELLING="JOB_STATE_CANCELLING",e.JOB_STATE_CANCELLED="JOB_STATE_CANCELLED",e.JOB_STATE_PAUSED="JOB_STATE_PAUSED",e.JOB_STATE_EXPIRED="JOB_STATE_EXPIRED",e.JOB_STATE_UPDATING="JOB_STATE_UPDATING",e.JOB_STATE_PARTIALLY_SUCCEEDED="JOB_STATE_PARTIALLY_SUCCEEDED"})(iv||(iv={}));var C_;(function(e){e.ADAPTER_SIZE_UNSPECIFIED="ADAPTER_SIZE_UNSPECIFIED",e.ADAPTER_SIZE_ONE="ADAPTER_SIZE_ONE",e.ADAPTER_SIZE_TWO="ADAPTER_SIZE_TWO",e.ADAPTER_SIZE_FOUR="ADAPTER_SIZE_FOUR",e.ADAPTER_SIZE_EIGHT="ADAPTER_SIZE_EIGHT",e.ADAPTER_SIZE_SIXTEEN="ADAPTER_SIZE_SIXTEEN",e.ADAPTER_SIZE_THIRTY_TWO="ADAPTER_SIZE_THIRTY_TWO"})(C_||(C_={}));var k_;(function(e){e.FEATURE_SELECTION_PREFERENCE_UNSPECIFIED="FEATURE_SELECTION_PREFERENCE_UNSPECIFIED",e.PRIORITIZE_QUALITY="PRIORITIZE_QUALITY",e.BALANCED="BALANCED",e.PRIORITIZE_COST="PRIORITIZE_COST"})(k_||(k_={}));var A_;(function(e){e.UNSPECIFIED="UNSPECIFIED",e.BLOCKING="BLOCKING",e.NON_BLOCKING="NON_BLOCKING"})(A_||(A_={}));var R_;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.MODE_DYNAMIC="MODE_DYNAMIC"})(R_||(R_={}));var M_;(function(e){e.MODE_UNSPECIFIED="MODE_UNSPECIFIED",e.AUTO="AUTO",e.ANY="ANY",e.NONE="NONE"})(M_||(M_={}));var F_;(function(e){e.BLOCK_LOW_AND_ABOVE="BLOCK_LOW_AND_ABOVE",e.BLOCK_MEDIUM_AND_ABOVE="BLOCK_MEDIUM_AND_ABOVE",e.BLOCK_ONLY_HIGH="BLOCK_ONLY_HIGH",e.BLOCK_NONE="BLOCK_NONE"})(F_||(F_={}));var D_;(function(e){e.DONT_ALLOW="DONT_ALLOW",e.ALLOW_ADULT="ALLOW_ADULT",e.ALLOW_ALL="ALLOW_ALL"})(D_||(D_={}));var P_;(function(e){e.auto="auto",e.en="en",e.ja="ja",e.ko="ko",e.hi="hi",e.zh="zh",e.pt="pt",e.es="es"})(P_||(P_={}));var I_;(function(e){e.MASK_MODE_DEFAULT="MASK_MODE_DEFAULT",e.MASK_MODE_USER_PROVIDED="MASK_MODE_USER_PROVIDED",e.MASK_MODE_BACKGROUND="MASK_MODE_BACKGROUND",e.MASK_MODE_FOREGROUND="MASK_MODE_FOREGROUND",e.MASK_MODE_SEMANTIC="MASK_MODE_SEMANTIC"})(I_||(I_={}));var N_;(function(e){e.CONTROL_TYPE_DEFAULT="CONTROL_TYPE_DEFAULT",e.CONTROL_TYPE_CANNY="CONTROL_TYPE_CANNY",e.CONTROL_TYPE_SCRIBBLE="CONTROL_TYPE_SCRIBBLE",e.CONTROL_TYPE_FACE_MESH="CONTROL_TYPE_FACE_MESH"})(N_||(N_={}));var b_;(function(e){e.SUBJECT_TYPE_DEFAULT="SUBJECT_TYPE_DEFAULT",e.SUBJECT_TYPE_PERSON="SUBJECT_TYPE_PERSON",e.SUBJECT_TYPE_ANIMAL="SUBJECT_TYPE_ANIMAL",e.SUBJECT_TYPE_PRODUCT="SUBJECT_TYPE_PRODUCT"})(b_||(b_={}));var L_;(function(e){e.EDIT_MODE_DEFAULT="EDIT_MODE_DEFAULT",e.EDIT_MODE_INPAINT_REMOVAL="EDIT_MODE_INPAINT_REMOVAL",e.EDIT_MODE_INPAINT_INSERTION="EDIT_MODE_INPAINT_INSERTION",e.EDIT_MODE_OUTPAINT="EDIT_MODE_OUTPAINT",e.EDIT_MODE_CONTROLLED_EDITING="EDIT_MODE_CONTROLLED_EDITING",e.EDIT_MODE_STYLE="EDIT_MODE_STYLE",e.EDIT_MODE_BGSWAP="EDIT_MODE_BGSWAP",e.EDIT_MODE_PRODUCT_IMAGE="EDIT_MODE_PRODUCT_IMAGE"})(L_||(L_={}));var O_;(function(e){e.OPTIMIZED="OPTIMIZED",e.LOSSLESS="LOSSLESS"})(O_||(O_={}));var B_;(function(e){e.STATE_UNSPECIFIED="STATE_UNSPECIFIED",e.PROCESSING="PROCESSING",e.ACTIVE="ACTIVE",e.FAILED="FAILED"})(B_||(B_={}));var U_;(function(e){e.SOURCE_UNSPECIFIED="SOURCE_UNSPECIFIED",e.UPLOADED="UPLOADED",e.GENERATED="GENERATED"})(U_||(U_={}));var V_;(function(e){e.MODALITY_UNSPECIFIED="MODALITY_UNSPECIFIED",e.TEXT="TEXT",e.IMAGE="IMAGE",e.VIDEO="VIDEO",e.AUDIO="AUDIO",e.DOCUMENT="DOCUMENT"})(V_||(V_={}));var H_;(function(e){e.START_SENSITIVITY_UNSPECIFIED="START_SENSITIVITY_UNSPECIFIED",e.START_SENSITIVITY_HIGH="START_SENSITIVITY_HIGH",e.START_SENSITIVITY_LOW="START_SENSITIVITY_LOW"})(H_||(H_={}));var $_;(function(e){e.END_SENSITIVITY_UNSPECIFIED="END_SENSITIVITY_UNSPECIFIED",e.END_SENSITIVITY_HIGH="END_SENSITIVITY_HIGH",e.END_SENSITIVITY_LOW="END_SENSITIVITY_LOW"})($_||($_={}));var z_;(function(e){e.ACTIVITY_HANDLING_UNSPECIFIED="ACTIVITY_HANDLING_UNSPECIFIED",e.START_OF_ACTIVITY_INTERRUPTS="START_OF_ACTIVITY_INTERRUPTS",e.NO_INTERRUPTION="NO_INTERRUPTION"})(z_||(z_={}));var W_;(function(e){e.TURN_COVERAGE_UNSPECIFIED="TURN_COVERAGE_UNSPECIFIED",e.TURN_INCLUDES_ONLY_ACTIVITY="TURN_INCLUDES_ONLY_ACTIVITY",e.TURN_INCLUDES_ALL_INPUT="TURN_INCLUDES_ALL_INPUT"})(W_||(W_={}));var G_;(function(e){e.SCHEDULING_UNSPECIFIED="SCHEDULING_UNSPECIFIED",e.SILENT="SILENT",e.WHEN_IDLE="WHEN_IDLE",e.INTERRUPT="INTERRUPT"})(G_||(G_={}));var q_;(function(e){e.SCALE_UNSPECIFIED="SCALE_UNSPECIFIED",e.C_MAJOR_A_MINOR="C_MAJOR_A_MINOR",e.D_FLAT_MAJOR_B_FLAT_MINOR="D_FLAT_MAJOR_B_FLAT_MINOR",e.D_MAJOR_B_MINOR="D_MAJOR_B_MINOR",e.E_FLAT_MAJOR_C_MINOR="E_FLAT_MAJOR_C_MINOR",e.E_MAJOR_D_FLAT_MINOR="E_MAJOR_D_FLAT_MINOR",e.F_MAJOR_D_MINOR="F_MAJOR_D_MINOR",e.G_FLAT_MAJOR_E_FLAT_MINOR="G_FLAT_MAJOR_E_FLAT_MINOR",e.G_MAJOR_E_MINOR="G_MAJOR_E_MINOR",e.A_FLAT_MAJOR_F_MINOR="A_FLAT_MAJOR_F_MINOR",e.A_MAJOR_G_FLAT_MINOR="A_MAJOR_G_FLAT_MINOR",e.B_FLAT_MAJOR_G_MINOR="B_FLAT_MAJOR_G_MINOR",e.B_MAJOR_A_FLAT_MINOR="B_MAJOR_A_FLAT_MINOR"})(q_||(q_={}));var Fl;(function(e){e.PLAYBACK_CONTROL_UNSPECIFIED="PLAYBACK_CONTROL_UNSPECIFIED",e.PLAY="PLAY",e.PAUSE="PAUSE",e.STOP="STOP",e.RESET_CONTEXT="RESET_CONTEXT"})(Fl||(Fl={}));class sv{constructor(t){const n={};for(const r of t.headers.entries())n[r[0]]=r[1];this.headers=n,this.responseInternal=t}json(){return this.responseInternal.json()}}class ec{get text(){var t,n,r,i,s,a,o,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning text from the first one.");let u="",c=!1;const h=[];for(const p of(l=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&l!==void 0?l:[]){for(const[m,v]of Object.entries(p))m!=="text"&&m!=="thought"&&(v!==null||v!==void 0)&&h.push(m);if(typeof p.text=="string"){if(typeof p.thought=="boolean"&&p.thought)continue;c=!0,u+=p.text}}return h.length>0&&console.warn(`there are non-text parts ${h} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),c?u:void 0}get data(){var t,n,r,i,s,a,o,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning data from the first one.");let u="";const c=[];for(const h of(l=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)!==null&&l!==void 0?l:[]){for(const[p,m]of Object.entries(h))p!=="inlineData"&&(m!==null||m!==void 0)&&c.push(p);h.inlineData&&typeof h.inlineData.data=="string"&&(u+=atob(h.inlineData.data))}return c.length>0&&console.warn(`there are non-data parts ${c} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),u.length>0?btoa(u):void 0}get functionCalls(){var t,n,r,i,s,a,o,l;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning function calls from the first one.");const u=(l=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(c=>c.functionCall).map(c=>c.functionCall).filter(c=>c!==void 0);if((u==null?void 0:u.length)!==0)return u}get executableCode(){var t,n,r,i,s,a,o,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning executable code from the first one.");const c=(l=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(h=>h.executableCode).map(h=>h.executableCode).filter(h=>h!==void 0);if((c==null?void 0:c.length)!==0)return(u=c==null?void 0:c[0])===null||u===void 0?void 0:u.code}get codeExecutionResult(){var t,n,r,i,s,a,o,l,u;if(((i=(r=(n=(t=this.candidates)===null||t===void 0?void 0:t[0])===null||n===void 0?void 0:n.content)===null||r===void 0?void 0:r.parts)===null||i===void 0?void 0:i.length)===0)return;this.candidates&&this.candidates.length>1&&console.warn("there are multiple candidates in the response, returning code execution result from the first one.");const c=(l=(o=(a=(s=this.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content)===null||o===void 0?void 0:o.parts)===null||l===void 0?void 0:l.filter(h=>h.codeExecutionResult).map(h=>h.codeExecutionResult).filter(h=>h!==void 0);if((c==null?void 0:c.length)!==0)return(u=c==null?void 0:c[0])===null||u===void 0?void 0:u.output}}class K_{}class Y_{}class VJ{}class HJ{}class X_{}class J_{}class Q_{}class $J{}class j_{}class Z_{}class eC{}class tC{}class zJ{}class WJ{}class GJ{}class nC{}class qJ{get text(){var t,n,r;let i="",s=!1;const a=[];for(const o of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[l,u]of Object.entries(o))l!=="text"&&l!=="thought"&&u!==null&&a.push(l);if(typeof o.text=="string"){if(typeof o.thought=="boolean"&&o.thought)continue;s=!0,i+=o.text}}return a.length>0&&console.warn(`there are non-text parts ${a} in the response, returning concatenation of all text parts. Please refer to the non text parts for a full response from model.`),s?i:void 0}get data(){var t,n,r;let i="";const s=[];for(const a of(r=(n=(t=this.serverContent)===null||t===void 0?void 0:t.modelTurn)===null||n===void 0?void 0:n.parts)!==null&&r!==void 0?r:[]){for(const[o,l]of Object.entries(a))o!=="inlineData"&&l!==null&&s.push(o);a.inlineData&&typeof a.inlineData.data=="string"&&(i+=atob(a.inlineData.data))}return s.length>0&&console.warn(`there are non-data parts ${s} in the response, returning concatenation of all data parts. Please refer to the non data parts for a full response from model.`),i.length>0?btoa(i):void 0}}class xh{_fromAPIResponse({apiResponse:t,isVertexAI:n}){const r=new xh;if(r.name=t.name,r.metadata=t.metadata,r.done=t.done,r.error=t.error,n){const i=t.response;if(i){const s=new j_,a=i.videos;s.generatedVideos=a==null?void 0:a.map(o=>({video:{uri:o.gcsUri,videoBytes:o.bytesBase64Encoded?rv(o.bytesBase64Encoded):void 0,mimeType:o.mimeType}})),s.raiMediaFilteredCount=i.raiMediaFilteredCount,s.raiMediaFilteredReasons=i.raiMediaFilteredReasons,r.response=s}}else{const i=t.response;if(i){const s=new j_,a=i.generateVideoResponse,o=a==null?void 0:a.generatedSamples;s.generatedVideos=o==null?void 0:o.map(l=>{const u=l.video;return{video:{uri:u==null?void 0:u.uri,videoBytes:u!=null&&u.encodedVideo?rv(u==null?void 0:u.encodedVideo):void 0,mimeType:l.encoding}}}),s.raiMediaFilteredCount=a==null?void 0:a.raiMediaFilteredCount,s.raiMediaFilteredReasons=a==null?void 0:a.raiMediaFilteredReasons,r.response=s}}return r}}class KJ{get audioChunk(){if(this.serverContent&&this.serverContent.audioChunks&&this.serverContent.audioChunks.length>0)return this.serverContent.audioChunks[0]}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Wt(e,t){if(!t||typeof t!="string")throw new Error("model is required and must be a string");if(e.isVertexAI()){if(t.startsWith("publishers/")||t.startsWith("projects/")||t.startsWith("models/"))return t;if(t.indexOf("/")>=0){const n=t.split("/",2);return`publishers/${n[0]}/models/${n[1]}`}else return`publishers/google/models/${t}`}else return t.startsWith("models/")||t.startsWith("tunedModels/")?t:`models/${t}`}function xP(e,t){const n=Wt(e,t);return n?n.startsWith("publishers/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}`:n.startsWith("models/")&&e.isVertexAI()?`projects/${e.getProject()}/locations/${e.getLocation()}/publishers/google/${n}`:n:""}function yP(e){return Array.isArray(e)?e.map(t=>yh(t)):[yh(e)]}function yh(e){if(typeof e=="object"&&e!==null)return e;throw new Error(`Could not parse input as Blob. Unsupported blob type: ${typeof e}`)}function wP(e){const t=yh(e);if(t.mimeType&&t.mimeType.startsWith("image/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function TP(e){const t=yh(e);if(t.mimeType&&t.mimeType.startsWith("audio/"))return t;throw new Error(`Unsupported mime type: ${t.mimeType}`)}function rC(e){if(e==null)throw new Error("PartUnion is required");if(typeof e=="object")return e;if(typeof e=="string")return{text:e};throw new Error(`Unsupported part type: ${typeof e}`)}function SP(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("PartListUnion is required");return Array.isArray(e)?e.map(t=>rC(t)):[rC(e)]}function av(e){return e!=null&&typeof e=="object"&&"parts"in e&&Array.isArray(e.parts)}function iC(e){return e!=null&&typeof e=="object"&&"functionCall"in e}function sC(e){return e!=null&&typeof e=="object"&&"functionResponse"in e}function fr(e){if(e==null)throw new Error("ContentUnion is required");return av(e)?e:{role:"user",parts:SP(e)}}function EP(e,t){if(!t)return[];if(e.isVertexAI()&&Array.isArray(t))return t.flatMap(n=>{const r=fr(n);return r.parts&&r.parts.length>0&&r.parts[0].text!==void 0?[r.parts[0].text]:[]});if(e.isVertexAI()){const n=fr(t);return n.parts&&n.parts.length>0&&n.parts[0].text!==void 0?[n.parts[0].text]:[]}return Array.isArray(t)?t.map(n=>fr(n)):[fr(t)]}function wi(e){if(e==null||Array.isArray(e)&&e.length===0)throw new Error("contents are required");if(!Array.isArray(e)){if(iC(e)||sC(e))throw new Error("To specify functionCall or functionResponse parts, please wrap them in a Content object, specifying the role for them");return[fr(e)]}const t=[],n=[],r=av(e[0]);for(const i of e){const s=av(i);if(s!=r)throw new Error("Mixing Content and Parts is not supported, please group the parts into a the appropriate Content objects and specify the roles for them");if(s)t.push(i);else{if(iC(i)||sC(i))throw new Error("To specify functionCall or functionResponse parts, please wrap them, and any other parts, in Content objects as appropriate, specifying the role for them");n.push(i)}}return r||t.push({role:"user",parts:SP(n)}),t}function YJ(e,t){e.includes("null")&&(t.nullable=!0);const n=e.filter(r=>r!=="null");if(n.length===1)t.type=Object.values(xa).includes(n[0].toUpperCase())?n[0].toUpperCase():xa.TYPE_UNSPECIFIED;else{t.anyOf=[];for(const r of n)t.anyOf.push({type:Object.values(xa).includes(r.toUpperCase())?r.toUpperCase():xa.TYPE_UNSPECIFIED})}}function zl(e){const t={},n=["items"],r=["anyOf"],i=["properties"];if(e.type&&e.anyOf)throw new Error("type and anyOf cannot be both populated.");const s=e.anyOf;s!=null&&s.length==2&&(s[0].type==="null"?(t.nullable=!0,e=s[1]):s[1].type==="null"&&(t.nullable=!0,e=s[0])),e.type instanceof Array&&YJ(e.type,t);for(const[a,o]of Object.entries(e))if(o!=null)if(a=="type"){if(o==="null")throw new Error("type: null can not be the only possible type for the field.");if(o instanceof Array)continue;t.type=Object.values(xa).includes(o.toUpperCase())?o.toUpperCase():xa.TYPE_UNSPECIFIED}else if(n.includes(a))t[a]=zl(o);else if(r.includes(a)){const l=[];for(const u of o){if(u.type=="null"){t.nullable=!0;continue}l.push(zl(u))}t[a]=l}else if(i.includes(a)){const l={};for(const[u,c]of Object.entries(o))l[u]=zl(c);t[a]=l}else{if(a==="additionalProperties")continue;t[a]=o}return t}function gy(e){return zl(e)}function vy(e){if(typeof e=="object")return e;if(typeof e=="string")return{voiceConfig:{prebuiltVoiceConfig:{voiceName:e}}};throw new Error(`Unsupported speechConfig type: ${typeof e}`)}function xy(e){if("multiSpeakerVoiceConfig"in e)throw new Error("multiSpeakerVoiceConfig is not supported in the live API.");return e}function Iu(e){if(e.functionDeclarations)for(const t of e.functionDeclarations)t.parameters&&(Object.keys(t.parameters).includes("$schema")?t.parametersJsonSchema||(t.parametersJsonSchema=t.parameters,delete t.parameters):t.parameters=zl(t.parameters)),t.response&&(Object.keys(t.response).includes("$schema")?t.responseJsonSchema||(t.responseJsonSchema=t.response,delete t.response):t.response=zl(t.response));return e}function Nu(e){if(e==null)throw new Error("tools is required");if(!Array.isArray(e))throw new Error("tools is required and must be an array of Tools");const t=[];for(const n of e)t.push(n);return t}function XJ(e,t,n,r=1){const i=!t.startsWith(`${n}/`)&&t.split("/").length===r;return e.isVertexAI()?t.startsWith("projects/")?t:t.startsWith("locations/")?`projects/${e.getProject()}/${t}`:t.startsWith(`${n}/`)?`projects/${e.getProject()}/locations/${e.getLocation()}/${t}`:i?`projects/${e.getProject()}/locations/${e.getLocation()}/${n}/${t}`:t:i?`${n}/${t}`:t}function Gs(e,t){if(typeof t!="string")throw new Error("name must be a string");return XJ(e,t,"cachedContents")}function _P(e){switch(e){case"STATE_UNSPECIFIED":return"JOB_STATE_UNSPECIFIED";case"CREATING":return"JOB_STATE_RUNNING";case"ACTIVE":return"JOB_STATE_SUCCEEDED";case"FAILED":return"JOB_STATE_FAILED";default:return e}}function tl(e){return rv(e)}function JJ(e){return e!=null&&typeof e=="object"&&"name"in e}function QJ(e){return e!=null&&typeof e=="object"&&"video"in e}function jJ(e){return e!=null&&typeof e=="object"&&"uri"in e}function CP(e){var t;let n;if(JJ(e)&&(n=e.name),!(jJ(e)&&(n=e.uri,n===void 0))&&!(QJ(e)&&(n=(t=e.video)===null||t===void 0?void 0:t.uri,n===void 0))){if(typeof e=="string"&&(n=e),n===void 0)throw new Error("Could not extract file name from the provided input.");if(n.startsWith("https://")){const i=n.split("files/")[1].match(/[a-z0-9]+/);if(i===null)throw new Error(`Could not extract file name from URI ${n}`);n=i[0]}else n.startsWith("files/")&&(n=n.split("files/")[1]);return n}}function kP(e,t){let n;return e.isVertexAI()?n=t?"publishers/google/models":"models":n=t?"models":"tunedModels",n}function AP(e){for(const t of["models","tunedModels","publisherModels"])if(ZJ(e,t))return e[t];return[]}function ZJ(e,t){return e!==null&&typeof e=="object"&&t in e}function eQ(e,t={}){const n=e,r={name:n.name,description:n.description,parametersJsonSchema:n.inputSchema};return t.behavior&&(r.behavior=t.behavior),{functionDeclarations:[r]}}function tQ(e,t={}){const n=[],r=new Set;for(const i of e){const s=i.name;if(r.has(s))throw new Error(`Duplicate function name ${s} found in MCP tools. Please ensure function names are unique.`);r.add(s);const a=eQ(i,t);a.functionDeclarations&&n.push(...a.functionDeclarations)}return{functionDeclarations:n}}function RP(e,t){if(typeof t!="string"&&!Array.isArray(t)){if(e&&e.isVertexAI()){if(t.gcsUri&&t.bigqueryUri)throw new Error("Only one of `gcsUri` or `bigqueryUri` can be set.");if(!t.gcsUri&&!t.bigqueryUri)throw new Error("One of `gcsUri` or `bigqueryUri` must be set.")}else{if(t.inlinedRequests&&t.fileName)throw new Error("Only one of `inlinedRequests` or `fileName` can be set.");if(!t.inlinedRequests&&!t.fileName)throw new Error("One of `inlinedRequests` or `fileName` must be set.")}return t}else{if(Array.isArray(t))return{inlinedRequests:t};if(typeof t=="string"){if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:[t]};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};if(t.startsWith("files/"))return{fileName:t}}}throw new Error(`Unsupported source: ${t}`)}function nQ(e){if(typeof e!="string")return e;const t=e;if(t.startsWith("gs://"))return{format:"jsonl",gcsUri:t};if(t.startsWith("bq://"))return{format:"bigquery",bigqueryUri:t};throw new Error(`Unsupported destination: ${t}`)}function bu(e,t){const n=t;if(!e.isVertexAI()){if(/batches\/[^/]+$/.test(n))return n.split("/").pop();throw new Error(`Invalid batch job name: ${n}.`)}if(/^projects\/[^/]+\/locations\/[^/]+\/batchPredictionJobs\/[^/]+$/.test(n))return n.split("/").pop();if(/^\d+$/.test(n))return n;throw new Error(`Invalid batch job name: ${n}.`)}function MP(e){const t=e;return t==="BATCH_STATE_UNSPECIFIED"?"JOB_STATE_UNSPECIFIED":t==="BATCH_STATE_PENDING"?"JOB_STATE_PENDING":t==="BATCH_STATE_SUCCEEDED"?"JOB_STATE_SUCCEEDED":t==="BATCH_STATE_FAILED"?"JOB_STATE_FAILED":t==="BATCH_STATE_CANCELLED"?"JOB_STATE_CANCELLED":t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function rQ(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function iQ(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function sQ(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function aQ(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],rQ(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],iQ(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],sQ(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function FP(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>aQ(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function oQ(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const i=f(e,["description"]);i!=null&&d(t,["description"],i);const s=f(e,["enum"]);s!=null&&d(t,["enum"],s);const a=f(e,["example"]);a!=null&&d(t,["example"],a);const o=f(e,["format"]);o!=null&&d(t,["format"],o);const l=f(e,["items"]);l!=null&&d(t,["items"],l);const u=f(e,["maxItems"]);u!=null&&d(t,["maxItems"],u);const c=f(e,["maxLength"]);c!=null&&d(t,["maxLength"],c);const h=f(e,["maxProperties"]);h!=null&&d(t,["maxProperties"],h);const p=f(e,["maximum"]);p!=null&&d(t,["maximum"],p);const m=f(e,["minItems"]);m!=null&&d(t,["minItems"],m);const v=f(e,["minLength"]);v!=null&&d(t,["minLength"],v);const g=f(e,["minProperties"]);g!=null&&d(t,["minProperties"],g);const w=f(e,["minimum"]);w!=null&&d(t,["minimum"],w);const x=f(e,["nullable"]);x!=null&&d(t,["nullable"],x);const T=f(e,["pattern"]);T!=null&&d(t,["pattern"],T);const y=f(e,["properties"]);y!=null&&d(t,["properties"],y);const _=f(e,["propertyOrdering"]);_!=null&&d(t,["propertyOrdering"],_);const k=f(e,["required"]);k!=null&&d(t,["required"],k);const S=f(e,["title"]);S!=null&&d(t,["title"],S);const C=f(e,["type"]);return C!=null&&d(t,["type"],C),t}function lQ(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function uQ(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const i=f(e,["name"]);i!=null&&d(t,["name"],i);const s=f(e,["parameters"]);s!=null&&d(t,["parameters"],s);const a=f(e,["parametersJsonSchema"]);a!=null&&d(t,["parametersJsonSchema"],a);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const l=f(e,["responseJsonSchema"]);return l!=null&&d(t,["responseJsonSchema"],l),t}function cQ(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function fQ(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],cQ(n)),t}function dQ(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function hQ(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],dQ(n)),t}function pQ(){return{}}function mQ(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>uQ(u))),d(t,["functionDeclarations"],l)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],fQ(r));const i=f(e,["googleSearchRetrieval"]);if(i!=null&&d(t,["googleSearchRetrieval"],hQ(i)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],pQ());const a=f(e,["codeExecution"]);a!=null&&d(t,["codeExecution"],a);const o=f(e,["computerUse"]);return o!=null&&d(t,["computerUse"],o),t}function gQ(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function vQ(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function xQ(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],vQ(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function yQ(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],gQ(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],xQ(r)),t}function wQ(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function DP(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],wQ(n)),t}function TQ(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],DP(r)),t}function SQ(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>TQ(i))),d(t,["speakerVoiceConfigs"],r)}return t}function EQ(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],DP(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],SQ(r));const i=f(e,["languageCode"]);return i!=null&&d(t,["languageCode"],i),t}function _Q(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function CQ(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],FP(fr(i)));const s=f(t,["temperature"]);s!=null&&d(r,["temperature"],s);const a=f(t,["topP"]);a!=null&&d(r,["topP"],a);const o=f(t,["topK"]);o!=null&&d(r,["topK"],o);const l=f(t,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const c=f(t,["stopSequences"]);c!=null&&d(r,["stopSequences"],c);const h=f(t,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);const p=f(t,["logprobs"]);p!=null&&d(r,["logprobs"],p);const m=f(t,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);const v=f(t,["frequencyPenalty"]);v!=null&&d(r,["frequencyPenalty"],v);const g=f(t,["seed"]);g!=null&&d(r,["seed"],g);const w=f(t,["responseMimeType"]);w!=null&&d(r,["responseMimeType"],w);const x=f(t,["responseSchema"]);x!=null&&d(r,["responseSchema"],oQ(gy(x)));const T=f(t,["responseJsonSchema"]);if(T!=null&&d(r,["responseJsonSchema"],T),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=f(t,["safetySettings"]);if(n!==void 0&&y!=null){let V=y;Array.isArray(V)&&(V=V.map(z=>lQ(z))),d(n,["safetySettings"],V)}const _=f(t,["tools"]);if(n!==void 0&&_!=null){let V=Nu(_);Array.isArray(V)&&(V=V.map(z=>mQ(Iu(z)))),d(n,["tools"],V)}const k=f(t,["toolConfig"]);if(n!==void 0&&k!=null&&d(n,["toolConfig"],yQ(k)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const S=f(t,["cachedContent"]);n!==void 0&&S!=null&&d(n,["cachedContent"],Gs(e,S));const C=f(t,["responseModalities"]);C!=null&&d(r,["responseModalities"],C);const M=f(t,["mediaResolution"]);M!=null&&d(r,["mediaResolution"],M);const F=f(t,["speechConfig"]);if(F!=null&&d(r,["speechConfig"],EQ(vy(F))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const b=f(t,["thinkingConfig"]);return b!=null&&d(r,["thinkingConfig"],_Q(b)),r}function kQ(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["request","model"],Wt(e,r));const i=f(t,["contents"]);if(i!=null){let a=wi(i);Array.isArray(a)&&(a=a.map(o=>FP(o))),d(n,["request","contents"],a)}const s=f(t,["config"]);return s!=null&&d(n,["request","generationConfig"],CQ(e,s,n)),n}function AQ(e,t){const n={};if(f(t,["format"])!==void 0)throw new Error("format parameter is not supported in Gemini API.");if(f(t,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(t,["bigqueryUri"])!==void 0)throw new Error("bigqueryUri parameter is not supported in Gemini API.");const r=f(t,["fileName"]);r!=null&&d(n,["fileName"],r);const i=f(t,["inlinedRequests"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>kQ(e,a))),d(n,["requests","requests"],s)}return n}function RQ(e,t){const n={},r=f(e,["displayName"]);if(t!==void 0&&r!=null&&d(t,["batch","displayName"],r),f(e,["dest"])!==void 0)throw new Error("dest parameter is not supported in Gemini API.");return n}function MQ(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["src"]);i!=null&&d(n,["batch","inputConfig"],AQ(e,RP(e,i)));const s=f(t,["config"]);return s!=null&&d(n,["config"],RQ(s,n)),n}function FQ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],bu(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function DQ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],bu(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function PQ(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);if(t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),f(e,["filter"])!==void 0)throw new Error("filter parameter is not supported in Gemini API.");return n}function IQ(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],PQ(n,t)),t}function NQ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],bu(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function bQ(e){const t={},n=f(e,["format"]);n!=null&&d(t,["instancesFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsSource","uris"],r);const i=f(e,["bigqueryUri"]);if(i!=null&&d(t,["bigquerySource","inputUri"],i),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedRequests"])!==void 0)throw new Error("inlinedRequests parameter is not supported in Vertex AI.");return t}function LQ(e){const t={},n=f(e,["format"]);n!=null&&d(t,["predictionsFormat"],n);const r=f(e,["gcsUri"]);r!=null&&d(t,["gcsDestination","outputUriPrefix"],r);const i=f(e,["bigqueryUri"]);if(i!=null&&d(t,["bigqueryDestination","outputUri"],i),f(e,["fileName"])!==void 0)throw new Error("fileName parameter is not supported in Vertex AI.");if(f(e,["inlinedResponses"])!==void 0)throw new Error("inlinedResponses parameter is not supported in Vertex AI.");return t}function OQ(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const i=f(e,["dest"]);return t!==void 0&&i!=null&&d(t,["outputConfig"],LQ(nQ(i))),n}function BQ(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],Wt(e,r));const i=f(t,["src"]);i!=null&&d(n,["inputConfig"],bQ(RP(e,i)));const s=f(t,["config"]);return s!=null&&d(n,["config"],OQ(s,n)),n}function UQ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],bu(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function VQ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],bu(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function HQ(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);t!==void 0&&i!=null&&d(t,["_query","pageToken"],i);const s=f(e,["filter"]);return t!==void 0&&s!=null&&d(t,["_query","filter"],s),n}function $Q(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],HQ(n,t)),t}function zQ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],bu(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function WQ(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function GQ(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function qQ(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function KQ(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],WQ(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],GQ(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],qQ(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function YQ(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>KQ(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function XQ(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function JQ(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function QQ(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>JQ(i))),d(t,["urlMetadata"],r)}return t}function jQ(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],YQ(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],XQ(r));const i=f(e,["tokenCount"]);i!=null&&d(t,["tokenCount"],i);const s=f(e,["finishReason"]);s!=null&&d(t,["finishReason"],s);const a=f(e,["urlContextMetadata"]);a!=null&&d(t,["urlContextMetadata"],QQ(a));const o=f(e,["avgLogprobs"]);o!=null&&d(t,["avgLogprobs"],o);const l=f(e,["groundingMetadata"]);l!=null&&d(t,["groundingMetadata"],l);const u=f(e,["index"]);u!=null&&d(t,["index"],u);const c=f(e,["logprobsResult"]);c!=null&&d(t,["logprobsResult"],c);const h=f(e,["safetyRatings"]);return h!=null&&d(t,["safetyRatings"],h),t}function ZQ(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>jQ(l))),d(t,["candidates"],o)}const i=f(e,["modelVersion"]);i!=null&&d(t,["modelVersion"],i);const s=f(e,["promptFeedback"]);s!=null&&d(t,["promptFeedback"],s);const a=f(e,["usageMetadata"]);return a!=null&&d(t,["usageMetadata"],a),t}function PP(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["code"]);r!=null&&d(t,["code"],r);const i=f(e,["message"]);return i!=null&&d(t,["message"],i),t}function ej(e){const t={},n=f(e,["response"]);n!=null&&d(t,["response"],ZQ(n));const r=f(e,["error"]);return r!=null&&d(t,["error"],PP(r)),t}function tj(e){const t={},n=f(e,["responsesFile"]);n!=null&&d(t,["fileName"],n);const r=f(e,["inlinedResponses","inlinedResponses"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>ej(s))),d(t,["inlinedResponses"],i)}return t}function ov(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata","displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["metadata","state"]);i!=null&&d(t,["state"],MP(i));const s=f(e,["metadata","createTime"]);s!=null&&d(t,["createTime"],s);const a=f(e,["metadata","endTime"]);a!=null&&d(t,["endTime"],a);const o=f(e,["metadata","updateTime"]);o!=null&&d(t,["updateTime"],o);const l=f(e,["metadata","model"]);l!=null&&d(t,["model"],l);const u=f(e,["metadata","output"]);return u!=null&&d(t,["dest"],tj(u)),t}function nj(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["operations"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>ov(a))),d(t,["batchJobs"],s)}return t}function rj(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);r!=null&&d(t,["done"],r);const i=f(e,["error"]);return i!=null&&d(t,["error"],PP(i)),t}function IP(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["code"]);r!=null&&d(t,["code"],r);const i=f(e,["message"]);return i!=null&&d(t,["message"],i),t}function ij(e){const t={},n=f(e,["instancesFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsSource","uris"]);r!=null&&d(t,["gcsUri"],r);const i=f(e,["bigquerySource","inputUri"]);return i!=null&&d(t,["bigqueryUri"],i),t}function sj(e){const t={},n=f(e,["predictionsFormat"]);n!=null&&d(t,["format"],n);const r=f(e,["gcsDestination","outputUriPrefix"]);r!=null&&d(t,["gcsUri"],r);const i=f(e,["bigqueryDestination","outputUri"]);return i!=null&&d(t,["bigqueryUri"],i),t}function lv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["state"]);i!=null&&d(t,["state"],MP(i));const s=f(e,["error"]);s!=null&&d(t,["error"],IP(s));const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const o=f(e,["startTime"]);o!=null&&d(t,["startTime"],o);const l=f(e,["endTime"]);l!=null&&d(t,["endTime"],l);const u=f(e,["updateTime"]);u!=null&&d(t,["updateTime"],u);const c=f(e,["model"]);c!=null&&d(t,["model"],c);const h=f(e,["inputConfig"]);h!=null&&d(t,["src"],ij(h));const p=f(e,["outputConfig"]);return p!=null&&d(t,["dest"],sj(p)),t}function aj(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["batchPredictionJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>lv(a))),d(t,["batchJobs"],s)}return t}function oj(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["done"]);r!=null&&d(t,["done"],r);const i=f(e,["error"]);return i!=null&&d(t,["error"],IP(i)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */var Oo;(function(e){e.PAGED_ITEM_BATCH_JOBS="batchJobs",e.PAGED_ITEM_MODELS="models",e.PAGED_ITEM_TUNING_JOBS="tuningJobs",e.PAGED_ITEM_FILES="files",e.PAGED_ITEM_CACHED_CONTENTS="cachedContents"})(Oo||(Oo={}));class nd{constructor(t,n,r,i){this.pageInternal=[],this.paramsInternal={},this.requestInternal=n,this.init(t,r,i)}init(t,n,r){var i,s;this.nameInternal=t,this.pageInternal=n[this.nameInternal]||[],this.sdkHttpResponseInternal=n==null?void 0:n.sdkHttpResponse,this.idxInternal=0;let a={config:{}};!r||Object.keys(r).length===0?a={config:{}}:typeof r=="object"?a=Object.assign({},r):a=r,a.config&&(a.config.pageToken=n.nextPageToken),this.paramsInternal=a,this.pageInternalSize=(s=(i=a.config)===null||i===void 0?void 0:i.pageSize)!==null&&s!==void 0?s:this.pageInternal.length}initNextPage(t){this.init(this.nameInternal,t,this.paramsInternal)}get page(){return this.pageInternal}get name(){return this.nameInternal}get pageSize(){return this.pageInternalSize}get sdkHttpResponse(){return this.sdkHttpResponseInternal}get params(){return this.paramsInternal}get pageLength(){return this.pageInternal.length}getItem(t){return this.pageInternal[t]}[Symbol.asyncIterator](){return{next:async()=>{if(this.idxInternal>=this.pageLength)if(this.hasNextPage())await this.nextPage();else return{value:void 0,done:!0};const t=this.getItem(this.idxInternal);return this.idxInternal+=1,{value:t,done:!1}},return:async()=>({value:void 0,done:!0})}}async nextPage(){if(!this.hasNextPage())throw new Error("No more pages to fetch.");const t=await this.requestInternal(this.params);return this.initNextPage(t),this.page}hasNextPage(){var t;return((t=this.params.config)===null||t===void 0?void 0:t.pageToken)!==void 0}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lj extends el{constructor(t){super(),this.apiClient=t,this.create=async n=>{if(this.apiClient.isVertexAI()){const i=Date.now().toString();if(Array.isArray(n.src))throw new Error("InlinedRequest[] is not supported in Vertex AI. Please use Google Cloud Storage URI or BigQuery URI instead.");if(n.config=n.config||{},n.config.displayName===void 0&&(n.config.displayName="genaiBatchJob_${timestampStr}"),n.config.dest===void 0&&typeof n.src=="string")if(n.src.startsWith("gs://")&&n.src.endsWith(".jsonl"))n.config.dest=`${n.src.slice(0,-6)}/dest`;else if(n.src.startsWith("bq://"))n.config.dest=`${n.src}_dest_${i}`;else throw new Error("Unsupported source:"+n.src)}return await this.createInternal(n)},this.list=async(n={})=>new nd(Oo.PAGED_ITEM_BATCH_JOBS,r=>this.listInternal(r),await this.listInternal(n),n)}async createInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=BQ(this.apiClient,t);return o=qe("batchPredictionJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>lv(c))}else{const u=MQ(this.apiClient,t);return o=qe("{model}:batchGenerateContent",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>ov(c))}}async get(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=UQ(this.apiClient,t);return o=qe("batchPredictionJobs/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>lv(c))}else{const u=FQ(this.apiClient,t);return o=qe("batches/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>ov(c))}}async cancel(t){var n,r,i,s;let a="",o={};if(this.apiClient.isVertexAI()){const l=VQ(this.apiClient,t);a=qe("batchPredictionJobs/{name}:cancel",l._url),o=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal})}else{const l=DQ(this.apiClient,t);a=qe("batches/{name}:cancel",l._url),o=l._query,delete l.config,delete l._url,delete l._query,await this.apiClient.request({path:a,queryParams:o,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal})}}async listInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=$Q(t);return o=qe("batchPredictionJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=aj(c),p=new nC;return Object.assign(p,h),p})}else{const u=IQ(t);return o=qe("batches",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=nj(c),p=new nC;return Object.assign(p,h),p})}}async delete(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=zQ(this.apiClient,t);return o=qe("batchPredictionJobs/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>oj(c))}else{const u=NQ(this.apiClient,t);return o=qe("batches/{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>rj(c))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function uj(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function cj(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function fj(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function dj(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],uj(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],cj(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],fj(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function aC(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>dj(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function hj(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const i=f(e,["name"]);i!=null&&d(t,["name"],i);const s=f(e,["parameters"]);s!=null&&d(t,["parameters"],s);const a=f(e,["parametersJsonSchema"]);a!=null&&d(t,["parametersJsonSchema"],a);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const l=f(e,["responseJsonSchema"]);return l!=null&&d(t,["responseJsonSchema"],l),t}function pj(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function mj(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],pj(n)),t}function gj(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function vj(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],gj(n)),t}function xj(){return{}}function yj(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>hj(u))),d(t,["functionDeclarations"],l)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],mj(r));const i=f(e,["googleSearchRetrieval"]);if(i!=null&&d(t,["googleSearchRetrieval"],vj(i)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],xj());const a=f(e,["codeExecution"]);a!=null&&d(t,["codeExecution"],a);const o=f(e,["computerUse"]);return o!=null&&d(t,["computerUse"],o),t}function wj(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function Tj(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function Sj(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],Tj(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function Ej(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],wj(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],Sj(r)),t}function _j(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);t!==void 0&&i!=null&&d(t,["expireTime"],i);const s=f(e,["displayName"]);t!==void 0&&s!=null&&d(t,["displayName"],s);const a=f(e,["contents"]);if(t!==void 0&&a!=null){let c=wi(a);Array.isArray(c)&&(c=c.map(h=>aC(h))),d(t,["contents"],c)}const o=f(e,["systemInstruction"]);t!==void 0&&o!=null&&d(t,["systemInstruction"],aC(fr(o)));const l=f(e,["tools"]);if(t!==void 0&&l!=null){let c=l;Array.isArray(c)&&(c=c.map(h=>yj(h))),d(t,["tools"],c)}const u=f(e,["toolConfig"]);if(t!==void 0&&u!=null&&d(t,["toolConfig"],Ej(u)),f(e,["kmsKeyName"])!==void 0)throw new Error("kmsKeyName parameter is not supported in Gemini API.");return n}function Cj(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],xP(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],_j(i,n)),n}function kj(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Gs(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function Aj(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Gs(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function Rj(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);return t!==void 0&&i!=null&&d(t,["expireTime"],i),n}function Mj(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Gs(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],Rj(i,n)),n}function Fj(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function Dj(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],Fj(n,t)),t}function Pj(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function Ij(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function Nj(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function bj(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Pj(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],Ij(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],Nj(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function oC(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>bj(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Lj(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["parameters"]);i!=null&&d(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&d(t,["parametersJsonSchema"],s);const a=f(e,["response"]);a!=null&&d(t,["response"],a);const o=f(e,["responseJsonSchema"]);return o!=null&&d(t,["responseJsonSchema"],o),t}function Oj(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Bj(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Oj(n)),t}function Uj(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Vj(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Uj(n)),t}function Hj(){return{}}function $j(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function zj(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],$j(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const i=f(e,["googleServiceAccountConfig"]);i!=null&&d(t,["googleServiceAccountConfig"],i);const s=f(e,["httpBasicAuthConfig"]);s!=null&&d(t,["httpBasicAuthConfig"],s);const a=f(e,["oauthConfig"]);a!=null&&d(t,["oauthConfig"],a);const o=f(e,["oidcConfig"]);return o!=null&&d(t,["oidcConfig"],o),t}function Wj(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],zj(n)),t}function Gj(){return{}}function qj(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>Lj(p))),d(t,["functionDeclarations"],h)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const i=f(e,["googleSearch"]);i!=null&&d(t,["googleSearch"],Bj(i));const s=f(e,["googleSearchRetrieval"]);s!=null&&d(t,["googleSearchRetrieval"],Vj(s)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],Hj());const o=f(e,["googleMaps"]);o!=null&&d(t,["googleMaps"],Wj(o)),f(e,["urlContext"])!=null&&d(t,["urlContext"],Gj());const u=f(e,["codeExecution"]);u!=null&&d(t,["codeExecution"],u);const c=f(e,["computerUse"]);return c!=null&&d(t,["computerUse"],c),t}function Kj(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function Yj(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function Xj(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],Yj(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function Jj(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],Kj(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],Xj(r)),t}function Qj(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);t!==void 0&&i!=null&&d(t,["expireTime"],i);const s=f(e,["displayName"]);t!==void 0&&s!=null&&d(t,["displayName"],s);const a=f(e,["contents"]);if(t!==void 0&&a!=null){let h=wi(a);Array.isArray(h)&&(h=h.map(p=>oC(p))),d(t,["contents"],h)}const o=f(e,["systemInstruction"]);t!==void 0&&o!=null&&d(t,["systemInstruction"],oC(fr(o)));const l=f(e,["tools"]);if(t!==void 0&&l!=null){let h=l;Array.isArray(h)&&(h=h.map(p=>qj(p))),d(t,["tools"],h)}const u=f(e,["toolConfig"]);t!==void 0&&u!=null&&d(t,["toolConfig"],Jj(u));const c=f(e,["kmsKeyName"]);return t!==void 0&&c!=null&&d(t,["encryption_spec","kmsKeyName"],c),n}function jj(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["model"],xP(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],Qj(i,n)),n}function Zj(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Gs(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function eZ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Gs(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function tZ(e,t){const n={},r=f(e,["ttl"]);t!==void 0&&r!=null&&d(t,["ttl"],r);const i=f(e,["expireTime"]);return t!==void 0&&i!=null&&d(t,["expireTime"],i),n}function nZ(e,t){const n={},r=f(t,["name"]);r!=null&&d(n,["_url","name"],Gs(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],tZ(i,n)),n}function rZ(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function iZ(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],rZ(n,t)),t}function g0(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["model"]);i!=null&&d(t,["model"],i);const s=f(e,["createTime"]);s!=null&&d(t,["createTime"],s);const a=f(e,["updateTime"]);a!=null&&d(t,["updateTime"],a);const o=f(e,["expireTime"]);o!=null&&d(t,["expireTime"],o);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function sZ(){return{}}function aZ(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>g0(a))),d(t,["cachedContents"],s)}return t}function v0(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["model"]);i!=null&&d(t,["model"],i);const s=f(e,["createTime"]);s!=null&&d(t,["createTime"],s);const a=f(e,["updateTime"]);a!=null&&d(t,["updateTime"],a);const o=f(e,["expireTime"]);o!=null&&d(t,["expireTime"],o);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function oZ(){return{}}function lZ(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["cachedContents"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>v0(a))),d(t,["cachedContents"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class uZ extends el{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new nd(Oo.PAGED_ITEM_CACHED_CONTENTS,r=>this.listInternal(r),await this.listInternal(n),n)}async create(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=jj(this.apiClient,t);return o=qe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>v0(c))}else{const u=Cj(this.apiClient,t);return o=qe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>g0(c))}}async get(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Zj(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>v0(c))}else{const u=kj(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>g0(c))}}async delete(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=eZ(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(()=>{const c=oZ(),h=new eC;return Object.assign(h,c),h})}else{const u=Aj(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(()=>{const c=sZ(),h=new eC;return Object.assign(h,c),h})}}async update(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=nZ(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>v0(c))}else{const u=Mj(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>g0(c))}}async listInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=iZ(t);return o=qe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=lZ(c),p=new tC;return Object.assign(p,h),p})}else{const u=Dj(t);return o=qe("cachedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=aZ(c),p=new tC;return Object.assign(p,h),p})}}}function lC(e){var t=typeof Symbol=="function"&&Symbol.iterator,n=t&&e[t],r=0;if(n)return n.call(e);if(e&&typeof e.length=="number")return{next:function(){return e&&r>=e.length&&(e=void 0),{value:e&&e[r++],done:!e}}};throw new TypeError(t?"Object is not iterable.":"Symbol.iterator is not defined.")}function Qt(e){return this instanceof Qt?(this.v=e,this):new Qt(e)}function Wl(e,t,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var r=n.apply(e,t||[]),i,s=[];return i=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),i[Symbol.asyncIterator]=function(){return this},i;function a(m){return function(v){return Promise.resolve(v).then(m,h)}}function o(m,v){r[m]&&(i[m]=function(g){return new Promise(function(w,x){s.push([m,g,w,x])>1||l(m,g)})},v&&(i[m]=v(i[m])))}function l(m,v){try{u(r[m](v))}catch(g){p(s[0][3],g)}}function u(m){m.value instanceof Qt?Promise.resolve(m.value.v).then(c,h):p(s[0][2],m)}function c(m){l("next",m)}function h(m){l("throw",m)}function p(m,v){m(v),s.shift(),s.length&&l(s[0][0],s[0][1])}}function Oc(e){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var t=e[Symbol.asyncIterator],n;return t?t.call(e):(e=typeof lC=="function"?lC(e):e[Symbol.iterator](),n={},r("next"),r("throw"),r("return"),n[Symbol.asyncIterator]=function(){return this},n);function r(s){n[s]=e[s]&&function(a){return new Promise(function(o,l){a=e[s](a),i(o,l,a.done,a.value)})}}function i(s,a,o,l){Promise.resolve(l).then(function(u){s({value:u,done:o})},a)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function cZ(e){var t;if(e.candidates==null||e.candidates.length===0)return!1;const n=(t=e.candidates[0])===null||t===void 0?void 0:t.content;return n===void 0?!1:NP(n)}function NP(e){if(e.parts===void 0||e.parts.length===0)return!1;for(const t of e.parts)if(t===void 0||Object.keys(t).length===0||!t.thought&&t.text!==void 0&&t.text==="")return!1;return!0}function fZ(e){if(e.length!==0){for(const t of e)if(t.role!=="user"&&t.role!=="model")throw new Error(`Role must be user or model, but got ${t.role}.`)}}function uC(e){if(e===void 0||e.length===0)return[];const t=[],n=e.length;let r=0;for(;r<n;)if(e[r].role==="user")t.push(e[r]),r++;else{const i=[];let s=!0;for(;r<n&&e[r].role==="model";)i.push(e[r]),s&&!NP(e[r])&&(s=!1),r++;s?t.push(...i):t.pop()}return t}class dZ{constructor(t,n){this.modelsModule=t,this.apiClient=n}create(t){return new hZ(this.apiClient,this.modelsModule,t.model,t.config,structuredClone(t.history))}}class hZ{constructor(t,n,r,i={},s=[]){this.apiClient=t,this.modelsModule=n,this.model=r,this.config=i,this.history=s,this.sendPromise=Promise.resolve(),fZ(s)}async sendMessage(t){var n;await this.sendPromise;const r=fr(t.message),i=this.modelsModule.generateContent({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});return this.sendPromise=(async()=>{var s,a,o;const l=await i,u=(a=(s=l.candidates)===null||s===void 0?void 0:s[0])===null||a===void 0?void 0:a.content,c=l.automaticFunctionCallingHistory,h=this.getHistory(!0).length;let p=[];c!=null&&(p=(o=c.slice(h))!==null&&o!==void 0?o:[]);const m=u?[u]:[];this.recordHistory(r,m,p)})(),await this.sendPromise.catch(()=>{this.sendPromise=Promise.resolve()}),i}async sendMessageStream(t){var n;await this.sendPromise;const r=fr(t.message),i=this.modelsModule.generateContentStream({model:this.model,contents:this.getHistory(!0).concat(r),config:(n=t.config)!==null&&n!==void 0?n:this.config});this.sendPromise=i.then(()=>{}).catch(()=>{});const s=await i;return this.processStreamResponse(s,r)}getHistory(t=!1){const n=t?uC(this.history):this.history;return structuredClone(n)}processStreamResponse(t,n){var r,i;return Wl(this,arguments,function*(){var a,o,l,u;const c=[];try{for(var h=!0,p=Oc(t),m;m=yield Qt(p.next()),a=m.done,!a;h=!0){u=m.value,h=!1;const v=u;if(cZ(v)){const g=(i=(r=v.candidates)===null||r===void 0?void 0:r[0])===null||i===void 0?void 0:i.content;g!==void 0&&c.push(g)}yield yield Qt(v)}}catch(v){o={error:v}}finally{try{!h&&!a&&(l=p.return)&&(yield Qt(l.call(p)))}finally{if(o)throw o.error}}this.recordHistory(n,c)})}recordHistory(t,n,r){let i=[];n.length>0&&n.every(s=>s.role!==void 0)?i=n:i.push({role:"model",parts:[]}),r&&r.length>0?this.history.push(...uC(r)):this.history.push(t),this.history.push(...i)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class lp extends Error{constructor(t){super(t.message),this.name="ApiError",this.status=t.status,Object.setPrototypeOf(this,lp.prototype)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function pZ(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);return t!==void 0&&i!=null&&d(t,["_query","pageToken"],i),n}function mZ(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],pZ(n,t)),t}function gZ(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const i=f(e,["code"]);return i!=null&&d(t,["code"],i),t}function vZ(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["mimeType"]);i!=null&&d(t,["mimeType"],i);const s=f(e,["sizeBytes"]);s!=null&&d(t,["sizeBytes"],s);const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const o=f(e,["expirationTime"]);o!=null&&d(t,["expirationTime"],o);const l=f(e,["updateTime"]);l!=null&&d(t,["updateTime"],l);const u=f(e,["sha256Hash"]);u!=null&&d(t,["sha256Hash"],u);const c=f(e,["uri"]);c!=null&&d(t,["uri"],c);const h=f(e,["downloadUri"]);h!=null&&d(t,["downloadUri"],h);const p=f(e,["state"]);p!=null&&d(t,["state"],p);const m=f(e,["source"]);m!=null&&d(t,["source"],m);const v=f(e,["videoMetadata"]);v!=null&&d(t,["videoMetadata"],v);const g=f(e,["error"]);return g!=null&&d(t,["error"],gZ(g)),t}function xZ(e){const t={},n=f(e,["file"]);n!=null&&d(t,["file"],vZ(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function yZ(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],CP(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function wZ(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","file"],CP(n));const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function TZ(e){const t={},n=f(e,["details"]);n!=null&&d(t,["details"],n);const r=f(e,["message"]);r!=null&&d(t,["message"],r);const i=f(e,["code"]);return i!=null&&d(t,["code"],i),t}function uv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["mimeType"]);i!=null&&d(t,["mimeType"],i);const s=f(e,["sizeBytes"]);s!=null&&d(t,["sizeBytes"],s);const a=f(e,["createTime"]);a!=null&&d(t,["createTime"],a);const o=f(e,["expirationTime"]);o!=null&&d(t,["expirationTime"],o);const l=f(e,["updateTime"]);l!=null&&d(t,["updateTime"],l);const u=f(e,["sha256Hash"]);u!=null&&d(t,["sha256Hash"],u);const c=f(e,["uri"]);c!=null&&d(t,["uri"],c);const h=f(e,["downloadUri"]);h!=null&&d(t,["downloadUri"],h);const p=f(e,["state"]);p!=null&&d(t,["state"],p);const m=f(e,["source"]);m!=null&&d(t,["source"],m);const v=f(e,["videoMetadata"]);v!=null&&d(t,["videoMetadata"],v);const g=f(e,["error"]);return g!=null&&d(t,["error"],TZ(g)),t}function SZ(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["files"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>uv(a))),d(t,["files"],s)}return t}function EZ(e){const t={},n=f(e,["sdkHttpResponse"]);return n!=null&&d(t,["sdkHttpResponse"],n),t}function _Z(){return{}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class CZ extends el{constructor(t){super(),this.apiClient=t,this.list=async(n={})=>new nd(Oo.PAGED_ITEM_FILES,r=>this.listInternal(r),await this.listInternal(n),n)}async upload(t){if(this.apiClient.isVertexAI())throw new Error("Vertex AI does not support uploading files. You can share files through a GCS bucket.");return this.apiClient.uploadFile(t.file,t.config).then(n=>uv(n))}async download(t){await this.apiClient.downloadFile(t)}async listInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=mZ(t);return s=qe("files",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=SZ(l),c=new zJ;return Object.assign(c,u),c})}}async createInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=xZ(t);return s=qe("upload/v1beta/files",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>{const u=EZ(l),c=new WJ;return Object.assign(c,u),c})}}async get(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=yZ(t);return s=qe("files/{file}",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(l=>uv(l))}}async delete(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=wZ(t);return s=qe("files/{file}",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i.then(()=>{const l=_Z(),u=new GJ;return Object.assign(u,l),u})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kZ(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function bP(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],kZ(n)),t}function AZ(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],bP(r)),t}function RZ(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>AZ(i))),d(t,["speakerVoiceConfigs"],r)}return t}function MZ(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],bP(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],RZ(r));const i=f(e,["languageCode"]);return i!=null&&d(t,["languageCode"],i),t}function FZ(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function DZ(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function PZ(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function IZ(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],FZ(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],DZ(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],PZ(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function NZ(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>IZ(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function bZ(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const i=f(e,["name"]);i!=null&&d(t,["name"],i);const s=f(e,["parameters"]);s!=null&&d(t,["parameters"],s);const a=f(e,["parametersJsonSchema"]);a!=null&&d(t,["parametersJsonSchema"],a);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const l=f(e,["responseJsonSchema"]);return l!=null&&d(t,["responseJsonSchema"],l),t}function LZ(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function OZ(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],LZ(n)),t}function BZ(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function UZ(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],BZ(n)),t}function VZ(){return{}}function HZ(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>bZ(u))),d(t,["functionDeclarations"],l)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],OZ(r));const i=f(e,["googleSearchRetrieval"]);if(i!=null&&d(t,["googleSearchRetrieval"],UZ(i)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],VZ());const a=f(e,["codeExecution"]);a!=null&&d(t,["codeExecution"],a);const o=f(e,["computerUse"]);return o!=null&&d(t,["computerUse"],o),t}function $Z(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function cC(){return{}}function zZ(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const i=f(e,["endOfSpeechSensitivity"]);i!=null&&d(t,["endOfSpeechSensitivity"],i);const s=f(e,["prefixPaddingMs"]);s!=null&&d(t,["prefixPaddingMs"],s);const a=f(e,["silenceDurationMs"]);return a!=null&&d(t,["silenceDurationMs"],a),t}function WZ(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],zZ(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const i=f(e,["turnCoverage"]);return i!=null&&d(t,["turnCoverage"],i),t}function GZ(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function qZ(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],GZ(r)),t}function KZ(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function YZ(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&d(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&d(t,["setup","generationConfig","temperature"],s);const a=f(e,["topP"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","topP"],a);const o=f(e,["topK"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","topK"],o);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","mediaResolution"],u);const c=f(e,["seed"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","seed"],c);const h=f(e,["speechConfig"]);t!==void 0&&h!=null&&d(t,["setup","generationConfig","speechConfig"],MZ(xy(h)));const p=f(e,["enableAffectiveDialog"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],p);const m=f(e,["systemInstruction"]);t!==void 0&&m!=null&&d(t,["setup","systemInstruction"],NZ(fr(m)));const v=f(e,["tools"]);if(t!==void 0&&v!=null){let k=Nu(v);Array.isArray(k)&&(k=k.map(S=>HZ(Iu(S)))),d(t,["setup","tools"],k)}const g=f(e,["sessionResumption"]);t!==void 0&&g!=null&&d(t,["setup","sessionResumption"],$Z(g));const w=f(e,["inputAudioTranscription"]);t!==void 0&&w!=null&&d(t,["setup","inputAudioTranscription"],cC());const x=f(e,["outputAudioTranscription"]);t!==void 0&&x!=null&&d(t,["setup","outputAudioTranscription"],cC());const T=f(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&d(t,["setup","realtimeInputConfig"],WZ(T));const y=f(e,["contextWindowCompression"]);t!==void 0&&y!=null&&d(t,["setup","contextWindowCompression"],qZ(y));const _=f(e,["proactivity"]);return t!==void 0&&_!=null&&d(t,["setup","proactivity"],KZ(_)),n}function XZ(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],YZ(i,n)),n}function JZ(){return{}}function QZ(){return{}}function jZ(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],yP(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],TP(r));const i=f(e,["audioStreamEnd"]);i!=null&&d(t,["audioStreamEnd"],i);const s=f(e,["video"]);s!=null&&d(t,["video"],wP(s));const a=f(e,["text"]);return a!=null&&d(t,["text"],a),f(e,["activityStart"])!=null&&d(t,["activityStart"],JZ()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],QZ()),t}function LP(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function ZZ(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>LP(i))),d(t,["weightedPrompts"],r)}return t}function OP(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const i=f(e,["seed"]);i!=null&&d(t,["seed"],i);const s=f(e,["guidance"]);s!=null&&d(t,["guidance"],s);const a=f(e,["bpm"]);a!=null&&d(t,["bpm"],a);const o=f(e,["density"]);o!=null&&d(t,["density"],o);const l=f(e,["brightness"]);l!=null&&d(t,["brightness"],l);const u=f(e,["scale"]);u!=null&&d(t,["scale"],u);const c=f(e,["muteBass"]);c!=null&&d(t,["muteBass"],c);const h=f(e,["muteDrums"]);h!=null&&d(t,["muteDrums"],h);const p=f(e,["onlyBassAndDrums"]);return p!=null&&d(t,["onlyBassAndDrums"],p),t}function eee(e){const t={},n=f(e,["musicGenerationConfig"]);return n!=null&&d(t,["musicGenerationConfig"],OP(n)),t}function BP(e){const t={},n=f(e,["model"]);return n!=null&&d(t,["model"],n),t}function UP(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>LP(i))),d(t,["weightedPrompts"],r)}return t}function cv(e){const t={},n=f(e,["setup"]);n!=null&&d(t,["setup"],BP(n));const r=f(e,["clientContent"]);r!=null&&d(t,["clientContent"],UP(r));const i=f(e,["musicGenerationConfig"]);i!=null&&d(t,["musicGenerationConfig"],OP(i));const s=f(e,["playbackControl"]);return s!=null&&d(t,["playbackControl"],s),t}function tee(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function nee(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],tee(n)),t}function ree(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],nee(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function iee(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function see(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function aee(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function oee(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],iee(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],see(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],aee(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function lee(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>oee(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function uee(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["parameters"]);i!=null&&d(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&d(t,["parametersJsonSchema"],s);const a=f(e,["response"]);a!=null&&d(t,["response"],a);const o=f(e,["responseJsonSchema"]);return o!=null&&d(t,["responseJsonSchema"],o),t}function cee(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function fee(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],cee(n)),t}function dee(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function hee(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],dee(n)),t}function pee(){return{}}function mee(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function gee(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],mee(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const i=f(e,["googleServiceAccountConfig"]);i!=null&&d(t,["googleServiceAccountConfig"],i);const s=f(e,["httpBasicAuthConfig"]);s!=null&&d(t,["httpBasicAuthConfig"],s);const a=f(e,["oauthConfig"]);a!=null&&d(t,["oauthConfig"],a);const o=f(e,["oidcConfig"]);return o!=null&&d(t,["oidcConfig"],o),t}function vee(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],gee(n)),t}function xee(){return{}}function yee(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>uee(p))),d(t,["functionDeclarations"],h)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const i=f(e,["googleSearch"]);i!=null&&d(t,["googleSearch"],fee(i));const s=f(e,["googleSearchRetrieval"]);s!=null&&d(t,["googleSearchRetrieval"],hee(s)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],pee());const o=f(e,["googleMaps"]);o!=null&&d(t,["googleMaps"],vee(o)),f(e,["urlContext"])!=null&&d(t,["urlContext"],xee());const u=f(e,["codeExecution"]);u!=null&&d(t,["codeExecution"],u);const c=f(e,["computerUse"]);return c!=null&&d(t,["computerUse"],c),t}function wee(e){const t={},n=f(e,["handle"]);n!=null&&d(t,["handle"],n);const r=f(e,["transparent"]);return r!=null&&d(t,["transparent"],r),t}function fC(){return{}}function Tee(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const i=f(e,["endOfSpeechSensitivity"]);i!=null&&d(t,["endOfSpeechSensitivity"],i);const s=f(e,["prefixPaddingMs"]);s!=null&&d(t,["prefixPaddingMs"],s);const a=f(e,["silenceDurationMs"]);return a!=null&&d(t,["silenceDurationMs"],a),t}function See(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],Tee(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const i=f(e,["turnCoverage"]);return i!=null&&d(t,["turnCoverage"],i),t}function Eee(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function _ee(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],Eee(r)),t}function Cee(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function kee(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&d(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&d(t,["setup","generationConfig","temperature"],s);const a=f(e,["topP"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","topP"],a);const o=f(e,["topK"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","topK"],o);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","mediaResolution"],u);const c=f(e,["seed"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","seed"],c);const h=f(e,["speechConfig"]);t!==void 0&&h!=null&&d(t,["setup","generationConfig","speechConfig"],ree(xy(h)));const p=f(e,["enableAffectiveDialog"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],p);const m=f(e,["systemInstruction"]);t!==void 0&&m!=null&&d(t,["setup","systemInstruction"],lee(fr(m)));const v=f(e,["tools"]);if(t!==void 0&&v!=null){let k=Nu(v);Array.isArray(k)&&(k=k.map(S=>yee(Iu(S)))),d(t,["setup","tools"],k)}const g=f(e,["sessionResumption"]);t!==void 0&&g!=null&&d(t,["setup","sessionResumption"],wee(g));const w=f(e,["inputAudioTranscription"]);t!==void 0&&w!=null&&d(t,["setup","inputAudioTranscription"],fC());const x=f(e,["outputAudioTranscription"]);t!==void 0&&x!=null&&d(t,["setup","outputAudioTranscription"],fC());const T=f(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&d(t,["setup","realtimeInputConfig"],See(T));const y=f(e,["contextWindowCompression"]);t!==void 0&&y!=null&&d(t,["setup","contextWindowCompression"],_ee(y));const _=f(e,["proactivity"]);return t!==void 0&&_!=null&&d(t,["setup","proactivity"],Cee(_)),n}function Aee(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],kee(i,n)),n}function Ree(){return{}}function Mee(){return{}}function Fee(e){const t={},n=f(e,["media"]);n!=null&&d(t,["mediaChunks"],yP(n));const r=f(e,["audio"]);r!=null&&d(t,["audio"],TP(r));const i=f(e,["audioStreamEnd"]);i!=null&&d(t,["audioStreamEnd"],i);const s=f(e,["video"]);s!=null&&d(t,["video"],wP(s));const a=f(e,["text"]);return a!=null&&d(t,["text"],a),f(e,["activityStart"])!=null&&d(t,["activityStart"],Ree()),f(e,["activityEnd"])!=null&&d(t,["activityEnd"],Mee()),t}function Dee(){return{}}function Pee(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function Iee(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Nee(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function bee(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Pee(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],Iee(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],Nee(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function Lee(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>bee(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function dC(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function Oee(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function Bee(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Oee(i))),d(t,["urlMetadata"],r)}return t}function Uee(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],Lee(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const i=f(e,["interrupted"]);i!=null&&d(t,["interrupted"],i);const s=f(e,["groundingMetadata"]);s!=null&&d(t,["groundingMetadata"],s);const a=f(e,["generationComplete"]);a!=null&&d(t,["generationComplete"],a);const o=f(e,["inputTranscription"]);o!=null&&d(t,["inputTranscription"],dC(o));const l=f(e,["outputTranscription"]);l!=null&&d(t,["outputTranscription"],dC(l));const u=f(e,["urlContextMetadata"]);return u!=null&&d(t,["urlContextMetadata"],Bee(u)),t}function Vee(e){const t={},n=f(e,["id"]);n!=null&&d(t,["id"],n);const r=f(e,["args"]);r!=null&&d(t,["args"],r);const i=f(e,["name"]);return i!=null&&d(t,["name"],i),t}function Hee(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Vee(i))),d(t,["functionCalls"],r)}return t}function $ee(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function Gd(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function zee(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const i=f(e,["responseTokenCount"]);i!=null&&d(t,["responseTokenCount"],i);const s=f(e,["toolUsePromptTokenCount"]);s!=null&&d(t,["toolUsePromptTokenCount"],s);const a=f(e,["thoughtsTokenCount"]);a!=null&&d(t,["thoughtsTokenCount"],a);const o=f(e,["totalTokenCount"]);o!=null&&d(t,["totalTokenCount"],o);const l=f(e,["promptTokensDetails"]);if(l!=null){let p=l;Array.isArray(p)&&(p=p.map(m=>Gd(m))),d(t,["promptTokensDetails"],p)}const u=f(e,["cacheTokensDetails"]);if(u!=null){let p=u;Array.isArray(p)&&(p=p.map(m=>Gd(m))),d(t,["cacheTokensDetails"],p)}const c=f(e,["responseTokensDetails"]);if(c!=null){let p=c;Array.isArray(p)&&(p=p.map(m=>Gd(m))),d(t,["responseTokensDetails"],p)}const h=f(e,["toolUsePromptTokensDetails"]);if(h!=null){let p=h;Array.isArray(p)&&(p=p.map(m=>Gd(m))),d(t,["toolUsePromptTokensDetails"],p)}return t}function Wee(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function Gee(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const i=f(e,["lastConsumedClientMessageIndex"]);return i!=null&&d(t,["lastConsumedClientMessageIndex"],i),t}function qee(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],Dee());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Uee(r));const i=f(e,["toolCall"]);i!=null&&d(t,["toolCall"],Hee(i));const s=f(e,["toolCallCancellation"]);s!=null&&d(t,["toolCallCancellation"],$ee(s));const a=f(e,["usageMetadata"]);a!=null&&d(t,["usageMetadata"],zee(a));const o=f(e,["goAway"]);o!=null&&d(t,["goAway"],Wee(o));const l=f(e,["sessionResumptionUpdate"]);return l!=null&&d(t,["sessionResumptionUpdate"],Gee(l)),t}function Kee(){return{}}function Yee(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["weight"]);return r!=null&&d(t,["weight"],r),t}function Xee(e){const t={},n=f(e,["weightedPrompts"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Yee(i))),d(t,["weightedPrompts"],r)}return t}function Jee(e){const t={},n=f(e,["temperature"]);n!=null&&d(t,["temperature"],n);const r=f(e,["topK"]);r!=null&&d(t,["topK"],r);const i=f(e,["seed"]);i!=null&&d(t,["seed"],i);const s=f(e,["guidance"]);s!=null&&d(t,["guidance"],s);const a=f(e,["bpm"]);a!=null&&d(t,["bpm"],a);const o=f(e,["density"]);o!=null&&d(t,["density"],o);const l=f(e,["brightness"]);l!=null&&d(t,["brightness"],l);const u=f(e,["scale"]);u!=null&&d(t,["scale"],u);const c=f(e,["muteBass"]);c!=null&&d(t,["muteBass"],c);const h=f(e,["muteDrums"]);h!=null&&d(t,["muteDrums"],h);const p=f(e,["onlyBassAndDrums"]);return p!=null&&d(t,["onlyBassAndDrums"],p),t}function Qee(e){const t={},n=f(e,["clientContent"]);n!=null&&d(t,["clientContent"],Xee(n));const r=f(e,["musicGenerationConfig"]);return r!=null&&d(t,["musicGenerationConfig"],Jee(r)),t}function jee(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);r!=null&&d(t,["mimeType"],r);const i=f(e,["sourceMetadata"]);return i!=null&&d(t,["sourceMetadata"],Qee(i)),t}function Zee(e){const t={},n=f(e,["audioChunks"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>jee(i))),d(t,["audioChunks"],r)}return t}function ete(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["filteredReason"]);return r!=null&&d(t,["filteredReason"],r),t}function tte(e){const t={};f(e,["setupComplete"])!=null&&d(t,["setupComplete"],Kee());const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],Zee(r));const i=f(e,["filteredPrompt"]);return i!=null&&d(t,["filteredPrompt"],ete(i)),t}function nte(e){const t={},n=f(e,["sessionId"]);return n!=null&&d(t,["sessionId"],n),t}function rte(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function ite(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function ste(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function ate(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],rte(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],ite(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],ste(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function ote(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ate(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function hC(e){const t={},n=f(e,["text"]);n!=null&&d(t,["text"],n);const r=f(e,["finished"]);return r!=null&&d(t,["finished"],r),t}function lte(e){const t={},n=f(e,["modelTurn"]);n!=null&&d(t,["modelTurn"],ote(n));const r=f(e,["turnComplete"]);r!=null&&d(t,["turnComplete"],r);const i=f(e,["interrupted"]);i!=null&&d(t,["interrupted"],i);const s=f(e,["groundingMetadata"]);s!=null&&d(t,["groundingMetadata"],s);const a=f(e,["generationComplete"]);a!=null&&d(t,["generationComplete"],a);const o=f(e,["inputTranscription"]);o!=null&&d(t,["inputTranscription"],hC(o));const l=f(e,["outputTranscription"]);return l!=null&&d(t,["outputTranscription"],hC(l)),t}function ute(e){const t={},n=f(e,["args"]);n!=null&&d(t,["args"],n);const r=f(e,["name"]);return r!=null&&d(t,["name"],r),t}function cte(e){const t={},n=f(e,["functionCalls"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>ute(i))),d(t,["functionCalls"],r)}return t}function fte(e){const t={},n=f(e,["ids"]);return n!=null&&d(t,["ids"],n),t}function qd(e){const t={},n=f(e,["modality"]);n!=null&&d(t,["modality"],n);const r=f(e,["tokenCount"]);return r!=null&&d(t,["tokenCount"],r),t}function dte(e){const t={},n=f(e,["promptTokenCount"]);n!=null&&d(t,["promptTokenCount"],n);const r=f(e,["cachedContentTokenCount"]);r!=null&&d(t,["cachedContentTokenCount"],r);const i=f(e,["candidatesTokenCount"]);i!=null&&d(t,["responseTokenCount"],i);const s=f(e,["toolUsePromptTokenCount"]);s!=null&&d(t,["toolUsePromptTokenCount"],s);const a=f(e,["thoughtsTokenCount"]);a!=null&&d(t,["thoughtsTokenCount"],a);const o=f(e,["totalTokenCount"]);o!=null&&d(t,["totalTokenCount"],o);const l=f(e,["promptTokensDetails"]);if(l!=null){let m=l;Array.isArray(m)&&(m=m.map(v=>qd(v))),d(t,["promptTokensDetails"],m)}const u=f(e,["cacheTokensDetails"]);if(u!=null){let m=u;Array.isArray(m)&&(m=m.map(v=>qd(v))),d(t,["cacheTokensDetails"],m)}const c=f(e,["candidatesTokensDetails"]);if(c!=null){let m=c;Array.isArray(m)&&(m=m.map(v=>qd(v))),d(t,["responseTokensDetails"],m)}const h=f(e,["toolUsePromptTokensDetails"]);if(h!=null){let m=h;Array.isArray(m)&&(m=m.map(v=>qd(v))),d(t,["toolUsePromptTokensDetails"],m)}const p=f(e,["trafficType"]);return p!=null&&d(t,["trafficType"],p),t}function hte(e){const t={},n=f(e,["timeLeft"]);return n!=null&&d(t,["timeLeft"],n),t}function pte(e){const t={},n=f(e,["newHandle"]);n!=null&&d(t,["newHandle"],n);const r=f(e,["resumable"]);r!=null&&d(t,["resumable"],r);const i=f(e,["lastConsumedClientMessageIndex"]);return i!=null&&d(t,["lastConsumedClientMessageIndex"],i),t}function mte(e){const t={},n=f(e,["setupComplete"]);n!=null&&d(t,["setupComplete"],nte(n));const r=f(e,["serverContent"]);r!=null&&d(t,["serverContent"],lte(r));const i=f(e,["toolCall"]);i!=null&&d(t,["toolCall"],cte(i));const s=f(e,["toolCallCancellation"]);s!=null&&d(t,["toolCallCancellation"],fte(s));const a=f(e,["usageMetadata"]);a!=null&&d(t,["usageMetadata"],dte(a));const o=f(e,["goAway"]);o!=null&&d(t,["goAway"],hte(o));const l=f(e,["sessionResumptionUpdate"]);return l!=null&&d(t,["sessionResumptionUpdate"],pte(l)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function gte(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function vte(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function xte(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function yte(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],gte(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],vte(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],xte(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function up(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>yte(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function wte(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const i=f(e,["description"]);i!=null&&d(t,["description"],i);const s=f(e,["enum"]);s!=null&&d(t,["enum"],s);const a=f(e,["example"]);a!=null&&d(t,["example"],a);const o=f(e,["format"]);o!=null&&d(t,["format"],o);const l=f(e,["items"]);l!=null&&d(t,["items"],l);const u=f(e,["maxItems"]);u!=null&&d(t,["maxItems"],u);const c=f(e,["maxLength"]);c!=null&&d(t,["maxLength"],c);const h=f(e,["maxProperties"]);h!=null&&d(t,["maxProperties"],h);const p=f(e,["maximum"]);p!=null&&d(t,["maximum"],p);const m=f(e,["minItems"]);m!=null&&d(t,["minItems"],m);const v=f(e,["minLength"]);v!=null&&d(t,["minLength"],v);const g=f(e,["minProperties"]);g!=null&&d(t,["minProperties"],g);const w=f(e,["minimum"]);w!=null&&d(t,["minimum"],w);const x=f(e,["nullable"]);x!=null&&d(t,["nullable"],x);const T=f(e,["pattern"]);T!=null&&d(t,["pattern"],T);const y=f(e,["properties"]);y!=null&&d(t,["properties"],y);const _=f(e,["propertyOrdering"]);_!=null&&d(t,["propertyOrdering"],_);const k=f(e,["required"]);k!=null&&d(t,["required"],k);const S=f(e,["title"]);S!=null&&d(t,["title"],S);const C=f(e,["type"]);return C!=null&&d(t,["type"],C),t}function Tte(e){const t={};if(f(e,["method"])!==void 0)throw new Error("method parameter is not supported in Gemini API.");const n=f(e,["category"]);n!=null&&d(t,["category"],n);const r=f(e,["threshold"]);return r!=null&&d(t,["threshold"],r),t}function Ste(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const i=f(e,["name"]);i!=null&&d(t,["name"],i);const s=f(e,["parameters"]);s!=null&&d(t,["parameters"],s);const a=f(e,["parametersJsonSchema"]);a!=null&&d(t,["parametersJsonSchema"],a);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const l=f(e,["responseJsonSchema"]);return l!=null&&d(t,["responseJsonSchema"],l),t}function Ete(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function _te(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Ete(n)),t}function Cte(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function kte(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Cte(n)),t}function Ate(){return{}}function Rte(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>Ste(u))),d(t,["functionDeclarations"],l)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],_te(r));const i=f(e,["googleSearchRetrieval"]);if(i!=null&&d(t,["googleSearchRetrieval"],kte(i)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],Ate());const a=f(e,["codeExecution"]);a!=null&&d(t,["codeExecution"],a);const o=f(e,["computerUse"]);return o!=null&&d(t,["computerUse"],o),t}function Mte(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function Fte(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function Dte(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],Fte(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function Pte(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],Mte(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],Dte(r)),t}function Ite(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function VP(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],Ite(n)),t}function Nte(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],VP(r)),t}function bte(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Nte(i))),d(t,["speakerVoiceConfigs"],r)}return t}function Lte(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],VP(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],bte(r));const i=f(e,["languageCode"]);return i!=null&&d(t,["languageCode"],i),t}function Ote(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function Bte(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],up(fr(i)));const s=f(t,["temperature"]);s!=null&&d(r,["temperature"],s);const a=f(t,["topP"]);a!=null&&d(r,["topP"],a);const o=f(t,["topK"]);o!=null&&d(r,["topK"],o);const l=f(t,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const c=f(t,["stopSequences"]);c!=null&&d(r,["stopSequences"],c);const h=f(t,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);const p=f(t,["logprobs"]);p!=null&&d(r,["logprobs"],p);const m=f(t,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);const v=f(t,["frequencyPenalty"]);v!=null&&d(r,["frequencyPenalty"],v);const g=f(t,["seed"]);g!=null&&d(r,["seed"],g);const w=f(t,["responseMimeType"]);w!=null&&d(r,["responseMimeType"],w);const x=f(t,["responseSchema"]);x!=null&&d(r,["responseSchema"],wte(gy(x)));const T=f(t,["responseJsonSchema"]);if(T!=null&&d(r,["responseJsonSchema"],T),f(t,["routingConfig"])!==void 0)throw new Error("routingConfig parameter is not supported in Gemini API.");if(f(t,["modelSelectionConfig"])!==void 0)throw new Error("modelSelectionConfig parameter is not supported in Gemini API.");const y=f(t,["safetySettings"]);if(n!==void 0&&y!=null){let V=y;Array.isArray(V)&&(V=V.map(z=>Tte(z))),d(n,["safetySettings"],V)}const _=f(t,["tools"]);if(n!==void 0&&_!=null){let V=Nu(_);Array.isArray(V)&&(V=V.map(z=>Rte(Iu(z)))),d(n,["tools"],V)}const k=f(t,["toolConfig"]);if(n!==void 0&&k!=null&&d(n,["toolConfig"],Pte(k)),f(t,["labels"])!==void 0)throw new Error("labels parameter is not supported in Gemini API.");const S=f(t,["cachedContent"]);n!==void 0&&S!=null&&d(n,["cachedContent"],Gs(e,S));const C=f(t,["responseModalities"]);C!=null&&d(r,["responseModalities"],C);const M=f(t,["mediaResolution"]);M!=null&&d(r,["mediaResolution"],M);const F=f(t,["speechConfig"]);if(F!=null&&d(r,["speechConfig"],Lte(vy(F))),f(t,["audioTimestamp"])!==void 0)throw new Error("audioTimestamp parameter is not supported in Gemini API.");const b=f(t,["thinkingConfig"]);return b!=null&&d(r,["thinkingConfig"],Ote(b)),r}function pC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["contents"]);if(i!=null){let a=wi(i);Array.isArray(a)&&(a=a.map(o=>up(o))),d(n,["contents"],a)}const s=f(t,["config"]);return s!=null&&d(n,["generationConfig"],Bte(e,s,n)),n}function Ute(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["requests[]","taskType"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&d(t,["requests[]","title"],i);const s=f(e,["outputDimensionality"]);if(t!==void 0&&s!=null&&d(t,["requests[]","outputDimensionality"],s),f(e,["mimeType"])!==void 0)throw new Error("mimeType parameter is not supported in Gemini API.");if(f(e,["autoTruncate"])!==void 0)throw new Error("autoTruncate parameter is not supported in Gemini API.");return n}function Vte(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["contents"]);i!=null&&d(n,["requests[]","content"],EP(e,i));const s=f(t,["config"]);s!=null&&d(n,["config"],Ute(s,n));const a=f(t,["model"]);return a!==void 0&&d(n,["requests[]","model"],Wt(e,a)),n}function Hte(e,t){const n={};if(f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["negativePrompt"])!==void 0)throw new Error("negativePrompt parameter is not supported in Gemini API.");const r=f(e,["numberOfImages"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const i=f(e,["aspectRatio"]);t!==void 0&&i!=null&&d(t,["parameters","aspectRatio"],i);const s=f(e,["guidanceScale"]);if(t!==void 0&&s!=null&&d(t,["parameters","guidanceScale"],s),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const a=f(e,["safetyFilterLevel"]);t!==void 0&&a!=null&&d(t,["parameters","safetySetting"],a);const o=f(e,["personGeneration"]);t!==void 0&&o!=null&&d(t,["parameters","personGeneration"],o);const l=f(e,["includeSafetyAttributes"]);t!==void 0&&l!=null&&d(t,["parameters","includeSafetyAttributes"],l);const u=f(e,["includeRaiReason"]);t!==void 0&&u!=null&&d(t,["parameters","includeRaiReason"],u);const c=f(e,["language"]);t!==void 0&&c!=null&&d(t,["parameters","language"],c);const h=f(e,["outputMimeType"]);t!==void 0&&h!=null&&d(t,["parameters","outputOptions","mimeType"],h);const p=f(e,["outputCompressionQuality"]);if(t!==void 0&&p!=null&&d(t,["parameters","outputOptions","compressionQuality"],p),f(e,["addWatermark"])!==void 0)throw new Error("addWatermark parameter is not supported in Gemini API.");if(f(e,["imageSize"])!==void 0)throw new Error("imageSize parameter is not supported in Gemini API.");if(f(e,["enhancePrompt"])!==void 0)throw new Error("enhancePrompt parameter is not supported in Gemini API.");return n}function $te(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["config"]);return s!=null&&d(n,["config"],Hte(s,n)),n}function zte(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function Wte(e,t,n){const r={},i=f(t,["pageSize"]);n!==void 0&&i!=null&&d(n,["_query","pageSize"],i);const s=f(t,["pageToken"]);n!==void 0&&s!=null&&d(n,["_query","pageToken"],s);const a=f(t,["filter"]);n!==void 0&&a!=null&&d(n,["_query","filter"],a);const o=f(t,["queryBase"]);return n!==void 0&&o!=null&&d(n,["_url","models_url"],kP(e,o)),r}function Gte(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],Wte(e,r,n)),n}function qte(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);t!==void 0&&i!=null&&d(t,["description"],i);const s=f(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&d(t,["defaultCheckpointId"],s),n}function Kte(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],qte(i,n)),n}function Yte(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function Xte(e){const t={};if(f(e,["systemInstruction"])!==void 0)throw new Error("systemInstruction parameter is not supported in Gemini API.");if(f(e,["tools"])!==void 0)throw new Error("tools parameter is not supported in Gemini API.");if(f(e,["generationConfig"])!==void 0)throw new Error("generationConfig parameter is not supported in Gemini API.");return t}function Jte(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["contents"]);if(i!=null){let a=wi(i);Array.isArray(a)&&(a=a.map(o=>up(o))),d(n,["contents"],a)}const s=f(t,["config"]);return s!=null&&d(n,["config"],Xte(s)),n}function Qte(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");const n=f(e,["imageBytes"]);n!=null&&d(t,["bytesBase64Encoded"],tl(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function jte(e,t){const n={},r=f(e,["numberOfVideos"]);if(t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r),f(e,["outputGcsUri"])!==void 0)throw new Error("outputGcsUri parameter is not supported in Gemini API.");if(f(e,["fps"])!==void 0)throw new Error("fps parameter is not supported in Gemini API.");const i=f(e,["durationSeconds"]);if(t!==void 0&&i!=null&&d(t,["parameters","durationSeconds"],i),f(e,["seed"])!==void 0)throw new Error("seed parameter is not supported in Gemini API.");const s=f(e,["aspectRatio"]);if(t!==void 0&&s!=null&&d(t,["parameters","aspectRatio"],s),f(e,["resolution"])!==void 0)throw new Error("resolution parameter is not supported in Gemini API.");const a=f(e,["personGeneration"]);if(t!==void 0&&a!=null&&d(t,["parameters","personGeneration"],a),f(e,["pubsubTopic"])!==void 0)throw new Error("pubsubTopic parameter is not supported in Gemini API.");const o=f(e,["negativePrompt"]);t!==void 0&&o!=null&&d(t,["parameters","negativePrompt"],o);const l=f(e,["enhancePrompt"]);if(t!==void 0&&l!=null&&d(t,["parameters","enhancePrompt"],l),f(e,["generateAudio"])!==void 0)throw new Error("generateAudio parameter is not supported in Gemini API.");if(f(e,["lastFrame"])!==void 0)throw new Error("lastFrame parameter is not supported in Gemini API.");if(f(e,["compressionQuality"])!==void 0)throw new Error("compressionQuality parameter is not supported in Gemini API.");return n}function Zte(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["image"]);if(s!=null&&d(n,["instances[0]","image"],Qte(s)),f(t,["video"])!==void 0)throw new Error("video parameter is not supported in Gemini API.");const a=f(t,["config"]);return a!=null&&d(n,["config"],jte(a,n)),n}function ene(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function tne(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function nne(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function rne(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],ene(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],tne(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],nne(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function Lu(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>rne(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function ine(e){const t={},n=f(e,["anyOf"]);n!=null&&d(t,["anyOf"],n);const r=f(e,["default"]);r!=null&&d(t,["default"],r);const i=f(e,["description"]);i!=null&&d(t,["description"],i);const s=f(e,["enum"]);s!=null&&d(t,["enum"],s);const a=f(e,["example"]);a!=null&&d(t,["example"],a);const o=f(e,["format"]);o!=null&&d(t,["format"],o);const l=f(e,["items"]);l!=null&&d(t,["items"],l);const u=f(e,["maxItems"]);u!=null&&d(t,["maxItems"],u);const c=f(e,["maxLength"]);c!=null&&d(t,["maxLength"],c);const h=f(e,["maxProperties"]);h!=null&&d(t,["maxProperties"],h);const p=f(e,["maximum"]);p!=null&&d(t,["maximum"],p);const m=f(e,["minItems"]);m!=null&&d(t,["minItems"],m);const v=f(e,["minLength"]);v!=null&&d(t,["minLength"],v);const g=f(e,["minProperties"]);g!=null&&d(t,["minProperties"],g);const w=f(e,["minimum"]);w!=null&&d(t,["minimum"],w);const x=f(e,["nullable"]);x!=null&&d(t,["nullable"],x);const T=f(e,["pattern"]);T!=null&&d(t,["pattern"],T);const y=f(e,["properties"]);y!=null&&d(t,["properties"],y);const _=f(e,["propertyOrdering"]);_!=null&&d(t,["propertyOrdering"],_);const k=f(e,["required"]);k!=null&&d(t,["required"],k);const S=f(e,["title"]);S!=null&&d(t,["title"],S);const C=f(e,["type"]);return C!=null&&d(t,["type"],C),t}function sne(e){const t={},n=f(e,["featureSelectionPreference"]);return n!=null&&d(t,["featureSelectionPreference"],n),t}function ane(e){const t={},n=f(e,["method"]);n!=null&&d(t,["method"],n);const r=f(e,["category"]);r!=null&&d(t,["category"],r);const i=f(e,["threshold"]);return i!=null&&d(t,["threshold"],i),t}function one(e){const t={};if(f(e,["behavior"])!==void 0)throw new Error("behavior parameter is not supported in Vertex AI.");const n=f(e,["description"]);n!=null&&d(t,["description"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["parameters"]);i!=null&&d(t,["parameters"],i);const s=f(e,["parametersJsonSchema"]);s!=null&&d(t,["parametersJsonSchema"],s);const a=f(e,["response"]);a!=null&&d(t,["response"],a);const o=f(e,["responseJsonSchema"]);return o!=null&&d(t,["responseJsonSchema"],o),t}function lne(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function une(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],lne(n)),t}function cne(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function fne(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],cne(n)),t}function dne(){return{}}function hne(e){const t={},n=f(e,["apiKeyString"]);return n!=null&&d(t,["apiKeyString"],n),t}function pne(e){const t={},n=f(e,["apiKeyConfig"]);n!=null&&d(t,["apiKeyConfig"],hne(n));const r=f(e,["authType"]);r!=null&&d(t,["authType"],r);const i=f(e,["googleServiceAccountConfig"]);i!=null&&d(t,["googleServiceAccountConfig"],i);const s=f(e,["httpBasicAuthConfig"]);s!=null&&d(t,["httpBasicAuthConfig"],s);const a=f(e,["oauthConfig"]);a!=null&&d(t,["oauthConfig"],a);const o=f(e,["oidcConfig"]);return o!=null&&d(t,["oidcConfig"],o),t}function mne(e){const t={},n=f(e,["authConfig"]);return n!=null&&d(t,["authConfig"],pne(n)),t}function gne(){return{}}function HP(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let h=n;Array.isArray(h)&&(h=h.map(p=>one(p))),d(t,["functionDeclarations"],h)}const r=f(e,["retrieval"]);r!=null&&d(t,["retrieval"],r);const i=f(e,["googleSearch"]);i!=null&&d(t,["googleSearch"],une(i));const s=f(e,["googleSearchRetrieval"]);s!=null&&d(t,["googleSearchRetrieval"],fne(s)),f(e,["enterpriseWebSearch"])!=null&&d(t,["enterpriseWebSearch"],dne());const o=f(e,["googleMaps"]);o!=null&&d(t,["googleMaps"],mne(o)),f(e,["urlContext"])!=null&&d(t,["urlContext"],gne());const u=f(e,["codeExecution"]);u!=null&&d(t,["codeExecution"],u);const c=f(e,["computerUse"]);return c!=null&&d(t,["computerUse"],c),t}function vne(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["allowedFunctionNames"]);return r!=null&&d(t,["allowedFunctionNames"],r),t}function xne(e){const t={},n=f(e,["latitude"]);n!=null&&d(t,["latitude"],n);const r=f(e,["longitude"]);return r!=null&&d(t,["longitude"],r),t}function yne(e){const t={},n=f(e,["latLng"]);n!=null&&d(t,["latLng"],xne(n));const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function wne(e){const t={},n=f(e,["functionCallingConfig"]);n!=null&&d(t,["functionCallingConfig"],vne(n));const r=f(e,["retrievalConfig"]);return r!=null&&d(t,["retrievalConfig"],yne(r)),t}function Tne(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function Sne(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],Tne(n)),t}function Ene(e){const t={},n=f(e,["voiceConfig"]);if(n!=null&&d(t,["voiceConfig"],Sne(n)),f(e,["multiSpeakerVoiceConfig"])!==void 0)throw new Error("multiSpeakerVoiceConfig parameter is not supported in Vertex AI.");const r=f(e,["languageCode"]);return r!=null&&d(t,["languageCode"],r),t}function _ne(e){const t={},n=f(e,["includeThoughts"]);n!=null&&d(t,["includeThoughts"],n);const r=f(e,["thinkingBudget"]);return r!=null&&d(t,["thinkingBudget"],r),t}function Cne(e,t,n){const r={},i=f(t,["systemInstruction"]);n!==void 0&&i!=null&&d(n,["systemInstruction"],Lu(fr(i)));const s=f(t,["temperature"]);s!=null&&d(r,["temperature"],s);const a=f(t,["topP"]);a!=null&&d(r,["topP"],a);const o=f(t,["topK"]);o!=null&&d(r,["topK"],o);const l=f(t,["candidateCount"]);l!=null&&d(r,["candidateCount"],l);const u=f(t,["maxOutputTokens"]);u!=null&&d(r,["maxOutputTokens"],u);const c=f(t,["stopSequences"]);c!=null&&d(r,["stopSequences"],c);const h=f(t,["responseLogprobs"]);h!=null&&d(r,["responseLogprobs"],h);const p=f(t,["logprobs"]);p!=null&&d(r,["logprobs"],p);const m=f(t,["presencePenalty"]);m!=null&&d(r,["presencePenalty"],m);const v=f(t,["frequencyPenalty"]);v!=null&&d(r,["frequencyPenalty"],v);const g=f(t,["seed"]);g!=null&&d(r,["seed"],g);const w=f(t,["responseMimeType"]);w!=null&&d(r,["responseMimeType"],w);const x=f(t,["responseSchema"]);x!=null&&d(r,["responseSchema"],ine(gy(x)));const T=f(t,["responseJsonSchema"]);T!=null&&d(r,["responseJsonSchema"],T);const y=f(t,["routingConfig"]);y!=null&&d(r,["routingConfig"],y);const _=f(t,["modelSelectionConfig"]);_!=null&&d(r,["modelConfig"],sne(_));const k=f(t,["safetySettings"]);if(n!==void 0&&k!=null){let se=k;Array.isArray(se)&&(se=se.map(de=>ane(de))),d(n,["safetySettings"],se)}const S=f(t,["tools"]);if(n!==void 0&&S!=null){let se=Nu(S);Array.isArray(se)&&(se=se.map(de=>HP(Iu(de)))),d(n,["tools"],se)}const C=f(t,["toolConfig"]);n!==void 0&&C!=null&&d(n,["toolConfig"],wne(C));const M=f(t,["labels"]);n!==void 0&&M!=null&&d(n,["labels"],M);const F=f(t,["cachedContent"]);n!==void 0&&F!=null&&d(n,["cachedContent"],Gs(e,F));const b=f(t,["responseModalities"]);b!=null&&d(r,["responseModalities"],b);const V=f(t,["mediaResolution"]);V!=null&&d(r,["mediaResolution"],V);const z=f(t,["speechConfig"]);z!=null&&d(r,["speechConfig"],Ene(vy(z)));const ie=f(t,["audioTimestamp"]);ie!=null&&d(r,["audioTimestamp"],ie);const Q=f(t,["thinkingConfig"]);return Q!=null&&d(r,["thinkingConfig"],_ne(Q)),r}function mC(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["contents"]);if(i!=null){let a=wi(i);Array.isArray(a)&&(a=a.map(o=>Lu(o))),d(n,["contents"],a)}const s=f(t,["config"]);return s!=null&&d(n,["generationConfig"],Cne(e,s,n)),n}function kne(e,t){const n={},r=f(e,["taskType"]);t!==void 0&&r!=null&&d(t,["instances[]","task_type"],r);const i=f(e,["title"]);t!==void 0&&i!=null&&d(t,["instances[]","title"],i);const s=f(e,["outputDimensionality"]);t!==void 0&&s!=null&&d(t,["parameters","outputDimensionality"],s);const a=f(e,["mimeType"]);t!==void 0&&a!=null&&d(t,["instances[]","mimeType"],a);const o=f(e,["autoTruncate"]);return t!==void 0&&o!=null&&d(t,["parameters","autoTruncate"],o),n}function Ane(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["contents"]);i!=null&&d(n,["instances[]","content"],EP(e,i));const s=f(t,["config"]);return s!=null&&d(n,["config"],kne(s,n)),n}function Rne(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const i=f(e,["negativePrompt"]);t!==void 0&&i!=null&&d(t,["parameters","negativePrompt"],i);const s=f(e,["numberOfImages"]);t!==void 0&&s!=null&&d(t,["parameters","sampleCount"],s);const a=f(e,["aspectRatio"]);t!==void 0&&a!=null&&d(t,["parameters","aspectRatio"],a);const o=f(e,["guidanceScale"]);t!==void 0&&o!=null&&d(t,["parameters","guidanceScale"],o);const l=f(e,["seed"]);t!==void 0&&l!=null&&d(t,["parameters","seed"],l);const u=f(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&d(t,["parameters","safetySetting"],u);const c=f(e,["personGeneration"]);t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c);const h=f(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&d(t,["parameters","includeSafetyAttributes"],h);const p=f(e,["includeRaiReason"]);t!==void 0&&p!=null&&d(t,["parameters","includeRaiReason"],p);const m=f(e,["language"]);t!==void 0&&m!=null&&d(t,["parameters","language"],m);const v=f(e,["outputMimeType"]);t!==void 0&&v!=null&&d(t,["parameters","outputOptions","mimeType"],v);const g=f(e,["outputCompressionQuality"]);t!==void 0&&g!=null&&d(t,["parameters","outputOptions","compressionQuality"],g);const w=f(e,["addWatermark"]);t!==void 0&&w!=null&&d(t,["parameters","addWatermark"],w);const x=f(e,["imageSize"]);t!==void 0&&x!=null&&d(t,["parameters","sampleImageSize"],x);const T=f(e,["enhancePrompt"]);return t!==void 0&&T!=null&&d(t,["parameters","enhancePrompt"],T),n}function Mne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["config"]);return s!=null&&d(n,["config"],Rne(s,n)),n}function cp(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["imageBytes"]);r!=null&&d(t,["bytesBase64Encoded"],tl(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function Fne(e){const t={},n=f(e,["maskMode"]);n!=null&&d(t,["maskMode"],n);const r=f(e,["segmentationClasses"]);r!=null&&d(t,["maskClasses"],r);const i=f(e,["maskDilation"]);return i!=null&&d(t,["dilation"],i),t}function Dne(e){const t={},n=f(e,["controlType"]);n!=null&&d(t,["controlType"],n);const r=f(e,["enableControlImageComputation"]);return r!=null&&d(t,["computeControl"],r),t}function Pne(e){const t={},n=f(e,["styleDescription"]);return n!=null&&d(t,["styleDescription"],n),t}function Ine(e){const t={},n=f(e,["subjectType"]);n!=null&&d(t,["subjectType"],n);const r=f(e,["subjectDescription"]);return r!=null&&d(t,["subjectDescription"],r),t}function Nne(e){const t={},n=f(e,["referenceImage"]);n!=null&&d(t,["referenceImage"],cp(n));const r=f(e,["referenceId"]);r!=null&&d(t,["referenceId"],r);const i=f(e,["referenceType"]);i!=null&&d(t,["referenceType"],i);const s=f(e,["maskImageConfig"]);s!=null&&d(t,["maskImageConfig"],Fne(s));const a=f(e,["controlImageConfig"]);a!=null&&d(t,["controlImageConfig"],Dne(a));const o=f(e,["styleImageConfig"]);o!=null&&d(t,["styleImageConfig"],Pne(o));const l=f(e,["subjectImageConfig"]);return l!=null&&d(t,["subjectImageConfig"],Ine(l)),t}function bne(e,t){const n={},r=f(e,["outputGcsUri"]);t!==void 0&&r!=null&&d(t,["parameters","storageUri"],r);const i=f(e,["negativePrompt"]);t!==void 0&&i!=null&&d(t,["parameters","negativePrompt"],i);const s=f(e,["numberOfImages"]);t!==void 0&&s!=null&&d(t,["parameters","sampleCount"],s);const a=f(e,["aspectRatio"]);t!==void 0&&a!=null&&d(t,["parameters","aspectRatio"],a);const o=f(e,["guidanceScale"]);t!==void 0&&o!=null&&d(t,["parameters","guidanceScale"],o);const l=f(e,["seed"]);t!==void 0&&l!=null&&d(t,["parameters","seed"],l);const u=f(e,["safetyFilterLevel"]);t!==void 0&&u!=null&&d(t,["parameters","safetySetting"],u);const c=f(e,["personGeneration"]);t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c);const h=f(e,["includeSafetyAttributes"]);t!==void 0&&h!=null&&d(t,["parameters","includeSafetyAttributes"],h);const p=f(e,["includeRaiReason"]);t!==void 0&&p!=null&&d(t,["parameters","includeRaiReason"],p);const m=f(e,["language"]);t!==void 0&&m!=null&&d(t,["parameters","language"],m);const v=f(e,["outputMimeType"]);t!==void 0&&v!=null&&d(t,["parameters","outputOptions","mimeType"],v);const g=f(e,["outputCompressionQuality"]);t!==void 0&&g!=null&&d(t,["parameters","outputOptions","compressionQuality"],g);const w=f(e,["addWatermark"]);t!==void 0&&w!=null&&d(t,["parameters","addWatermark"],w);const x=f(e,["editMode"]);t!==void 0&&x!=null&&d(t,["parameters","editMode"],x);const T=f(e,["baseSteps"]);return t!==void 0&&T!=null&&d(t,["parameters","editConfig","baseSteps"],T),n}function Lne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["referenceImages"]);if(s!=null){let o=s;Array.isArray(o)&&(o=o.map(l=>Nne(l))),d(n,["instances[0]","referenceImages"],o)}const a=f(t,["config"]);return a!=null&&d(n,["config"],bne(a,n)),n}function One(e,t){const n={},r=f(e,["includeRaiReason"]);t!==void 0&&r!=null&&d(t,["parameters","includeRaiReason"],r);const i=f(e,["outputMimeType"]);t!==void 0&&i!=null&&d(t,["parameters","outputOptions","mimeType"],i);const s=f(e,["outputCompressionQuality"]);t!==void 0&&s!=null&&d(t,["parameters","outputOptions","compressionQuality"],s);const a=f(e,["enhanceInputImage"]);t!==void 0&&a!=null&&d(t,["parameters","upscaleConfig","enhanceInputImage"],a);const o=f(e,["imagePreservationFactor"]);t!==void 0&&o!=null&&d(t,["parameters","upscaleConfig","imagePreservationFactor"],o);const l=f(e,["numberOfImages"]);t!==void 0&&l!=null&&d(t,["parameters","sampleCount"],l);const u=f(e,["mode"]);return t!==void 0&&u!=null&&d(t,["parameters","mode"],u),n}function Bne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["image"]);i!=null&&d(n,["instances[0]","image"],cp(i));const s=f(t,["upscaleFactor"]);s!=null&&d(n,["parameters","upscaleConfig","upscaleFactor"],s);const a=f(t,["config"]);return a!=null&&d(n,["config"],One(a,n)),n}function Une(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function Vne(e,t,n){const r={},i=f(t,["pageSize"]);n!==void 0&&i!=null&&d(n,["_query","pageSize"],i);const s=f(t,["pageToken"]);n!==void 0&&s!=null&&d(n,["_query","pageToken"],s);const a=f(t,["filter"]);n!==void 0&&a!=null&&d(n,["_query","filter"],a);const o=f(t,["queryBase"]);return n!==void 0&&o!=null&&d(n,["_url","models_url"],kP(e,o)),r}function Hne(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],Vne(e,r,n)),n}function $ne(e,t){const n={},r=f(e,["displayName"]);t!==void 0&&r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);t!==void 0&&i!=null&&d(t,["description"],i);const s=f(e,["defaultCheckpointId"]);return t!==void 0&&s!=null&&d(t,["defaultCheckpointId"],s),n}function zne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],$ne(i,n)),n}function Wne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","name"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],i),n}function Gne(e,t){const n={},r=f(e,["systemInstruction"]);t!==void 0&&r!=null&&d(t,["systemInstruction"],Lu(fr(r)));const i=f(e,["tools"]);if(t!==void 0&&i!=null){let a=i;Array.isArray(a)&&(a=a.map(o=>HP(o))),d(t,["tools"],a)}const s=f(e,["generationConfig"]);return t!==void 0&&s!=null&&d(t,["generationConfig"],s),n}function qne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["contents"]);if(i!=null){let a=wi(i);Array.isArray(a)&&(a=a.map(o=>Lu(o))),d(n,["contents"],a)}const s=f(t,["config"]);return s!=null&&d(n,["config"],Gne(s,n)),n}function Kne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["contents"]);if(i!=null){let a=wi(i);Array.isArray(a)&&(a=a.map(o=>Lu(o))),d(n,["contents"],a)}const s=f(t,["config"]);return s!=null&&d(n,["config"],s),n}function Yne(e){const t={},n=f(e,["uri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["videoBytes"]);r!=null&&d(t,["bytesBase64Encoded"],tl(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function Xne(e,t){const n={},r=f(e,["numberOfVideos"]);t!==void 0&&r!=null&&d(t,["parameters","sampleCount"],r);const i=f(e,["outputGcsUri"]);t!==void 0&&i!=null&&d(t,["parameters","storageUri"],i);const s=f(e,["fps"]);t!==void 0&&s!=null&&d(t,["parameters","fps"],s);const a=f(e,["durationSeconds"]);t!==void 0&&a!=null&&d(t,["parameters","durationSeconds"],a);const o=f(e,["seed"]);t!==void 0&&o!=null&&d(t,["parameters","seed"],o);const l=f(e,["aspectRatio"]);t!==void 0&&l!=null&&d(t,["parameters","aspectRatio"],l);const u=f(e,["resolution"]);t!==void 0&&u!=null&&d(t,["parameters","resolution"],u);const c=f(e,["personGeneration"]);t!==void 0&&c!=null&&d(t,["parameters","personGeneration"],c);const h=f(e,["pubsubTopic"]);t!==void 0&&h!=null&&d(t,["parameters","pubsubTopic"],h);const p=f(e,["negativePrompt"]);t!==void 0&&p!=null&&d(t,["parameters","negativePrompt"],p);const m=f(e,["enhancePrompt"]);t!==void 0&&m!=null&&d(t,["parameters","enhancePrompt"],m);const v=f(e,["generateAudio"]);t!==void 0&&v!=null&&d(t,["parameters","generateAudio"],v);const g=f(e,["lastFrame"]);t!==void 0&&g!=null&&d(t,["instances[0]","lastFrame"],cp(g));const w=f(e,["compressionQuality"]);return t!==void 0&&w!=null&&d(t,["parameters","compressionQuality"],w),n}function Jne(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["_url","model"],Wt(e,r));const i=f(t,["prompt"]);i!=null&&d(n,["instances[0]","prompt"],i);const s=f(t,["image"]);s!=null&&d(n,["instances[0]","image"],cp(s));const a=f(t,["video"]);a!=null&&d(n,["instances[0]","video"],Yne(a));const o=f(t,["config"]);return o!=null&&d(n,["config"],Xne(o,n)),n}function Qne(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function jne(e){const t={},n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Zne(e){const t={},n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function ere(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Qne(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],jne(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],Zne(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function tre(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>ere(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function nre(e){const t={},n=f(e,["citationSources"]);return n!=null&&d(t,["citations"],n),t}function rre(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function ire(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>rre(i))),d(t,["urlMetadata"],r)}return t}function sre(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],tre(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],nre(r));const i=f(e,["tokenCount"]);i!=null&&d(t,["tokenCount"],i);const s=f(e,["finishReason"]);s!=null&&d(t,["finishReason"],s);const a=f(e,["urlContextMetadata"]);a!=null&&d(t,["urlContextMetadata"],ire(a));const o=f(e,["avgLogprobs"]);o!=null&&d(t,["avgLogprobs"],o);const l=f(e,["groundingMetadata"]);l!=null&&d(t,["groundingMetadata"],l);const u=f(e,["index"]);u!=null&&d(t,["index"],u);const c=f(e,["logprobsResult"]);c!=null&&d(t,["logprobsResult"],c);const h=f(e,["safetyRatings"]);return h!=null&&d(t,["safetyRatings"],h),t}function gC(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let o=r;Array.isArray(o)&&(o=o.map(l=>sre(l))),d(t,["candidates"],o)}const i=f(e,["modelVersion"]);i!=null&&d(t,["modelVersion"],i);const s=f(e,["promptFeedback"]);s!=null&&d(t,["promptFeedback"],s);const a=f(e,["usageMetadata"]);return a!=null&&d(t,["usageMetadata"],a),t}function are(e){const t={},n=f(e,["values"]);return n!=null&&d(t,["values"],n),t}function ore(){return{}}function lre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>are(a))),d(t,["embeddings"],s)}return f(e,["metadata"])!=null&&d(t,["metadata"],ore()),t}function ure(e){const t={},n=f(e,["bytesBase64Encoded"]);n!=null&&d(t,["imageBytes"],tl(n));const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function $P(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const i=f(e,["contentType"]);return i!=null&&d(t,["contentType"],i),t}function cre(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],ure(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const i=f(e,["_self"]);return i!=null&&d(t,["safetyAttributes"],$P(i)),t}function fre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>cre(a))),d(t,["generatedImages"],s)}const i=f(e,["positivePromptSafetyAttributes"]);return i!=null&&d(t,["positivePromptSafetyAttributes"],$P(i)),t}function dre(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const i=f(e,["updateTime"]);return i!=null&&d(t,["updateTime"],i),t}function fv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);i!=null&&d(t,["description"],i);const s=f(e,["version"]);s!=null&&d(t,["version"],s);const a=f(e,["_self"]);a!=null&&d(t,["tunedModelInfo"],dre(a));const o=f(e,["inputTokenLimit"]);o!=null&&d(t,["inputTokenLimit"],o);const l=f(e,["outputTokenLimit"]);l!=null&&d(t,["outputTokenLimit"],l);const u=f(e,["supportedGenerationMethods"]);return u!=null&&d(t,["supportedActions"],u),t}function hre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["_self"]);if(i!=null){let s=AP(i);Array.isArray(s)&&(s=s.map(a=>fv(a))),d(t,["models"],s)}return t}function pre(){return{}}function mre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["totalTokens"]);r!=null&&d(t,["totalTokens"],r);const i=f(e,["cachedContentTokenCount"]);return i!=null&&d(t,["cachedContentTokenCount"],i),t}function gre(e){const t={},n=f(e,["video","uri"]);n!=null&&d(t,["uri"],n);const r=f(e,["video","encodedVideo"]);r!=null&&d(t,["videoBytes"],tl(r));const i=f(e,["encoding"]);return i!=null&&d(t,["mimeType"],i),t}function vre(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],gre(n)),t}function xre(e){const t={},n=f(e,["generatedSamples"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>vre(a))),d(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&d(t,["raiMediaFilteredReasons"],i),t}function yre(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const a=f(e,["response","generateVideoResponse"]);return a!=null&&d(t,["response"],xre(a)),t}function wre(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function Tre(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["data"]);r!=null&&d(t,["data"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function Sre(e){const t={},n=f(e,["displayName"]);n!=null&&d(t,["displayName"],n);const r=f(e,["fileUri"]);r!=null&&d(t,["fileUri"],r);const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function Ere(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],wre(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],Tre(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],Sre(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function _re(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Ere(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function Cre(e){const t={},n=f(e,["citations"]);return n!=null&&d(t,["citations"],n),t}function kre(e){const t={},n=f(e,["retrievedUrl"]);n!=null&&d(t,["retrievedUrl"],n);const r=f(e,["urlRetrievalStatus"]);return r!=null&&d(t,["urlRetrievalStatus"],r),t}function Are(e){const t={},n=f(e,["urlMetadata"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>kre(i))),d(t,["urlMetadata"],r)}return t}function Rre(e){const t={},n=f(e,["content"]);n!=null&&d(t,["content"],_re(n));const r=f(e,["citationMetadata"]);r!=null&&d(t,["citationMetadata"],Cre(r));const i=f(e,["finishMessage"]);i!=null&&d(t,["finishMessage"],i);const s=f(e,["finishReason"]);s!=null&&d(t,["finishReason"],s);const a=f(e,["urlContextMetadata"]);a!=null&&d(t,["urlContextMetadata"],Are(a));const o=f(e,["avgLogprobs"]);o!=null&&d(t,["avgLogprobs"],o);const l=f(e,["groundingMetadata"]);l!=null&&d(t,["groundingMetadata"],l);const u=f(e,["index"]);u!=null&&d(t,["index"],u);const c=f(e,["logprobsResult"]);c!=null&&d(t,["logprobsResult"],c);const h=f(e,["safetyRatings"]);return h!=null&&d(t,["safetyRatings"],h),t}function vC(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["candidates"]);if(r!=null){let u=r;Array.isArray(u)&&(u=u.map(c=>Rre(c))),d(t,["candidates"],u)}const i=f(e,["createTime"]);i!=null&&d(t,["createTime"],i);const s=f(e,["responseId"]);s!=null&&d(t,["responseId"],s);const a=f(e,["modelVersion"]);a!=null&&d(t,["modelVersion"],a);const o=f(e,["promptFeedback"]);o!=null&&d(t,["promptFeedback"],o);const l=f(e,["usageMetadata"]);return l!=null&&d(t,["usageMetadata"],l),t}function Mre(e){const t={},n=f(e,["truncated"]);n!=null&&d(t,["truncated"],n);const r=f(e,["token_count"]);return r!=null&&d(t,["tokenCount"],r),t}function Fre(e){const t={},n=f(e,["values"]);n!=null&&d(t,["values"],n);const r=f(e,["statistics"]);return r!=null&&d(t,["statistics"],Mre(r)),t}function Dre(e){const t={},n=f(e,["billableCharacterCount"]);return n!=null&&d(t,["billableCharacterCount"],n),t}function Pre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions[]","embeddings"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>Fre(a))),d(t,["embeddings"],s)}const i=f(e,["metadata"]);return i!=null&&d(t,["metadata"],Dre(i)),t}function Ire(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["gcsUri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["imageBytes"],tl(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function zP(e){const t={},n=f(e,["safetyAttributes","categories"]);n!=null&&d(t,["categories"],n);const r=f(e,["safetyAttributes","scores"]);r!=null&&d(t,["scores"],r);const i=f(e,["contentType"]);return i!=null&&d(t,["contentType"],i),t}function yy(e){const t={},n=f(e,["_self"]);n!=null&&d(t,["image"],Ire(n));const r=f(e,["raiFilteredReason"]);r!=null&&d(t,["raiFilteredReason"],r);const i=f(e,["_self"]);i!=null&&d(t,["safetyAttributes"],zP(i));const s=f(e,["prompt"]);return s!=null&&d(t,["enhancedPrompt"],s),t}function Nre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let s=r;Array.isArray(s)&&(s=s.map(a=>yy(a))),d(t,["generatedImages"],s)}const i=f(e,["positivePromptSafetyAttributes"]);return i!=null&&d(t,["positivePromptSafetyAttributes"],zP(i)),t}function bre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>yy(s))),d(t,["generatedImages"],i)}return t}function Lre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["predictions"]);if(r!=null){let i=r;Array.isArray(i)&&(i=i.map(s=>yy(s))),d(t,["generatedImages"],i)}return t}function Ore(e){const t={},n=f(e,["endpoint"]);n!=null&&d(t,["name"],n);const r=f(e,["deployedModelId"]);return r!=null&&d(t,["deployedModelId"],r),t}function Bre(e){const t={},n=f(e,["labels","google-vertex-llm-tuning-base-model-id"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["createTime"]);r!=null&&d(t,["createTime"],r);const i=f(e,["updateTime"]);return i!=null&&d(t,["updateTime"],i),t}function Ure(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const i=f(e,["step"]);return i!=null&&d(t,["step"],i),t}function dv(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["displayName"]);r!=null&&d(t,["displayName"],r);const i=f(e,["description"]);i!=null&&d(t,["description"],i);const s=f(e,["versionId"]);s!=null&&d(t,["version"],s);const a=f(e,["deployedModels"]);if(a!=null){let h=a;Array.isArray(h)&&(h=h.map(p=>Ore(p))),d(t,["endpoints"],h)}const o=f(e,["labels"]);o!=null&&d(t,["labels"],o);const l=f(e,["_self"]);l!=null&&d(t,["tunedModelInfo"],Bre(l));const u=f(e,["defaultCheckpointId"]);u!=null&&d(t,["defaultCheckpointId"],u);const c=f(e,["checkpoints"]);if(c!=null){let h=c;Array.isArray(h)&&(h=h.map(p=>Ure(p))),d(t,["checkpoints"],h)}return t}function Vre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["_self"]);if(i!=null){let s=AP(i);Array.isArray(s)&&(s=s.map(a=>dv(a))),d(t,["models"],s)}return t}function Hre(){return{}}function $re(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["totalTokens"]);return r!=null&&d(t,["totalTokens"],r),t}function zre(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["tokensInfo"]);return r!=null&&d(t,["tokensInfo"],r),t}function Wre(e){const t={},n=f(e,["gcsUri"]);n!=null&&d(t,["uri"],n);const r=f(e,["bytesBase64Encoded"]);r!=null&&d(t,["videoBytes"],tl(r));const i=f(e,["mimeType"]);return i!=null&&d(t,["mimeType"],i),t}function Gre(e){const t={},n=f(e,["_self"]);return n!=null&&d(t,["video"],Wre(n)),t}function qre(e){const t={},n=f(e,["videos"]);if(n!=null){let s=n;Array.isArray(s)&&(s=s.map(a=>Gre(a))),d(t,["generatedVideos"],s)}const r=f(e,["raiMediaFilteredCount"]);r!=null&&d(t,["raiMediaFilteredCount"],r);const i=f(e,["raiMediaFilteredReasons"]);return i!=null&&d(t,["raiMediaFilteredReasons"],i),t}function Kre(e){const t={},n=f(e,["name"]);n!=null&&d(t,["name"],n);const r=f(e,["metadata"]);r!=null&&d(t,["metadata"],r);const i=f(e,["done"]);i!=null&&d(t,["done"],i);const s=f(e,["error"]);s!=null&&d(t,["error"],s);const a=f(e,["response"]);return a!=null&&d(t,["response"],qre(a)),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const Yre="Content-Type",Xre="X-Server-Timeout",Jre="User-Agent",hv="x-goog-api-client",Qre="1.12.0",jre=`google-genai-sdk/${Qre}`,Zre="v1beta1",eie="v1beta",xC=/^data: (.*)(?:\n\n|\r\r|\r\n\r\n)/;class tie{constructor(t){var n,r;this.clientOptions=Object.assign(Object.assign({},t),{project:t.project,location:t.location,apiKey:t.apiKey,vertexai:t.vertexai});const i={};this.clientOptions.vertexai?(i.apiVersion=(n=this.clientOptions.apiVersion)!==null&&n!==void 0?n:Zre,i.baseUrl=this.baseUrlFromProjectLocation(),this.normalizeAuthParameters()):(i.apiVersion=(r=this.clientOptions.apiVersion)!==null&&r!==void 0?r:eie,i.baseUrl="https://generativelanguage.googleapis.com/"),i.headers=this.getDefaultHeaders(),this.clientOptions.httpOptions=i,t.httpOptions&&(this.clientOptions.httpOptions=this.patchHttpOptions(i,t.httpOptions))}baseUrlFromProjectLocation(){return this.clientOptions.project&&this.clientOptions.location&&this.clientOptions.location!=="global"?`https://${this.clientOptions.location}-aiplatform.googleapis.com/`:"https://aiplatform.googleapis.com/"}normalizeAuthParameters(){if(this.clientOptions.project&&this.clientOptions.location){this.clientOptions.apiKey=void 0;return}this.clientOptions.project=void 0,this.clientOptions.location=void 0}isVertexAI(){var t;return(t=this.clientOptions.vertexai)!==null&&t!==void 0?t:!1}getProject(){return this.clientOptions.project}getLocation(){return this.clientOptions.location}getApiVersion(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.apiVersion!==void 0)return this.clientOptions.httpOptions.apiVersion;throw new Error("API version is not set.")}getBaseUrl(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.baseUrl!==void 0)return this.clientOptions.httpOptions.baseUrl;throw new Error("Base URL is not set.")}getRequestUrl(){return this.getRequestUrlInternal(this.clientOptions.httpOptions)}getHeaders(){if(this.clientOptions.httpOptions&&this.clientOptions.httpOptions.headers!==void 0)return this.clientOptions.httpOptions.headers;throw new Error("Headers are not set.")}getRequestUrlInternal(t){if(!t||t.baseUrl===void 0||t.apiVersion===void 0)throw new Error("HTTP options are not correctly set.");const r=[t.baseUrl.endsWith("/")?t.baseUrl.slice(0,-1):t.baseUrl];return t.apiVersion&&t.apiVersion!==""&&r.push(t.apiVersion),r.join("/")}getBaseResourcePath(){return`projects/${this.clientOptions.project}/locations/${this.clientOptions.location}`}getApiKey(){return this.clientOptions.apiKey}getWebsocketBaseUrl(){const t=this.getBaseUrl(),n=new URL(t);return n.protocol=n.protocol=="http:"?"ws":"wss",n.toString()}setBaseUrl(t){if(this.clientOptions.httpOptions)this.clientOptions.httpOptions.baseUrl=t;else throw new Error("HTTP options are not correctly set.")}constructUrl(t,n,r){const i=[this.getRequestUrlInternal(n)];return r&&i.push(this.getBaseResourcePath()),t!==""&&i.push(t),new URL(`${i.join("/")}`)}shouldPrependVertexProjectPath(t){return!(this.clientOptions.apiKey||!this.clientOptions.vertexai||t.path.startsWith("projects/")||t.httpMethod==="GET"&&t.path.startsWith("publishers/google/models"))}async request(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);if(t.queryParams)for(const[a,o]of Object.entries(t.queryParams))i.searchParams.append(a,String(o));let s={};if(t.httpMethod==="GET"){if(t.body&&t.body!=="{}")throw new Error("Request body should be empty for GET request, but got non empty request body")}else s.body=t.body;return s=await this.includeExtraHttpOptionsToRequestInit(s,n,t.abortSignal),this.unaryApiCall(i,s,t.httpMethod)}patchHttpOptions(t,n){const r=JSON.parse(JSON.stringify(t));for(const[i,s]of Object.entries(n))typeof s=="object"?r[i]=Object.assign(Object.assign({},r[i]),s):s!==void 0&&(r[i]=s);return r}async requestStream(t){let n=this.clientOptions.httpOptions;t.httpOptions&&(n=this.patchHttpOptions(this.clientOptions.httpOptions,t.httpOptions));const r=this.shouldPrependVertexProjectPath(t),i=this.constructUrl(t.path,n,r);(!i.searchParams.has("alt")||i.searchParams.get("alt")!=="sse")&&i.searchParams.set("alt","sse");let s={};return s.body=t.body,s=await this.includeExtraHttpOptionsToRequestInit(s,n,t.abortSignal),this.streamApiCall(i,s,t.httpMethod)}async includeExtraHttpOptionsToRequestInit(t,n,r){if(n&&n.timeout||r){const i=new AbortController,s=i.signal;if(n.timeout&&(n==null?void 0:n.timeout)>0){const a=setTimeout(()=>i.abort(),n.timeout);a&&typeof a.unref=="function"&&a.unref()}r&&r.addEventListener("abort",()=>{i.abort()}),t.signal=s}return n&&n.extraBody!==null&&nie(t,n.extraBody),t.headers=await this.getHeadersInternal(n),t}async unaryApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await yC(i),new sv(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}async streamApiCall(t,n,r){return this.apiCall(t.toString(),Object.assign(Object.assign({},n),{method:r})).then(async i=>(await yC(i),this.processStreamResponse(i))).catch(i=>{throw i instanceof Error?i:new Error(JSON.stringify(i))})}processStreamResponse(t){var n;return Wl(this,arguments,function*(){const i=(n=t==null?void 0:t.body)===null||n===void 0?void 0:n.getReader(),s=new TextDecoder("utf-8");if(!i)throw new Error("Response body is empty");try{let a="";for(;;){const{done:o,value:l}=yield Qt(i.read());if(o){if(a.trim().length>0)throw new Error("Incomplete JSON segment at the end");break}const u=s.decode(l,{stream:!0});try{const h=JSON.parse(u);if("error"in h){const p=JSON.parse(JSON.stringify(h.error)),m=p.status,v=p.code,g=`got status: ${m}. ${JSON.stringify(h)}`;if(v>=400&&v<600)throw new lp({message:g,status:v})}}catch(h){if(h.name==="ApiError")throw h}a+=u;let c=a.match(xC);for(;c;){const h=c[1];try{const p=new Response(h,{headers:t==null?void 0:t.headers,status:t==null?void 0:t.status,statusText:t==null?void 0:t.statusText});yield yield Qt(new sv(p)),a=a.slice(c[0].length),c=a.match(xC)}catch(p){throw new Error(`exception parsing stream chunk ${h}. ${p}`)}}}}finally{i.releaseLock()}})}async apiCall(t,n){return fetch(t,n).catch(r=>{throw new Error(`exception ${r} sending request`)})}getDefaultHeaders(){const t={},n=jre+" "+this.clientOptions.userAgentExtra;return t[Jre]=n,t[hv]=n,t[Yre]="application/json",t}async getHeadersInternal(t){const n=new Headers;if(t&&t.headers){for(const[r,i]of Object.entries(t.headers))n.append(r,i);t.timeout&&t.timeout>0&&n.append(Xre,String(Math.ceil(t.timeout/1e3)))}return await this.clientOptions.auth.addAuthHeaders(n),n}async uploadFile(t,n){var r;const i={};n!=null&&(i.mimeType=n.mimeType,i.name=n.name,i.displayName=n.displayName),i.name&&!i.name.startsWith("files/")&&(i.name=`files/${i.name}`);const s=this.clientOptions.uploader,a=await s.stat(t);i.sizeBytes=String(a.size);const o=(r=n==null?void 0:n.mimeType)!==null&&r!==void 0?r:a.type;if(o===void 0||o==="")throw new Error("Can not determine mimeType. Please provide mimeType in the config.");i.mimeType=o;const l=await this.fetchUploadUrl(i,n);return s.upload(t,l,this)}async downloadFile(t){await this.clientOptions.downloader.download(t,this)}async fetchUploadUrl(t,n){var r;let i={};n!=null&&n.httpOptions?i=n.httpOptions:i={apiVersion:"",headers:{"Content-Type":"application/json","X-Goog-Upload-Protocol":"resumable","X-Goog-Upload-Command":"start","X-Goog-Upload-Header-Content-Length":`${t.sizeBytes}`,"X-Goog-Upload-Header-Content-Type":`${t.mimeType}`}};const s={file:t},a=await this.request({path:qe("upload/v1beta/files",s._url),body:JSON.stringify(s),httpMethod:"POST",httpOptions:i});if(!a||!(a!=null&&a.headers))throw new Error("Server did not return an HttpResponse or the returned HttpResponse did not have headers.");const o=(r=a==null?void 0:a.headers)===null||r===void 0?void 0:r["x-goog-upload-url"];if(o===void 0)throw new Error("Failed to get upload url. Server did not return the x-google-upload-url in the headers");return o}}async function yC(e){var t;if(e===void 0)throw new Error("response is undefined");if(!e.ok){const n=e.status;let r;!((t=e.headers.get("content-type"))===null||t===void 0)&&t.includes("application/json")?r=await e.json():r={error:{message:await e.text(),code:e.status,status:e.statusText}};const i=JSON.stringify(r);throw n>=400&&n<600?new lp({message:i,status:n}):new Error(i)}}function nie(e,t){if(!t||Object.keys(t).length===0)return;if(e.body instanceof Blob){console.warn("includeExtraBodyToRequestInit: extraBody provided but current request body is a Blob. extraBody will be ignored as merging is not supported for Blob bodies.");return}let n={};if(typeof e.body=="string"&&e.body.length>0)try{const s=JSON.parse(e.body);if(typeof s=="object"&&s!==null&&!Array.isArray(s))n=s;else{console.warn("includeExtraBodyToRequestInit: Original request body is valid JSON but not a non-array object. Skip applying extraBody to the request body.");return}}catch{console.warn("includeExtraBodyToRequestInit: Original request body is not valid JSON. Skip applying extraBody to the request body.");return}function r(s,a){const o=Object.assign({},s);for(const l in a)if(Object.prototype.hasOwnProperty.call(a,l)){const u=a[l],c=o[l];u&&typeof u=="object"&&!Array.isArray(u)&&c&&typeof c=="object"&&!Array.isArray(c)?o[l]=r(c,u):(c&&u&&typeof c!=typeof u&&console.warn(`includeExtraBodyToRequestInit:deepMerge: Type mismatch for key "${l}". Original type: ${typeof c}, New type: ${typeof u}. Overwriting.`),o[l]=u)}return o}const i=r(n,t);e.body=JSON.stringify(i)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const rie="mcp_used/unknown";let iie=!1;function WP(e){for(const t of e)if(sie(t)||typeof t=="object"&&"inputSchema"in t)return!0;return iie}function GP(e){var t;const n=(t=e[hv])!==null&&t!==void 0?t:"";e[hv]=(n+` ${rie}`).trimStart()}function sie(e){return e!==null&&typeof e=="object"&&e instanceof wy}function aie(e,t=100){return Wl(this,arguments,function*(){let r,i=0;for(;i<t;){const s=yield Qt(e.listTools({cursor:r}));for(const a of s.tools)yield yield Qt(a),i++;if(!s.nextCursor)break;r=s.nextCursor}})}class wy{constructor(t=[],n){this.mcpTools=[],this.functionNameToMcpClient={},this.mcpClients=t,this.config=n}static create(t,n){return new wy(t,n)}async initialize(){var t,n,r,i;if(this.mcpTools.length>0)return;const s={},a=[];for(const c of this.mcpClients)try{for(var o=!0,l=(n=void 0,Oc(aie(c))),u;u=await l.next(),t=u.done,!t;o=!0){i=u.value,o=!1;const h=i;a.push(h);const p=h.name;if(s[p])throw new Error(`Duplicate function name ${p} found in MCP tools. Please ensure function names are unique.`);s[p]=c}}catch(h){n={error:h}}finally{try{!o&&!t&&(r=l.return)&&await r.call(l)}finally{if(n)throw n.error}}this.mcpTools=a,this.functionNameToMcpClient=s}async tool(){return await this.initialize(),tQ(this.mcpTools,this.config)}async callTool(t){await this.initialize();const n=[];for(const r of t)if(r.name in this.functionNameToMcpClient){const i=this.functionNameToMcpClient[r.name];let s;this.config.timeout&&(s={timeout:this.config.timeout});const a=await i.callTool({name:r.name,arguments:r.args},void 0,s);n.push({functionResponse:{name:r.name,response:a.isError?{error:a}:a}})}return n}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */async function oie(e,t,n){const r=new KJ;let i;n.data instanceof Blob?i=JSON.parse(await n.data.text()):i=JSON.parse(n.data);const s=tte(i);Object.assign(r,s),t(r)}class lie{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r}async connect(t){var n,r;if(this.apiClient.isVertexAI())throw new Error("Live music is not supported for Vertex AI.");console.warn("Live music generation is experimental and may change in future versions.");const i=this.apiClient.getWebsocketBaseUrl(),s=this.apiClient.getApiVersion(),a=fie(this.apiClient.getDefaultHeaders()),o=this.apiClient.getApiKey(),l=`${i}/ws/google.ai.generativelanguage.${s}.GenerativeService.BidiGenerateMusic?key=${o}`;let u=()=>{};const c=new Promise(y=>{u=y}),h=t.callbacks,p=function(){u({})},m=this.apiClient,v={onopen:p,onmessage:y=>{oie(m,h.onmessage,y)},onerror:(n=h==null?void 0:h.onerror)!==null&&n!==void 0?n:function(y){},onclose:(r=h==null?void 0:h.onclose)!==null&&r!==void 0?r:function(y){}},g=this.webSocketFactory.create(l,cie(a),v);g.connect(),await c;const w=Wt(this.apiClient,t.model),x=BP({model:w}),T=cv({setup:x});return g.send(JSON.stringify(T)),new uie(g,this.apiClient)}}class uie{constructor(t,n){this.conn=t,this.apiClient=n}async setWeightedPrompts(t){if(!t.weightedPrompts||Object.keys(t.weightedPrompts).length===0)throw new Error("Weighted prompts must be set and contain at least one entry.");const n=ZZ(t),r=UP(n);this.conn.send(JSON.stringify({clientContent:r}))}async setMusicGenerationConfig(t){t.musicGenerationConfig||(t.musicGenerationConfig={});const n=eee(t),r=cv(n);this.conn.send(JSON.stringify(r))}sendPlaybackControl(t){const n=cv({playbackControl:t});this.conn.send(JSON.stringify(n))}play(){this.sendPlaybackControl(Fl.PLAY)}pause(){this.sendPlaybackControl(Fl.PAUSE)}stop(){this.sendPlaybackControl(Fl.STOP)}resetContext(){this.sendPlaybackControl(Fl.RESET_CONTEXT)}close(){this.conn.close()}}function cie(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function fie(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const die="FunctionResponse request must have an `id` field from the response of a ToolCall.FunctionalCalls in Google AI.";async function hie(e,t,n){const r=new qJ;let i;n.data instanceof Blob?i=await n.data.text():n.data instanceof ArrayBuffer?i=new TextDecoder().decode(n.data):i=n.data;const s=JSON.parse(i);if(e.isVertexAI()){const a=mte(s);Object.assign(r,a)}else{const a=qee(s);Object.assign(r,a)}t(r)}class pie{constructor(t,n,r){this.apiClient=t,this.auth=n,this.webSocketFactory=r,this.music=new lie(this.apiClient,this.auth,this.webSocketFactory)}async connect(t){var n,r,i,s,a,o;if(t.config&&t.config.httpOptions)throw new Error("The Live module does not support httpOptions at request-level in LiveConnectConfig yet. Please use the client-level httpOptions configuration instead.");const l=this.apiClient.getWebsocketBaseUrl(),u=this.apiClient.getApiVersion();let c;const h=this.apiClient.getHeaders();t.config&&t.config.tools&&WP(t.config.tools)&&GP(h);const p=xie(h);if(this.apiClient.isVertexAI())c=`${l}/ws/google.cloud.aiplatform.${u}.LlmBidiService/BidiGenerateContent`,await this.auth.addAuthHeaders(p);else{const F=this.apiClient.getApiKey();let b="BidiGenerateContent",V="key";F!=null&&F.startsWith("auth_tokens/")&&(console.warn("Warning: Ephemeral token support is experimental and may change in future versions."),u!=="v1alpha"&&console.warn("Warning: The SDK's ephemeral token support is in v1alpha only. Please use const ai = new GoogleGenAI({apiKey: token.name, httpOptions: { apiVersion: 'v1alpha' }}); before session connection."),b="BidiGenerateContentConstrained",V="access_token"),c=`${l}/ws/google.ai.generativelanguage.${u}.GenerativeService.${b}?${V}=${F}`}let m=()=>{};const v=new Promise(F=>{m=F}),g=t.callbacks,w=function(){var F;(F=g==null?void 0:g.onopen)===null||F===void 0||F.call(g),m({})},x=this.apiClient,T={onopen:w,onmessage:F=>{hie(x,g.onmessage,F)},onerror:(n=g==null?void 0:g.onerror)!==null&&n!==void 0?n:function(F){},onclose:(r=g==null?void 0:g.onclose)!==null&&r!==void 0?r:function(F){}},y=this.webSocketFactory.create(c,vie(p),T);y.connect(),await v;let _=Wt(this.apiClient,t.model);if(this.apiClient.isVertexAI()&&_.startsWith("publishers/")){const F=this.apiClient.getProject(),b=this.apiClient.getLocation();_=`projects/${F}/locations/${b}/`+_}let k={};this.apiClient.isVertexAI()&&((i=t.config)===null||i===void 0?void 0:i.responseModalities)===void 0&&(t.config===void 0?t.config={responseModalities:[vh.AUDIO]}:t.config.responseModalities=[vh.AUDIO]),!((s=t.config)===null||s===void 0)&&s.generationConfig&&console.warn("Setting `LiveConnectConfig.generation_config` is deprecated, please set the fields on `LiveConnectConfig` directly. This will become an error in a future version (not before Q3 2025).");const S=(o=(a=t.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[],C=[];for(const F of S)if(this.isCallableTool(F)){const b=F;C.push(await b.tool())}else C.push(F);C.length>0&&(t.config.tools=C);const M={model:_,config:t.config,callbacks:t.callbacks};return this.apiClient.isVertexAI()?k=Aee(this.apiClient,M):k=XZ(this.apiClient,M),delete k.config,y.send(JSON.stringify(k)),new gie(y,this.apiClient)}isCallableTool(t){return"callTool"in t&&typeof t.callTool=="function"}}const mie={turnComplete:!0};class gie{constructor(t,n){this.conn=t,this.apiClient=n}tLiveClientContent(t,n){if(n.turns!==null&&n.turns!==void 0){let r=[];try{r=wi(n.turns),t.isVertexAI()?r=r.map(i=>Lu(i)):r=r.map(i=>up(i))}catch{throw new Error(`Failed to parse client content "turns", type: '${typeof n.turns}'`)}return{clientContent:{turns:r,turnComplete:n.turnComplete}}}return{clientContent:{turnComplete:n.turnComplete}}}tLiveClienttToolResponse(t,n){let r=[];if(n.functionResponses==null)throw new Error("functionResponses is required.");if(Array.isArray(n.functionResponses)?r=n.functionResponses:r=[n.functionResponses],r.length===0)throw new Error("functionResponses is required.");for(const s of r){if(typeof s!="object"||s===null||!("name"in s)||!("response"in s))throw new Error(`Could not parse function response, type '${typeof s}'.`);if(!t.isVertexAI()&&!("id"in s))throw new Error(die)}return{toolResponse:{functionResponses:r}}}sendClientContent(t){t=Object.assign(Object.assign({},mie),t);const n=this.tLiveClientContent(this.apiClient,t);this.conn.send(JSON.stringify(n))}sendRealtimeInput(t){let n={};this.apiClient.isVertexAI()?n={realtimeInput:Fee(t)}:n={realtimeInput:jZ(t)},this.conn.send(JSON.stringify(n))}sendToolResponse(t){if(t.functionResponses==null)throw new Error("Tool response parameters are required.");const n=this.tLiveClienttToolResponse(this.apiClient,t);this.conn.send(JSON.stringify(n))}close(){this.conn.close()}}function vie(e){const t={};return e.forEach((n,r)=>{t[r]=n}),t}function xie(e){const t=new Headers;for(const[n,r]of Object.entries(e))t.append(n,r);return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const wC=10;function TC(e){var t,n,r;if(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.disable)return!0;let i=!1;for(const a of(n=e==null?void 0:e.tools)!==null&&n!==void 0?n:[])if(Gl(a)){i=!0;break}if(!i)return!0;const s=(r=e==null?void 0:e.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls;return s&&(s<0||!Number.isInteger(s))||s==0?(console.warn("Invalid maximumRemoteCalls value provided for automatic function calling. Disabled automatic function calling. Please provide a valid integer value greater than 0. maximumRemoteCalls provided:",s),!0):!1}function Gl(e){return"callTool"in e&&typeof e.callTool=="function"}function yie(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>Gl(i)))!==null&&r!==void 0?r:!1}function wie(e){var t,n,r;return(r=(n=(t=e.config)===null||t===void 0?void 0:t.tools)===null||n===void 0?void 0:n.some(i=>!Gl(i)))!==null&&r!==void 0?r:!1}function SC(e){var t;return!(!((t=e==null?void 0:e.automaticFunctionCalling)===null||t===void 0)&&t.ignoreCallHistory)}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Tie extends el{constructor(t){super(),this.apiClient=t,this.generateContent=async n=>{var r,i,s,a,o;const l=await this.processParamsMaybeAddMcpUsage(n);if(this.maybeMoveToResponseJsonSchem(n),!yie(n)||TC(n.config))return await this.generateContentInternal(l);if(wie(n))throw new Error("Automatic function calling with CallableTools and Tools is not yet supported.");let u,c;const h=wi(l.contents),p=(s=(i=(r=l.config)===null||r===void 0?void 0:r.automaticFunctionCalling)===null||i===void 0?void 0:i.maximumRemoteCalls)!==null&&s!==void 0?s:wC;let m=0;for(;m<p&&(u=await this.generateContentInternal(l),!(!u.functionCalls||u.functionCalls.length===0));){const v=u.candidates[0].content,g=[];for(const w of(o=(a=n.config)===null||a===void 0?void 0:a.tools)!==null&&o!==void 0?o:[])if(Gl(w)){const T=await w.callTool(u.functionCalls);g.push(...T)}m++,c={role:"user",parts:g},l.contents=wi(l.contents),l.contents.push(v),l.contents.push(c),SC(l.config)&&(h.push(v),h.push(c))}return SC(l.config)&&(u.automaticFunctionCallingHistory=h),u},this.generateContentStream=async n=>{if(this.maybeMoveToResponseJsonSchem(n),TC(n.config)){const r=await this.processParamsMaybeAddMcpUsage(n);return await this.generateContentStreamInternal(r)}else return await this.processAfcStream(n)},this.generateImages=async n=>await this.generateImagesInternal(n).then(r=>{var i;let s;const a=[];if(r!=null&&r.generatedImages)for(const l of r.generatedImages)l&&(l!=null&&l.safetyAttributes)&&((i=l==null?void 0:l.safetyAttributes)===null||i===void 0?void 0:i.contentType)==="Positive Prompt"?s=l==null?void 0:l.safetyAttributes:a.push(l);let o;return s?o={generatedImages:a,positivePromptSafetyAttributes:s,sdkHttpResponse:r.sdkHttpResponse}:o={generatedImages:a,sdkHttpResponse:r.sdkHttpResponse},o}),this.list=async n=>{var r;const a={config:Object.assign(Object.assign({},{queryBase:!0}),n==null?void 0:n.config)};if(this.apiClient.isVertexAI()&&!a.config.queryBase){if(!((r=a.config)===null||r===void 0)&&r.filter)throw new Error("Filtering tuned models list for Vertex AI is not currently supported");a.config.filter="labels.tune-type:*"}return new nd(Oo.PAGED_ITEM_MODELS,o=>this.listInternal(o),await this.listInternal(a),a)},this.editImage=async n=>{const r={model:n.model,prompt:n.prompt,referenceImages:[],config:n.config};return n.referenceImages&&n.referenceImages&&(r.referenceImages=n.referenceImages.map(i=>i.toReferenceImageAPI())),await this.editImageInternal(r)},this.upscaleImage=async n=>{let r={numberOfImages:1,mode:"upscale"};n.config&&(r=Object.assign(Object.assign({},r),n.config));const i={model:n.model,image:n.image,upscaleFactor:n.upscaleFactor,config:r};return await this.upscaleImageInternal(i)},this.generateVideos=async n=>await this.generateVideosInternal(n)}maybeMoveToResponseJsonSchem(t){t.config&&t.config.responseSchema&&(t.config.responseJsonSchema||Object.keys(t.config.responseSchema).includes("$schema")&&(t.config.responseJsonSchema=t.config.responseSchema,delete t.config.responseSchema))}async processParamsMaybeAddMcpUsage(t){var n,r,i;const s=(n=t.config)===null||n===void 0?void 0:n.tools;if(!s)return t;const a=await Promise.all(s.map(async l=>Gl(l)?await l.tool():l)),o={model:t.model,contents:t.contents,config:Object.assign(Object.assign({},t.config),{tools:a})};if(o.config.tools=a,t.config&&t.config.tools&&WP(t.config.tools)){const l=(i=(r=t.config.httpOptions)===null||r===void 0?void 0:r.headers)!==null&&i!==void 0?i:{};let u=Object.assign({},l);Object.keys(u).length===0&&(u=this.apiClient.getDefaultHeaders()),GP(u),o.config.httpOptions=Object.assign(Object.assign({},t.config.httpOptions),{headers:u})}return o}async initAfcToolsMap(t){var n,r,i;const s=new Map;for(const a of(r=(n=t.config)===null||n===void 0?void 0:n.tools)!==null&&r!==void 0?r:[])if(Gl(a)){const o=a,l=await o.tool();for(const u of(i=l.functionDeclarations)!==null&&i!==void 0?i:[]){if(!u.name)throw new Error("Function declaration name is required.");if(s.has(u.name))throw new Error(`Duplicate tool declaration name: ${u.name}`);s.set(u.name,o)}}return s}async processAfcStream(t){var n,r,i;const s=(i=(r=(n=t.config)===null||n===void 0?void 0:n.automaticFunctionCalling)===null||r===void 0?void 0:r.maximumRemoteCalls)!==null&&i!==void 0?i:wC;let a=!1,o=0;const l=await this.initAfcToolsMap(t);return function(u,c,h){var p,m;return Wl(this,arguments,function*(){for(var v,g,w,x;o<s;){a&&(o++,a=!1);const k=yield Qt(u.processParamsMaybeAddMcpUsage(h)),S=yield Qt(u.generateContentStreamInternal(k)),C=[],M=[];try{for(var T=!0,y=(g=void 0,Oc(S)),_;_=yield Qt(y.next()),v=_.done,!v;T=!0){x=_.value,T=!1;const F=x;if(yield yield Qt(F),F.candidates&&(!((p=F.candidates[0])===null||p===void 0)&&p.content)){M.push(F.candidates[0].content);for(const b of(m=F.candidates[0].content.parts)!==null&&m!==void 0?m:[])if(o<s&&b.functionCall){if(!b.functionCall.name)throw new Error("Function call name was not returned by the model.");if(c.has(b.functionCall.name)){const V=yield Qt(c.get(b.functionCall.name).callTool([b.functionCall]));C.push(...V)}else throw new Error(`Automatic function calling was requested, but not all the tools the model used implement the CallableTool interface. Available tools: ${c.keys()}, mising tool: ${b.functionCall.name}`)}}}}catch(F){g={error:F}}finally{try{!T&&!v&&(w=y.return)&&(yield Qt(w.call(y)))}finally{if(g)throw g.error}}if(C.length>0){a=!0;const F=new ec;F.candidates=[{content:{role:"user",parts:C}}],yield yield Qt(F);const b=[];b.push(...M),b.push({role:"user",parts:C});const V=wi(h.contents).concat(b);h.contents=V}else break}})}(this,l,t)}async generateContentInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=mC(this.apiClient,t);return o=qe("{model}:generateContent",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=vC(c),p=new ec;return Object.assign(p,h),p})}else{const u=pC(this.apiClient,t);return o=qe("{model}:generateContent",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=gC(c),p=new ec;return Object.assign(p,h),p})}}async generateContentStreamInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=mC(this.apiClient,t);return o=qe("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.requestStream({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}),a.then(function(h){return Wl(this,arguments,function*(){var p,m,v,g;try{for(var w=!0,x=Oc(h),T;T=yield Qt(x.next()),p=T.done,!p;w=!0){g=T.value,w=!1;const y=g,_=vC(yield Qt(y.json()));_.sdkHttpResponse={headers:y.headers};const k=new ec;Object.assign(k,_),yield yield Qt(k)}}catch(y){m={error:y}}finally{try{!w&&!p&&(v=x.return)&&(yield Qt(v.call(x)))}finally{if(m)throw m.error}}})})}else{const u=pC(this.apiClient,t);return o=qe("{model}:streamGenerateContent?alt=sse",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.requestStream({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}),a.then(function(h){return Wl(this,arguments,function*(){var p,m,v,g;try{for(var w=!0,x=Oc(h),T;T=yield Qt(x.next()),p=T.done,!p;w=!0){g=T.value,w=!1;const y=g,_=gC(yield Qt(y.json()));_.sdkHttpResponse={headers:y.headers};const k=new ec;Object.assign(k,_),yield yield Qt(k)}}catch(y){m={error:y}}finally{try{!w&&!p&&(v=x.return)&&(yield Qt(v.call(x)))}finally{if(m)throw m.error}}})})}}async embedContent(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Ane(this.apiClient,t);return o=qe("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=Pre(c),p=new K_;return Object.assign(p,h),p})}else{const u=Vte(this.apiClient,t);return o=qe("{model}:batchEmbedContents",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=lre(c),p=new K_;return Object.assign(p,h),p})}}async generateImagesInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Mne(this.apiClient,t);return o=qe("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=Nre(c),p=new Y_;return Object.assign(p,h),p})}else{const u=$te(this.apiClient,t);return o=qe("{model}:predict",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=fre(c),p=new Y_;return Object.assign(p,h),p})}}async editImageInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=Lne(this.apiClient,t);return s=qe("{model}:predict",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=bre(l),c=new VJ;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async upscaleImageInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=Bne(this.apiClient,t);return s=qe("{model}:predict",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=Lre(l),c=new HJ;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async get(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Une(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>dv(c))}else{const u=zte(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>fv(c))}}async listInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Hne(this.apiClient,t);return o=qe("{models_url}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=Vre(c),p=new X_;return Object.assign(p,h),p})}else{const u=Gte(this.apiClient,t);return o=qe("{models_url}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=hre(c),p=new X_;return Object.assign(p,h),p})}}async update(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=zne(this.apiClient,t);return o=qe("{model}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>dv(c))}else{const u=Kte(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"PATCH",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>fv(c))}}async delete(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Wne(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(()=>{const c=Hre(),h=new J_;return Object.assign(h,c),h})}else{const u=Yte(this.apiClient,t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"DELETE",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(()=>{const c=pre(),h=new J_;return Object.assign(h,c),h})}}async countTokens(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=qne(this.apiClient,t);return o=qe("{model}:countTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=$re(c),p=new Q_;return Object.assign(p,h),p})}else{const u=Jte(this.apiClient,t);return o=qe("{model}:countTokens",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=mre(c),p=new Q_;return Object.assign(p,h),p})}}async computeTokens(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=Kne(this.apiClient,t);return s=qe("{model}:computeTokens",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>{const u=zre(l),c=new $J;return Object.assign(c,u),c})}else throw new Error("This method is only supported by the Vertex AI.")}async generateVideosInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Jne(this.apiClient,t);return o=qe("{model}:predictLongRunning",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a.then(c=>{const h=Kre(c),p=new xh;return Object.assign(p,h),p})}else{const u=Zte(this.apiClient,t);return o=qe("{model}:predictLongRunning",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"POST",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a.then(c=>{const h=yre(c),p=new xh;return Object.assign(p,h),p})}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Sie(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function Eie(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["_url","operationName"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function _ie(e){const t={},n=f(e,["operationName"]);n!=null&&d(t,["operationName"],n);const r=f(e,["resourceName"]);r!=null&&d(t,["_url","resourceName"],r);const i=f(e,["config"]);return i!=null&&d(t,["config"],i),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Cie extends el{constructor(t){super(),this.apiClient=t}async getVideosOperation(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:a,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async get(t){const n=t.operation,r=t.config;if(n.name===void 0||n.name==="")throw new Error("Operation name is required.");if(this.apiClient.isVertexAI()){const i=n.name.split("/operations/")[0];let s;r&&"httpOptions"in r&&(s=r.httpOptions);const a=await this.fetchPredictVideosOperationInternal({operationName:n.name,resourceName:i,config:{httpOptions:s}});return n._fromAPIResponse({apiResponse:a,isVertexAI:!0})}else{const i=await this.getVideosOperationInternal({operationName:n.name,config:r});return n._fromAPIResponse({apiResponse:i,isVertexAI:!1})}}async getVideosOperationInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=Eie(t);return o=qe("{operationName}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json()),a}else{const u=Sie(t);return o=qe("{operationName}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json()),a}}async fetchPredictVideosOperationInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=_ie(t);return s=qe("{resourceName}:fetchPredictOperation",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json()),i}else throw new Error("This method is only supported by the Vertex AI.")}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function kie(e){const t={},n=f(e,["voiceName"]);return n!=null&&d(t,["voiceName"],n),t}function qP(e){const t={},n=f(e,["prebuiltVoiceConfig"]);return n!=null&&d(t,["prebuiltVoiceConfig"],kie(n)),t}function Aie(e){const t={},n=f(e,["speaker"]);n!=null&&d(t,["speaker"],n);const r=f(e,["voiceConfig"]);return r!=null&&d(t,["voiceConfig"],qP(r)),t}function Rie(e){const t={},n=f(e,["speakerVoiceConfigs"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>Aie(i))),d(t,["speakerVoiceConfigs"],r)}return t}function Mie(e){const t={},n=f(e,["voiceConfig"]);n!=null&&d(t,["voiceConfig"],qP(n));const r=f(e,["multiSpeakerVoiceConfig"]);r!=null&&d(t,["multiSpeakerVoiceConfig"],Rie(r));const i=f(e,["languageCode"]);return i!=null&&d(t,["languageCode"],i),t}function Fie(e){const t={},n=f(e,["fps"]);n!=null&&d(t,["fps"],n);const r=f(e,["endOffset"]);r!=null&&d(t,["endOffset"],r);const i=f(e,["startOffset"]);return i!=null&&d(t,["startOffset"],i),t}function Die(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["data"]);n!=null&&d(t,["data"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Pie(e){const t={};if(f(e,["displayName"])!==void 0)throw new Error("displayName parameter is not supported in Gemini API.");const n=f(e,["fileUri"]);n!=null&&d(t,["fileUri"],n);const r=f(e,["mimeType"]);return r!=null&&d(t,["mimeType"],r),t}function Iie(e){const t={},n=f(e,["videoMetadata"]);n!=null&&d(t,["videoMetadata"],Fie(n));const r=f(e,["thought"]);r!=null&&d(t,["thought"],r);const i=f(e,["inlineData"]);i!=null&&d(t,["inlineData"],Die(i));const s=f(e,["fileData"]);s!=null&&d(t,["fileData"],Pie(s));const a=f(e,["thoughtSignature"]);a!=null&&d(t,["thoughtSignature"],a);const o=f(e,["codeExecutionResult"]);o!=null&&d(t,["codeExecutionResult"],o);const l=f(e,["executableCode"]);l!=null&&d(t,["executableCode"],l);const u=f(e,["functionCall"]);u!=null&&d(t,["functionCall"],u);const c=f(e,["functionResponse"]);c!=null&&d(t,["functionResponse"],c);const h=f(e,["text"]);return h!=null&&d(t,["text"],h),t}function Nie(e){const t={},n=f(e,["parts"]);if(n!=null){let i=n;Array.isArray(i)&&(i=i.map(s=>Iie(s))),d(t,["parts"],i)}const r=f(e,["role"]);return r!=null&&d(t,["role"],r),t}function bie(e){const t={},n=f(e,["behavior"]);n!=null&&d(t,["behavior"],n);const r=f(e,["description"]);r!=null&&d(t,["description"],r);const i=f(e,["name"]);i!=null&&d(t,["name"],i);const s=f(e,["parameters"]);s!=null&&d(t,["parameters"],s);const a=f(e,["parametersJsonSchema"]);a!=null&&d(t,["parametersJsonSchema"],a);const o=f(e,["response"]);o!=null&&d(t,["response"],o);const l=f(e,["responseJsonSchema"]);return l!=null&&d(t,["responseJsonSchema"],l),t}function Lie(e){const t={},n=f(e,["startTime"]);n!=null&&d(t,["startTime"],n);const r=f(e,["endTime"]);return r!=null&&d(t,["endTime"],r),t}function Oie(e){const t={},n=f(e,["timeRangeFilter"]);return n!=null&&d(t,["timeRangeFilter"],Lie(n)),t}function Bie(e){const t={},n=f(e,["mode"]);n!=null&&d(t,["mode"],n);const r=f(e,["dynamicThreshold"]);return r!=null&&d(t,["dynamicThreshold"],r),t}function Uie(e){const t={},n=f(e,["dynamicRetrievalConfig"]);return n!=null&&d(t,["dynamicRetrievalConfig"],Bie(n)),t}function Vie(){return{}}function Hie(e){const t={},n=f(e,["functionDeclarations"]);if(n!=null){let l=n;Array.isArray(l)&&(l=l.map(u=>bie(u))),d(t,["functionDeclarations"],l)}if(f(e,["retrieval"])!==void 0)throw new Error("retrieval parameter is not supported in Gemini API.");const r=f(e,["googleSearch"]);r!=null&&d(t,["googleSearch"],Oie(r));const i=f(e,["googleSearchRetrieval"]);if(i!=null&&d(t,["googleSearchRetrieval"],Uie(i)),f(e,["enterpriseWebSearch"])!==void 0)throw new Error("enterpriseWebSearch parameter is not supported in Gemini API.");if(f(e,["googleMaps"])!==void 0)throw new Error("googleMaps parameter is not supported in Gemini API.");f(e,["urlContext"])!=null&&d(t,["urlContext"],Vie());const a=f(e,["codeExecution"]);a!=null&&d(t,["codeExecution"],a);const o=f(e,["computerUse"]);return o!=null&&d(t,["computerUse"],o),t}function $ie(e){const t={},n=f(e,["handle"]);if(n!=null&&d(t,["handle"],n),f(e,["transparent"])!==void 0)throw new Error("transparent parameter is not supported in Gemini API.");return t}function EC(){return{}}function zie(e){const t={},n=f(e,["disabled"]);n!=null&&d(t,["disabled"],n);const r=f(e,["startOfSpeechSensitivity"]);r!=null&&d(t,["startOfSpeechSensitivity"],r);const i=f(e,["endOfSpeechSensitivity"]);i!=null&&d(t,["endOfSpeechSensitivity"],i);const s=f(e,["prefixPaddingMs"]);s!=null&&d(t,["prefixPaddingMs"],s);const a=f(e,["silenceDurationMs"]);return a!=null&&d(t,["silenceDurationMs"],a),t}function Wie(e){const t={},n=f(e,["automaticActivityDetection"]);n!=null&&d(t,["automaticActivityDetection"],zie(n));const r=f(e,["activityHandling"]);r!=null&&d(t,["activityHandling"],r);const i=f(e,["turnCoverage"]);return i!=null&&d(t,["turnCoverage"],i),t}function Gie(e){const t={},n=f(e,["targetTokens"]);return n!=null&&d(t,["targetTokens"],n),t}function qie(e){const t={},n=f(e,["triggerTokens"]);n!=null&&d(t,["triggerTokens"],n);const r=f(e,["slidingWindow"]);return r!=null&&d(t,["slidingWindow"],Gie(r)),t}function Kie(e){const t={},n=f(e,["proactiveAudio"]);return n!=null&&d(t,["proactiveAudio"],n),t}function Yie(e,t){const n={},r=f(e,["generationConfig"]);t!==void 0&&r!=null&&d(t,["setup","generationConfig"],r);const i=f(e,["responseModalities"]);t!==void 0&&i!=null&&d(t,["setup","generationConfig","responseModalities"],i);const s=f(e,["temperature"]);t!==void 0&&s!=null&&d(t,["setup","generationConfig","temperature"],s);const a=f(e,["topP"]);t!==void 0&&a!=null&&d(t,["setup","generationConfig","topP"],a);const o=f(e,["topK"]);t!==void 0&&o!=null&&d(t,["setup","generationConfig","topK"],o);const l=f(e,["maxOutputTokens"]);t!==void 0&&l!=null&&d(t,["setup","generationConfig","maxOutputTokens"],l);const u=f(e,["mediaResolution"]);t!==void 0&&u!=null&&d(t,["setup","generationConfig","mediaResolution"],u);const c=f(e,["seed"]);t!==void 0&&c!=null&&d(t,["setup","generationConfig","seed"],c);const h=f(e,["speechConfig"]);t!==void 0&&h!=null&&d(t,["setup","generationConfig","speechConfig"],Mie(xy(h)));const p=f(e,["enableAffectiveDialog"]);t!==void 0&&p!=null&&d(t,["setup","generationConfig","enableAffectiveDialog"],p);const m=f(e,["systemInstruction"]);t!==void 0&&m!=null&&d(t,["setup","systemInstruction"],Nie(fr(m)));const v=f(e,["tools"]);if(t!==void 0&&v!=null){let k=Nu(v);Array.isArray(k)&&(k=k.map(S=>Hie(Iu(S)))),d(t,["setup","tools"],k)}const g=f(e,["sessionResumption"]);t!==void 0&&g!=null&&d(t,["setup","sessionResumption"],$ie(g));const w=f(e,["inputAudioTranscription"]);t!==void 0&&w!=null&&d(t,["setup","inputAudioTranscription"],EC());const x=f(e,["outputAudioTranscription"]);t!==void 0&&x!=null&&d(t,["setup","outputAudioTranscription"],EC());const T=f(e,["realtimeInputConfig"]);t!==void 0&&T!=null&&d(t,["setup","realtimeInputConfig"],Wie(T));const y=f(e,["contextWindowCompression"]);t!==void 0&&y!=null&&d(t,["setup","contextWindowCompression"],qie(y));const _=f(e,["proactivity"]);return t!==void 0&&_!=null&&d(t,["setup","proactivity"],Kie(_)),n}function Xie(e,t){const n={},r=f(t,["model"]);r!=null&&d(n,["setup","model"],Wt(e,r));const i=f(t,["config"]);return i!=null&&d(n,["config"],Yie(i,n)),n}function Jie(e,t,n){const r={},i=f(t,["expireTime"]);n!==void 0&&i!=null&&d(n,["expireTime"],i);const s=f(t,["newSessionExpireTime"]);n!==void 0&&s!=null&&d(n,["newSessionExpireTime"],s);const a=f(t,["uses"]);n!==void 0&&a!=null&&d(n,["uses"],a);const o=f(t,["liveConnectConstraints"]);n!==void 0&&o!=null&&d(n,["bidiGenerateContentSetup"],Xie(e,o));const l=f(t,["lockAdditionalFields"]);return n!==void 0&&l!=null&&d(n,["fieldMask"],l),r}function Qie(e,t){const n={},r=f(t,["config"]);return r!=null&&d(n,["config"],Jie(e,r,n)),n}function jie(e){const t={},n=f(e,["name"]);return n!=null&&d(t,["name"],n),t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function Zie(e){const t=[];for(const n in e)if(Object.prototype.hasOwnProperty.call(e,n)){const r=e[n];if(typeof r=="object"&&r!=null&&Object.keys(r).length>0){const i=Object.keys(r).map(s=>`${n}.${s}`);t.push(...i)}else t.push(n)}return t.join(",")}function ese(e,t){let n=null;const r=e.bidiGenerateContentSetup;if(typeof r=="object"&&r!==null&&"setup"in r){const s=r.setup;typeof s=="object"&&s!==null?(e.bidiGenerateContentSetup=s,n=s):delete e.bidiGenerateContentSetup}else r!==void 0&&delete e.bidiGenerateContentSetup;const i=e.fieldMask;if(n){const s=Zie(n);if(Array.isArray(t==null?void 0:t.lockAdditionalFields)&&(t==null?void 0:t.lockAdditionalFields.length)===0)s?e.fieldMask=s:delete e.fieldMask;else if(t!=null&&t.lockAdditionalFields&&t.lockAdditionalFields.length>0&&i!==null&&Array.isArray(i)&&i.length>0){const a=["temperature","topK","topP","maxOutputTokens","responseModalities","seed","speechConfig"];let o=[];i.length>0&&(o=i.map(u=>a.includes(u)?`generationConfig.${u}`:u));const l=[];s&&l.push(s),o.length>0&&l.push(...o),l.length>0?e.fieldMask=l.join(","):delete e.fieldMask}else delete e.fieldMask}else i!==null&&Array.isArray(i)&&i.length>0?e.fieldMask=i.join(","):delete e.fieldMask;return e}class tse extends el{constructor(t){super(),this.apiClient=t}async create(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("The client.tokens.create method is only supported by the Gemini Developer API.");{const o=Qie(this.apiClient,t);s=qe("auth_tokens",o._url),a=o._query,delete o.config,delete o._url,delete o._query;const l=ese(o,t.config);return i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(l),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(u=>u.json()),i.then(u=>jie(u))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */function nse(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function rse(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);t!==void 0&&i!=null&&d(t,["_query","pageToken"],i);const s=f(e,["filter"]);return t!==void 0&&s!=null&&d(t,["_query","filter"],s),n}function ise(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],rse(n,t)),t}function sse(e){const t={},n=f(e,["textInput"]);n!=null&&d(t,["textInput"],n);const r=f(e,["output"]);return r!=null&&d(t,["output"],r),t}function ase(e){const t={};if(f(e,["gcsUri"])!==void 0)throw new Error("gcsUri parameter is not supported in Gemini API.");if(f(e,["vertexDatasetResource"])!==void 0)throw new Error("vertexDatasetResource parameter is not supported in Gemini API.");const n=f(e,["examples"]);if(n!=null){let r=n;Array.isArray(r)&&(r=r.map(i=>sse(i))),d(t,["examples","examples"],r)}return t}function ose(e,t){const n={};if(f(e,["validationDataset"])!==void 0)throw new Error("validationDataset parameter is not supported in Gemini API.");const r=f(e,["tunedModelDisplayName"]);if(t!==void 0&&r!=null&&d(t,["displayName"],r),f(e,["description"])!==void 0)throw new Error("description parameter is not supported in Gemini API.");const i=f(e,["epochCount"]);t!==void 0&&i!=null&&d(t,["tuningTask","hyperparameters","epochCount"],i);const s=f(e,["learningRateMultiplier"]);if(s!=null&&d(n,["tuningTask","hyperparameters","learningRateMultiplier"],s),f(e,["exportLastCheckpointOnly"])!==void 0)throw new Error("exportLastCheckpointOnly parameter is not supported in Gemini API.");if(f(e,["adapterSize"])!==void 0)throw new Error("adapterSize parameter is not supported in Gemini API.");const a=f(e,["batchSize"]);t!==void 0&&a!=null&&d(t,["tuningTask","hyperparameters","batchSize"],a);const o=f(e,["learningRate"]);return t!==void 0&&o!=null&&d(t,["tuningTask","hyperparameters","learningRate"],o),n}function lse(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["tuningTask","trainingData"],ase(r));const i=f(e,["config"]);return i!=null&&d(t,["config"],ose(i,t)),t}function use(e){const t={},n=f(e,["name"]);n!=null&&d(t,["_url","name"],n);const r=f(e,["config"]);return r!=null&&d(t,["config"],r),t}function cse(e,t){const n={},r=f(e,["pageSize"]);t!==void 0&&r!=null&&d(t,["_query","pageSize"],r);const i=f(e,["pageToken"]);t!==void 0&&i!=null&&d(t,["_query","pageToken"],i);const s=f(e,["filter"]);return t!==void 0&&s!=null&&d(t,["_query","filter"],s),n}function fse(e){const t={},n=f(e,["config"]);return n!=null&&d(t,["config"],cse(n,t)),t}function dse(e,t){const n={},r=f(e,["gcsUri"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],r);const i=f(e,["vertexDatasetResource"]);if(t!==void 0&&i!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],i),f(e,["examples"])!==void 0)throw new Error("examples parameter is not supported in Vertex AI.");return n}function hse(e,t){const n={},r=f(e,["gcsUri"]);r!=null&&d(n,["validationDatasetUri"],r);const i=f(e,["vertexDatasetResource"]);return t!==void 0&&i!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],i),n}function pse(e,t){const n={},r=f(e,["validationDataset"]);t!==void 0&&r!=null&&d(t,["supervisedTuningSpec"],hse(r,n));const i=f(e,["tunedModelDisplayName"]);t!==void 0&&i!=null&&d(t,["tunedModelDisplayName"],i);const s=f(e,["description"]);t!==void 0&&s!=null&&d(t,["description"],s);const a=f(e,["epochCount"]);t!==void 0&&a!=null&&d(t,["supervisedTuningSpec","hyperParameters","epochCount"],a);const o=f(e,["learningRateMultiplier"]);t!==void 0&&o!=null&&d(t,["supervisedTuningSpec","hyperParameters","learningRateMultiplier"],o);const l=f(e,["exportLastCheckpointOnly"]);t!==void 0&&l!=null&&d(t,["supervisedTuningSpec","exportLastCheckpointOnly"],l);const u=f(e,["adapterSize"]);if(t!==void 0&&u!=null&&d(t,["supervisedTuningSpec","hyperParameters","adapterSize"],u),f(e,["batchSize"])!==void 0)throw new Error("batchSize parameter is not supported in Vertex AI.");if(f(e,["learningRate"])!==void 0)throw new Error("learningRate parameter is not supported in Vertex AI.");return n}function mse(e){const t={},n=f(e,["baseModel"]);n!=null&&d(t,["baseModel"],n);const r=f(e,["trainingDataset"]);r!=null&&d(t,["supervisedTuningSpec","trainingDatasetUri"],dse(r,t));const i=f(e,["config"]);return i!=null&&d(t,["config"],pse(i,t)),t}function gse(e){const t={},n=f(e,["name"]);n!=null&&d(t,["model"],n);const r=f(e,["name"]);return r!=null&&d(t,["endpoint"],r),t}function KP(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["state"]);i!=null&&d(t,["state"],_P(i));const s=f(e,["createTime"]);s!=null&&d(t,["createTime"],s);const a=f(e,["tuningTask","startTime"]);a!=null&&d(t,["startTime"],a);const o=f(e,["tuningTask","completeTime"]);o!=null&&d(t,["endTime"],o);const l=f(e,["updateTime"]);l!=null&&d(t,["updateTime"],l);const u=f(e,["description"]);u!=null&&d(t,["description"],u);const c=f(e,["baseModel"]);c!=null&&d(t,["baseModel"],c);const h=f(e,["_self"]);h!=null&&d(t,["tunedModel"],gse(h));const p=f(e,["distillationSpec"]);p!=null&&d(t,["distillationSpec"],p);const m=f(e,["experiment"]);m!=null&&d(t,["experiment"],m);const v=f(e,["labels"]);v!=null&&d(t,["labels"],v);const g=f(e,["pipelineJob"]);g!=null&&d(t,["pipelineJob"],g);const w=f(e,["satisfiesPzi"]);w!=null&&d(t,["satisfiesPzi"],w);const x=f(e,["satisfiesPzs"]);x!=null&&d(t,["satisfiesPzs"],x);const T=f(e,["serviceAccount"]);T!=null&&d(t,["serviceAccount"],T);const y=f(e,["tunedModelDisplayName"]);return y!=null&&d(t,["tunedModelDisplayName"],y),t}function vse(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["tunedModels"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>KP(a))),d(t,["tuningJobs"],s)}return t}function xse(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["metadata"]);i!=null&&d(t,["metadata"],i);const s=f(e,["done"]);s!=null&&d(t,["done"],s);const a=f(e,["error"]);return a!=null&&d(t,["error"],a),t}function yse(e){const t={},n=f(e,["checkpointId"]);n!=null&&d(t,["checkpointId"],n);const r=f(e,["epoch"]);r!=null&&d(t,["epoch"],r);const i=f(e,["step"]);i!=null&&d(t,["step"],i);const s=f(e,["endpoint"]);return s!=null&&d(t,["endpoint"],s),t}function wse(e){const t={},n=f(e,["model"]);n!=null&&d(t,["model"],n);const r=f(e,["endpoint"]);r!=null&&d(t,["endpoint"],r);const i=f(e,["checkpoints"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>yse(a))),d(t,["checkpoints"],s)}return t}function pv(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["name"]);r!=null&&d(t,["name"],r);const i=f(e,["state"]);i!=null&&d(t,["state"],_P(i));const s=f(e,["createTime"]);s!=null&&d(t,["createTime"],s);const a=f(e,["startTime"]);a!=null&&d(t,["startTime"],a);const o=f(e,["endTime"]);o!=null&&d(t,["endTime"],o);const l=f(e,["updateTime"]);l!=null&&d(t,["updateTime"],l);const u=f(e,["error"]);u!=null&&d(t,["error"],u);const c=f(e,["description"]);c!=null&&d(t,["description"],c);const h=f(e,["baseModel"]);h!=null&&d(t,["baseModel"],h);const p=f(e,["tunedModel"]);p!=null&&d(t,["tunedModel"],wse(p));const m=f(e,["supervisedTuningSpec"]);m!=null&&d(t,["supervisedTuningSpec"],m);const v=f(e,["tuningDataStats"]);v!=null&&d(t,["tuningDataStats"],v);const g=f(e,["encryptionSpec"]);g!=null&&d(t,["encryptionSpec"],g);const w=f(e,["partnerModelTuningSpec"]);w!=null&&d(t,["partnerModelTuningSpec"],w);const x=f(e,["distillationSpec"]);x!=null&&d(t,["distillationSpec"],x);const T=f(e,["experiment"]);T!=null&&d(t,["experiment"],T);const y=f(e,["labels"]);y!=null&&d(t,["labels"],y);const _=f(e,["pipelineJob"]);_!=null&&d(t,["pipelineJob"],_);const k=f(e,["satisfiesPzi"]);k!=null&&d(t,["satisfiesPzi"],k);const S=f(e,["satisfiesPzs"]);S!=null&&d(t,["satisfiesPzs"],S);const C=f(e,["serviceAccount"]);C!=null&&d(t,["serviceAccount"],C);const M=f(e,["tunedModelDisplayName"]);return M!=null&&d(t,["tunedModelDisplayName"],M),t}function Tse(e){const t={},n=f(e,["sdkHttpResponse"]);n!=null&&d(t,["sdkHttpResponse"],n);const r=f(e,["nextPageToken"]);r!=null&&d(t,["nextPageToken"],r);const i=f(e,["tuningJobs"]);if(i!=null){let s=i;Array.isArray(s)&&(s=s.map(a=>pv(a))),d(t,["tuningJobs"],s)}return t}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Sse extends el{constructor(t){super(),this.apiClient=t,this.get=async n=>await this.getInternal(n),this.list=async(n={})=>new nd(Oo.PAGED_ITEM_TUNING_JOBS,r=>this.listInternal(r),await this.listInternal(n),n),this.tune=async n=>{if(this.apiClient.isVertexAI())return await this.tuneInternal(n);{const r=await this.tuneMldevInternal(n);let i="";return r.metadata!==void 0&&r.metadata.tunedModel!==void 0?i=r.metadata.tunedModel:r.name!==void 0&&r.name.includes("/operations/")&&(i=r.name.split("/operations/")[0]),{name:i,state:iv.JOB_STATE_QUEUED}}}}async getInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=use(t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>pv(c))}else{const u=nse(t);return o=qe("{name}",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>KP(c))}}async listInternal(t){var n,r,i,s;let a,o="",l={};if(this.apiClient.isVertexAI()){const u=fse(t);return o=qe("tuningJobs",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=Tse(c),p=new Z_;return Object.assign(p,h),p})}else{const u=ise(t);return o=qe("tunedModels",u._url),l=u._query,delete u.config,delete u._url,delete u._query,a=this.apiClient.request({path:o,queryParams:l,body:JSON.stringify(u),httpMethod:"GET",httpOptions:(i=t.config)===null||i===void 0?void 0:i.httpOptions,abortSignal:(s=t.config)===null||s===void 0?void 0:s.abortSignal}).then(c=>c.json().then(h=>{const p=h;return p.sdkHttpResponse={headers:c.headers},p})),a.then(c=>{const h=vse(c),p=new Z_;return Object.assign(p,h),p})}}async tuneInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI()){const o=mse(t);return s=qe("tuningJobs",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>pv(l))}else throw new Error("This method is only supported by the Vertex AI.")}async tuneMldevInternal(t){var n,r;let i,s="",a={};if(this.apiClient.isVertexAI())throw new Error("This method is only supported by the Gemini Developer API.");{const o=lse(t);return s=qe("tunedModels",o._url),a=o._query,delete o.config,delete o._url,delete o._query,i=this.apiClient.request({path:s,queryParams:a,body:JSON.stringify(o),httpMethod:"POST",httpOptions:(n=t.config)===null||n===void 0?void 0:n.httpOptions,abortSignal:(r=t.config)===null||r===void 0?void 0:r.abortSignal}).then(l=>l.json().then(u=>{const c=u;return c.sdkHttpResponse={headers:l.headers},c})),i.then(l=>xse(l))}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Ese{async download(t,n){throw new Error("Download to file is not supported in the browser, please use a browser compliant download like an <a> tag.")}}const _se=1024*1024*8,Cse=3,kse=1e3,Ase=2,Em="x-goog-upload-status";async function Rse(e,t,n){var r,i,s;let a=0,o=0,l=new sv(new Response),u="upload";for(a=e.size;o<a;){const h=Math.min(_se,a-o),p=e.slice(o,o+h);o+h>=a&&(u+=", finalize");let m=0,v=kse;for(;m<Cse&&(l=await n.request({path:"",body:p,httpMethod:"POST",httpOptions:{apiVersion:"",baseUrl:t,headers:{"X-Goog-Upload-Command":u,"X-Goog-Upload-Offset":String(o),"Content-Length":String(h)}}}),!(!((r=l==null?void 0:l.headers)===null||r===void 0)&&r[Em]));)m++,await Fse(v),v=v*Ase;if(o+=h,((i=l==null?void 0:l.headers)===null||i===void 0?void 0:i[Em])!=="active")break;if(a<=o)throw new Error("All content has been uploaded, but the upload status is not finalized.")}const c=await(l==null?void 0:l.json());if(((s=l==null?void 0:l.headers)===null||s===void 0?void 0:s[Em])!=="final")throw new Error("Failed to upload file: Upload status is not finalized.");return c.file}async function Mse(e){return{size:e.size,type:e.type}}function Fse(e){return new Promise(t=>setTimeout(t,e))}class Dse{async upload(t,n,r){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Rse(t,n,r)}async stat(t){if(typeof t=="string")throw new Error("File path is not supported in browser uploader.");return await Mse(t)}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */class Pse{create(t,n,r){return new Ise(t,n,r)}}class Ise{constructor(t,n,r){this.url=t,this.headers=n,this.callbacks=r}connect(){this.ws=new WebSocket(this.url),this.ws.onopen=this.callbacks.onopen,this.ws.onerror=this.callbacks.onerror,this.ws.onclose=this.callbacks.onclose,this.ws.onmessage=this.callbacks.onmessage}send(t){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.send(t)}close(){if(this.ws===void 0)throw new Error("WebSocket is not connected");this.ws.close()}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const _C="x-goog-api-key";class Nse{constructor(t){this.apiKey=t}async addAuthHeaders(t){if(t.get(_C)===null){if(this.apiKey.startsWith("auth_tokens/"))throw new Error("Ephemeral tokens are only supported by the live API.");if(!this.apiKey)throw new Error("API key is missing. Please provide a valid API key.");t.append(_C,this.apiKey)}}}/**
 * @license
 * Copyright 2025 Google LLC
 * SPDX-License-Identifier: Apache-2.0
 */const bse="gl-node/";class Lse{constructor(t){var n;if(t.apiKey==null)throw new Error("An API Key must be set when running in a browser");if(t.project||t.location)throw new Error("Vertex AI project based authentication is not supported on browser runtimes. Please do not provide a project or location.");this.vertexai=(n=t.vertexai)!==null&&n!==void 0?n:!1,this.apiKey=t.apiKey;const r=UJ(t.httpOptions,t.vertexai,void 0,void 0);r&&(t.httpOptions?t.httpOptions.baseUrl=r:t.httpOptions={baseUrl:r}),this.apiVersion=t.apiVersion;const i=new Nse(this.apiKey);this.apiClient=new tie({auth:i,apiVersion:this.apiVersion,apiKey:this.apiKey,vertexai:this.vertexai,httpOptions:t.httpOptions,userAgentExtra:bse+"web",uploader:new Dse,downloader:new Ese}),this.models=new Tie(this.apiClient),this.live=new pie(this.apiClient,i,new Pse),this.batches=new lj(this.apiClient),this.chats=new dZ(this.models,this.apiClient),this.caches=new uZ(this.apiClient),this.files=new CZ(this.apiClient),this.operations=new Cie(this.apiClient),this.authTokens=new tse(this.apiClient),this.tunings=new Sse(this.apiClient)}}const yu=Math.min,_o=Math.max,wh=Math.round,Kd=Math.floor,ls=e=>({x:e,y:e}),Ose={left:"right",right:"left",bottom:"top",top:"bottom"},Bse={start:"end",end:"start"};function mv(e,t,n){return _o(e,yu(t,n))}function rd(e,t){return typeof e=="function"?e(t):e}function Bo(e){return e.split("-")[0]}function id(e){return e.split("-")[1]}function YP(e){return e==="x"?"y":"x"}function Ty(e){return e==="y"?"height":"width"}const Use=new Set(["top","bottom"]);function ya(e){return Use.has(Bo(e))?"y":"x"}function Sy(e){return YP(ya(e))}function Vse(e,t,n){n===void 0&&(n=!1);const r=id(e),i=Sy(e),s=Ty(i);let a=i==="x"?r===(n?"end":"start")?"right":"left":r==="start"?"bottom":"top";return t.reference[s]>t.floating[s]&&(a=Th(a)),[a,Th(a)]}function Hse(e){const t=Th(e);return[gv(e),t,gv(t)]}function gv(e){return e.replace(/start|end/g,t=>Bse[t])}const CC=["left","right"],kC=["right","left"],$se=["top","bottom"],zse=["bottom","top"];function Wse(e,t,n){switch(e){case"top":case"bottom":return n?t?kC:CC:t?CC:kC;case"left":case"right":return t?$se:zse;default:return[]}}function Gse(e,t,n,r){const i=id(e);let s=Wse(Bo(e),n==="start",r);return i&&(s=s.map(a=>a+"-"+i),t&&(s=s.concat(s.map(gv)))),s}function Th(e){return e.replace(/left|right|bottom|top/g,t=>Ose[t])}function qse(e){return{top:0,right:0,bottom:0,left:0,...e}}function XP(e){return typeof e!="number"?qse(e):{top:e,right:e,bottom:e,left:e}}function Sh(e){const{x:t,y:n,width:r,height:i}=e;return{width:r,height:i,top:n,left:t,right:t+r,bottom:n+i,x:t,y:n}}function AC(e,t,n){let{reference:r,floating:i}=e;const s=ya(t),a=Sy(t),o=Ty(a),l=Bo(t),u=s==="y",c=r.x+r.width/2-i.width/2,h=r.y+r.height/2-i.height/2,p=r[o]/2-i[o]/2;let m;switch(l){case"top":m={x:c,y:r.y-i.height};break;case"bottom":m={x:c,y:r.y+r.height};break;case"right":m={x:r.x+r.width,y:h};break;case"left":m={x:r.x-i.width,y:h};break;default:m={x:r.x,y:r.y}}switch(id(t)){case"start":m[a]-=p*(n&&u?-1:1);break;case"end":m[a]+=p*(n&&u?-1:1);break}return m}const Kse=async(e,t,n)=>{const{placement:r="bottom",strategy:i="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(t));let u=await a.getElementRects({reference:e,floating:t,strategy:i}),{x:c,y:h}=AC(u,r,l),p=r,m={},v=0;for(let g=0;g<o.length;g++){const{name:w,fn:x}=o[g],{x:T,y,data:_,reset:k}=await x({x:c,y:h,initialPlacement:r,placement:p,strategy:i,middlewareData:m,rects:u,platform:a,elements:{reference:e,floating:t}});c=T??c,h=y??h,m={...m,[w]:{...m[w],..._}},k&&v<=50&&(v++,typeof k=="object"&&(k.placement&&(p=k.placement),k.rects&&(u=k.rects===!0?await a.getElementRects({reference:e,floating:t,strategy:i}):k.rects),{x:c,y:h}=AC(u,p,l)),g=-1)}return{x:c,y:h,placement:p,strategy:i,middlewareData:m}};async function JP(e,t){var n;t===void 0&&(t={});const{x:r,y:i,platform:s,rects:a,elements:o,strategy:l}=e,{boundary:u="clippingAncestors",rootBoundary:c="viewport",elementContext:h="floating",altBoundary:p=!1,padding:m=0}=rd(t,e),v=XP(m),w=o[p?h==="floating"?"reference":"floating":h],x=Sh(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(w)))==null||n?w:w.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:u,rootBoundary:c,strategy:l})),T=h==="floating"?{x:r,y:i,width:a.floating.width,height:a.floating.height}:a.reference,y=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),_=await(s.isElement==null?void 0:s.isElement(y))?await(s.getScale==null?void 0:s.getScale(y))||{x:1,y:1}:{x:1,y:1},k=Sh(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:T,offsetParent:y,strategy:l}):T);return{top:(x.top-k.top+v.top)/_.y,bottom:(k.bottom-x.bottom+v.bottom)/_.y,left:(x.left-k.left+v.left)/_.x,right:(k.right-x.right+v.right)/_.x}}const Yse=e=>({name:"arrow",options:e,async fn(t){const{x:n,y:r,placement:i,rects:s,platform:a,elements:o,middlewareData:l}=t,{element:u,padding:c=0}=rd(e,t)||{};if(u==null)return{};const h=XP(c),p={x:n,y:r},m=Sy(i),v=Ty(m),g=await a.getDimensions(u),w=m==="y",x=w?"top":"left",T=w?"bottom":"right",y=w?"clientHeight":"clientWidth",_=s.reference[v]+s.reference[m]-p[m]-s.floating[v],k=p[m]-s.reference[m],S=await(a.getOffsetParent==null?void 0:a.getOffsetParent(u));let C=S?S[y]:0;(!C||!await(a.isElement==null?void 0:a.isElement(S)))&&(C=o.floating[y]||s.floating[v]);const M=_/2-k/2,F=C/2-g[v]/2-1,b=yu(h[x],F),V=yu(h[T],F),z=b,ie=C-g[v]-V,Q=C/2-g[v]/2+M,se=mv(z,Q,ie),de=!l.arrow&&id(i)!=null&&Q!==se&&s.reference[v]/2-(Q<z?b:V)-g[v]/2<0,ae=de?Q<z?Q-z:Q-ie:0;return{[m]:p[m]+ae,data:{[m]:se,centerOffset:Q-se-ae,...de&&{alignmentOffset:ae}},reset:de}}}),Xse=function(e){return e===void 0&&(e={}),{name:"flip",options:e,async fn(t){var n,r;const{placement:i,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:u}=t,{mainAxis:c=!0,crossAxis:h=!0,fallbackPlacements:p,fallbackStrategy:m="bestFit",fallbackAxisSideDirection:v="none",flipAlignment:g=!0,...w}=rd(e,t);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const x=Bo(i),T=ya(o),y=Bo(o)===o,_=await(l.isRTL==null?void 0:l.isRTL(u.floating)),k=p||(y||!g?[Th(o)]:Hse(o)),S=v!=="none";!p&&S&&k.push(...Gse(o,g,v,_));const C=[o,...k],M=await JP(t,w),F=[];let b=((r=s.flip)==null?void 0:r.overflows)||[];if(c&&F.push(M[x]),h){const Q=Vse(i,a,_);F.push(M[Q[0]],M[Q[1]])}if(b=[...b,{placement:i,overflows:F}],!F.every(Q=>Q<=0)){var V,z;const Q=(((V=s.flip)==null?void 0:V.index)||0)+1,se=C[Q];if(se&&(!(h==="alignment"?T!==ya(se):!1)||b.every(ne=>ya(ne.placement)===T?ne.overflows[0]>0:!0)))return{data:{index:Q,overflows:b},reset:{placement:se}};let de=(z=b.filter(ae=>ae.overflows[0]<=0).sort((ae,ne)=>ae.overflows[1]-ne.overflows[1])[0])==null?void 0:z.placement;if(!de)switch(m){case"bestFit":{var ie;const ae=(ie=b.filter(ne=>{if(S){const H=ya(ne.placement);return H===T||H==="y"}return!0}).map(ne=>[ne.placement,ne.overflows.filter(H=>H>0).reduce((H,fe)=>H+fe,0)]).sort((ne,H)=>ne[1]-H[1])[0])==null?void 0:ie[0];ae&&(de=ae);break}case"initialPlacement":de=o;break}if(i!==de)return{reset:{placement:de}}}return{}}}},Jse=new Set(["left","top"]);async function Qse(e,t){const{placement:n,platform:r,elements:i}=e,s=await(r.isRTL==null?void 0:r.isRTL(i.floating)),a=Bo(n),o=id(n),l=ya(n)==="y",u=Jse.has(a)?-1:1,c=s&&l?-1:1,h=rd(t,e);let{mainAxis:p,crossAxis:m,alignmentAxis:v}=typeof h=="number"?{mainAxis:h,crossAxis:0,alignmentAxis:null}:{mainAxis:h.mainAxis||0,crossAxis:h.crossAxis||0,alignmentAxis:h.alignmentAxis};return o&&typeof v=="number"&&(m=o==="end"?v*-1:v),l?{x:m*c,y:p*u}:{x:p*u,y:m*c}}const jse=function(e){return e===void 0&&(e=0),{name:"offset",options:e,async fn(t){var n,r;const{x:i,y:s,placement:a,middlewareData:o}=t,l=await Qse(t,e);return a===((n=o.offset)==null?void 0:n.placement)&&(r=o.arrow)!=null&&r.alignmentOffset?{}:{x:i+l.x,y:s+l.y,data:{...l,placement:a}}}}},Zse=function(e){return e===void 0&&(e={}),{name:"shift",options:e,async fn(t){const{x:n,y:r,placement:i}=t,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:w=>{let{x,y:T}=w;return{x,y:T}}},...l}=rd(e,t),u={x:n,y:r},c=await JP(t,l),h=ya(Bo(i)),p=YP(h);let m=u[p],v=u[h];if(s){const w=p==="y"?"top":"left",x=p==="y"?"bottom":"right",T=m+c[w],y=m-c[x];m=mv(T,m,y)}if(a){const w=h==="y"?"top":"left",x=h==="y"?"bottom":"right",T=v+c[w],y=v-c[x];v=mv(T,v,y)}const g=o.fn({...t,[p]:m,[h]:v});return{...g,data:{x:g.x-n,y:g.y-r,enabled:{[p]:s,[h]:a}}}}}};function fp(){return typeof window<"u"}function Ou(e){return QP(e)?(e.nodeName||"").toLowerCase():"#document"}function Jr(e){var t;return(e==null||(t=e.ownerDocument)==null?void 0:t.defaultView)||window}function ms(e){var t;return(t=(QP(e)?e.ownerDocument:e.document)||window.document)==null?void 0:t.documentElement}function QP(e){return fp()?e instanceof Node||e instanceof Jr(e).Node:!1}function Wi(e){return fp()?e instanceof Element||e instanceof Jr(e).Element:!1}function cs(e){return fp()?e instanceof HTMLElement||e instanceof Jr(e).HTMLElement:!1}function RC(e){return!fp()||typeof ShadowRoot>"u"?!1:e instanceof ShadowRoot||e instanceof Jr(e).ShadowRoot}const eae=new Set(["inline","contents"]);function sd(e){const{overflow:t,overflowX:n,overflowY:r,display:i}=Gi(e);return/auto|scroll|overlay|hidden|clip/.test(t+r+n)&&!eae.has(i)}const tae=new Set(["table","td","th"]);function nae(e){return tae.has(Ou(e))}const rae=[":popover-open",":modal"];function dp(e){return rae.some(t=>{try{return e.matches(t)}catch{return!1}})}const iae=["transform","translate","scale","rotate","perspective"],sae=["transform","translate","scale","rotate","perspective","filter"],aae=["paint","layout","strict","content"];function Ey(e){const t=_y(),n=Wi(e)?Gi(e):e;return iae.some(r=>n[r]?n[r]!=="none":!1)||(n.containerType?n.containerType!=="normal":!1)||!t&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!t&&(n.filter?n.filter!=="none":!1)||sae.some(r=>(n.willChange||"").includes(r))||aae.some(r=>(n.contain||"").includes(r))}function oae(e){let t=Ba(e);for(;cs(t)&&!wu(t);){if(Ey(t))return t;if(dp(t))return null;t=Ba(t)}return null}function _y(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}const lae=new Set(["html","body","#document"]);function wu(e){return lae.has(Ou(e))}function Gi(e){return Jr(e).getComputedStyle(e)}function hp(e){return Wi(e)?{scrollLeft:e.scrollLeft,scrollTop:e.scrollTop}:{scrollLeft:e.scrollX,scrollTop:e.scrollY}}function Ba(e){if(Ou(e)==="html")return e;const t=e.assignedSlot||e.parentNode||RC(e)&&e.host||ms(e);return RC(t)?t.host:t}function jP(e){const t=Ba(e);return wu(t)?e.ownerDocument?e.ownerDocument.body:e.body:cs(t)&&sd(t)?t:jP(t)}function Af(e,t,n){var r;t===void 0&&(t=[]),n===void 0&&(n=!0);const i=jP(e),s=i===((r=e.ownerDocument)==null?void 0:r.body),a=Jr(i);if(s){const o=vv(a);return t.concat(a,a.visualViewport||[],sd(i)?i:[],o&&n?Af(o):[])}return t.concat(i,Af(i,[],n))}function vv(e){return e.parent&&Object.getPrototypeOf(e.parent)?e.frameElement:null}function ZP(e){const t=Gi(e);let n=parseFloat(t.width)||0,r=parseFloat(t.height)||0;const i=cs(e),s=i?e.offsetWidth:n,a=i?e.offsetHeight:r,o=wh(n)!==s||wh(r)!==a;return o&&(n=s,r=a),{width:n,height:r,$:o}}function Cy(e){return Wi(e)?e:e.contextElement}function ql(e){const t=Cy(e);if(!cs(t))return ls(1);const n=t.getBoundingClientRect(),{width:r,height:i,$:s}=ZP(t);let a=(s?wh(n.width):n.width)/r,o=(s?wh(n.height):n.height)/i;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const uae=ls(0);function eI(e){const t=Jr(e);return!_y()||!t.visualViewport?uae:{x:t.visualViewport.offsetLeft,y:t.visualViewport.offsetTop}}function cae(e,t,n){return t===void 0&&(t=!1),!n||t&&n!==Jr(e)?!1:t}function Uo(e,t,n,r){t===void 0&&(t=!1),n===void 0&&(n=!1);const i=e.getBoundingClientRect(),s=Cy(e);let a=ls(1);t&&(r?Wi(r)&&(a=ql(r)):a=ql(e));const o=cae(s,n,r)?eI(s):ls(0);let l=(i.left+o.x)/a.x,u=(i.top+o.y)/a.y,c=i.width/a.x,h=i.height/a.y;if(s){const p=Jr(s),m=r&&Wi(r)?Jr(r):r;let v=p,g=vv(v);for(;g&&r&&m!==v;){const w=ql(g),x=g.getBoundingClientRect(),T=Gi(g),y=x.left+(g.clientLeft+parseFloat(T.paddingLeft))*w.x,_=x.top+(g.clientTop+parseFloat(T.paddingTop))*w.y;l*=w.x,u*=w.y,c*=w.x,h*=w.y,l+=y,u+=_,v=Jr(g),g=vv(v)}}return Sh({width:c,height:h,x:l,y:u})}function ky(e,t){const n=hp(e).scrollLeft;return t?t.left+n:Uo(ms(e)).left+n}function tI(e,t,n){n===void 0&&(n=!1);const r=e.getBoundingClientRect(),i=r.left+t.scrollLeft-(n?0:ky(e,r)),s=r.top+t.scrollTop;return{x:i,y:s}}function fae(e){let{elements:t,rect:n,offsetParent:r,strategy:i}=e;const s=i==="fixed",a=ms(r),o=t?dp(t.floating):!1;if(r===a||o&&s)return n;let l={scrollLeft:0,scrollTop:0},u=ls(1);const c=ls(0),h=cs(r);if((h||!h&&!s)&&((Ou(r)!=="body"||sd(a))&&(l=hp(r)),cs(r))){const m=Uo(r);u=ql(r),c.x=m.x+r.clientLeft,c.y=m.y+r.clientTop}const p=a&&!h&&!s?tI(a,l,!0):ls(0);return{width:n.width*u.x,height:n.height*u.y,x:n.x*u.x-l.scrollLeft*u.x+c.x+p.x,y:n.y*u.y-l.scrollTop*u.y+c.y+p.y}}function dae(e){return Array.from(e.getClientRects())}function hae(e){const t=ms(e),n=hp(e),r=e.ownerDocument.body,i=_o(t.scrollWidth,t.clientWidth,r.scrollWidth,r.clientWidth),s=_o(t.scrollHeight,t.clientHeight,r.scrollHeight,r.clientHeight);let a=-n.scrollLeft+ky(e);const o=-n.scrollTop;return Gi(r).direction==="rtl"&&(a+=_o(t.clientWidth,r.clientWidth)-i),{width:i,height:s,x:a,y:o}}function pae(e,t){const n=Jr(e),r=ms(e),i=n.visualViewport;let s=r.clientWidth,a=r.clientHeight,o=0,l=0;if(i){s=i.width,a=i.height;const u=_y();(!u||u&&t==="fixed")&&(o=i.offsetLeft,l=i.offsetTop)}return{width:s,height:a,x:o,y:l}}const mae=new Set(["absolute","fixed"]);function gae(e,t){const n=Uo(e,!0,t==="fixed"),r=n.top+e.clientTop,i=n.left+e.clientLeft,s=cs(e)?ql(e):ls(1),a=e.clientWidth*s.x,o=e.clientHeight*s.y,l=i*s.x,u=r*s.y;return{width:a,height:o,x:l,y:u}}function MC(e,t,n){let r;if(t==="viewport")r=pae(e,n);else if(t==="document")r=hae(ms(e));else if(Wi(t))r=gae(t,n);else{const i=eI(e);r={x:t.x-i.x,y:t.y-i.y,width:t.width,height:t.height}}return Sh(r)}function nI(e,t){const n=Ba(e);return n===t||!Wi(n)||wu(n)?!1:Gi(n).position==="fixed"||nI(n,t)}function vae(e,t){const n=t.get(e);if(n)return n;let r=Af(e,[],!1).filter(o=>Wi(o)&&Ou(o)!=="body"),i=null;const s=Gi(e).position==="fixed";let a=s?Ba(e):e;for(;Wi(a)&&!wu(a);){const o=Gi(a),l=Ey(a);!l&&o.position==="fixed"&&(i=null),(s?!l&&!i:!l&&o.position==="static"&&!!i&&mae.has(i.position)||sd(a)&&!l&&nI(e,a))?r=r.filter(c=>c!==a):i=o,a=Ba(a)}return t.set(e,r),r}function xae(e){let{element:t,boundary:n,rootBoundary:r,strategy:i}=e;const a=[...n==="clippingAncestors"?dp(t)?[]:vae(t,this._c):[].concat(n),r],o=a[0],l=a.reduce((u,c)=>{const h=MC(t,c,i);return u.top=_o(h.top,u.top),u.right=yu(h.right,u.right),u.bottom=yu(h.bottom,u.bottom),u.left=_o(h.left,u.left),u},MC(t,o,i));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function yae(e){const{width:t,height:n}=ZP(e);return{width:t,height:n}}function wae(e,t,n){const r=cs(t),i=ms(t),s=n==="fixed",a=Uo(e,!0,s,t);let o={scrollLeft:0,scrollTop:0};const l=ls(0);function u(){l.x=ky(i)}if(r||!r&&!s)if((Ou(t)!=="body"||sd(i))&&(o=hp(t)),r){const m=Uo(t,!0,s,t);l.x=m.x+t.clientLeft,l.y=m.y+t.clientTop}else i&&u();s&&!r&&i&&u();const c=i&&!r&&!s?tI(i,o):ls(0),h=a.left+o.scrollLeft-l.x-c.x,p=a.top+o.scrollTop-l.y-c.y;return{x:h,y:p,width:a.width,height:a.height}}function _m(e){return Gi(e).position==="static"}function FC(e,t){if(!cs(e)||Gi(e).position==="fixed")return null;if(t)return t(e);let n=e.offsetParent;return ms(e)===n&&(n=n.ownerDocument.body),n}function rI(e,t){const n=Jr(e);if(dp(e))return n;if(!cs(e)){let i=Ba(e);for(;i&&!wu(i);){if(Wi(i)&&!_m(i))return i;i=Ba(i)}return n}let r=FC(e,t);for(;r&&nae(r)&&_m(r);)r=FC(r,t);return r&&wu(r)&&_m(r)&&!Ey(r)?n:r||oae(e)||n}const Tae=async function(e){const t=this.getOffsetParent||rI,n=this.getDimensions,r=await n(e.floating);return{reference:wae(e.reference,await t(e.floating),e.strategy),floating:{x:0,y:0,width:r.width,height:r.height}}};function Sae(e){return Gi(e).direction==="rtl"}const Eae={convertOffsetParentRelativeRectToViewportRelativeRect:fae,getDocumentElement:ms,getClippingRect:xae,getOffsetParent:rI,getElementRects:Tae,getClientRects:dae,getDimensions:yae,getScale:ql,isElement:Wi,isRTL:Sae};function iI(e,t){return e.x===t.x&&e.y===t.y&&e.width===t.width&&e.height===t.height}function _ae(e,t){let n=null,r;const i=ms(e);function s(){var o;clearTimeout(r),(o=n)==null||o.disconnect(),n=null}function a(o,l){o===void 0&&(o=!1),l===void 0&&(l=1),s();const u=e.getBoundingClientRect(),{left:c,top:h,width:p,height:m}=u;if(o||t(),!p||!m)return;const v=Kd(h),g=Kd(i.clientWidth-(c+p)),w=Kd(i.clientHeight-(h+m)),x=Kd(c),y={rootMargin:-v+"px "+-g+"px "+-w+"px "+-x+"px",threshold:_o(0,yu(1,l))||1};let _=!0;function k(S){const C=S[0].intersectionRatio;if(C!==l){if(!_)return a();C?a(!1,C):r=setTimeout(()=>{a(!1,1e-7)},1e3)}C===1&&!iI(u,e.getBoundingClientRect())&&a(),_=!1}try{n=new IntersectionObserver(k,{...y,root:i.ownerDocument})}catch{n=new IntersectionObserver(k,y)}n.observe(e)}return a(!0),s}function Cae(e,t,n,r){r===void 0&&(r={});const{ancestorScroll:i=!0,ancestorResize:s=!0,elementResize:a=typeof ResizeObserver=="function",layoutShift:o=typeof IntersectionObserver=="function",animationFrame:l=!1}=r,u=Cy(e),c=i||s?[...u?Af(u):[],...Af(t)]:[];c.forEach(x=>{i&&x.addEventListener("scroll",n,{passive:!0}),s&&x.addEventListener("resize",n)});const h=u&&o?_ae(u,n):null;let p=-1,m=null;a&&(m=new ResizeObserver(x=>{let[T]=x;T&&T.target===u&&m&&(m.unobserve(t),cancelAnimationFrame(p),p=requestAnimationFrame(()=>{var y;(y=m)==null||y.observe(t)})),n()}),u&&!l&&m.observe(u),m.observe(t));let v,g=l?Uo(e):null;l&&w();function w(){const x=Uo(e);g&&!iI(g,x)&&n(),g=x,v=requestAnimationFrame(w)}return n(),()=>{var x;c.forEach(T=>{i&&T.removeEventListener("scroll",n),s&&T.removeEventListener("resize",n)}),h==null||h(),(x=m)==null||x.disconnect(),m=null,l&&cancelAnimationFrame(v)}}const kae=jse,Aae=Zse,Rae=Xse,Mae=Yse,DC=(e,t,n)=>{const r=new Map,i={platform:Eae,...n},s={...i.platform,_c:r};return Kse(e,t,{...i,platform:s})};var sI={exports:{}};/*!
	Copyright (c) 2018 Jed Watson.
	Licensed under the MIT License (MIT), see
	http://jedwatson.github.io/classnames
*/(function(e){(function(){var t={}.hasOwnProperty;function n(){for(var s="",a=0;a<arguments.length;a++){var o=arguments[a];o&&(s=i(s,r(o)))}return s}function r(s){if(typeof s=="string"||typeof s=="number")return s;if(typeof s!="object")return"";if(Array.isArray(s))return n.apply(null,s);if(s.toString!==Object.prototype.toString&&!s.toString.toString().includes("[native code]"))return s.toString();var a="";for(var o in s)t.call(s,o)&&s[o]&&(a=i(a,o));return a}function i(s,a){return a?s?s+" "+a:s+a:s}e.exports?(n.default=n,e.exports=n):window.classNames=n})()})(sI);var Fae=sI.exports;const xv=u2(Fae);var PC={};const Dae="react-tooltip-core-styles",Pae="react-tooltip-base-styles",IC={core:!1,base:!1};function NC({css:e,id:t=Pae,type:n="base",ref:r}){var i,s;if(!e||typeof document>"u"||IC[n]||n==="core"&&typeof process<"u"&&(!((i=process==null?void 0:PC)===null||i===void 0)&&i.REACT_TOOLTIP_DISABLE_CORE_STYLES)||n!=="base"&&typeof process<"u"&&(!((s=process==null?void 0:PC)===null||s===void 0)&&s.REACT_TOOLTIP_DISABLE_BASE_STYLES))return;n==="core"&&(t=Dae),r||(r={});const{insertAt:a}=r;if(document.getElementById(t))return;const o=document.head||document.getElementsByTagName("head")[0],l=document.createElement("style");l.id=t,l.type="text/css",a==="top"&&o.firstChild?o.insertBefore(l,o.firstChild):o.appendChild(l),l.styleSheet?l.styleSheet.cssText=e:l.appendChild(document.createTextNode(e)),IC[n]=!0}const bC=async({elementReference:e=null,tooltipReference:t=null,tooltipArrowReference:n=null,place:r="top",offset:i=10,strategy:s="absolute",middlewares:a=[kae(Number(i)),Rae({fallbackAxisSideDirection:"start"}),Aae({padding:5})],border:o,arrowSize:l=8})=>{if(!e)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};if(t===null)return{tooltipStyles:{},tooltipArrowStyles:{},place:r};const u=a;return n?(u.push(Mae({element:n,padding:5})),DC(e,t,{placement:r,strategy:s,middleware:u}).then(({x:c,y:h,placement:p,middlewareData:m})=>{var v,g;const w={left:`${c}px`,top:`${h}px`,border:o},{x,y:T}=(v=m.arrow)!==null&&v!==void 0?v:{x:0,y:0},y=(g={top:"bottom",right:"left",bottom:"top",left:"right"}[p.split("-")[0]])!==null&&g!==void 0?g:"bottom",_=o&&{borderBottom:o,borderRight:o};let k=0;if(o){const S=`${o}`.match(/(\d+)px/);k=S!=null&&S[1]?Number(S[1]):1}return{tooltipStyles:w,tooltipArrowStyles:{left:x!=null?`${x}px`:"",top:T!=null?`${T}px`:"",right:"",bottom:"",..._,[y]:`-${l/2+k}px`},place:p}})):DC(e,t,{placement:"bottom",strategy:s,middleware:u}).then(({x:c,y:h,placement:p})=>({tooltipStyles:{left:`${c}px`,top:`${h}px`},tooltipArrowStyles:{},place:p}))},LC=(e,t)=>!("CSS"in window&&"supports"in window.CSS)||window.CSS.supports(e,t),OC=(e,t,n)=>{let r=null;const i=function(...s){const a=()=>{r=null};!r&&(e.apply(this,s),r=setTimeout(a,t))};return i.cancel=()=>{r&&(clearTimeout(r),r=null)},i},BC=e=>e!==null&&!Array.isArray(e)&&typeof e=="object",yv=(e,t)=>{if(e===t)return!0;if(Array.isArray(e)&&Array.isArray(t))return e.length===t.length&&e.every((i,s)=>yv(i,t[s]));if(Array.isArray(e)!==Array.isArray(t))return!1;if(!BC(e)||!BC(t))return e===t;const n=Object.keys(e),r=Object.keys(t);return n.length===r.length&&n.every(i=>yv(e[i],t[i]))},Iae=e=>{if(!(e instanceof HTMLElement||e instanceof SVGElement))return!1;const t=getComputedStyle(e);return["overflow","overflow-x","overflow-y"].some(n=>{const r=t.getPropertyValue(n);return r==="auto"||r==="scroll"})},UC=e=>{if(!e)return null;let t=e.parentElement;for(;t;){if(Iae(t))return t;t=t.parentElement}return document.scrollingElement||document.documentElement},Nae=typeof window<"u"?E.useLayoutEffect:E.useEffect,ii=e=>{e.current&&(clearTimeout(e.current),e.current=null)},bae="DEFAULT_TOOLTIP_ID",Lae={anchorRefs:new Set,activeAnchor:{current:null},attach:()=>{},detach:()=>{},setActiveAnchor:()=>{}},Oae=E.createContext({getTooltipData:()=>Lae});function aI(e=bae){return E.useContext(Oae).getTooltipData(e)}var ll={tooltip:"core-styles-module_tooltip__3vRRp",fixed:"core-styles-module_fixed__pcSol",arrow:"core-styles-module_arrow__cvMwQ",noArrow:"core-styles-module_noArrow__xock6",clickable:"core-styles-module_clickable__ZuTTB",show:"core-styles-module_show__Nt9eE",closing:"core-styles-module_closing__sGnxF"},Cm={tooltip:"styles-module_tooltip__mnnfp",arrow:"styles-module_arrow__K0L3T",dark:"styles-module_dark__xNqje",light:"styles-module_light__Z6W-X",success:"styles-module_success__A2AKt",warning:"styles-module_warning__SCK0X",error:"styles-module_error__JvumD",info:"styles-module_info__BWdHW"};const Bae=({forwardRef:e,id:t,className:n,classNameArrow:r,variant:i="dark",anchorId:s,anchorSelect:a,place:o="top",offset:l=10,events:u=["hover"],openOnClick:c=!1,positionStrategy:h="absolute",middlewares:p,wrapper:m,delayShow:v=0,delayHide:g=0,float:w=!1,hidden:x=!1,noArrow:T=!1,clickable:y=!1,closeOnEsc:_=!1,closeOnScroll:k=!1,closeOnResize:S=!1,openEvents:C,closeEvents:M,globalCloseEvents:F,imperativeModeOnly:b,style:V,position:z,afterShow:ie,afterHide:Q,disableTooltip:se,content:de,contentWrapperRef:ae,isOpen:ne,defaultIsOpen:H=!1,setIsOpen:fe,activeAnchor:xe,setActiveAnchor:L,border:q,opacity:W,arrowColor:G,arrowSize:ee=8,role:Se="tooltip"})=>{var we;const pe=E.useRef(null),oe=E.useRef(null),Le=E.useRef(null),B=E.useRef(null),st=E.useRef(null),[Ue,at]=E.useState({tooltipStyles:{},tooltipArrowStyles:{},place:o}),[$e,Re]=E.useState(!1),[ht,Dt]=E.useState(!1),[tt,Kt]=E.useState(null),ve=E.useRef(!1),Ce=E.useRef(null),{anchorRefs:Ne,setActiveAnchor:Oe}=aI(t),He=E.useRef(!1),[Je,Qe]=E.useState([]),mt=E.useRef(!1),We=c||u.includes("click"),Xe=We||(C==null?void 0:C.click)||(C==null?void 0:C.dblclick)||(C==null?void 0:C.mousedown),Rt=C?{...C}:{mouseover:!0,focus:!0,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1};!C&&We&&Object.assign(Rt,{mouseenter:!1,focus:!1,mouseover:!1,click:!0});const yt=M?{...M}:{mouseout:!0,blur:!0,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1};!M&&We&&Object.assign(yt,{mouseleave:!1,blur:!1,mouseout:!1});const It=F?{...F}:{escape:_||!1,scroll:k||!1,resize:S||!1,clickOutsideAnchor:Xe||!1};b&&(Object.assign(Rt,{mouseover:!1,focus:!1,mouseenter:!1,click:!1,dblclick:!1,mousedown:!1}),Object.assign(yt,{mouseout:!1,blur:!1,mouseleave:!1,click:!1,dblclick:!1,mouseup:!1}),Object.assign(It,{escape:!1,scroll:!1,resize:!1,clickOutsideAnchor:!1})),Nae(()=>(mt.current=!0,()=>{mt.current=!1}),[]);const Mt=j=>{mt.current&&(j&&Dt(!0),setTimeout(()=>{mt.current&&(fe==null||fe(j),ne===void 0&&Re(j))},10))};E.useEffect(()=>{if(ne===void 0)return()=>null;ne&&Dt(!0);const j=setTimeout(()=>{Re(ne)},10);return()=>{clearTimeout(j)}},[ne]),E.useEffect(()=>{if($e!==ve.current)if(ii(st),ve.current=$e,$e)ie==null||ie();else{const j=(ue=>{const ye=ue.match(/^([\d.]+)(ms|s)$/);if(!ye)return 0;const[,Fe,Me]=ye;return Number(Fe)*(Me==="ms"?1:1e3)})(getComputedStyle(document.body).getPropertyValue("--rt-transition-show-delay"));st.current=setTimeout(()=>{Dt(!1),Kt(null),Q==null||Q()},j+25)}},[$e]);const bn=j=>{at(ue=>yv(ue,j)?ue:j)},Et=(j=v)=>{ii(Le),ht?Mt(!0):Le.current=setTimeout(()=>{Mt(!0)},j)},xn=(j=g)=>{ii(B),B.current=setTimeout(()=>{He.current||Mt(!1)},j)},Wn=j=>{var ue;if(!j)return;const ye=(ue=j.currentTarget)!==null&&ue!==void 0?ue:j.target;if(!(ye!=null&&ye.isConnected))return L(null),void Oe({current:null});v?Et():Mt(!0),L(ye),Oe({current:ye}),ii(B)},Gn=()=>{y?xn(g||100):g?xn():Mt(!1),ii(Le)},fn=({x:j,y:ue})=>{var ye;const Fe={getBoundingClientRect:()=>({x:j,y:ue,width:0,height:0,top:ue,left:j,right:j,bottom:ue})};bC({place:(ye=tt==null?void 0:tt.place)!==null&&ye!==void 0?ye:o,offset:l,elementReference:Fe,tooltipReference:pe.current,tooltipArrowReference:oe.current,strategy:h,middlewares:p,border:q,arrowSize:ee}).then(Me=>{bn(Me)})},Nt=j=>{if(!j)return;const ue=j,ye={x:ue.clientX,y:ue.clientY};fn(ye),Ce.current=ye},bt=j=>{var ue;if(!$e)return;const ye=j.target;ye.isConnected&&(!((ue=pe.current)===null||ue===void 0)&&ue.contains(ye)||[document.querySelector(`[id='${s}']`),...Je].some(Fe=>Fe==null?void 0:Fe.contains(ye))||(Mt(!1),ii(Le)))},Ut=OC(Wn,50),ot=OC(Gn,50),wt=j=>{ot.cancel(),Ut(j)},be=()=>{Ut.cancel(),ot()},U=E.useCallback(()=>{var j,ue;const ye=(j=tt==null?void 0:tt.position)!==null&&j!==void 0?j:z;ye?fn(ye):w?Ce.current&&fn(Ce.current):xe!=null&&xe.isConnected&&bC({place:(ue=tt==null?void 0:tt.place)!==null&&ue!==void 0?ue:o,offset:l,elementReference:xe,tooltipReference:pe.current,tooltipArrowReference:oe.current,strategy:h,middlewares:p,border:q,arrowSize:ee}).then(Fe=>{mt.current&&bn(Fe)})},[$e,xe,de,V,o,tt==null?void 0:tt.place,l,h,z,tt==null?void 0:tt.position,w,ee]);E.useEffect(()=>{var j,ue;const ye=new Set(Ne);Je.forEach(Te=>{se!=null&&se(Te)||ye.add({current:Te})});const Fe=document.querySelector(`[id='${s}']`);Fe&&!(se!=null&&se(Fe))&&ye.add({current:Fe});const Me=()=>{Mt(!1)},A=UC(xe),I=UC(pe.current);It.scroll&&(window.addEventListener("scroll",Me),A==null||A.addEventListener("scroll",Me),I==null||I.addEventListener("scroll",Me));let D=null;It.resize?window.addEventListener("resize",Me):xe&&pe.current&&(D=Cae(xe,pe.current,U,{ancestorResize:!0,elementResize:!0,layoutShift:!0}));const P=Te=>{Te.key==="Escape"&&Mt(!1)};It.escape&&window.addEventListener("keydown",P),It.clickOutsideAnchor&&window.addEventListener("click",bt);const N=[],O=Te=>!!(Te!=null&&Te.target&&(xe!=null&&xe.contains(Te.target))),Z=Te=>{$e&&O(Te)||Wn(Te)},ce=Te=>{$e&&O(Te)&&Gn()},X=["mouseover","mouseout","mouseenter","mouseleave","focus","blur"],J=["click","dblclick","mousedown","mouseup"];Object.entries(Rt).forEach(([Te,Ee])=>{Ee&&(X.includes(Te)?N.push({event:Te,listener:wt}):J.includes(Te)&&N.push({event:Te,listener:Z}))}),Object.entries(yt).forEach(([Te,Ee])=>{Ee&&(X.includes(Te)?N.push({event:Te,listener:be}):J.includes(Te)&&N.push({event:Te,listener:ce}))}),w&&N.push({event:"pointermove",listener:Nt});const re=()=>{He.current=!0},le=()=>{He.current=!1,Gn()},Ae=y&&(yt.mouseout||yt.mouseleave);return Ae&&((j=pe.current)===null||j===void 0||j.addEventListener("mouseover",re),(ue=pe.current)===null||ue===void 0||ue.addEventListener("mouseout",le)),N.forEach(({event:Te,listener:Ee})=>{ye.forEach(De=>{var Ge;(Ge=De.current)===null||Ge===void 0||Ge.addEventListener(Te,Ee)})}),()=>{var Te,Ee;It.scroll&&(window.removeEventListener("scroll",Me),A==null||A.removeEventListener("scroll",Me),I==null||I.removeEventListener("scroll",Me)),It.resize?window.removeEventListener("resize",Me):D==null||D(),It.clickOutsideAnchor&&window.removeEventListener("click",bt),It.escape&&window.removeEventListener("keydown",P),Ae&&((Te=pe.current)===null||Te===void 0||Te.removeEventListener("mouseover",re),(Ee=pe.current)===null||Ee===void 0||Ee.removeEventListener("mouseout",le)),N.forEach(({event:De,listener:Ge})=>{ye.forEach(_t=>{var Tt;(Tt=_t.current)===null||Tt===void 0||Tt.removeEventListener(De,Ge)})})}},[xe,U,ht,Ne,Je,C,M,F,We,v,g]),E.useEffect(()=>{var j,ue;let ye=(ue=(j=tt==null?void 0:tt.anchorSelect)!==null&&j!==void 0?j:a)!==null&&ue!==void 0?ue:"";!ye&&t&&(ye=`[data-tooltip-id='${t.replace(/'/g,"\\'")}']`);const Fe=new MutationObserver(Me=>{const A=[],I=[];Me.forEach(D=>{if(D.type==="attributes"&&D.attributeName==="data-tooltip-id"&&(D.target.getAttribute("data-tooltip-id")===t?A.push(D.target):D.oldValue===t&&I.push(D.target)),D.type==="childList"){if(xe){const P=[...D.removedNodes].filter(N=>N.nodeType===1);if(ye)try{I.push(...P.filter(N=>N.matches(ye))),I.push(...P.flatMap(N=>[...N.querySelectorAll(ye)]))}catch{}P.some(N=>{var O;return!!(!((O=N==null?void 0:N.contains)===null||O===void 0)&&O.call(N,xe))&&(Dt(!1),Mt(!1),L(null),ii(Le),ii(B),!0)})}if(ye)try{const P=[...D.addedNodes].filter(N=>N.nodeType===1);A.push(...P.filter(N=>N.matches(ye))),A.push(...P.flatMap(N=>[...N.querySelectorAll(ye)]))}catch{}}}),(A.length||I.length)&&Qe(D=>[...D.filter(P=>!I.includes(P)),...A])});return Fe.observe(document.body,{childList:!0,subtree:!0,attributes:!0,attributeFilter:["data-tooltip-id"],attributeOldValue:!0}),()=>{Fe.disconnect()}},[t,a,tt==null?void 0:tt.anchorSelect,xe]),E.useEffect(()=>{U()},[U]),E.useEffect(()=>{if(!(ae!=null&&ae.current))return()=>null;const j=new ResizeObserver(()=>{setTimeout(()=>U())});return j.observe(ae.current),()=>{j.disconnect()}},[de,ae==null?void 0:ae.current]),E.useEffect(()=>{var j;const ue=document.querySelector(`[id='${s}']`),ye=[...Je,ue];xe&&ye.includes(xe)||L((j=Je[0])!==null&&j!==void 0?j:ue)},[s,Je,xe]),E.useEffect(()=>(H&&Mt(!0),()=>{ii(Le),ii(B)}),[]),E.useEffect(()=>{var j;let ue=(j=tt==null?void 0:tt.anchorSelect)!==null&&j!==void 0?j:a;if(!ue&&t&&(ue=`[data-tooltip-id='${t.replace(/'/g,"\\'")}']`),ue)try{const ye=Array.from(document.querySelectorAll(ue));Qe(ye)}catch{Qe([])}},[t,a,tt==null?void 0:tt.anchorSelect]),E.useEffect(()=>{Le.current&&(ii(Le),Et(v))},[v]);const Y=(we=tt==null?void 0:tt.content)!==null&&we!==void 0?we:de,te=$e&&Object.keys(Ue.tooltipStyles).length>0;return E.useImperativeHandle(e,()=>({open:j=>{if(j!=null&&j.anchorSelect)try{document.querySelector(j.anchorSelect)}catch{return void console.warn(`[react-tooltip] "${j.anchorSelect}" is not a valid CSS selector`)}Kt(j??null),j!=null&&j.delay?Et(j.delay):Mt(!0)},close:j=>{j!=null&&j.delay?xn(j.delay):Mt(!1)},activeAnchor:xe,place:Ue.place,isOpen:!!(ht&&!x&&Y&&te)})),ht&&!x&&Y?xt.createElement(m,{id:t,role:Se,className:xv("react-tooltip",ll.tooltip,Cm.tooltip,Cm[i],n,`react-tooltip__place-${Ue.place}`,ll[te?"show":"closing"],te?"react-tooltip__show":"react-tooltip__closing",h==="fixed"&&ll.fixed,y&&ll.clickable),onTransitionEnd:j=>{ii(st),$e||j.propertyName!=="opacity"||(Dt(!1),Kt(null),Q==null||Q())},style:{...V,...Ue.tooltipStyles,opacity:W!==void 0&&te?W:void 0},ref:pe},Y,xt.createElement(m,{className:xv("react-tooltip-arrow",ll.arrow,Cm.arrow,r,T&&ll.noArrow),style:{...Ue.tooltipArrowStyles,background:G?`linear-gradient(to right bottom, transparent 50%, ${G} 50%)`:void 0,"--rt-arrow-size":`${ee}px`},ref:oe})):null},Uae=({content:e})=>xt.createElement("span",{dangerouslySetInnerHTML:{__html:e}}),Vae=xt.forwardRef(({id:e,anchorId:t,anchorSelect:n,content:r,html:i,render:s,className:a,classNameArrow:o,variant:l="dark",place:u="top",offset:c=10,wrapper:h="div",children:p=null,events:m=["hover"],openOnClick:v=!1,positionStrategy:g="absolute",middlewares:w,delayShow:x=0,delayHide:T=0,float:y=!1,hidden:_=!1,noArrow:k=!1,clickable:S=!1,closeOnEsc:C=!1,closeOnScroll:M=!1,closeOnResize:F=!1,openEvents:b,closeEvents:V,globalCloseEvents:z,imperativeModeOnly:ie=!1,style:Q,position:se,isOpen:de,defaultIsOpen:ae=!1,disableStyleInjection:ne=!1,border:H,opacity:fe,arrowColor:xe,arrowSize:L,setIsOpen:q,afterShow:W,afterHide:G,disableTooltip:ee,role:Se="tooltip"},we)=>{const[pe,oe]=E.useState(r),[Le,B]=E.useState(i),[st,Ue]=E.useState(u),[at,$e]=E.useState(l),[Re,ht]=E.useState(c),[Dt,tt]=E.useState(x),[Kt,ve]=E.useState(T),[Ce,Ne]=E.useState(y),[Oe,He]=E.useState(_),[Je,Qe]=E.useState(h),[mt,We]=E.useState(m),[Xe,Rt]=E.useState(g),[yt,It]=E.useState(null),[Mt,bn]=E.useState(null),Et=E.useRef(ne),{anchorRefs:xn,activeAnchor:Wn}=aI(e),Gn=ot=>ot==null?void 0:ot.getAttributeNames().reduce((wt,be)=>{var U;return be.startsWith("data-tooltip-")&&(wt[be.replace(/^data-tooltip-/,"")]=(U=ot==null?void 0:ot.getAttribute(be))!==null&&U!==void 0?U:null),wt},{}),fn=ot=>{const wt={place:be=>{var U;Ue((U=be)!==null&&U!==void 0?U:u)},content:be=>{oe(be??r)},html:be=>{B(be??i)},variant:be=>{var U;$e((U=be)!==null&&U!==void 0?U:l)},offset:be=>{ht(be===null?c:Number(be))},wrapper:be=>{var U;Qe((U=be)!==null&&U!==void 0?U:h)},events:be=>{const U=be==null?void 0:be.split(" ");We(U??m)},"position-strategy":be=>{var U;Rt((U=be)!==null&&U!==void 0?U:g)},"delay-show":be=>{tt(be===null?x:Number(be))},"delay-hide":be=>{ve(be===null?T:Number(be))},float:be=>{Ne(be===null?y:be==="true")},hidden:be=>{He(be===null?_:be==="true")},"class-name":be=>{It(be)}};Object.values(wt).forEach(be=>be(null)),Object.entries(ot).forEach(([be,U])=>{var Y;(Y=wt[be])===null||Y===void 0||Y.call(wt,U)})};E.useEffect(()=>{oe(r)},[r]),E.useEffect(()=>{B(i)},[i]),E.useEffect(()=>{Ue(u)},[u]),E.useEffect(()=>{$e(l)},[l]),E.useEffect(()=>{ht(c)},[c]),E.useEffect(()=>{tt(x)},[x]),E.useEffect(()=>{ve(T)},[T]),E.useEffect(()=>{Ne(y)},[y]),E.useEffect(()=>{He(_)},[_]),E.useEffect(()=>{Rt(g)},[g]),E.useEffect(()=>{Et.current!==ne&&console.warn("[react-tooltip] Do not change `disableStyleInjection` dynamically.")},[ne]),E.useEffect(()=>{typeof window<"u"&&window.dispatchEvent(new CustomEvent("react-tooltip-inject-styles",{detail:{disableCore:ne==="core",disableBase:ne}}))},[]),E.useEffect(()=>{var ot;const wt=new Set(xn);let be=n;if(!be&&e&&(be=`[data-tooltip-id='${e.replace(/'/g,"\\'")}']`),be)try{document.querySelectorAll(be).forEach(ue=>{wt.add({current:ue})})}catch{console.warn(`[react-tooltip] "${be}" is not a valid CSS selector`)}const U=document.querySelector(`[id='${t}']`);if(U&&wt.add({current:U}),!wt.size)return()=>null;const Y=(ot=Mt??U)!==null&&ot!==void 0?ot:Wn.current,te=new MutationObserver(ue=>{ue.forEach(ye=>{var Fe;if(!Y||ye.type!=="attributes"||!(!((Fe=ye.attributeName)===null||Fe===void 0)&&Fe.startsWith("data-tooltip-")))return;const Me=Gn(Y);fn(Me)})}),j={attributes:!0,childList:!1,subtree:!1};if(Y){const ue=Gn(Y);fn(ue),te.observe(Y,j)}return()=>{te.disconnect()}},[xn,Wn,Mt,t,n]),E.useEffect(()=>{Q!=null&&Q.border&&console.warn("[react-tooltip] Do not set `style.border`. Use `border` prop instead."),H&&!LC("border",`${H}`)&&console.warn(`[react-tooltip] "${H}" is not a valid \`border\`.`),Q!=null&&Q.opacity&&console.warn("[react-tooltip] Do not set `style.opacity`. Use `opacity` prop instead."),fe&&!LC("opacity",`${fe}`)&&console.warn(`[react-tooltip] "${fe}" is not a valid \`opacity\`.`)},[]);let Nt=p;const bt=E.useRef(null);if(s){const ot=s({content:(Mt==null?void 0:Mt.getAttribute("data-tooltip-content"))||pe||null,activeAnchor:Mt});Nt=ot?xt.createElement("div",{ref:bt,className:"react-tooltip-content-wrapper"},ot):null}else pe&&(Nt=pe);Le&&(Nt=xt.createElement(Uae,{content:Le}));const Ut={forwardRef:we,id:e,anchorId:t,anchorSelect:n,className:xv(a,yt),classNameArrow:o,content:Nt,contentWrapperRef:bt,place:st,variant:at,offset:Re,wrapper:Je,events:mt,openOnClick:v,positionStrategy:Xe,middlewares:w,delayShow:Dt,delayHide:Kt,float:Ce,hidden:Oe,noArrow:k,clickable:S,closeOnEsc:C,closeOnScroll:M,closeOnResize:F,openEvents:b,closeEvents:V,globalCloseEvents:z,imperativeModeOnly:ie,style:Q,position:se,isOpen:de,defaultIsOpen:ae,border:H,opacity:fe,arrowColor:xe,arrowSize:L,setIsOpen:q,afterShow:W,afterHide:G,disableTooltip:ee,activeAnchor:Mt,setActiveAnchor:ot=>bn(ot),role:Se};return xt.createElement(Bae,{...Ut})});typeof window<"u"&&window.addEventListener("react-tooltip-inject-styles",e=>{e.detail.disableCore||NC({css:":root{--rt-color-white:#fff;--rt-color-dark:#222;--rt-color-success:#8dc572;--rt-color-error:#be6464;--rt-color-warning:#f0ad4e;--rt-color-info:#337ab7;--rt-opacity:0.9;--rt-transition-show-delay:0.15s;--rt-transition-closing-delay:0.15s;--rt-arrow-size:8px}.core-styles-module_tooltip__3vRRp{position:absolute;top:0;left:0;pointer-events:none;opacity:0;will-change:opacity}.core-styles-module_fixed__pcSol{position:fixed}.core-styles-module_arrow__cvMwQ{position:absolute;background:inherit;z-index:-1}.core-styles-module_noArrow__xock6{display:none}.core-styles-module_clickable__ZuTTB{pointer-events:auto}.core-styles-module_show__Nt9eE{opacity:var(--rt-opacity);transition:opacity var(--rt-transition-show-delay)ease-out}.core-styles-module_closing__sGnxF{opacity:0;transition:opacity var(--rt-transition-closing-delay)ease-in}",type:"core"}),e.detail.disableBase||NC({css:`
.styles-module_tooltip__mnnfp{padding:8px 16px;border-radius:3px;font-size:90%;width:max-content}.styles-module_arrow__K0L3T{width:var(--rt-arrow-size);height:var(--rt-arrow-size)}[class*='react-tooltip__place-top']>.styles-module_arrow__K0L3T{transform:rotate(45deg)}[class*='react-tooltip__place-right']>.styles-module_arrow__K0L3T{transform:rotate(135deg)}[class*='react-tooltip__place-bottom']>.styles-module_arrow__K0L3T{transform:rotate(225deg)}[class*='react-tooltip__place-left']>.styles-module_arrow__K0L3T{transform:rotate(315deg)}.styles-module_dark__xNqje{background:var(--rt-color-dark);color:var(--rt-color-white)}.styles-module_light__Z6W-X{background-color:var(--rt-color-white);color:var(--rt-color-dark)}.styles-module_success__A2AKt{background-color:var(--rt-color-success);color:var(--rt-color-white)}.styles-module_warning__SCK0X{background-color:var(--rt-color-warning);color:var(--rt-color-white)}.styles-module_error__JvumD{background-color:var(--rt-color-error);color:var(--rt-color-white)}.styles-module_info__BWdHW{background-color:var(--rt-color-info);color:var(--rt-color-white)}`,type:"base"})});const Hae=({status:e,isOnline:t})=>{const n=()=>{if(!t)return{Icon:BM,color:"text-gray-500",tooltip:"Offline",animate:!1};switch(e){case"syncing":return{Icon:TB,color:"text-blue-500",tooltip:"Syncing...",animate:!0};case"synced":return{Icon:RM,color:"text-green-500",tooltip:"Synced",animate:!1};case"error":return{Icon:cB,color:"text-red-500",tooltip:"Sync Error",animate:!1};case"idle":default:return{Icon:AB,color:"text-gray-400",tooltip:"Online",animate:!1}}},{Icon:r,color:i,tooltip:s,animate:a}=n();return R.jsxs(R.Fragment,{children:[R.jsx(dr.div,{"data-tooltip-id":"sync-status-tooltip","data-tooltip-content":s,className:`flex items-center justify-center w-8 h-8 rounded-full ${i}`,children:R.jsx(r,{size:18,className:a?"animate-spin":""})}),R.jsx(Vae,{id:"sync-status-tooltip",place:"top"})]})},Co={hidden:{opacity:0,x:-20,transition:{duration:.2}},visible:{opacity:1,x:0,transition:{delay:.1,duration:.2}}},$ae={collapsed:{height:"64px",transition:{duration:.3}},expanded:{height:"96px",transition:{duration:.3}}},ul=({icon:e,label:t,to:n,isCollapsed:r})=>{const s=Hs().pathname===n;return R.jsxs(Ox,{to:n,className:`w-full flex items-center px-4 py-3 rounded-lg text-sm font-semibold transition-all duration-200 ${s?"bg-gradient-to-r from-[var(--primary-accent-start)] to-[var(--primary-accent-end)] text-white shadow-lg shadow-[var(--primary-accent-start)]/20":"text-[var(--text-secondary)] hover:text-[var(--text-primary)] hover:bg-white/5"} ${r?"justify-center":""}`,"aria-current":s?"page":void 0,title:r?t:void 0,children:[R.jsx(e,{size:20}),R.jsx(dr.span,{variants:Co,initial:r?"hidden":"visible",animate:r?"hidden":"visible",className:"ml-3",style:{pointerEvents:r?"none":"auto"},children:t})]})},zae=({isLoggedIn:e,userProfile:t,syncStatus:n,signIn:r,signOut:i,isCollapsed:s,isConfigured:a,isOnline:o})=>a?e&&t?R.jsxs(dr.div,{initial:s?"hidden":"visible",animate:s?"hidden":"visible",variants:Co,className:"p-3 bg-[var(--bg-card)] rounded-lg",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("img",{src:t.imageUrl,alt:t.name,className:"w-10 h-10 rounded-full"}),R.jsxs("div",{className:"text-left overflow-hidden flex-grow",children:[R.jsx("p",{className:"text-sm font-semibold text-[var(--text-primary)] truncate",children:t.name}),R.jsx("p",{className:"text-xs text-[var(--text-muted)] truncate",children:t.email})]}),R.jsx(Hae,{status:n,isOnline:o})]}),R.jsx(Gt,{onClick:i,fullWidth:!0,variant:"danger",size:"sm",className:"mt-3 !bg-transparent !text-[var(--danger-text)] hover:!bg-[var(--danger-start)]/10",children:"Sign Out"})]}):R.jsxs(dr.div,{initial:s?"hidden":"visible",animate:s?"hidden":"visible",variants:Co,className:"p-3 bg-[var(--bg-card)] rounded-lg text-center",children:[R.jsx("h4",{className:"font-semibold text-[var(--text-primary)]",children:"Cloud Sync"}),R.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1 mb-4",children:"Sign in to sync your favorites across devices."}),R.jsx(Gt,{onClick:r,leftIcon:R.jsx(yB,{size:16}),fullWidth:!0,variant:"primary",children:"Sign in with Google"})]}):R.jsxs(dr.div,{initial:s?"hidden":"visible",animate:s?"hidden":"visible",variants:Co,className:"p-3 bg-[var(--bg-card)] rounded-lg text-center",children:[R.jsx("h4",{className:"font-semibold text-[var(--text-primary)]",children:"Cloud Sync Unavailable"}),R.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"This feature has not been configured."})]}),Wae=({theme:e,setTheme:t,accentColor:n,setAccentColor:r,isCollapsed:i})=>R.jsxs(dr.div,{initial:i?"hidden":"visible",animate:i?"hidden":"visible",variants:Co,className:"p-3 bg-[var(--bg-card)] rounded-lg",children:[R.jsx("h4",{className:"font-semibold text-xs text-[var(--text-secondary)] uppercase tracking-wider mb-3",children:"Appearance"}),R.jsxs("div",{className:"flex items-center space-x-2 p-1 bg-[var(--input-bg)] rounded-xl shadow-inner mb-3",children:[R.jsxs("button",{className:`w-full justify-center py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 flex-1 ${e==="dark"?"bg-[var(--primary-accent-start)]/40 text-white":"text-[var(--text-secondary)] hover:text-[var(--text-primary)]"}`,onClick:()=>t("dark"),"aria-pressed":e==="dark",children:[R.jsx(IM,{size:16})," Dark"]}),R.jsxs("button",{className:`w-full justify-center py-1.5 rounded-lg text-sm font-medium transition-colors flex items-center gap-2 flex-1 ${e==="light"?"bg-slate-200 text-slate-800":"text-[var(--text-secondary)] hover:text-[var(--text-primary)]"}`,onClick:()=>t("light"),"aria-pressed":e==="light",children:[R.jsx(OM,{size:16})," Light"]})]}),R.jsx("div",{className:"flex items-center justify-around",children:nv.map(s=>R.jsx("button",{title:s.name,onClick:()=>r(s),className:"w-7 h-7 rounded-full transition-all duration-200 border-2",style:{backgroundColor:`hsl(${s.values.h}, ${s.values.s}%, ${s.values.l}%)`,borderColor:n.key===s.key?`hsl(${s.values.h}, ${s.values.s}%, ${s.values.l}%)`:"transparent",boxShadow:n.key===s.key?"0 0 0 2px var(--bg-card)":"none"},children:n.key===s.key&&R.jsx(AM,{size:16,className:"text-white/80 mx-auto"})},s.key))})]}),Gae=({theme:e,setTheme:t,isCollapsed:n,setIsCollapsed:r,isLoggedIn:i,userProfile:s,syncStatus:a,signIn:o,signOut:l,isConfigured:u,accentColor:c,setAccentColor:h,openCommandPalette:p,isOnline:m})=>{const v=n?e==="dark"?"/TACTMS/img/DarkLogoCollapsed.svg":"/TACTMS/img/LightLogoCollapsed.svg":e==="dark"?"/TACTMS/img/DarkLogoExpanded.svg":"/TACTMS/img/LightLogoExpanded.svg";return R.jsxs("aside",{className:`sidebar glassmorphism-bg ${n?"collapsed":""}`,children:[R.jsxs("div",{className:"flex flex-col items-center mb-10",children:[R.jsx(dr.img,{src:v,alt:"TACTMS Logo",variants:$ae,animate:n?"collapsed":"expanded",className:"w-auto"}),R.jsx(ks,{children:!n&&R.jsx(dr.p,{variants:Co,initial:"hidden",animate:"visible",exit:"exit",className:"text-xs text-[var(--text-muted)] mt-2 text-center",children:"TACTMS - The Apostolic Church Tithe Made Simple"})})]}),R.jsxs("nav",{className:"flex-grow space-y-2",children:[R.jsx(ul,{icon:PM,label:"Dashboard",to:"/",isCollapsed:n}),R.jsx(ul,{icon:MM,label:"Tithe Processor",to:"/processor",isCollapsed:n}),R.jsx(ul,{icon:FM,label:"Member Database",to:"/database",isCollapsed:n}),R.jsx(ul,{icon:LM,label:"Favorites",to:"/favorites",isCollapsed:n}),R.jsx(ul,{icon:NM,label:"Reports",to:"/reports",isCollapsed:n}),R.jsx(ul,{icon:kM,label:"AI Analytics",to:"/analytics",isCollapsed:n})]}),R.jsxs("div",{className:"mt-auto flex-shrink-0",children:[R.jsx("div",{className:"flex justify-center items-center gap-2 mb-4",children:R.jsx("button",{onClick:()=>r(!n),className:"p-2 rounded-lg text-[var(--text-muted)] hover:text-[var(--text-primary)] bg-[var(--bg-card)] hover:bg-[var(--bg-card-subtle-accent)] transition-all flex-grow","aria-label":n?"Expand sidebar":"Collapse sidebar",children:n?R.jsx(lB,{size:20,className:"mx-auto"}):R.jsx(oB,{size:20,className:"mx-auto"})})}),R.jsx("div",{className:"mb-4",children:R.jsx(zae,{isCollapsed:n,isLoggedIn:i,userProfile:s,syncStatus:a,signIn:o,signOut:l,isConfigured:u,isOnline:m})}),R.jsx("div",{className:"mb-4",children:R.jsx(Wae,{theme:e,setTheme:t,accentColor:c,setAccentColor:h,isCollapsed:n})}),R.jsx(ks,{children:!n&&R.jsxs(dr.div,{variants:Co,initial:"hidden",animate:"visible",exit:"exit",className:"text-center space-y-3",children:[R.jsxs("button",{onClick:p,className:"w-full text-center text-xs text-[var(--text-muted)] p-2 rounded-md hover:bg-[var(--bg-card)] transition-colors",children:["Press ",R.jsx("span",{className:"kbd-hint",children:"K"})," to search"]}),R.jsx("p",{className:"text-xs text-[var(--text-muted)]",children:" 2025 Dexify by DexignMasters"})]})})]})]})};var Bu=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(e){return this.listeners.add(e),this.onSubscribe(),()=>{this.listeners.delete(e),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Vo=typeof window>"u"||"Deno"in globalThis;function Sr(){}function qae(e,t){return typeof e=="function"?e(t):e}function wv(e){return typeof e=="number"&&e>=0&&e!==1/0}function oI(e,t){return Math.max(e+(t||0)-Date.now(),0)}function Ra(e,t){return typeof e=="function"?e(t):e}function pi(e,t){return typeof e=="function"?e(t):e}function VC(e,t){const{type:n="all",exact:r,fetchStatus:i,predicate:s,queryKey:a,stale:o}=e;if(a){if(r){if(t.queryHash!==Ay(a,t.options))return!1}else if(!Rf(t.queryKey,a))return!1}if(n!=="all"){const l=t.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof o=="boolean"&&t.isStale()!==o||i&&i!==t.state.fetchStatus||s&&!s(t))}function HC(e,t){const{exact:n,status:r,predicate:i,mutationKey:s}=e;if(s){if(!t.options.mutationKey)return!1;if(n){if(Ho(t.options.mutationKey)!==Ho(s))return!1}else if(!Rf(t.options.mutationKey,s))return!1}return!(r&&t.state.status!==r||i&&!i(t))}function Ay(e,t){return((t==null?void 0:t.queryKeyHashFn)||Ho)(e)}function Ho(e){return JSON.stringify(e,(t,n)=>Tv(n)?Object.keys(n).sort().reduce((r,i)=>(r[i]=n[i],r),{}):n)}function Rf(e,t){return e===t?!0:typeof e!=typeof t?!1:e&&t&&typeof e=="object"&&typeof t=="object"?Object.keys(t).every(n=>Rf(e[n],t[n])):!1}function lI(e,t){if(e===t)return e;const n=$C(e)&&$C(t);if(n||Tv(e)&&Tv(t)){const r=n?e:Object.keys(e),i=r.length,s=n?t:Object.keys(t),a=s.length,o=n?[]:{},l=new Set(r);let u=0;for(let c=0;c<a;c++){const h=n?c:s[c];(!n&&l.has(h)||n)&&e[h]===void 0&&t[h]===void 0?(o[h]=void 0,u++):(o[h]=lI(e[h],t[h]),o[h]===e[h]&&e[h]!==void 0&&u++)}return i===a&&u===i?e:o}return t}function Eh(e,t){if(!t||Object.keys(e).length!==Object.keys(t).length)return!1;for(const n in e)if(e[n]!==t[n])return!1;return!0}function $C(e){return Array.isArray(e)&&e.length===Object.keys(e).length}function Tv(e){if(!zC(e))return!1;const t=e.constructor;if(t===void 0)return!0;const n=t.prototype;return!(!zC(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(e)!==Object.prototype)}function zC(e){return Object.prototype.toString.call(e)==="[object Object]"}function Kae(e){return new Promise(t=>{setTimeout(t,e)})}function Sv(e,t,n){return typeof n.structuralSharing=="function"?n.structuralSharing(e,t):n.structuralSharing!==!1?lI(e,t):t}function Yae(e,t,n=0){const r=[...e,t];return n&&r.length>n?r.slice(1):r}function Xae(e,t,n=0){const r=[t,...e];return n&&r.length>n?r.slice(0,-1):r}var Ry=Symbol();function uI(e,t){return!e.queryFn&&(t!=null&&t.initialPromise)?()=>t.initialPromise:!e.queryFn||e.queryFn===Ry?()=>Promise.reject(new Error(`Missing queryFn: '${e.queryHash}'`)):e.queryFn}function cI(e,t){return typeof e=="function"?e(...t):!!e}var lo,ia,Kl,ZC,Jae=(ZC=class extends Bu{constructor(){super();Ye(this,lo);Ye(this,ia);Ye(this,Kl);Be(this,Kl,t=>{if(!Vo&&window.addEventListener){const n=()=>t();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){K(this,ia)||this.setEventListener(K(this,Kl))}onUnsubscribe(){var t;this.hasListeners()||((t=K(this,ia))==null||t.call(this),Be(this,ia,void 0))}setEventListener(t){var n;Be(this,Kl,t),(n=K(this,ia))==null||n.call(this),Be(this,ia,t(r=>{typeof r=="boolean"?this.setFocused(r):this.onFocus()}))}setFocused(t){K(this,lo)!==t&&(Be(this,lo,t),this.onFocus())}onFocus(){const t=this.isFocused();this.listeners.forEach(n=>{n(t)})}isFocused(){var t;return typeof K(this,lo)=="boolean"?K(this,lo):((t=globalThis.document)==null?void 0:t.visibilityState)!=="hidden"}},lo=new WeakMap,ia=new WeakMap,Kl=new WeakMap,ZC),My=new Jae,Yl,sa,Xl,e2,Qae=(e2=class extends Bu{constructor(){super();Ye(this,Yl,!0);Ye(this,sa);Ye(this,Xl);Be(this,Xl,t=>{if(!Vo&&window.addEventListener){const n=()=>t(!0),r=()=>t(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",r,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",r)}}})}onSubscribe(){K(this,sa)||this.setEventListener(K(this,Xl))}onUnsubscribe(){var t;this.hasListeners()||((t=K(this,sa))==null||t.call(this),Be(this,sa,void 0))}setEventListener(t){var n;Be(this,Xl,t),(n=K(this,sa))==null||n.call(this),Be(this,sa,t(this.setOnline.bind(this)))}setOnline(t){K(this,Yl)!==t&&(Be(this,Yl,t),this.listeners.forEach(r=>{r(t)}))}isOnline(){return K(this,Yl)}},Yl=new WeakMap,sa=new WeakMap,Xl=new WeakMap,e2),_h=new Qae;function Ev(){let e,t;const n=new Promise((i,s)=>{e=i,t=s});n.status="pending",n.catch(()=>{});function r(i){Object.assign(n,i),delete n.resolve,delete n.reject}return n.resolve=i=>{r({status:"fulfilled",value:i}),e(i)},n.reject=i=>{r({status:"rejected",reason:i}),t(i)},n}function jae(e){return Math.min(1e3*2**e,3e4)}function fI(e){return(e??"online")==="online"?_h.isOnline():!0}var dI=class extends Error{constructor(e){super("CancelledError"),this.revert=e==null?void 0:e.revert,this.silent=e==null?void 0:e.silent}};function hI(e){let t=!1,n=0,r;const i=Ev(),s=()=>i.status!=="pending",a=g=>{var w;s()||(p(new dI(g)),(w=e.abort)==null||w.call(e))},o=()=>{t=!0},l=()=>{t=!1},u=()=>My.isFocused()&&(e.networkMode==="always"||_h.isOnline())&&e.canRun(),c=()=>fI(e.networkMode)&&e.canRun(),h=g=>{s()||(r==null||r(),i.resolve(g))},p=g=>{s()||(r==null||r(),i.reject(g))},m=()=>new Promise(g=>{var w;r=x=>{(s()||u())&&g(x)},(w=e.onPause)==null||w.call(e)}).then(()=>{var g;r=void 0,s()||(g=e.onContinue)==null||g.call(e)}),v=()=>{if(s())return;let g;const w=n===0?e.initialPromise:void 0;try{g=w??e.fn()}catch(x){g=Promise.reject(x)}Promise.resolve(g).then(h).catch(x=>{var S;if(s())return;const T=e.retry??(Vo?0:3),y=e.retryDelay??jae,_=typeof y=="function"?y(n,x):y,k=T===!0||typeof T=="number"&&n<T||typeof T=="function"&&T(n,x);if(t||!k){p(x);return}n++,(S=e.onFail)==null||S.call(e,n,x),Kae(_).then(()=>u()?void 0:m()).then(()=>{t?p(x):v()})})};return{promise:i,status:()=>i.status,cancel:a,continue:()=>(r==null||r(),i),cancelRetry:o,continueRetry:l,canStart:c,start:()=>(c()?v():m().then(v),i)}}var Zae=e=>setTimeout(e,0);function eoe(){let e=[],t=0,n=o=>{o()},r=o=>{o()},i=Zae;const s=o=>{t?e.push(o):i(()=>{n(o)})},a=()=>{const o=e;e=[],o.length&&i(()=>{r(()=>{o.forEach(l=>{n(l)})})})};return{batch:o=>{let l;t++;try{l=o()}finally{t--,t||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{r=o},setScheduler:o=>{i=o}}}var Dn=eoe(),uo,t2,pI=(t2=class{constructor(){Ye(this,uo)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),wv(this.gcTime)&&Be(this,uo,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(e){this.gcTime=Math.max(this.gcTime||0,e??(Vo?1/0:5*60*1e3))}clearGcTimeout(){K(this,uo)&&(clearTimeout(K(this,uo)),Be(this,uo,void 0))}},uo=new WeakMap,t2),Jl,Ql,ci,co,On,Mf,fo,Pi,vs,n2,toe=(n2=class extends pI{constructor(t){super();Ye(this,Pi);Ye(this,Jl);Ye(this,Ql);Ye(this,ci);Ye(this,co);Ye(this,On);Ye(this,Mf);Ye(this,fo);Be(this,fo,!1),Be(this,Mf,t.defaultOptions),this.setOptions(t.options),this.observers=[],Be(this,co,t.client),Be(this,ci,K(this,co).getQueryCache()),this.queryKey=t.queryKey,this.queryHash=t.queryHash,Be(this,Jl,noe(this.options)),this.state=t.state??K(this,Jl),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var t;return(t=K(this,On))==null?void 0:t.promise}setOptions(t){this.options={...K(this,Mf),...t},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&K(this,ci).remove(this)}setData(t,n){const r=Sv(this.state.data,t,this.options);return ct(this,Pi,vs).call(this,{data:r,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),r}setState(t,n){ct(this,Pi,vs).call(this,{type:"setState",state:t,setStateOptions:n})}cancel(t){var r,i;const n=(r=K(this,On))==null?void 0:r.promise;return(i=K(this,On))==null||i.cancel(t),n?n.then(Sr).catch(Sr):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(K(this,Jl))}isActive(){return this.observers.some(t=>pi(t.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===Ry||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStatic(){return this.getObserversCount()>0?this.observers.some(t=>Ra(t.options.staleTime,this)==="static"):!1}isStale(){return this.getObserversCount()>0?this.observers.some(t=>t.getCurrentResult().isStale):this.state.data===void 0||this.state.isInvalidated}isStaleByTime(t=0){return this.state.data===void 0?!0:t==="static"?!1:this.state.isInvalidated?!0:!oI(this.state.dataUpdatedAt,t)}onFocus(){var n;const t=this.observers.find(r=>r.shouldFetchOnWindowFocus());t==null||t.refetch({cancelRefetch:!1}),(n=K(this,On))==null||n.continue()}onOnline(){var n;const t=this.observers.find(r=>r.shouldFetchOnReconnect());t==null||t.refetch({cancelRefetch:!1}),(n=K(this,On))==null||n.continue()}addObserver(t){this.observers.includes(t)||(this.observers.push(t),this.clearGcTimeout(),K(this,ci).notify({type:"observerAdded",query:this,observer:t}))}removeObserver(t){this.observers.includes(t)&&(this.observers=this.observers.filter(n=>n!==t),this.observers.length||(K(this,On)&&(K(this,fo)?K(this,On).cancel({revert:!0}):K(this,On).cancelRetry()),this.scheduleGc()),K(this,ci).notify({type:"observerRemoved",query:this,observer:t}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||ct(this,Pi,vs).call(this,{type:"invalidate"})}async fetch(t,n){var l,u,c,h,p,m,v,g,w,x,T,y;if(this.state.fetchStatus!=="idle"&&((l=K(this,On))==null?void 0:l.status())!=="rejected"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(K(this,On))return K(this,On).continueRetry(),K(this,On).promise}if(t&&this.setOptions(t),!this.options.queryFn){const _=this.observers.find(k=>k.options.queryFn);_&&this.setOptions(_.options)}const r=new AbortController,i=_=>{Object.defineProperty(_,"signal",{enumerable:!0,get:()=>(Be(this,fo,!0),r.signal)})},s=()=>{const _=uI(this.options,n),S=(()=>{const C={client:K(this,co),queryKey:this.queryKey,meta:this.meta};return i(C),C})();return Be(this,fo,!1),this.options.persister?this.options.persister(_,S,this):_(S)},o=(()=>{const _={fetchOptions:n,options:this.options,queryKey:this.queryKey,client:K(this,co),state:this.state,fetchFn:s};return i(_),_})();(u=this.options.behavior)==null||u.onFetch(o,this),Be(this,Ql,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=o.fetchOptions)==null?void 0:c.meta))&&ct(this,Pi,vs).call(this,{type:"fetch",meta:(h=o.fetchOptions)==null?void 0:h.meta}),Be(this,On,hI({initialPromise:n==null?void 0:n.initialPromise,fn:o.fetchFn,abort:r.abort.bind(r),onFail:(_,k)=>{ct(this,Pi,vs).call(this,{type:"failed",failureCount:_,error:k})},onPause:()=>{ct(this,Pi,vs).call(this,{type:"pause"})},onContinue:()=>{ct(this,Pi,vs).call(this,{type:"continue"})},retry:o.options.retry,retryDelay:o.options.retryDelay,networkMode:o.options.networkMode,canRun:()=>!0}));try{const _=await K(this,On).start();if(_===void 0)throw new Error(`${this.queryHash} data is undefined`);return this.setData(_),(m=(p=K(this,ci).config).onSuccess)==null||m.call(p,_,this),(g=(v=K(this,ci).config).onSettled)==null||g.call(v,_,this.state.error,this),_}catch(_){if(_ instanceof dI){if(_.silent)return K(this,On).promise;if(_.revert)return this.setState({...K(this,Ql),fetchStatus:"idle"}),this.state.data}throw ct(this,Pi,vs).call(this,{type:"error",error:_}),(x=(w=K(this,ci).config).onError)==null||x.call(w,_,this),(y=(T=K(this,ci).config).onSettled)==null||y.call(T,this.state.data,_,this),_}finally{this.scheduleGc()}}},Jl=new WeakMap,Ql=new WeakMap,ci=new WeakMap,co=new WeakMap,On=new WeakMap,Mf=new WeakMap,fo=new WeakMap,Pi=new WeakSet,vs=function(t){const n=r=>{switch(t.type){case"failed":return{...r,fetchFailureCount:t.failureCount,fetchFailureReason:t.error};case"pause":return{...r,fetchStatus:"paused"};case"continue":return{...r,fetchStatus:"fetching"};case"fetch":return{...r,...mI(r.data,this.options),fetchMeta:t.meta??null};case"success":const i={...r,data:t.data,dataUpdateCount:r.dataUpdateCount+1,dataUpdatedAt:t.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!t.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};return Be(this,Ql,t.manual?i:void 0),i;case"error":const s=t.error;return{...r,error:s,errorUpdateCount:r.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:r.fetchFailureCount+1,fetchFailureReason:s,fetchStatus:"idle",status:"error"};case"invalidate":return{...r,isInvalidated:!0};case"setState":return{...r,...t.state}}};this.state=n(this.state),Dn.batch(()=>{this.observers.forEach(r=>{r.onQueryUpdate()}),K(this,ci).notify({query:this,type:"updated",action:t})})},n2);function mI(e,t){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:fI(t.networkMode)?"fetching":"paused",...e===void 0&&{error:null,status:"pending"}}}function noe(e){const t=typeof e.initialData=="function"?e.initialData():e.initialData,n=t!==void 0,r=n?typeof e.initialDataUpdatedAt=="function"?e.initialDataUpdatedAt():e.initialDataUpdatedAt:0;return{data:t,dataUpdateCount:0,dataUpdatedAt:n?r??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var ji,r2,roe=(r2=class extends Bu{constructor(t={}){super();Ye(this,ji);this.config=t,Be(this,ji,new Map)}build(t,n,r){const i=n.queryKey,s=n.queryHash??Ay(i,n);let a=this.get(s);return a||(a=new toe({client:t,queryKey:i,queryHash:s,options:t.defaultQueryOptions(n),state:r,defaultOptions:t.getQueryDefaults(i)}),this.add(a)),a}add(t){K(this,ji).has(t.queryHash)||(K(this,ji).set(t.queryHash,t),this.notify({type:"added",query:t}))}remove(t){const n=K(this,ji).get(t.queryHash);n&&(t.destroy(),n===t&&K(this,ji).delete(t.queryHash),this.notify({type:"removed",query:t}))}clear(){Dn.batch(()=>{this.getAll().forEach(t=>{this.remove(t)})})}get(t){return K(this,ji).get(t)}getAll(){return[...K(this,ji).values()]}find(t){const n={exact:!0,...t};return this.getAll().find(r=>VC(n,r))}findAll(t={}){const n=this.getAll();return Object.keys(t).length>0?n.filter(r=>VC(t,r)):n}notify(t){Dn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}onFocus(){Dn.batch(()=>{this.getAll().forEach(t=>{t.onFocus()})})}onOnline(){Dn.batch(()=>{this.getAll().forEach(t=>{t.onOnline()})})}},ji=new WeakMap,r2),Zi,vr,ho,es,Js,i2,ioe=(i2=class extends pI{constructor(t){super();Ye(this,es);Ye(this,Zi);Ye(this,vr);Ye(this,ho);this.mutationId=t.mutationId,Be(this,vr,t.mutationCache),Be(this,Zi,[]),this.state=t.state||gI(),this.setOptions(t.options),this.scheduleGc()}setOptions(t){this.options=t,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(t){K(this,Zi).includes(t)||(K(this,Zi).push(t),this.clearGcTimeout(),K(this,vr).notify({type:"observerAdded",mutation:this,observer:t}))}removeObserver(t){Be(this,Zi,K(this,Zi).filter(n=>n!==t)),this.scheduleGc(),K(this,vr).notify({type:"observerRemoved",mutation:this,observer:t})}optionalRemove(){K(this,Zi).length||(this.state.status==="pending"?this.scheduleGc():K(this,vr).remove(this))}continue(){var t;return((t=K(this,ho))==null?void 0:t.continue())??this.execute(this.state.variables)}async execute(t){var s,a,o,l,u,c,h,p,m,v,g,w,x,T,y,_,k,S,C,M;const n=()=>{ct(this,es,Js).call(this,{type:"continue"})};Be(this,ho,hI({fn:()=>this.options.mutationFn?this.options.mutationFn(t):Promise.reject(new Error("No mutationFn found")),onFail:(F,b)=>{ct(this,es,Js).call(this,{type:"failed",failureCount:F,error:b})},onPause:()=>{ct(this,es,Js).call(this,{type:"pause"})},onContinue:n,retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>K(this,vr).canRun(this)}));const r=this.state.status==="pending",i=!K(this,ho).canStart();try{if(r)n();else{ct(this,es,Js).call(this,{type:"pending",variables:t,isPaused:i}),await((a=(s=K(this,vr).config).onMutate)==null?void 0:a.call(s,t,this));const b=await((l=(o=this.options).onMutate)==null?void 0:l.call(o,t));b!==this.state.context&&ct(this,es,Js).call(this,{type:"pending",context:b,variables:t,isPaused:i})}const F=await K(this,ho).start();return await((c=(u=K(this,vr).config).onSuccess)==null?void 0:c.call(u,F,t,this.state.context,this)),await((p=(h=this.options).onSuccess)==null?void 0:p.call(h,F,t,this.state.context)),await((v=(m=K(this,vr).config).onSettled)==null?void 0:v.call(m,F,null,this.state.variables,this.state.context,this)),await((w=(g=this.options).onSettled)==null?void 0:w.call(g,F,null,t,this.state.context)),ct(this,es,Js).call(this,{type:"success",data:F}),F}catch(F){try{throw await((T=(x=K(this,vr).config).onError)==null?void 0:T.call(x,F,t,this.state.context,this)),await((_=(y=this.options).onError)==null?void 0:_.call(y,F,t,this.state.context)),await((S=(k=K(this,vr).config).onSettled)==null?void 0:S.call(k,void 0,F,this.state.variables,this.state.context,this)),await((M=(C=this.options).onSettled)==null?void 0:M.call(C,void 0,F,t,this.state.context)),F}finally{ct(this,es,Js).call(this,{type:"error",error:F})}}finally{K(this,vr).runNext(this)}}},Zi=new WeakMap,vr=new WeakMap,ho=new WeakMap,es=new WeakSet,Js=function(t){const n=r=>{switch(t.type){case"failed":return{...r,failureCount:t.failureCount,failureReason:t.error};case"pause":return{...r,isPaused:!0};case"continue":return{...r,isPaused:!1};case"pending":return{...r,context:t.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:t.isPaused,status:"pending",variables:t.variables,submittedAt:Date.now()};case"success":return{...r,data:t.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...r,data:void 0,error:t.error,failureCount:r.failureCount+1,failureReason:t.error,isPaused:!1,status:"error"}}};this.state=n(this.state),Dn.batch(()=>{K(this,Zi).forEach(r=>{r.onMutationUpdate(t)}),K(this,vr).notify({mutation:this,type:"updated",action:t})})},i2);function gI(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var ws,Ii,Ff,s2,soe=(s2=class extends Bu{constructor(t={}){super();Ye(this,ws);Ye(this,Ii);Ye(this,Ff);this.config=t,Be(this,ws,new Set),Be(this,Ii,new Map),Be(this,Ff,0)}build(t,n,r){const i=new ioe({mutationCache:this,mutationId:++ld(this,Ff)._,options:t.defaultMutationOptions(n),state:r});return this.add(i),i}add(t){K(this,ws).add(t);const n=Yd(t);if(typeof n=="string"){const r=K(this,Ii).get(n);r?r.push(t):K(this,Ii).set(n,[t])}this.notify({type:"added",mutation:t})}remove(t){if(K(this,ws).delete(t)){const n=Yd(t);if(typeof n=="string"){const r=K(this,Ii).get(n);if(r)if(r.length>1){const i=r.indexOf(t);i!==-1&&r.splice(i,1)}else r[0]===t&&K(this,Ii).delete(n)}}this.notify({type:"removed",mutation:t})}canRun(t){const n=Yd(t);if(typeof n=="string"){const r=K(this,Ii).get(n),i=r==null?void 0:r.find(s=>s.state.status==="pending");return!i||i===t}else return!0}runNext(t){var r;const n=Yd(t);if(typeof n=="string"){const i=(r=K(this,Ii).get(n))==null?void 0:r.find(s=>s!==t&&s.state.isPaused);return(i==null?void 0:i.continue())??Promise.resolve()}else return Promise.resolve()}clear(){Dn.batch(()=>{K(this,ws).forEach(t=>{this.notify({type:"removed",mutation:t})}),K(this,ws).clear(),K(this,Ii).clear()})}getAll(){return Array.from(K(this,ws))}find(t){const n={exact:!0,...t};return this.getAll().find(r=>HC(n,r))}findAll(t={}){return this.getAll().filter(n=>HC(t,n))}notify(t){Dn.batch(()=>{this.listeners.forEach(n=>{n(t)})})}resumePausedMutations(){const t=this.getAll().filter(n=>n.state.isPaused);return Dn.batch(()=>Promise.all(t.map(n=>n.continue().catch(Sr))))}},ws=new WeakMap,Ii=new WeakMap,Ff=new WeakMap,s2);function Yd(e){var t;return(t=e.options.scope)==null?void 0:t.id}function WC(e){return{onFetch:(t,n)=>{var c,h,p,m,v;const r=t.options,i=(p=(h=(c=t.fetchOptions)==null?void 0:c.meta)==null?void 0:h.fetchMore)==null?void 0:p.direction,s=((m=t.state.data)==null?void 0:m.pages)||[],a=((v=t.state.data)==null?void 0:v.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const u=async()=>{let g=!1;const w=y=>{Object.defineProperty(y,"signal",{enumerable:!0,get:()=>(t.signal.aborted?g=!0:t.signal.addEventListener("abort",()=>{g=!0}),t.signal)})},x=uI(t.options,t.fetchOptions),T=async(y,_,k)=>{if(g)return Promise.reject();if(_==null&&y.pages.length)return Promise.resolve(y);const C=(()=>{const V={client:t.client,queryKey:t.queryKey,pageParam:_,direction:k?"backward":"forward",meta:t.options.meta};return w(V),V})(),M=await x(C),{maxPages:F}=t.options,b=k?Xae:Yae;return{pages:b(y.pages,M,F),pageParams:b(y.pageParams,_,F)}};if(i&&s.length){const y=i==="backward",_=y?aoe:GC,k={pages:s,pageParams:a},S=_(r,k);o=await T(k,S,y)}else{const y=e??s.length;do{const _=l===0?a[0]??r.initialPageParam:GC(r,o);if(l>0&&_==null)break;o=await T(o,_),l++}while(l<y)}return o};t.options.persister?t.fetchFn=()=>{var g,w;return(w=(g=t.options).persister)==null?void 0:w.call(g,u,{client:t.client,queryKey:t.queryKey,meta:t.options.meta,signal:t.signal},n)}:t.fetchFn=u}}}function GC(e,{pages:t,pageParams:n}){const r=t.length-1;return t.length>0?e.getNextPageParam(t[r],t,n[r],n):void 0}function aoe(e,{pages:t,pageParams:n}){var r;return t.length>0?(r=e.getPreviousPageParam)==null?void 0:r.call(e,t[0],t,n[0],n):void 0}var dn,aa,oa,jl,Zl,la,eu,tu,a2,ooe=(a2=class{constructor(e={}){Ye(this,dn);Ye(this,aa);Ye(this,oa);Ye(this,jl);Ye(this,Zl);Ye(this,la);Ye(this,eu);Ye(this,tu);Be(this,dn,e.queryCache||new roe),Be(this,aa,e.mutationCache||new soe),Be(this,oa,e.defaultOptions||{}),Be(this,jl,new Map),Be(this,Zl,new Map),Be(this,la,0)}mount(){ld(this,la)._++,K(this,la)===1&&(Be(this,eu,My.subscribe(async e=>{e&&(await this.resumePausedMutations(),K(this,dn).onFocus())})),Be(this,tu,_h.subscribe(async e=>{e&&(await this.resumePausedMutations(),K(this,dn).onOnline())})))}unmount(){var e,t;ld(this,la)._--,K(this,la)===0&&((e=K(this,eu))==null||e.call(this),Be(this,eu,void 0),(t=K(this,tu))==null||t.call(this),Be(this,tu,void 0))}isFetching(e){return K(this,dn).findAll({...e,fetchStatus:"fetching"}).length}isMutating(e){return K(this,aa).findAll({...e,status:"pending"}).length}getQueryData(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=K(this,dn).get(t.queryHash))==null?void 0:n.state.data}ensureQueryData(e){const t=this.defaultQueryOptions(e),n=K(this,dn).build(this,t),r=n.state.data;return r===void 0?this.fetchQuery(e):(e.revalidateIfStale&&n.isStaleByTime(Ra(t.staleTime,n))&&this.prefetchQuery(t),Promise.resolve(r))}getQueriesData(e){return K(this,dn).findAll(e).map(({queryKey:t,state:n})=>{const r=n.data;return[t,r]})}setQueryData(e,t,n){const r=this.defaultQueryOptions({queryKey:e}),i=K(this,dn).get(r.queryHash),s=i==null?void 0:i.state.data,a=qae(t,s);if(a!==void 0)return K(this,dn).build(this,r).setData(a,{...n,manual:!0})}setQueriesData(e,t,n){return Dn.batch(()=>K(this,dn).findAll(e).map(({queryKey:r})=>[r,this.setQueryData(r,t,n)]))}getQueryState(e){var n;const t=this.defaultQueryOptions({queryKey:e});return(n=K(this,dn).get(t.queryHash))==null?void 0:n.state}removeQueries(e){const t=K(this,dn);Dn.batch(()=>{t.findAll(e).forEach(n=>{t.remove(n)})})}resetQueries(e,t){const n=K(this,dn);return Dn.batch(()=>(n.findAll(e).forEach(r=>{r.reset()}),this.refetchQueries({type:"active",...e},t)))}cancelQueries(e,t={}){const n={revert:!0,...t},r=Dn.batch(()=>K(this,dn).findAll(e).map(i=>i.cancel(n)));return Promise.all(r).then(Sr).catch(Sr)}invalidateQueries(e,t={}){return Dn.batch(()=>(K(this,dn).findAll(e).forEach(n=>{n.invalidate()}),(e==null?void 0:e.refetchType)==="none"?Promise.resolve():this.refetchQueries({...e,type:(e==null?void 0:e.refetchType)??(e==null?void 0:e.type)??"active"},t)))}refetchQueries(e,t={}){const n={...t,cancelRefetch:t.cancelRefetch??!0},r=Dn.batch(()=>K(this,dn).findAll(e).filter(i=>!i.isDisabled()&&!i.isStatic()).map(i=>{let s=i.fetch(void 0,n);return n.throwOnError||(s=s.catch(Sr)),i.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(r).then(Sr)}fetchQuery(e){const t=this.defaultQueryOptions(e);t.retry===void 0&&(t.retry=!1);const n=K(this,dn).build(this,t);return n.isStaleByTime(Ra(t.staleTime,n))?n.fetch(t):Promise.resolve(n.state.data)}prefetchQuery(e){return this.fetchQuery(e).then(Sr).catch(Sr)}fetchInfiniteQuery(e){return e.behavior=WC(e.pages),this.fetchQuery(e)}prefetchInfiniteQuery(e){return this.fetchInfiniteQuery(e).then(Sr).catch(Sr)}ensureInfiniteQueryData(e){return e.behavior=WC(e.pages),this.ensureQueryData(e)}resumePausedMutations(){return _h.isOnline()?K(this,aa).resumePausedMutations():Promise.resolve()}getQueryCache(){return K(this,dn)}getMutationCache(){return K(this,aa)}getDefaultOptions(){return K(this,oa)}setDefaultOptions(e){Be(this,oa,e)}setQueryDefaults(e,t){K(this,jl).set(Ho(e),{queryKey:e,defaultOptions:t})}getQueryDefaults(e){const t=[...K(this,jl).values()],n={};return t.forEach(r=>{Rf(e,r.queryKey)&&Object.assign(n,r.defaultOptions)}),n}setMutationDefaults(e,t){K(this,Zl).set(Ho(e),{mutationKey:e,defaultOptions:t})}getMutationDefaults(e){const t=[...K(this,Zl).values()],n={};return t.forEach(r=>{Rf(e,r.mutationKey)&&Object.assign(n,r.defaultOptions)}),n}defaultQueryOptions(e){if(e._defaulted)return e;const t={...K(this,oa).queries,...this.getQueryDefaults(e.queryKey),...e,_defaulted:!0};return t.queryHash||(t.queryHash=Ay(t.queryKey,t)),t.refetchOnReconnect===void 0&&(t.refetchOnReconnect=t.networkMode!=="always"),t.throwOnError===void 0&&(t.throwOnError=!!t.suspense),!t.networkMode&&t.persister&&(t.networkMode="offlineFirst"),t.queryFn===Ry&&(t.enabled=!1),t}defaultMutationOptions(e){return e!=null&&e._defaulted?e:{...K(this,oa).mutations,...(e==null?void 0:e.mutationKey)&&this.getMutationDefaults(e.mutationKey),...e,_defaulted:!0}}clear(){K(this,dn).clear(),K(this,aa).clear()}},dn=new WeakMap,aa=new WeakMap,oa=new WeakMap,jl=new WeakMap,Zl=new WeakMap,la=new WeakMap,eu=new WeakMap,tu=new WeakMap,a2),Rr,St,Df,xr,po,nu,ua,ca,Pf,ru,iu,mo,go,fa,su,Bt,dc,_v,Cv,kv,Av,Rv,Mv,Fv,vI,o2,loe=(o2=class extends Bu{constructor(t,n){super();Ye(this,Bt);Ye(this,Rr);Ye(this,St);Ye(this,Df);Ye(this,xr);Ye(this,po);Ye(this,nu);Ye(this,ua);Ye(this,ca);Ye(this,Pf);Ye(this,ru);Ye(this,iu);Ye(this,mo);Ye(this,go);Ye(this,fa);Ye(this,su,new Set);this.options=n,Be(this,Rr,t),Be(this,ca,null),Be(this,ua,Ev()),this.options.experimental_prefetchInRender||K(this,ua).reject(new Error("experimental_prefetchInRender feature flag is not enabled")),this.bindMethods(),this.setOptions(n)}bindMethods(){this.refetch=this.refetch.bind(this)}onSubscribe(){this.listeners.size===1&&(K(this,St).addObserver(this),qC(K(this,St),this.options)?ct(this,Bt,dc).call(this):this.updateResult(),ct(this,Bt,Av).call(this))}onUnsubscribe(){this.hasListeners()||this.destroy()}shouldFetchOnReconnect(){return Dv(K(this,St),this.options,this.options.refetchOnReconnect)}shouldFetchOnWindowFocus(){return Dv(K(this,St),this.options,this.options.refetchOnWindowFocus)}destroy(){this.listeners=new Set,ct(this,Bt,Rv).call(this),ct(this,Bt,Mv).call(this),K(this,St).removeObserver(this)}setOptions(t){const n=this.options,r=K(this,St);if(this.options=K(this,Rr).defaultQueryOptions(t),this.options.enabled!==void 0&&typeof this.options.enabled!="boolean"&&typeof this.options.enabled!="function"&&typeof pi(this.options.enabled,K(this,St))!="boolean")throw new Error("Expected enabled to be a boolean or a callback that returns a boolean");ct(this,Bt,Fv).call(this),K(this,St).setOptions(this.options),n._defaulted&&!Eh(this.options,n)&&K(this,Rr).getQueryCache().notify({type:"observerOptionsUpdated",query:K(this,St),observer:this});const i=this.hasListeners();i&&KC(K(this,St),r,this.options,n)&&ct(this,Bt,dc).call(this),this.updateResult(),i&&(K(this,St)!==r||pi(this.options.enabled,K(this,St))!==pi(n.enabled,K(this,St))||Ra(this.options.staleTime,K(this,St))!==Ra(n.staleTime,K(this,St)))&&ct(this,Bt,_v).call(this);const s=ct(this,Bt,Cv).call(this);i&&(K(this,St)!==r||pi(this.options.enabled,K(this,St))!==pi(n.enabled,K(this,St))||s!==K(this,fa))&&ct(this,Bt,kv).call(this,s)}getOptimisticResult(t){const n=K(this,Rr).getQueryCache().build(K(this,Rr),t),r=this.createResult(n,t);return coe(this,r)&&(Be(this,xr,r),Be(this,nu,this.options),Be(this,po,K(this,St).state)),r}getCurrentResult(){return K(this,xr)}trackResult(t,n){return new Proxy(t,{get:(r,i)=>(this.trackProp(i),n==null||n(i),Reflect.get(r,i))})}trackProp(t){K(this,su).add(t)}getCurrentQuery(){return K(this,St)}refetch({...t}={}){return this.fetch({...t})}fetchOptimistic(t){const n=K(this,Rr).defaultQueryOptions(t),r=K(this,Rr).getQueryCache().build(K(this,Rr),n);return r.fetch().then(()=>this.createResult(r,n))}fetch(t){return ct(this,Bt,dc).call(this,{...t,cancelRefetch:t.cancelRefetch??!0}).then(()=>(this.updateResult(),K(this,xr)))}createResult(t,n){var F;const r=K(this,St),i=this.options,s=K(this,xr),a=K(this,po),o=K(this,nu),u=t!==r?t.state:K(this,Df),{state:c}=t;let h={...c},p=!1,m;if(n._optimisticResults){const b=this.hasListeners(),V=!b&&qC(t,n),z=b&&KC(t,r,n,i);(V||z)&&(h={...h,...mI(c.data,t.options)}),n._optimisticResults==="isRestoring"&&(h.fetchStatus="idle")}let{error:v,errorUpdatedAt:g,status:w}=h;m=h.data;let x=!1;if(n.placeholderData!==void 0&&m===void 0&&w==="pending"){let b;s!=null&&s.isPlaceholderData&&n.placeholderData===(o==null?void 0:o.placeholderData)?(b=s.data,x=!0):b=typeof n.placeholderData=="function"?n.placeholderData((F=K(this,iu))==null?void 0:F.state.data,K(this,iu)):n.placeholderData,b!==void 0&&(w="success",m=Sv(s==null?void 0:s.data,b,n),p=!0)}if(n.select&&m!==void 0&&!x)if(s&&m===(a==null?void 0:a.data)&&n.select===K(this,Pf))m=K(this,ru);else try{Be(this,Pf,n.select),m=n.select(m),m=Sv(s==null?void 0:s.data,m,n),Be(this,ru,m),Be(this,ca,null)}catch(b){Be(this,ca,b)}K(this,ca)&&(v=K(this,ca),m=K(this,ru),g=Date.now(),w="error");const T=h.fetchStatus==="fetching",y=w==="pending",_=w==="error",k=y&&T,S=m!==void 0,M={status:w,fetchStatus:h.fetchStatus,isPending:y,isSuccess:w==="success",isError:_,isInitialLoading:k,isLoading:k,data:m,dataUpdatedAt:h.dataUpdatedAt,error:v,errorUpdatedAt:g,failureCount:h.fetchFailureCount,failureReason:h.fetchFailureReason,errorUpdateCount:h.errorUpdateCount,isFetched:h.dataUpdateCount>0||h.errorUpdateCount>0,isFetchedAfterMount:h.dataUpdateCount>u.dataUpdateCount||h.errorUpdateCount>u.errorUpdateCount,isFetching:T,isRefetching:T&&!y,isLoadingError:_&&!S,isPaused:h.fetchStatus==="paused",isPlaceholderData:p,isRefetchError:_&&S,isStale:Fy(t,n),refetch:this.refetch,promise:K(this,ua),isEnabled:pi(n.enabled,t)!==!1};if(this.options.experimental_prefetchInRender){const b=ie=>{M.status==="error"?ie.reject(M.error):M.data!==void 0&&ie.resolve(M.data)},V=()=>{const ie=Be(this,ua,M.promise=Ev());b(ie)},z=K(this,ua);switch(z.status){case"pending":t.queryHash===r.queryHash&&b(z);break;case"fulfilled":(M.status==="error"||M.data!==z.value)&&V();break;case"rejected":(M.status!=="error"||M.error!==z.reason)&&V();break}}return M}updateResult(){const t=K(this,xr),n=this.createResult(K(this,St),this.options);if(Be(this,po,K(this,St).state),Be(this,nu,this.options),K(this,po).data!==void 0&&Be(this,iu,K(this,St)),Eh(n,t))return;Be(this,xr,n);const r=()=>{if(!t)return!0;const{notifyOnChangeProps:i}=this.options,s=typeof i=="function"?i():i;if(s==="all"||!s&&!K(this,su).size)return!0;const a=new Set(s??K(this,su));return this.options.throwOnError&&a.add("error"),Object.keys(K(this,xr)).some(o=>{const l=o;return K(this,xr)[l]!==t[l]&&a.has(l)})};ct(this,Bt,vI).call(this,{listeners:r()})}onQueryUpdate(){this.updateResult(),this.hasListeners()&&ct(this,Bt,Av).call(this)}},Rr=new WeakMap,St=new WeakMap,Df=new WeakMap,xr=new WeakMap,po=new WeakMap,nu=new WeakMap,ua=new WeakMap,ca=new WeakMap,Pf=new WeakMap,ru=new WeakMap,iu=new WeakMap,mo=new WeakMap,go=new WeakMap,fa=new WeakMap,su=new WeakMap,Bt=new WeakSet,dc=function(t){ct(this,Bt,Fv).call(this);let n=K(this,St).fetch(this.options,t);return t!=null&&t.throwOnError||(n=n.catch(Sr)),n},_v=function(){ct(this,Bt,Rv).call(this);const t=Ra(this.options.staleTime,K(this,St));if(Vo||K(this,xr).isStale||!wv(t))return;const r=oI(K(this,xr).dataUpdatedAt,t)+1;Be(this,mo,setTimeout(()=>{K(this,xr).isStale||this.updateResult()},r))},Cv=function(){return(typeof this.options.refetchInterval=="function"?this.options.refetchInterval(K(this,St)):this.options.refetchInterval)??!1},kv=function(t){ct(this,Bt,Mv).call(this),Be(this,fa,t),!(Vo||pi(this.options.enabled,K(this,St))===!1||!wv(K(this,fa))||K(this,fa)===0)&&Be(this,go,setInterval(()=>{(this.options.refetchIntervalInBackground||My.isFocused())&&ct(this,Bt,dc).call(this)},K(this,fa)))},Av=function(){ct(this,Bt,_v).call(this),ct(this,Bt,kv).call(this,ct(this,Bt,Cv).call(this))},Rv=function(){K(this,mo)&&(clearTimeout(K(this,mo)),Be(this,mo,void 0))},Mv=function(){K(this,go)&&(clearInterval(K(this,go)),Be(this,go,void 0))},Fv=function(){const t=K(this,Rr).getQueryCache().build(K(this,Rr),this.options);if(t===K(this,St))return;const n=K(this,St);Be(this,St,t),Be(this,Df,t.state),this.hasListeners()&&(n==null||n.removeObserver(this),t.addObserver(this))},vI=function(t){Dn.batch(()=>{t.listeners&&this.listeners.forEach(n=>{n(K(this,xr))}),K(this,Rr).getQueryCache().notify({query:K(this,St),type:"observerResultsUpdated"})})},o2);function uoe(e,t){return pi(t.enabled,e)!==!1&&e.state.data===void 0&&!(e.state.status==="error"&&t.retryOnMount===!1)}function qC(e,t){return uoe(e,t)||e.state.data!==void 0&&Dv(e,t,t.refetchOnMount)}function Dv(e,t,n){if(pi(t.enabled,e)!==!1&&Ra(t.staleTime,e)!=="static"){const r=typeof n=="function"?n(e):n;return r==="always"||r!==!1&&Fy(e,t)}return!1}function KC(e,t,n,r){return(e!==t||pi(r.enabled,e)===!1)&&(!n.suspense||e.state.status!=="error")&&Fy(e,n)}function Fy(e,t){return pi(t.enabled,e)!==!1&&e.isStaleByTime(Ra(t.staleTime,e))}function coe(e,t){return!Eh(e.getCurrentResult(),t)}var da,ha,Mr,Ts,Is,x0,Pv,l2,foe=(l2=class extends Bu{constructor(n,r){super();Ye(this,Is);Ye(this,da);Ye(this,ha);Ye(this,Mr);Ye(this,Ts);Be(this,da,n),this.setOptions(r),this.bindMethods(),ct(this,Is,x0).call(this)}bindMethods(){this.mutate=this.mutate.bind(this),this.reset=this.reset.bind(this)}setOptions(n){var i;const r=this.options;this.options=K(this,da).defaultMutationOptions(n),Eh(this.options,r)||K(this,da).getMutationCache().notify({type:"observerOptionsUpdated",mutation:K(this,Mr),observer:this}),r!=null&&r.mutationKey&&this.options.mutationKey&&Ho(r.mutationKey)!==Ho(this.options.mutationKey)?this.reset():((i=K(this,Mr))==null?void 0:i.state.status)==="pending"&&K(this,Mr).setOptions(this.options)}onUnsubscribe(){var n;this.hasListeners()||(n=K(this,Mr))==null||n.removeObserver(this)}onMutationUpdate(n){ct(this,Is,x0).call(this),ct(this,Is,Pv).call(this,n)}getCurrentResult(){return K(this,ha)}reset(){var n;(n=K(this,Mr))==null||n.removeObserver(this),Be(this,Mr,void 0),ct(this,Is,x0).call(this),ct(this,Is,Pv).call(this)}mutate(n,r){var i;return Be(this,Ts,r),(i=K(this,Mr))==null||i.removeObserver(this),Be(this,Mr,K(this,da).getMutationCache().build(K(this,da),this.options)),K(this,Mr).addObserver(this),K(this,Mr).execute(n)}},da=new WeakMap,ha=new WeakMap,Mr=new WeakMap,Ts=new WeakMap,Is=new WeakSet,x0=function(){var r;const n=((r=K(this,Mr))==null?void 0:r.state)??gI();Be(this,ha,{...n,isPending:n.status==="pending",isSuccess:n.status==="success",isError:n.status==="error",isIdle:n.status==="idle",mutate:this.mutate,reset:this.reset})},Pv=function(n){Dn.batch(()=>{var r,i,s,a,o,l,u,c;if(K(this,Ts)&&this.hasListeners()){const h=K(this,ha).variables,p=K(this,ha).context;(n==null?void 0:n.type)==="success"?((i=(r=K(this,Ts)).onSuccess)==null||i.call(r,n.data,h,p),(a=(s=K(this,Ts)).onSettled)==null||a.call(s,n.data,null,h,p)):(n==null?void 0:n.type)==="error"&&((l=(o=K(this,Ts)).onError)==null||l.call(o,n.error,h,p),(c=(u=K(this,Ts)).onSettled)==null||c.call(u,void 0,n.error,h,p))}this.listeners.forEach(h=>{h(K(this,ha))})})},l2),xI=E.createContext(void 0),Dy=e=>{const t=E.useContext(xI);if(!t)throw new Error("No QueryClient set, use QueryClientProvider to set one");return t},doe=({client:e,children:t})=>(E.useEffect(()=>(e.mount(),()=>{e.unmount()}),[e]),R.jsx(xI.Provider,{value:e,children:t})),yI=E.createContext(!1),hoe=()=>E.useContext(yI);yI.Provider;function poe(){let e=!1;return{clearReset:()=>{e=!1},reset:()=>{e=!0},isReset:()=>e}}var moe=E.createContext(poe()),goe=()=>E.useContext(moe),voe=(e,t)=>{(e.suspense||e.throwOnError||e.experimental_prefetchInRender)&&(t.isReset()||(e.retryOnMount=!1))},xoe=e=>{E.useEffect(()=>{e.clearReset()},[e])},yoe=({result:e,errorResetBoundary:t,throwOnError:n,query:r,suspense:i})=>e.isError&&!t.isReset()&&!e.isFetching&&r&&(i&&e.data===void 0||cI(n,[e.error,r])),woe=e=>{if(e.suspense){const t=r=>r==="static"?r:Math.max(r??1e3,1e3),n=e.staleTime;e.staleTime=typeof n=="function"?(...r)=>t(n(...r)):t(n),typeof e.gcTime=="number"&&(e.gcTime=Math.max(e.gcTime,1e3))}},Toe=(e,t)=>e.isLoading&&e.isFetching&&!t,Soe=(e,t)=>(e==null?void 0:e.suspense)&&t.isPending,YC=(e,t,n)=>t.fetchOptimistic(e).catch(()=>{n.clearReset()});function Eoe(e,t,n){var h,p,m,v,g;const r=hoe(),i=goe(),s=Dy(),a=s.defaultQueryOptions(e);(p=(h=s.getDefaultOptions().queries)==null?void 0:h._experimental_beforeQuery)==null||p.call(h,a),a._optimisticResults=r?"isRestoring":"optimistic",woe(a),voe(a,i),xoe(i);const o=!s.getQueryCache().get(a.queryHash),[l]=E.useState(()=>new t(s,a)),u=l.getOptimisticResult(a),c=!r&&e.subscribed!==!1;if(E.useSyncExternalStore(E.useCallback(w=>{const x=c?l.subscribe(Dn.batchCalls(w)):Sr;return l.updateResult(),x},[l,c]),()=>l.getCurrentResult(),()=>l.getCurrentResult()),E.useEffect(()=>{l.setOptions(a)},[a,l]),Soe(a,u))throw YC(a,l,i);if(yoe({result:u,errorResetBoundary:i,throwOnError:a.throwOnError,query:s.getQueryCache().get(a.queryHash),suspense:a.suspense}))throw u.error;if((v=(m=s.getDefaultOptions().queries)==null?void 0:m._experimental_afterQuery)==null||v.call(m,a,u),a.experimental_prefetchInRender&&!Vo&&Toe(u,r)){const w=o?YC(a,l,i):(g=s.getQueryCache().get(a.queryHash))==null?void 0:g.promise;w==null||w.catch(Sr).finally(()=>{l.updateResult()})}return a.notifyOnChangeProps?u:l.trackResult(u)}function wI(e,t){return Eoe(e,loe)}function _oe(e,t){const n=Dy(),[r]=E.useState(()=>new foe(n,e));E.useEffect(()=>{r.setOptions(e)},[r,e]);const i=E.useSyncExternalStore(E.useCallback(a=>r.subscribe(Dn.batchCalls(a)),[r]),()=>r.getCurrentResult(),()=>r.getCurrentResult()),s=E.useCallback((a,o)=>{r.mutate(a,o).catch(Sr)},[r]);if(i.error&&cI(r.options.throwOnError,[i.error]))throw i.error;return{...i,mutate:s,mutateAsync:i.mutate}}const Coe=async e=>{const t=await window.gapi.client.drive.files.list({q:`name='${e}' and trashed=false`,spaces:"drive",fields:"files(id, name)"});if(t.result.files.length>0)return t.result.files[0].id;const n=await window.gapi.client.drive.files.create({resource:{name:e,mimeType:"application/json"},fields:"id"});return await TI(n.result.id,[]),n.result.id},koe=async e=>{try{const t=await window.gapi.client.drive.files.get({fileId:e,alt:"media"});return t.body?JSON.parse(t.body):[]}catch{return[]}},TI=(e,t)=>{const n=new Blob([JSON.stringify(t,null,2)],{type:"application/json"}),r=new FormData;return r.append("metadata",new Blob([],{type:"application/json"})),r.append("file",n),window.gapi.client.request({path:`/upload/drive/v3/files/${e}`,method:"PATCH",params:{uploadType:"multipart"},body:r})},XC=(e,t)=>{var n,r;return wI({queryKey:["driveFile",e],queryFn:()=>Coe(e),enabled:t&&!!((r=(n=window.gapi)==null?void 0:n.client)!=null&&r.drive)})},JC=(e,t)=>{var n,r;return wI({queryKey:["driveFileContent",e],queryFn:()=>koe(e),enabled:t&&!!e&&!!((r=(n=window.gapi)==null?void 0:n.client)!=null&&r.drive)})},QC=e=>{const t=Dy();return _oe({mutationFn:n=>TI(e,n),onSuccess:()=>{t.invalidateQueries({queryKey:["driveFileContent",e]})}})},Aoe=!0,jC=(e,t)=>{const[n,r]=E.useState([]);E.useEffect(()=>{try{const s=localStorage.getItem(e);s&&r(JSON.parse(s))}catch(s){console.error(`Failed to load ${e} from localStorage`,s),t(`Could not load local ${e}.`,"error")}},[e,t]);const i=E.useCallback(s=>{r(a=>{const o=typeof s=="function"?s(a):s;try{localStorage.setItem(e,JSON.stringify(o))}catch(l){console.error(`Failed to save ${e} to localStorage`,l),t(`Could not save ${e} locally.`,"error")}return o})},[e,t]);return[n,i]},Roe=e=>{const[t,n]=jC(s_,e),[r,i]=jC(a_,e),[s,a]=E.useState(!1),[o,l]=E.useState(!1),[u,c]=E.useState(!1),[h,p]=E.useState(null),[m,v]=E.useState("idle"),[g]=E.useState(Aoe),w=E.useRef(!1),{data:x}=XC(FJ,u),{data:T}=XC(DJ,u),{data:y,isLoading:_}=JC(x,u),{data:k,isLoading:S}=JC(T,u),{mutate:C}=QC(x),{mutate:M}=QC(T);E.useEffect(()=>{if(!g)return;const Q=document.createElement("script");Q.src="https://apis.google.com/js/api.js",Q.async=!0,Q.defer=!0,Q.onload=()=>window.gapi.load("client",()=>{window.gapi.client.init({apiKey:AJ}).then(()=>{window.gapi.client.load("drive","v3",()=>a(!0))}).catch(de=>console.error("Error init gapi client",de))}),document.body.appendChild(Q);const se=document.createElement("script");se.src="https://accounts.google.com/gsi/client",se.async=!0,se.defer=!0,se.onload=()=>l(!0),document.body.appendChild(se)},[g]);const F=E.useCallback(async()=>{try{const Q=await window.gapi.client.request({path:"https://www.googleapis.com/oauth2/v3/userinfo"});p({id:Q.result.sub,name:Q.result.name,email:Q.result.email,imageUrl:Q.result.picture})}catch(Q){console.error("Error fetching user profile",Q)}},[]);E.useEffect(()=>{g&&s&&o&&!window.tokenClient&&(window.tokenClient=window.google.accounts.oauth2.initTokenClient({client_id:RJ,scope:MJ,callback:Q=>{if(Q.error){console.error("Token error:",Q.error),e("Authentication failed. Please try again.","error");return}window.gapi.client.setToken(Q),c(!0),F()}}))},[g,s,o,e,F]);const b=E.useCallback(async(Q=!1)=>{var se,de;if(!(!u||w.current||_||S)){w.current=!0,v("syncing");try{if(!x||!T)throw new Error("Could not find or create Drive files.");const ae=JSON.parse(localStorage.getItem(s_)||"[]"),ne=JSON.parse(localStorage.getItem(a_)||"[]");if(Q)C(ae),M(ne);else{const{mergedData:H,updated:fe,added:xe}=V(ae,y||[]),{mergedData:L,updated:q,added:W}=V(ne,k||[]);n(H),i(L),C(H),M(L),fe+xe+q+W>0?e(`Sync complete. Loaded ${xe+W} new items from Drive.`,"info"):e("Data is up to date.","success",2e3)}v("synced")}catch(ae){console.error("Sync error:",ae),v("error");const ne=((de=(se=ae.result)==null?void 0:se.error)==null?void 0:de.message)||"An unknown error occurred during sync.";e(`Google Drive sync failed: ${ne}`,"error")}finally{w.current=!1}}},[u,x,T,y,k,_,S,e,n,i,C,M]),V=(Q,se)=>{const de=new Map;let ae=0,ne=0;return[...Q,...se].forEach(H=>{const fe=de.get(H.id);fe?H.timestamp&&fe.timestamp&&H.timestamp>fe.timestamp&&(de.set(H.id,H),fe.timestamp!==H.timestamp&&ae++):(de.set(H.id,H),Q.find(xe=>xe.id===H.id)||ne++)}),{mergedData:Array.from(de.values()).sort((H,fe)=>(fe.timestamp||0)-(H.timestamp||0)),updated:ae,added:ne}};return E.useEffect(()=>{u&&b()},[u,b]),E.useEffect(()=>{if(u){const Q=setTimeout(()=>b(!0),1500);return()=>clearTimeout(Q)}},[t,r,u,b]),{favorites:t,setFavorites:n,transactionLog:r,setTransactionLog:i,isLoggedIn:u,userProfile:h,syncStatus:m,signIn:()=>{if(!g){e("Cloud Sync feature is not configured by the administrator.","error");return}if(!s||!o){e("Google API is not ready. Please wait a moment.","warning");return}window.tokenClient?window.tokenClient.requestAccessToken({prompt:"consent"}):(e("Google authentication is not ready. Please try again in a moment.","warning"),console.error("signIn called but window.tokenClient is not initialized."))},signOut:()=>{window.gapi.client.setToken(null),c(!1),p(null),v("idle"),e("Signed out from Google.","info")},isConfigured:g}},Moe="YOUR_PUBLIC_VAPID_KEY";function Foe(e){const t="=".repeat((4-e.length%4)%4),n=(e+t).replace(/-/g,"+").replace(/_/g,"/"),r=window.atob(n),i=new Uint8Array(r.length);for(let s=0;s<r.length;++s)i[s]=r.charCodeAt(s);return i}const Doe=(e,t)=>{const[n,r]=E.useState(!1);E.useEffect(()=>{"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(l=>{l.waiting&&t(l.waiting),l.addEventListener("updatefound",()=>{const u=l.installing;u&&u.addEventListener("statechange",()=>{u.state==="installed"&&navigator.serviceWorker.controller&&t(u)})}),l.pushManager.getSubscription().then(u=>{r(!!u)})})},[t]);const i=async()=>{if(!("Notification"in window)){e("This browser does not support desktop notification","error");return}await Notification.requestPermission()==="granted"?(e("Notification permission granted.","success"),s()):e("Notification permission denied.","warning")},s=async()=>{try{const u=await(await navigator.serviceWorker.ready).pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:Foe(Moe)});console.log("User is subscribed:",u),r(!0),e("Successfully subscribed to push notifications!","success")}catch(l){console.error("Failed to subscribe the user: ",l),e("Failed to subscribe to push notifications.","error")}};return{isSubscribed:n,requestNotificationPermission:i,registerBackgroundSync:async()=>{try{await(await navigator.serviceWorker.ready).sync.register("sync-tithe-data"),console.log('Background sync registered for "sync-tithe-data"'),e("Offline changes will be synced in the background.","info")}catch(l){console.error("Background sync could not be registered!",l),e("Background sync is not supported by this browser.","error")}},registerPeriodicSync:async()=>{try{const l=await navigator.serviceWorker.ready;"periodicSync"in l?(await navigator.permissions.query({name:"periodic-background-sync"})).state==="granted"?(await l.periodicSync.register("get-latest-updates",{minInterval:24*60*60*1e3}),console.log('Periodic sync registered for "get-latest-updates"'),e("App will periodically sync in the background.","info")):e("Periodic background sync permission not granted.","warning"):e("Periodic background sync is not supported by this browser.","error")}catch(l){console.error("Periodic sync could not be registered!",l),e("Failed to register periodic sync.","error")}}}},SI=xt.memo(({record:e,visualIndex:t,isActive:n,onAmountChange:r,onNavigate:i,setActiveRow:s})=>{const[a,o]=E.useState(String(e["Transaction Amount"]??"")),l=E.useRef(null);E.useEffect(()=>{o(String(e["Transaction Amount"]??""))},[e["Transaction Amount"]]),E.useEffect(()=>{var h,p;n&&((h=l.current)==null||h.focus(),(p=l.current)==null||p.select())},[n]);const u=()=>{r(e["No."],a)},c=h=>{var p;switch(h.key){case"Enter":case"ArrowDown":h.preventDefault(),r(e["No."],a),i("down");break;case"ArrowUp":h.preventDefault(),r(e["No."],a),i("up");break;case"Tab":h.preventDefault(),r(e["No."],a),i(h.shiftKey?"up":"down");break;case"Escape":(p=l.current)==null||p.blur();break}};return R.jsxs("tr",{onClick:s,className:`transition-colors duration-150 ${n?"bg-[var(--primary-accent-start)]/10":"hover:bg-[var(--bg-card-subtle-accent)]"}`,id:`data-entry-row-${e["No."]}`,children:[R.jsx("td",{className:"p-2 align-middle text-center text-xs text-[var(--text-muted)] w-12",children:t}),R.jsx("td",{className:"p-2 align-middle text-sm text-[var(--text-primary)] w-2/3 truncate",title:e["Membership Number"],children:e["Membership Number"]}),R.jsx("td",{className:"p-2 align-middle text-sm w-1/3",children:R.jsx("input",{ref:l,type:"number",step:"any",min:"0",value:a,onChange:h=>o(h.target.value),onKeyDown:c,onBlur:u,onClick:h=>h.stopPropagation(),className:"form-input-light w-full text-sm py-1","aria-label":`Amount for ${e["Membership Number"]}`})})]})});SI.displayName="DataEntryRow";const Poe=({isOpen:e,onClose:t,onSave:n,titheListData:r})=>{const[i,s]=E.useState([]),[a,o]=E.useState("original"),[l,u]=E.useState(null),[c,h]=E.useState(""),[p,m]=E.useState(!1),v=E.useRef(null);E.useEffect(()=>{e?(s(JSON.parse(JSON.stringify(r))),r.length>0&&u(r[0]["No."])):(s([]),o("original"),u(null),h(""),m(!1))},[e,r]);const g=E.useMemo(()=>{let S=i;return c&&(S=S.filter(C=>C["Membership Number"].toLowerCase().includes(c.toLowerCase()))),p&&(S=S.filter(C=>C["Transaction Amount"]===""||C["Transaction Amount"]===null)),a==="alpha"?[...S].sort((C,M)=>C["Membership Number"].localeCompare(M["Membership Number"])):S},[i,a,c,p]),w=E.useCallback((S,C)=>{s(M=>M.map(F=>F["No."]===S?{...F,"Transaction Amount":C}:F))},[]),x=E.useCallback(S=>{const C=g.findIndex(F=>F["No."]===l);if(C===-1)return;const M=S==="down"?C+1:C-1;M>=0&&M<g.length&&u(g[M]["No."])},[g,l]);E.useEffect(()=>{const S=l?document.getElementById(`data-entry-row-${l}`):null;S&&S.scrollIntoView({behavior:"smooth",block:"nearest"})},[l]);const T=()=>{n(i)},{entriesFilled:y,totalEntries:_,progressPercentage:k}=E.useMemo(()=>{const S=i.length,C=i.filter(M=>{const F=Number(M["Transaction Amount"]);return!isNaN(F)&&M["Transaction Amount"]!==""&&M["Transaction Amount"]!==null}).length;return{entriesFilled:C,totalEntries:S,progressPercentage:S>0?C/S*100:0}},[i]);return R.jsx(Ms,{isOpen:e,onClose:t,title:"Advanced Data Entry Mode",size:"xl",footerContent:R.jsxs(R.Fragment,{children:[R.jsx(Gt,{variant:"outline",onClick:t,children:"Cancel"}),R.jsx(Gt,{variant:"primary",onClick:T,leftIcon:R.jsx(AM,{size:16}),children:"Done & Save Changes"})]}),children:R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{className:"flex justify-between items-center flex-wrap gap-4 bg-[var(--bg-elevated)] p-3 rounded-lg border border-[var(--border-color)]",children:[R.jsxs("div",{className:"flex items-center gap-2",children:[R.jsx(Gt,{size:"sm",variant:a==="original"?"secondary":"subtle",onClick:()=>o("original"),leftIcon:R.jsx(aB,{size:16}),children:"Original"}),R.jsx(Gt,{size:"sm",variant:a==="alpha"?"secondary":"subtle",onClick:()=>o("alpha"),leftIcon:R.jsx(sB,{size:16}),children:"A-Z"})]}),R.jsxs("div",{className:"flex items-center gap-2 flex-grow sm:flex-grow-0",children:[R.jsxs("div",{className:"relative flex-grow",children:[R.jsx(Xh,{size:16,className:"absolute left-3 top-1/2 -translate-y-1/2 text-[var(--text-muted)]"}),R.jsx("input",{type:"text",placeholder:"Jump to member...",value:c,onChange:S=>h(S.target.value),className:"form-input-light !pl-9 !py-1.5 w-full text-sm"})]}),R.jsx(Gt,{size:"sm",variant:p?"secondary":"subtle",onClick:()=>m(S=>!S),leftIcon:R.jsx(mB,{size:16}),children:"Needs Amount"})]}),R.jsxs("div",{className:"w-full sm:w-1/3",children:[R.jsxs("div",{className:"flex justify-between text-xs text-[var(--text-secondary)] mb-1",children:[R.jsx("span",{children:"Progress"}),R.jsxs("span",{children:[y," / ",_," Filled"]})]}),R.jsx("div",{className:"w-full bg-[var(--input-bg)] rounded-full h-2.5",children:R.jsx("div",{className:"bg-gradient-to-r from-[var(--primary-accent-start)] to-[var(--primary-accent-end)] h-2.5 rounded-full transition-all duration-300",style:{width:`${k}%`}})})]})]}),R.jsxs("div",{className:"overflow-y-auto border border-[var(--border-color)] rounded-lg shadow-md bg-[var(--bg-elevated)] max-h-[55vh]",children:[R.jsxs("table",{className:"min-w-full text-sm modern-table",children:[R.jsx("caption",{className:"sr-only",children:"Table for rapid data entry of tithe amounts."}),R.jsx("thead",{className:"bg-[var(--bg-card-subtle-accent)] sticky top-0 z-10",children:R.jsxs("tr",{children:[R.jsx("th",{scope:"col",className:"p-2.5 text-center text-xs font-semibold uppercase tracking-wider w-12",children:"No."}),R.jsx("th",{scope:"col",className:"p-2.5 text-left text-xs font-semibold uppercase tracking-wider w-2/3",children:"Member Details"}),R.jsx("th",{scope:"col",className:"p-2.5 text-left text-xs font-semibold uppercase tracking-wider w-1/3",children:"Amount (GH)"})]})}),R.jsx("tbody",{ref:v,children:g.map(S=>R.jsx(SI,{record:S,visualIndex:i.findIndex(C=>C["No."]===S["No."])+1,isActive:l===S["No."],onAmountChange:w,onNavigate:x,setActiveRow:()=>u(S["No."])},S["No."]))})]}),g.length===0&&R.jsx("div",{className:"text-center py-8 text-[var(--text-muted)]",children:"No members match your current filters."})]})]})})},Ioe=({isOpen:e,onClose:t,onConfirm:n,fileName:r,suggestedAssembly:i})=>{const[s,a]=E.useState(i||"");E.useEffect(()=>{a(i||"")},[i,e]);const o=()=>{s&&n(s)};return R.jsxs(Ms,{isOpen:e,onClose:t,title:"Select Assembly",children:[R.jsxs("div",{className:"space-y-4",children:[R.jsxs("p",{className:"text-sm text-gray-600 dark:text-gray-400",children:["Which assembly does the file"," ",R.jsx("span",{className:"font-semibold text-gray-800 dark:text-gray-200",children:r})," ","belong to?"]}),R.jsxs("div",{children:[R.jsx("label",{htmlFor:"assembly-select",className:"form-label",children:"Assembly"}),R.jsxs("select",{id:"assembly-select",value:s,onChange:l=>a(l.target.value),className:"form-input-light w-full",children:[R.jsx("option",{value:"",disabled:!0,children:"-- Select an assembly --"}),my.map(l=>R.jsx("option",{value:l,children:l},l))]})]})]}),R.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[R.jsx(Gt,{variant:"outline",onClick:t,children:"Cancel"}),R.jsx(Gt,{variant:"primary",onClick:o,disabled:!s,children:"Confirm"})]})]})},Noe=({title:e,icon:t,members:n,emptyText:r})=>R.jsxs("div",{className:"bg-[var(--bg-card-subtle-accent)] p-4 rounded-lg flex-1",children:[R.jsxs("h3",{className:"font-semibold text-md mb-3 flex items-center text-[var(--text-primary)]",children:[R.jsx("span",{className:"mr-2",children:t}),e," (",n.length,")"]}),n.length>0?R.jsx("ul",{className:"space-y-2 text-sm max-h-48 overflow-y-auto pr-2",children:n.map((i,s)=>{const a=`${i.Title||""} ${i["First Name"]||""} ${i.Surname||""} ${i["Other Names"]||""}`.replace(/\s+/g," ").trim()||"Unnamed Member",o=i["Membership Number"]||i["Old Membership Number"]||"N/A";return R.jsxs("li",{className:"text-[var(--text-secondary)] p-2 rounded-md bg-[var(--bg-card)]",children:[R.jsx("p",{className:"font-medium text-[var(--text-primary)] truncate",title:a,children:a}),R.jsxs("p",{className:"text-xs text-[var(--text-muted)]",children:["ID: ",o]})]},i["No."]||s)})}):R.jsxs("div",{className:"text-center py-4 flex flex-col items-center justify-center h-full text-[var(--text-muted)]",children:[R.jsx(DM,{size:24,className:"mb-2 opacity-50"}),R.jsx("p",{className:"text-sm",children:r})]})]}),boe=({isOpen:e,onClose:t,report:n,onKeepMembers:r})=>{const[i,s]=E.useState(new Set),a=u=>{s(c=>{const h=new Set(c);return h.has(u)?h.delete(u):h.add(u),h})},o=()=>{n&&(i.size===n.missingMembers.length?s(new Set):s(new Set(n.missingMembers.map(u=>u["No."]).filter(Boolean))))},l=()=>{if(!n)return;const u=n.missingMembers.filter(c=>i.has(c["No."]));u.length>0&&(r(u),s(new Set))};return n?R.jsx(Ms,{isOpen:e,onClose:t,title:"Membership Reconciliation",size:"xl",footerContent:R.jsx(Gt,{onClick:t,variant:"primary",size:"md",children:"Continue to Dashboard"}),children:R.jsxs("div",{className:"space-y-4",children:[R.jsxs("div",{className:"text-center",children:[R.jsx(kB,{size:40,className:"mx-auto text-[var(--primary-accent-start)]"}),R.jsxs("p",{className:"mt-2 text-md text-[var(--text-secondary)]",children:["Comparing current file with the"," ",R.jsx("strong",{className:"text-[var(--text-primary)]",children:n.previousFileDate}),"."]})]}),R.jsxs("div",{className:"flex flex-col md:flex-row gap-4",children:[R.jsx(Noe,{title:"New Members (Souls Won)",icon:R.jsx(y1,{size:20,className:"text-[var(--success-text)]"}),members:n.newMembers,emptyText:"No new members found."}),R.jsxs("div",{className:"bg-[var(--bg-card-subtle-accent)] p-4 rounded-lg flex-1",children:[R.jsxs("h3",{className:"font-semibold text-md mb-3 flex items-center text-[var(--text-primary)]",children:[R.jsx(CB,{size:20,className:"mr-2 text-[var(--danger-text)]"}),"Missing Members (",n.missingMembers.length,")"]}),n.missingMembers.length>0?R.jsxs(R.Fragment,{children:[R.jsx("ul",{className:"space-y-1.5 text-sm max-h-48 overflow-y-auto pr-2",children:n.missingMembers.map(u=>R.jsxs("li",{className:"text-[var(--text-secondary)] p-2 rounded-md bg-[var(--bg-card)] flex items-center gap-3 hover:bg-[var(--border-color)]/30 transition-colors",children:[R.jsx("button",{onClick:()=>a(u["No."]),className:"flex-shrink-0 p-1",children:i.has(u["No."])?R.jsx(SB,{size:20,className:"text-[var(--primary-accent-start)]"}):R.jsx(EB,{size:20,className:"text-[var(--text-muted)]"})}),R.jsxs("div",{className:"flex-grow overflow-hidden",children:[R.jsx("p",{className:"font-medium text-[var(--text-primary)] truncate",children:`${u.Title||""} ${u["First Name"]||""} ${u.Surname||""} ${u["Other Names"]||""}`.replace(/\s+/g," ").trim()||"Unnamed Member"}),R.jsxs("p",{className:"text-xs text-[var(--text-muted)]",children:["ID:"," ",u["Membership Number"]||u["Old Membership Number"]||"N/A"]})]})]},u["No."]))}),R.jsxs("div",{className:"mt-3 pt-3 border-t border-[var(--border-color)] flex items-center gap-3",children:[R.jsx(Gt,{variant:"outline",size:"sm",onClick:o,children:i.size===n.missingMembers.length?"Deselect All":"Select All"}),R.jsxs(Gt,{variant:"primary",size:"sm",onClick:l,disabled:i.size===0,children:["Keep Selected in List (",i.size,")"]})]})]}):R.jsxs("div",{className:"text-center py-4 flex flex-col items-center justify-center h-full text-[var(--text-muted)]",children:[R.jsx(DM,{size:24,className:"mb-2 opacity-50"}),R.jsx("p",{className:"text-sm",children:"No missing members."})]})]})]})]})}):null},Loe=({isOpen:e,onClose:t,onConfirm:n})=>e?R.jsx("div",{className:"modal-backdrop",children:R.jsxs("div",{className:"modal-content",children:[R.jsx("h2",{children:"Clear Workspace?"}),R.jsx("p",{children:"Are you sure you want to clear the entire workspace? This action cannot be undone."}),R.jsxs("div",{className:"modal-actions",children:[R.jsx("button",{onClick:t,children:"Cancel"}),R.jsx("button",{onClick:n,children:"Confirm"})]})]})}):null,Ooe=({isOpen:e,onClose:t,onConfirm:n,pendingUpdate:r})=>e?R.jsx("div",{className:"modal-backdrop",children:R.jsxs("div",{className:"modal-content",children:[R.jsx("h2",{children:"Update Master List?"}),R.jsxs("p",{children:["Are you sure you want to update the master list for"," ",r.assemblyName,"?"]}),R.jsxs("div",{className:"modal-actions",children:[R.jsx("button",{onClick:t,children:"Cancel"}),R.jsx("button",{onClick:n,children:"Confirm"})]})]})}):null,Boe=({isOpen:e,onClose:t,onSave:n,memberData:r,assemblyName:i})=>e?R.jsx("div",{className:"modal-backdrop",children:R.jsxs("div",{className:"modal-content",children:[R.jsxs("h2",{children:["Edit Member in ",i]}),R.jsxs("div",{className:"modal-actions",children:[R.jsx("button",{onClick:t,children:"Cancel"}),R.jsx("button",{onClick:()=>n(r),children:"Save"})]})]})}):null,Uoe=({onMenuClick:e,title:t})=>R.jsxs("header",{className:"md:hidden fixed top-0 left-0 right-0 h-16 bg-[var(--bg-main)]/80 backdrop-blur-md border-b border-[var(--border-color)] z-30 flex items-center px-4 justify-between",children:[R.jsx(Gt,{onClick:e,variant:"ghost",size:"icon","aria-label":"Open menu",children:R.jsx(wB,{size:24})}),R.jsx("h1",{className:"text-lg font-bold text-gradient-primary truncate",children:t}),R.jsx("div",{className:"w-10"})," "]}),Voe=e=>{let t=e.replace(/</g,"&lt;").replace(/>/g,"&gt;");return t=t.replace(/^### (.*$)/gm,'<h3 class="text-lg font-semibold text-[var(--text-primary)] mt-3 mb-1">$1</h3>'),t=t.replace(/^## (.*$)/gm,'<h2 class="text-xl font-bold text-gradient-primary mt-4 mb-2">$1</h2>'),t=t.replace(/^# (.*$)/gm,'<h1 class="text-2xl font-bold text-gradient-primary mt-5 mb-3">$1</h1>'),t=t.replace(/((?:^[*-] .*(?:\n|$))+)/gm,n=>`<ul class="list-outside mt-2">${n.trim().split(`
`).map(i=>`<li class="list-disc ml-5 mb-1.5">${i.replace(/^[*-] /,"").trim()}</li>`).join("")}</ul>`),t=t.replace(/\*\*(.*?)\*\*/g,"<strong>$1</strong>"),t=t.replace(/__(.*?)__/g,"<strong>$1</strong>"),t=t.replace(/\*(.*?)\*/g,"<em>$1</em>"),t=t.replace(/_(.*?)_/g,"<em>$1</em>"),t=t.replace(/\n/g,"<br />"),t=t.replace(/<br \/>\s*(<(?:ul|ol|h[1-3]))/g,"$1"),t=t.replace(/(<\/(?:ul|ol|h[1-3])>)\s*<br \/>/g,"$1"),t},Hoe=({isOpen:e,onClose:t,reportContent:n,isLoading:r})=>R.jsx(Ms,{isOpen:e,onClose:t,title:"AI Data Quality Report",size:"xl",footerContent:R.jsx(Gt,{onClick:t,variant:"primary",children:"Close"}),children:R.jsx("div",{className:"space-y-4 max-h-[70vh] overflow-y-auto pr-2",children:r?R.jsxs("div",{className:"flex flex-col items-center justify-center min-h-[300px] text-center",children:[R.jsx(xB,{className:"animate-spin text-[var(--primary-accent-start)]",size:40}),R.jsx("p",{className:"mt-4 text-lg font-semibold text-[var(--text-primary)]",children:"Generating Report..."}),R.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"The AI is analyzing your data. This may take a moment."})]}):R.jsx("article",{className:"prose prose-sm md:prose-base dark:prose-invert max-w-none prose-headings:text-[var(--text-primary)] prose-strong:text-[var(--text-primary)] prose-h1:text-gradient-primary prose-h1:border-b prose-h1:border-[var(--border-color)] prose-h1:pb-2 prose-h2:border-b prose-h2:border-[var(--border-color)] prose-h2:pb-2",dangerouslySetInnerHTML:{__html:Voe(n)}})})}),$oe=({isOpen:e,onClose:t,setActiveView:n,setTheme:r,onStartNewWeek:i,favorites:s,theme:a})=>{const[o,l]=E.useState(""),[u,c]=E.useState(0),h=E.useRef(null),p=E.useRef(null),m=E.useMemo(()=>new Set(s.map(T=>T.assemblyName)),[s]),v=E.useMemo(()=>[{id:"nav_dashboard",title:"Go to Dashboard",subtitle:"View KPIs and recent activity",icon:R.jsx(PM,{size:18}),onPerform:()=>n("dashboard"),keywords:["home","main"]},{id:"nav_processor",title:"Go to Tithe Processor",subtitle:"Process weekly tithe lists",icon:R.jsx(MM,{size:18}),onPerform:()=>n("processor"),keywords:["upload","generate","new list"]},{id:"nav_database",title:"Go to Member Database",subtitle:"View and manage master lists",icon:R.jsx(FM,{size:18}),onPerform:()=>n("database"),keywords:["members","master"]},{id:"nav_favorites",title:"Go to Favorites",subtitle:"Load saved configurations",icon:R.jsx(LM,{size:18}),onPerform:()=>n("favorites"),keywords:["saved","load"]},{id:"nav_reports",title:"Go to Reports",subtitle:"View annual performance",icon:R.jsx(NM,{size:18}),onPerform:()=>n("reports"),keywords:["stats","statistics","charts"]},{id:"nav_analytics",title:"Go to AI Analytics",subtitle:"Chat with your data",icon:R.jsx(kM,{size:18}),onPerform:()=>n("analytics"),keywords:["ai","chat","gemini"]},...a==="dark"?[{id:"theme_light",title:"Switch to Light Theme",icon:R.jsx(OM,{size:18}),onPerform:()=>r("light")}]:[],...a==="light"?[{id:"theme_dark",title:"Switch to Dark Theme",icon:R.jsx(IM,{size:18}),onPerform:()=>r("dark")}]:[],...my.filter(T=>m.has(T)).map(T=>({id:`start_week_${T}`,title:`Start New Week: ${T}`,subtitle:"Load latest member list",icon:R.jsx(uB,{size:18}),onPerform:()=>i(T),keywords:["start",T]}))],[n,r,i,s,a,m]),g=E.useMemo(()=>{if(!o.trim())return v;const T=o.toLowerCase();return v.filter(y=>{var _,k;return y.title.toLowerCase().includes(T)||((_=y.subtitle)==null?void 0:_.toLowerCase().includes(T))||((k=y.keywords)==null?void 0:k.some(S=>S.toLowerCase().includes(T)))})},[o,v]),w=T=>{T.onPerform(),t()};E.useEffect(()=>{var T;e?(T=h.current)==null||T.focus():l("")},[e]),E.useEffect(()=>{c(0)},[o]);const x=E.useCallback(T=>{T.key==="ArrowDown"?(T.preventDefault(),c(y=>(y+1)%g.length)):T.key==="ArrowUp"?(T.preventDefault(),c(y=>(y-1+g.length)%g.length)):T.key==="Enter"&&(T.preventDefault(),g[u]&&w(g[u]))},[u,g,w]);return E.useEffect(()=>{var y;const T=(y=p.current)==null?void 0:y.querySelector(`[data-index="${u}"]`);T==null||T.scrollIntoView({block:"nearest"})},[u]),R.jsx(ks,{children:e&&R.jsx(dr.div,{className:"command-palette-overlay",initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},transition:{duration:.2,ease:"easeOut"},onClick:t,children:R.jsxs(dr.div,{className:"command-palette-container",initial:{scale:.95,y:-20},animate:{scale:1,y:0},exit:{scale:.95,y:-20,opacity:0},transition:{duration:.2,ease:"easeOut"},onClick:T=>T.stopPropagation(),onKeyDown:x,children:[R.jsxs("div",{className:"p-3 border-b border-[var(--border-color)] flex items-center gap-3",children:[R.jsx(Xh,{size:20,className:"text-[var(--text-muted)] flex-shrink-0"}),R.jsx("input",{ref:h,type:"text",value:o,onChange:T=>l(T.target.value),placeholder:"Type a command or search...",className:"w-full bg-transparent focus:outline-none text-[var(--text-primary)] placeholder-[var(--text-placeholder)]"})]}),R.jsx("div",{ref:p,className:"overflow-y-auto p-2 max-h-[50vh]",children:g.length>0?g.map((T,y)=>R.jsxs("button",{"data-index":y,"data-selected":u===y,onClick:()=>w(T),className:"w-full flex items-center justify-between p-3 rounded-lg text-left transition-colors command-palette-item",children:[R.jsxs("div",{className:"flex items-center gap-3",children:[R.jsx("div",{className:"text-[var(--text-secondary)]",children:T.icon}),R.jsxs("div",{children:[R.jsx("p",{className:"text-sm font-medium text-[var(--text-primary)]",children:T.title}),T.subtitle&&R.jsx("p",{className:"text-xs text-[var(--text-secondary)]",children:T.subtitle})]})]}),u===y&&R.jsx(pB,{size:16,className:"text-[var(--text-muted)]"})]},T.id)):R.jsx("p",{className:"text-center p-8 text-sm text-[var(--text-muted)]",children:"No results found."})})]})})})},zoe=dr.div,Woe=()=>R.jsxs(dr.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:20},className:"fixed bottom-4 right-4 bg-red-500 text-white px-4 py-2 rounded-lg shadow-lg flex items-center gap-2 z-[1000]",children:[R.jsx(BM,{size:18}),R.jsx("span",{children:"You are currently offline."})]}),Goe=()=>{var Ly;const[e,t]=E.useState(null),[n,r]=E.useState([]),[i,s]=E.useState([]),[a,o]=E.useState([]),[l,u]=E.useState({}),[c,h]=E.useState(null),[p,m]=E.useState(!1),[v,g]=E.useState(0),[w,x]=E.useState(""),[T,y]=E.useState(""),[_,k]=E.useState(!1),[S,C]=E.useState(()=>{const he=localStorage.getItem(i_);return he?JSON.parse(he):_J}),[M,F]=E.useState(new Date),[b,V]=E.useState("Tithe"),[z,ie]=E.useState(null),[Q,se]=E.useState("GeneratedTitheList"),[de,ae]=E.useState(""),[ne,H]=E.useState(!1),[fe,xe]=E.useState(null),[L,q]=E.useState(!1),[W,G]=E.useState(null),[ee,Se]=E.useState(!1),[we,pe]=E.useState(!1),[oe,Le]=E.useState(!1),[B,st]=E.useState(!1),[Ue,at]=E.useState(null),[$e,Re]=E.useState(null),[ht,Dt]=E.useState(""),[tt,Kt]=E.useState(null),[ve,Ce]=E.useState(!1),[Ne,Oe]=E.useState([]),[He,Je]=E.useState(()=>localStorage.getItem(n_)||"dark"),[Qe,mt]=E.useState(()=>{const he=localStorage.getItem(r_);return nv.find(ge=>ge.key===he)||nv[0]}),[We,Xe]=E.useState(!1),[Rt,yt]=E.useState(""),It=E.useRef(null),[Mt,bn]=E.useState(window.innerWidth<768),[Et,xn]=E.useState(null),[Wn,Gn]=E.useState(!1),[fn,Nt]=E.useState(null),[bt,Ut]=E.useState(!1),[ot,wt]=E.useState(()=>{const he=localStorage.getItem(l_);if(!he)return{};try{const ge=JSON.parse(he);return Object.keys(ge).forEach(Ve=>{Array.isArray(ge[Ve])&&(ge[Ve]={data:ge[Ve],lastUpdated:new Date(0).getTime(),fileName:"Unknown (migrated data)"})}),ge}catch(ge){return console.error("Failed to parse member database from storage:",ge),{}}}),[be,U]=E.useState(null),[Y,te]=E.useState(!1),[j,ue]=E.useState(!1),[ye,Fe]=E.useState(null),[Me,A]=E.useState(!1),[I,D]=E.useState(""),[P,N]=E.useState(!1),[O,Z]=E.useState(!1),[ce,X]=E.useState(null),[J,re]=E.useState(!navigator.onLine),le=E.useCallback((he,ge,Ve,rt)=>{const Ot=Math.random().toString(36).substring(2,9);Oe(qn=>[...qn,{id:Ot,message:he,type:ge,duration:Ve,actions:rt}])},[]),{isSubscribed:Ae,requestNotificationPermission:Te}=Doe(le,X);E.useEffect(()=>{ce&&le("A new version is available!","info",void 0,[{label:"Reload",onClick:()=>ce.postMessage({type:"SKIP_WAITING"})}])},[ce,le]),E.useEffect(()=>{const he=()=>re(!1),ge=()=>re(!0);return window.addEventListener("online",he),window.addEventListener("offline",ge),()=>{window.removeEventListener("online",he),window.removeEventListener("offline",ge)}},[]),E.useEffect(()=>{const he=ge=>{(ge.metaKey||ge.ctrlKey)&&ge.key==="k"?(ge.preventDefault(),Z(Ve=>!Ve)):ge.key==="Escape"&&O&&Z(!1)};return window.addEventListener("keydown",he),()=>window.removeEventListener("keydown",he)},[O]);const{favorites:Ee,setFavorites:De,transactionLog:Ge,setTransactionLog:_t,isLoggedIn:Tt,userProfile:je,syncStatus:Xt,signIn:Vr,signOut:Ar,isConfigured:Lt}=Roe(le),qi=E.useCallback(he=>{Oe(ge=>ge.filter(Ve=>Ve.id!==he))},[]);E.useEffect(()=>{document.body.classList.remove("light-theme","dark-theme"),document.body.classList.add(He==="light"?"light-theme":"dark-theme"),localStorage.setItem(n_,He)},[He]),E.useEffect(()=>{localStorage.setItem(l_,JSON.stringify(ot))},[ot]),E.useEffect(()=>{const he=document.documentElement;he.style.setProperty("--primary-hue",Qe.values.h.toString()),he.style.setProperty("--primary-saturation",`${Qe.values.s}%`),he.style.setProperty("--primary-lightness",`${Qe.values.l}%`),localStorage.setItem(r_,Qe.key)},[Qe]);const Ln=E.useCallback(()=>{localStorage.removeItem(t_)},[]),ki=E.useCallback(()=>{t(null),r([]),s([]),o([]),u({}),x(""),y(""),k(!1),F(new Date),V("Tithe"),se("GeneratedTitheList"),Ce(!1),Ln(),xn(null),g(0),h(null),ie(null)},[Ln]),_I=E.useCallback(he=>{V(he),a.length>0&&(o(gs(i,S,M,he,z)),Ce(!0))},[a.length,i,S,M,z]);E.useEffect(()=>{const he=()=>{window.innerWidth<768?bn(!0):bn(!1)};return window.addEventListener("resize",he),he(),()=>window.removeEventListener("resize",he)},[]);const Py=E.useCallback(()=>{It.current&&clearTimeout(It.current),It.current=window.setTimeout(()=>{if(a.length===0||!Et)return;const he={timestamp:Date.now(),titheListData:a,selectedDate:M.toISOString(),descriptionText:b,concatenationConfig:S,ageRangeMin:w,ageRangeMax:T,fileNameToSave:Q,amountMappingColumn:z,uploadedFileName:e==null?void 0:e.name,originalDataRecordCount:n.length,processedDataARecordCount:i.length,assemblyName:Et,soulsWonCount:v};localStorage.setItem(t_,JSON.stringify(he)),Ce(!1),le("Draft auto-saved!","success",2e3)},CJ)},[a,M,b,S,w,T,Q,z,e,n.length,i.length,Et,v,le]);E.useEffect(()=>(ve&&a.length>0&&Py(),()=>{It.current&&clearTimeout(It.current)}),[ve,a,Py]);const ad=E.useCallback(async(he,ge,Ve)=>{if(!he){if(ge)return;ki();return}t(he);try{const rt=await IY(he);if(ge&&Ve){const Ot=ot[Ve];Ot&&Ot.data.length>0?(U({assemblyName:Ve,newData:rt,newFileName:he.name}),te(!0)):Iy(Ve,rt,he.name)}else{if(ve){le("You have unsaved changes. Please save or discard them before loading a new file.","warning",5e3);return}const Ot=my.find(qn=>he.name.toLowerCase().includes(qn.toLowerCase()))||"";Nt({data:rt,fileName:he.name,file:he,suggestedAssembly:Ot,isMasterList:!1}),Gn(!0)}}catch(rt){const Ot=rt.message||"An unknown error occurred during parsing.";le(`Error parsing file: ${Ot}`,"error",5e3)}finally{}},[ve,le,ot,ki]);E.useEffect(()=>{"launchQueue"in window&&window.launchQueue.setConsumer(async he=>{if(!(!he.files||he.files.length===0))for(const ge of he.files){const Ve=await ge.getFile();ad(Ve,!1)}})},[ad]);const Iy=(he,ge,Ve)=>{wt(rt=>({...rt,[he]:{data:ge,lastUpdated:Date.now(),fileName:Ve}})),le(`${he} master list has been updated with ${ge.length} records.`,"success")},Ka=HA(),CI=E.useCallback(async he=>{fn&&(ki(),t(fn.file),xn(he),kI(fn.data,he,fn.file.name),Ka("/processor"),Gn(!1),Nt(null))},[fn,ki,Ka]),kI=(he,ge,Ve)=>{r(he);const rt=ot[ge];if(rt!=null&&rt.data){const er=bY(he,rt.data);if(er.newMembers.length>0){const Ai=new Date().toISOString(),nl=er.newMembers.map(Vu=>({...Vu,firstSeenDate:Ai,firstSeenSource:Ve}));wt(Vu=>{var Oy;const XI=[...((Oy=Vu[ge])==null?void 0:Oy.data)||[],...nl];return{...Vu,[ge]:{...Vu[ge]||{fileName:"Initial Data",lastUpdated:Date.now()},data:XI,lastUpdated:Date.now()}}}),h({...er,newMembers:nl,previousFileDate:`Master List (updated ${new Date(rt.lastUpdated).toLocaleDateString()})`}),g(er.newMembers.length),m(!0)}else er.missingMembers.length>0&&(h({...er,newMembers:[],previousFileDate:`Master List (updated ${new Date(rt.lastUpdated).toLocaleDateString()})`}),m(!0)),g(0)}else{g(he.length),le(`${he.length} members added as the first master list for ${ge}.`,"success");const er=new Date().toISOString(),Ai=he.map(nl=>({...nl,firstSeenDate:er,firstSeenSource:Ve}));wt(nl=>({...nl,[ge]:{data:Ai,lastUpdated:Date.now(),fileName:Ve}}))}let Ot=he;w||T?(Ot=$E(he,Number(w)||void 0,Number(T)||void 0),k(!0)):k(!1),s(Ot);const qn=gs(Ot,S,M,b,z);o(qn),se(`${ge}-TitheList-${eo(new Date)}`),le(`${ge} data processed. ${he.length} records loaded.`,"success")},AI=he=>{const ge=gs(he,S,M,b,z);o(Ve=>{const rt=new Set(Ve.map(qn=>qn["No."])),Ot=ge.filter(qn=>!rt.has(qn["No."]));return[...Ve,...Ot]}),s(Ve=>[...Ve,...he]),le(`Kept ${he.length} missing members in the list.`,"success")},RI=E.useCallback(()=>{const he=Number(w)||0,ge=Number(T)||1/0;if(he>ge&&T){u({age:"Min age cannot be greater than max age."});return}u({});const Ve=$E(n,he,ge);s(Ve),k(!0),o(gs(Ve,S,M,b,z)),le(`Age filter applied. ${Ve.length} records match.`,"info"),Ce(!0)},[w,T,n,S,M,b,z,le]),MI=E.useCallback(()=>{x(""),y(""),u({}),s(n),k(!1),o(gs(n,S,M,b,z)),le("Age filter removed.","info"),Ce(!0)},[n,S,M,b,z,le]),FI=he=>{C(ge=>{const Ve={...ge,[he]:!ge[he]};return localStorage.setItem(i_,JSON.stringify(Ve)),n.length>0&&(o(gs(i,Ve,M,b,z)),Ce(!0)),Ve})},DI=he=>{o(he),Ce(!0),le("Changes from list view have been saved to the workspace.","success"),Se(!1)},{tithersCount:Uu,totalTitheAmount:od}=E.useMemo(()=>{let he=0;const ge=a.reduce((Ve,rt)=>{const Ot=Number(rt["Transaction Amount"]);return!isNaN(Ot)&&Ot>0?(he++,Ve+Ot):Ve},0);return{tithersCount:he,totalTitheAmount:ge}},[a]),PI=E.useCallback(()=>{if(!Q.trim()){u(ge=>({...ge,fileName:"File name is required."}));return}u(ge=>({...ge,fileName:""}));const he=a.map((ge,Ve)=>({...ge,"No.":Ve+1}));if(LY(he,Q),bJ({type:"download_excel",payload:{fileName:Q,records:he.length}}),Et&&a.length>0){const ge={id:`${Et}-${M.toISOString().split("T")[0]}`,assemblyName:Et,timestamp:Date.now(),selectedDate:M.toISOString(),totalTitheAmount:od,soulsWonCount:v??0,titherCount:Uu,recordCount:a.length,titheListData:a,concatenationConfig:S,descriptionText:b,amountMappingColumn:z};_t(Ve=>{const rt=Ve.findIndex(Ot=>Ot.id===ge.id);if(rt>-1){const Ot=[...Ve];return Ot[rt]=ge,Ot}return[...Ve,ge]}),le("Transaction has been logged for reporting.","info")}},[Q,a,Et,M,od,v,Uu,_t,le,S,b,z]),II=()=>{const he=`${Et} - ${eo(M)}`;yt(he),Xe(!0)},NI=()=>{if(!Rt.trim()){le("Favorite name cannot be empty.","error");return}if(!Et){le("Cannot save favorite without an assembly.","error");return}const ge={id:`${Date.now()}`,name:Rt,timestamp:Date.now(),originalFileName:(e==null?void 0:e.name)||"Manual/Database Start",assemblyName:Et,ageRangeMin:Number(w)||void 0,ageRangeMax:Number(T)||void 0,concatenationConfig:S,selectedDate:M.toISOString(),descriptionText:b,amountMappingColumn:z,originalData:n.length>0?n:void 0,processedDataA:i,titheListData:a,soulsWonCount:v??0,processedRecordsCount:i.length,totalTitheAmount:od};De(Ve=>[ge,...Ve.filter(rt=>rt.name!==ge.name)]),le("Saved to favorites!","success"),Xe(!1)},bI=E.useCallback(he=>{const ge=Ee.find(rt=>rt.id===he);if(!ge){le("Favorite not found.","error");return}ki(),t(ge.originalFileName?new File([],ge.originalFileName,{type:"text/plain"}):null),r(ge.originalData||[]),s(ge.processedDataA||[]),o(ge.titheListData||[]),x(String(ge.ageRangeMin||"")),y(String(ge.ageRangeMax||"")),k(!!(ge.ageRangeMin||ge.ageRangeMax)),C(ge.concatenationConfig),F(new Date(ge.selectedDate)),V(ge.descriptionText),ie(ge.amountMappingColumn||null);const Ve=eo(new Date(ge.selectedDate));se(`${ge.assemblyName}-TitheList-${Ve}`),xn(ge.assemblyName),g(ge.soulsWonCount??0),Ce(!1),Ln(),le(`Loaded favorite: "${ge.name}"`,"success"),Ka("/processor")},[Ee,le,ki,Ln,Ka]),LI=E.useCallback(he=>Ee.filter(ge=>ge.assemblyName===he).sort((ge,Ve)=>Ve.timestamp-ge.timestamp)[0],[Ee]),Ny=he=>{const ge=LI(he);if(!ge){le(`No saved data found for ${he}. Please upload a file first.`,"warning");return}ki();const Ve=ge.titheListData;if(!Ve||Ve.length===0){le(`The latest favorite for ${he} has no members.`,"error");return}const rt=new Date,Ot=eo(rt),qn=ge.descriptionText.replace(/{DD-MMM-YYYY}/gi,Ot),er=Ve.map(Ai=>({...Ai,"Transaction Amount":"","Transaction Date ('DD-MMM-YYYY')":Ot,"Narration/Description":qn}));o(er),r(ge.originalData||[]),s(ge.processedDataA||[]),C(ge.concatenationConfig),V(ge.descriptionText),ie(ge.amountMappingColumn||null),xn(ge.assemblyName),ge.originalFileName&&t(new File([],ge.originalFileName,{type:"text/plain"})),se(`${ge.assemblyName}-TitheList-${Ot}`),g(0),F(rt),Ce(!1),Ln(),Ka("/processor"),le(`Started new week for ${he} using the latest member list.`,"success")},OI=he=>{G(he),q(!0)},BI=()=>{W&&(De(he=>he.filter(ge=>ge.id!==W)),le("Favorite deleted.","success"),q(!1),G(null))},UI=(he,ge)=>{De(Ve=>Ve.map(rt=>rt.id===he?{...rt,name:ge}:rt))},VI=he=>{xe(he),H(!0)},HI=()=>{ki(),le("Workspace cleared.","info"),Ut(!1)},$I=he=>{if(Et){const ge={...he,firstSeenDate:new Date().toISOString(),firstSeenSource:"manual_add"};wt(rt=>{var er;const qn=[...((er=rt[Et])==null?void 0:er.data)||[],ge];return{...rt,[Et]:{...rt[Et]||{fileName:"Mixed Source",lastUpdated:Date.now()},data:qn,lastUpdated:Date.now()}}});const Ve=gs([ge],S,M,b,null)[0];o(rt=>[...rt,Ve]),g(rt=>(rt||0)+1),le(`Added new member: ${he["First Name"]} ${he.Surname}`,"success"),Le(!1)}},zI=he=>{const ge=gs([he],S,M,b,null)[0];o(Ve=>[...Ve,ge]),le(`Added existing member: ${he["First Name"]} ${he.Surname}`,"success")},WI=(he,ge)=>{ki(),xn(ge),r(he),s(he);const Ve=gs(he,S,M,b,null);o(Ve),se(`${ge}-TitheList-${eo(new Date)}`),Ka("/processor"),st(!1),le(`Created a new list with ${he.length} members from the database.`,"success")},GI=he=>{if(!ye)return;const{assemblyName:ge}=ye;wt(Ve=>{var er;const rt=((er=Ve[ge])==null?void 0:er.data)||[],Ot=String(he["No."]).startsWith("new_");let qn;if(Ot){const Ai={...he,"No.":rt.length+1,firstSeenDate:new Date().toISOString(),firstSeenSource:"manual_db_add"};qn=[...rt,Ai],le(`New member added to ${ge} database.`,"success")}else qn=rt.map(Ai=>Ai["No."]===he["No."]?{...Ai,...he}:Ai),le(`Member details updated in ${ge} database.`,"success");return{...Ve,[ge]:{...Ve[ge]||{fileName:"Mixed Source"},data:qn,lastUpdated:Date.now()}}}),ue(!1),Fe(null)},qI=()=>{if(!Et){le("An assembly must be active to add a member.","warning");return}Le(!0)},KI=async()=>{if(!n||n.length===0){le("No data to analyze. Please upload a file first.","warning");return}N(!0),A(!0),D("");try{const he=new Lse({apiKey:"AIzaSyCc8wwsp9E7PuNUu20Svoc_wSaSQXtMbjM"}),ge=n.slice(0,50),Ve=`
You are a data quality analyst reviewing a church membership list. Analyze the following JSON data sample for quality issues. Provide a concise summary in markdown format. Focus on:
- Rows with missing critical information (e.g., missing phone numbers, email, membership numbers). List the row number or name if possible.
- Potential duplicates based on similar names or details.
- Inconsistent formatting (e.g., in names, phone numbers, or addresses).
- Any other logical inconsistencies you find.

Do not suggest changes, just report the issues found. Start the report with a main heading "# Data Quality Report" and a brief summary of findings, then provide details under subheadings like "## Missing Information" or "## Potential Duplicates".

Data Sample:
\`\`\`json
${JSON.stringify(ge,null,2)}
\`\`\`
`,rt=await he.models.generateContent({model:"gemini-2.5-flash",contents:Ve});D(rt.text??"")}catch(he){console.error("Error generating validation report:",he),D(`# Error

Sorry, I encountered an error while generating the report. Please check your connection or API configuration and try again.`),le("Failed to generate AI report.","error")}finally{N(!1)}},by=Hs(),YI={"/":"Dashboard","/processor":"Tithe Processor","/database":"Member Database","/favorites":"Favorites","/reports":"Reports","/analytics":"AI Analytics"};return R.jsxs("div",{className:`app-container ${!Mt&&window.innerWidth<768?"sidebar-open":""}`,children:[R.jsx(Gae,{theme:He,setTheme:Je,accentColor:Qe,setAccentColor:mt,isCollapsed:Mt,setIsCollapsed:bn,isLoggedIn:Tt,userProfile:je,syncStatus:Xt,signIn:Vr,signOut:Ar,isConfigured:Lt,openCommandPalette:()=>Z(!0),isOnline:!J}),R.jsx(ks,{children:O&&R.jsx($oe,{isOpen:O,onClose:()=>Z(!1),setTheme:Je,onStartNewWeek:Ny,favorites:Ee,theme:He,setActiveView:he=>Ka(he)})}),R.jsx("div",{className:"app-container-overlay",onClick:()=>bn(!0)}),R.jsxs("main",{className:"main-content",children:[R.jsx(Uoe,{onMenuClick:()=>bn(!1),title:YI[by.pathname]||"TACTMS"}),R.jsx(ks,{mode:"wait",children:R.jsx(zoe,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},exit:{opacity:0,y:-20},transition:{duration:.3},children:R.jsx(K3,{context:{transactionLog:Ge,memberDatabase:ot,favorites:Ee,onStartNewWeek:Ny,userProfile:je,onUploadFile:ad,onGenerateValidationReport:KI,favoritesSearchTerm:de,setFavoritesSearchTerm:ae,loadFavorite:bI,deleteFavorite:OI,viewFavoriteDetails:VI,updateFavoriteName:UI,addToast:le,titheListData:a,currentAssembly:Et,selectedDate:M,onUploadMasterList:(he,ge)=>ad(he,!0,ge),onCreateTitheList:(he,ge)=>{at(he),Re(ge),st(!0)},onEditMember:(he,ge)=>{Fe({member:he,assemblyName:ge}),ue(!0)},currentTotalTithe:od,hasUnsavedChanges:ve,tithersCount:Uu,nonTithersCount:i.length-Uu,tithersPercentage:i.length>0?Uu/i.length*100:0,setIsFullPreviewModalOpen:Se,setIsDataEntryModalOpen:pe,fileNameToSave:Q,setFileNameToSave:se,inputErrors:l,setInputErrors:u,handleDownloadExcel:PI,openSaveFavoriteModal:II,onClearWorkspace:()=>Ut(!0),soulsWonCount:v,isLoggedIn:Tt,syncStatus:Xt,signIn:Vr,signOut:Ar,isConfigured:Lt,ageRangeMin:w,setAgeRangeMin:x,ageRangeMax:T,setAgeRangeMax:y,isAgeFilterActive:_,handleApplyAgeFilter:RI,handleRemoveAgeFilter:MI,concatenationConfig:S,handleConcatenationConfigChange:FI,descriptionText:b,handleDescriptionChange:_I,amountMappingColumn:z,setAmountMappingColumn:ie,theme:He,setTheme:Je,accentColor:Qe,setAccentColor:mt,isSubscribed:Ae,requestNotificationPermission:Te}})},by.pathname)})]}),R.jsx(ks,{children:J&&R.jsx(Woe,{})}),R.jsx(DB,{toasts:Ne,onDismiss:qi}),ee&&R.jsx(PJ,{isOpen:ee,onClose:()=>Se(!1),titheListData:a,onSave:DI,itemsPerPage:kJ,addToast:le,searchTerm:ht,setSearchTerm:Dt,sortConfig:tt,setSortConfig:Kt,openAddMemberToListModal:qI}),we&&R.jsx(Poe,{isOpen:we,onClose:()=>pe(!1),titheListData:a,onSave:he=>{o(he),Ce(!0),pe(!1),le("Data entry saved to workspace.","success")}}),oe&&R.jsx(IJ,{isOpen:oe,onClose:()=>Le(!1),onConfirm:$I,onAddExistingMember:zI,currentAssembly:Et,memberDatabase:Et?((Ly=ot[Et])==null?void 0:Ly.data)||[]:[],titheListData:a}),B&&R.jsx(NJ,{isOpen:B,onClose:()=>st(!1),onConfirm:()=>{Ue&&$e&&WI(Ue,$e)},memberCount:(Ue==null?void 0:Ue.length)||0,assemblyName:$e||""}),We&&R.jsxs(Ms,{isOpen:We,onClose:()=>Xe(!1),title:"Save Configuration to Favorites",children:[R.jsx("div",{className:"space-y-4",children:R.jsxs("div",{children:[R.jsx("label",{htmlFor:"favName",className:"form-label",children:"Favorite Name"}),R.jsx("input",{id:"favName",type:"text",value:Rt,onChange:he=>yt(he.target.value),className:"form-input-light w-full"})]})}),R.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[R.jsx(Gt,{variant:"outline",onClick:()=>Xe(!1),children:"Cancel"}),R.jsx(Gt,{variant:"primary",onClick:NI,leftIcon:R.jsx(bM,{size:16}),children:"Save Favorite"})]})]}),L&&R.jsxs(Ms,{isOpen:L,onClose:()=>q(!1),title:"Delete Favorite?",children:[R.jsx("p",{children:"Are you sure you want to delete this favorite? This action cannot be undone."}),R.jsxs("div",{className:"mt-6 flex justify-end gap-3",children:[R.jsx(Gt,{variant:"outline",onClick:()=>q(!1),children:"Cancel"}),R.jsx(Gt,{variant:"danger",onClick:BI,leftIcon:R.jsx(x1,{size:16}),children:"Delete"})]})]}),fe&&R.jsx(Ms,{isOpen:ne,onClose:()=>H(!1),title:`Details for "${fe.name}"`,size:"lg",children:R.jsx("pre",{className:"text-xs bg-[var(--bg-elevated)] p-4 rounded-md max-h-96 overflow-auto",children:JSON.stringify(fe,null,2)})}),Wn&&fn&&R.jsx(Ioe,{isOpen:Wn,onClose:()=>Gn(!1),onConfirm:CI,fileName:fn.fileName,suggestedAssembly:fn.suggestedAssembly}),p&&c&&R.jsx(boe,{isOpen:p,onClose:()=>m(!1),report:c,onKeepMembers:AI}),bt&&R.jsx(Loe,{isOpen:bt,onClose:()=>Ut(!1),onConfirm:HI}),Y&&be&&R.jsx(Ooe,{isOpen:Y,onClose:()=>te(!1),onConfirm:()=>{Iy(be.assemblyName,be.newData,be.newFileName),te(!1)},existingData:ot[be.assemblyName],pendingUpdate:be}),j&&ye&&R.jsx(Boe,{isOpen:j,onClose:()=>ue(!1),onSave:GI,memberData:ye.member,assemblyName:ye.assemblyName}),Me&&R.jsx(Hoe,{isOpen:Me,onClose:()=>A(!1),reportContent:I,isLoading:P})]})},qoe=({size:e="md",text:t,className:n})=>{const r={sm:"w-6 h-6 border-2",md:"w-10 h-10 border-[3px]",lg:"w-16 h-16 border-4"};return R.jsxs("div",{className:`flex flex-col items-center justify-center ${n||""}`,children:[R.jsx("div",{className:`${r[e]} border-t-transparent border-[var(--primary-accent-start)] rounded-full animate-spin`}),t&&R.jsx("p",{className:"mt-4 text-[var(--text-secondary)]",children:t})]})},Koe=()=>R.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[R.jsx("h1",{className:"text-4xl font-bold",children:"404"}),R.jsx("p",{className:"text-lg",children:"Page Not Found"})]}),Yoe=()=>R.jsxs("div",{className:"flex flex-col items-center justify-center h-full",children:[R.jsx("h1",{className:"text-4xl font-bold text-red-500",children:"Oops!"}),R.jsx("p",{className:"text-lg",children:"Sorry, an unexpected error has occurred."})]}),Xoe=xt.lazy(()=>Wo(()=>import("./DashboardSection-BA_92nEJ.js"),__vite__mapDeps([0,1,2]))),Joe=xt.lazy(()=>Wo(()=>import("./FavoritesView-BYKPZCXa.js"),[])),Qoe=xt.lazy(()=>Wo(()=>import("./AnalyticsSection-D2enVB4p.js"),[])),joe=xt.lazy(()=>Wo(()=>import("./ReportsSection-D9ZTl2Uj.js"),__vite__mapDeps([3,1]))),Zoe=xt.lazy(()=>Wo(()=>import("./MemberDatabaseSection-CtvkpDDq.js"),[])),ele=xt.lazy(()=>Wo(()=>import("./ListOverviewActionsSection-DkyMiZDI.js"),__vite__mapDeps([4,1,5,2]))),tle=xt.lazy(()=>Wo(()=>import("./ConfigurationSection-BlhjtupV.js"),__vite__mapDeps([6,5]))),nle=()=>R.jsx(Xoe,{...qo()}),rle=()=>R.jsx(Joe,{...qo()}),ile=()=>R.jsx(Qoe,{...qo()}),sle=()=>R.jsx(joe,{...qo()}),ale=()=>R.jsx(Zoe,{...qo()}),ole=()=>R.jsx(ele,{...qo()}),lle=()=>R.jsx(tle,{...qo()}),ule=e=>vL([{path:"/",element:R.jsx(Goe,{...e}),errorElement:R.jsx(Yoe,{}),children:[{index:!0,element:R.jsx(nle,{})},{path:"processor",element:R.jsx(ole,{})},{path:"database",element:R.jsx(ale,{})},{path:"favorites",element:R.jsx(rle,{})},{path:"reports",element:R.jsx(sle,{})},{path:"analytics",element:R.jsx(ile,{})},{path:"configuration",element:R.jsx(lle,{})},{path:"*",element:R.jsx(Koe,{})}]}],{basename:"/TACTMS/"}),cle=e=>{const t=ule(e);return R.jsx(E.Suspense,{fallback:R.jsx("div",{className:"flex justify-center items-center h-full",children:R.jsx(qoe,{})}),children:R.jsx(ML,{router:t})})},fle=new ooe,EI=document.getElementById("root");if(!EI)throw new Error("Could not find root element to mount to");const dle=km.createRoot(EI);dle.render(R.jsx(xt.StrictMode,{children:R.jsx(doe,{client:fle,children:R.jsx(cle,{})})}));export{nM as $,my as A,Gt as B,AM as C,an as D,o1 as E,cr as F,Lse as G,qO as H,vB as I,GO as J,r1 as K,As as L,Vx as M,hu as N,wn as O,NM as P,e5 as Q,xt as R,LM as S,x1 as T,kB as U,J5 as V,Z5 as W,UM as X,j5 as Y,DS as Z,Z6 as _,Xh as a,ZR as a0,M8 as a1,mB as a2,_J as a3,Hae as a4,yB as a5,kM as b,ft as c,_B as d,xa as e,eo as f,ks as g,fB as h,y1 as i,R as j,bM as k,vR as l,dr as m,_g as n,Rs as o,Ux as p,of as q,E as r,JA as s,en as t,qo as u,Pa as v,WO as w,FT as x,HO as y,P8 as z};

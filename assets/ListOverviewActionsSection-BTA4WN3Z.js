import{c as m,j as e,m as L,R as ae,r as Y,u as ie,B as g,U as ne,i as re,k as le,d as oe}from"./index-CuI5jObH.js";import{D as ce,A as p,S as N,T as q}from"./AnimatedNumber-DsIDgrtT.js";import{I as de}from"./InfoTooltip-BNC21C3E.js";import{A as me}from"./activity-DlbzSBR_.js";/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const he=m("CalendarCheck",[["path",{d:"M8 2v4",key:"1cmpym"}],["path",{d:"M16 2v4",key:"4m81vk"}],["rect",{width:"18",height:"18",x:"3",y:"4",rx:"2",key:"1hopcy"}],["path",{d:"M3 10h18",key:"8toen8"}],["path",{d:"m9 16 2 2 4-4",key:"19s6y9"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const xe=m("Download",[["path",{d:"M21 15v4a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2v-4",key:"ih7n3h"}],["polyline",{points:"7 10 12 15 17 10",key:"2ggqvy"}],["line",{x1:"12",x2:"12",y1:"15",y2:"3",key:"1vk2je"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ue=m("Eraser",[["path",{d:"m7 21-4.3-4.3c-1-1-1-2.5 0-3.4l9.6-9.6c1-1 2.5-1 3.4 0l5.6 5.6c1 1 1 2.5 0 3.4L13 21",key:"182aya"}],["path",{d:"M22 21H7",key:"t4ddhn"}],["path",{d:"m5 11 9 9",key:"1mo9qw"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const pe=m("FileSpreadsheet",[["path",{d:"M15 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V7Z",key:"1rqfz7"}],["path",{d:"M14 2v4a2 2 0 0 0 2 2h4",key:"tnqrlb"}],["path",{d:"M8 13h2",key:"yr2amv"}],["path",{d:"M14 13h2",key:"un5t4a"}],["path",{d:"M8 17h2",key:"2yhykz"}],["path",{d:"M14 17h2",key:"10kma7"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const S=m("History",[["path",{d:"M3 12a9 9 0 1 0 9-9 9.75 9.75 0 0 0-6.74 2.74L3 8",key:"1357e3"}],["path",{d:"M3 3v5h5",key:"1xhq8a"}],["path",{d:"M12 7v5l4 2",key:"1fdv2h"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ve=m("Keyboard",[["path",{d:"M10 8h.01",key:"1r9ogq"}],["path",{d:"M12 12h.01",key:"1mp3jc"}],["path",{d:"M14 8h.01",key:"1primd"}],["path",{d:"M16 12h.01",key:"1l6xoz"}],["path",{d:"M18 8h.01",key:"emo2bl"}],["path",{d:"M6 8h.01",key:"x9i8wu"}],["path",{d:"M7 16h10",key:"wp8him"}],["path",{d:"M8 12h.01",key:"czm47f"}],["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const ge=m("ListChecks",[["path",{d:"m3 17 2 2 4-4",key:"1jhpwq"}],["path",{d:"m3 7 2 2 4-4",key:"1obspn"}],["path",{d:"M13 6h8",key:"15sg57"}],["path",{d:"M13 12h8",key:"h98zly"}],["path",{d:"M13 18h8",key:"oe0vm4"}]]);/**
 * @license lucide-react v0.395.0 - ISC
 *
 * This source code is licensed under the ISC license.
 * See the LICENSE file in the root directory of this source tree.
 */const O=m("TrendingDown",[["polyline",{points:"22 17 13.5 8.5 8.5 13.5 2 7",key:"1r2t7k"}],["polyline",{points:"16 17 22 17 22 11",key:"11uiuu"}]]),ye=L.circle,fe=L.span,je=({percentage:x,size:a=100,strokeWidth:l=10,color:i})=>{const n=(a-l)/2,o=2*Math.PI*n,d=o-x/100*o,u=i||"var(--primary-accent-start)";return e.jsxs("div",{className:"relative",style:{width:a,height:a},children:[e.jsxs("svg",{width:a,height:a,viewBox:`0 0 ${a} ${a}`,className:"-rotate-90",children:[e.jsx("circle",{cx:a/2,cy:a/2,r:n,stroke:"var(--bg-card-subtle-accent)",strokeWidth:l,fill:"transparent"}),e.jsx(ye,{cx:a/2,cy:a/2,r:n,stroke:u,strokeWidth:l,fill:"transparent",strokeDasharray:o,strokeDashoffset:o,strokeLinecap:"round",animate:{strokeDashoffset:d},transition:{duration:1.2,ease:"circOut"}})]}),e.jsx("div",{className:"absolute inset-0 flex items-center justify-center",children:e.jsxs(fe,{className:"text-xl font-bold text-[var(--text-primary)]",initial:{opacity:0},animate:{opacity:1},transition:{duration:.5,delay:.5},children:[Math.round(x),"%"]})})]})},Ne=L.section,z=({title:x,stats:a,defaultIcon:l})=>{const{change:i,current:n,previous:o}=a;if(o==null||o===0)return e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:x}),e.jsx(l,{size:20,className:"text-[var(--text-muted)]"})]}),e.jsx("p",{className:"text-xl font-bold mt-2 text-[var(--text-muted)]",children:"No Data"}),e.jsx("p",{className:"text-xs text-[var(--text-muted)] mt-1",children:"No past records to compare."})]});const d=i!==null&&i>0,u=i!==null&&i<0,y=d?"text-[var(--success-text)]":u?"text-[var(--danger-text)]":"text-[var(--text-secondary)]",k=d?q:u?O:l,b=()=>i===null?"N/A":i===1/0?"+∞%":`${i>=0?"+":""}${i.toFixed(1)}%`;return e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:x}),e.jsx(k,{size:20,className:y})]}),e.jsx("p",{className:`text-3xl font-bold mt-2 ${y}`,children:b()}),e.jsxs("p",{className:"text-xs text-[var(--text-muted)] mt-1 truncate",children:["GH₵ ",n.toLocaleString(void 0,{minimumFractionDigits:2})," vs GH₵ ",o.toLocaleString(void 0,{minimumFractionDigits:2})]})]})},ke=ae.memo(Y.forwardRef((x,a)=>{const{currentAssembly:l,selectedDate:i,currentTotalTithe:n,hasUnsavedChanges:o,titheListData:d=[],tithersCount:u,nonTithersCount:y,tithersPercentage:k,setIsFullPreviewModalOpen:b,setIsDataEntryModalOpen:W,fileNameToSave:A,setFileNameToSave:G,inputErrors:w,setInputErrors:V,handleDownloadExcel:$,openSaveFavoriteModal:P,onClearWorkspace:U,transactionLog:f=[],soulsWonCount:R}=ie(),{lowestTitheAmount:I,highestTitheAmount:B,lowestTitherName:K,highestTitherName:Z,historicalStats:M}=Y.useMemo(()=>{const r=d.map(s=>({...s,amount:Number(s["Transaction Amount"])||0})).filter(s=>s.amount>0);let h=null,v=null;r.length>0&&(h=r.reduce((s,t)=>s.amount<t.amount?s:t),v=r.reduce((s,t)=>s.amount>t.amount?s:t));const _=h?h.amount:0,J=v?v.amount:0,Q=h?h["Membership Number"]:void 0,X=v?v["Membership Number"]:void 0,H=(s,t)=>t===null||t===0?s>0?1/0:0:(s-t)/t*100,D=i instanceof Date&&!isNaN(i.getTime())?i:new Date,ee=D.getMonth(),E=D.getFullYear(),j=new Date(D);j.setMonth(j.getMonth()-1);const te=j.getMonth(),se=j.getFullYear();let T=null,C=null,F=0;if(f&&f.length>0&&l){const s=f.filter(t=>t.assemblyName===l);T=s.filter(t=>{const c=new Date(t.selectedDate);return c.getMonth()===te&&c.getFullYear()===se}).reduce((t,c)=>t+c.totalTitheAmount,0),C=s.filter(t=>{const c=new Date(t.selectedDate);return c.getMonth()===ee&&c.getFullYear()===E-1}).reduce((t,c)=>t+c.totalTitheAmount,0),F=s.filter(t=>new Date(t.selectedDate).getFullYear()===E).reduce((t,c)=>t+c.totalTitheAmount,0)}return F+=n,{lowestTitheAmount:_,highestTitheAmount:J,lowestTitherName:Q,highestTitherName:X,historicalStats:{vsLastMonth:{change:H(n,T),current:n,previous:T},vsLastYear:{change:H(n,C),current:n,previous:C},ytdTotal:F}}},[d,f,i,n,l]);return d.length===0?null:e.jsxs(Ne,{ref:a,className:"space-y-8","aria-labelledby":"overview-actions-heading",initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{duration:.5,ease:"easeOut"},children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsxs("h2",{id:"overview-actions-heading",className:"section-heading !border-b-0 !pb-0 !mb-0",children:[e.jsx(me,{size:22,className:"mr-3 icon-primary"}),l," Assembly Dashboard"]}),e.jsxs("div",{className:"flex items-center gap-2",children:[e.jsx(g,{onClick:()=>W(!0),variant:"outline",size:"md",leftIcon:e.jsx(ve,{size:16}),children:"Data Entry Mode"}),e.jsx(g,{onClick:()=>b(!0),variant:"secondary",size:"md",leftIcon:e.jsx(ge,{size:16}),children:"Full List View"})]})]}),e.jsxs("div",{className:"grid grid-cols-1 lg:grid-cols-5 gap-6",children:[e.jsxs("div",{className:"lg:col-span-3 space-y-6",children:[e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-6",children:[e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Total Amount"}),e.jsx(ce,{size:20,className:"text-[var(--success-text)]"})]}),e.jsxs("p",{className:"text-4xl font-bold text-[var(--text-primary)] mt-2",children:["GH₵"," ",e.jsx(p,{n,formatter:r=>r.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})]}),e.jsxs("div",{className:"content-card card-glow-on-hover p-5 flex flex-col justify-between",children:[e.jsxs("div",{className:"flex justify-between items-center",children:[e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Participation"}),e.jsx(ne,{size:20,className:"text-[var(--primary-accent-start)]"})]}),e.jsxs("div",{className:"flex items-center justify-around mt-2",children:[e.jsx(je,{percentage:k,size:90,strokeWidth:8}),e.jsxs("div",{className:"text-right",children:[e.jsx("p",{className:"font-bold text-2xl text-[var(--text-primary)]",children:e.jsx(p,{n:u})}),e.jsx("p",{className:"text-sm text-[var(--text-secondary)]",children:"Tithers"}),e.jsxs("p",{className:"text-sm text-[var(--text-muted)] mt-1",children:[y," Non-tithers"]})]})]})]})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(N,{icon:e.jsx(re,{}),label:"Souls Won (New Members)",value:e.jsx(p,{n:R??0})}),e.jsx(N,{icon:e.jsx(q,{}),label:"Highest Tithe Amount",value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(p,{n:B,formatter:r=>r.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),subValue:Z}),e.jsx(N,{icon:e.jsx(O,{}),label:"Lowest Tithe Amount",value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(p,{n:I>0?I:0,formatter:r=>r.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]}),subValue:K})]})]}),e.jsxs("div",{className:"lg:col-span-2 content-card card-glow-on-hover flex flex-col",children:[e.jsxs("h3",{className:"text-lg font-semibold text-[var(--text-primary)] mb-4 flex items-center gap-2",children:[e.jsx(xe,{size:20})," Export & Save"]}),e.jsxs("div",{className:"flex-grow flex flex-col justify-center gap-4",children:[e.jsxs("div",{children:[e.jsx("label",{htmlFor:"fileNameToSave",className:"form-label",children:"File Name for Download"}),e.jsx("input",{type:"text",id:"fileNameToSave",value:A,onChange:r=>{G(r.target.value),V(h=>({...h,fileName:""}))},className:`form-input-light ${w.fileName?"input-error":""}`,placeholder:"Enter file name"}),w.fileName&&e.jsx("p",{className:"form-error-text",children:w.fileName})]}),e.jsxs("div",{className:"flex flex-col sm:flex-row gap-3",children:[e.jsx(g,{onClick:$,leftIcon:e.jsx(pe,{size:18}),disabled:!A.trim(),variant:"primary",fullWidth:!0,children:"Download Excel"}),e.jsx(g,{onClick:P,leftIcon:e.jsx(le,{size:18}),variant:"outline",fullWidth:!0,children:"Save to Favorites"})]}),e.jsx(g,{onClick:U,leftIcon:e.jsx(ue,{size:18}),variant:"subtle",className:"!text-[var(--danger-text)] hover:!bg-[var(--danger-start)]/10",fullWidth:!0,children:"Clear Workspace"})]}),o&&e.jsxs("p",{className:"text-xs text-[var(--warning-text)] mt-4 flex items-center gap-1.5",children:[e.jsx(oe,{size:14})," List has been modified. Apply changes in 'Full List View' before saving or exporting for accuracy."]})]})]}),e.jsxs("div",{className:"mt-8",children:[e.jsxs("h3",{className:"section-heading",children:[e.jsx(S,{size:22,className:"mr-3 icon-primary"}),"Historical Comparison",e.jsx(de,{text:"Compares the current list's total amount against data from your transaction log for the same assembly.",className:"ml-2"})]}),e.jsxs("div",{className:"grid grid-cols-1 md:grid-cols-3 gap-6",children:[e.jsx(z,{title:"vs. Last Month",stats:M.vsLastMonth,defaultIcon:S}),e.jsx(z,{title:"vs. Last Year (Same Month)",stats:M.vsLastYear,defaultIcon:S}),e.jsx(N,{icon:e.jsx(he,{}),label:"YTD Total (Live)",value:e.jsxs(e.Fragment,{children:["GH₵"," ",e.jsx(p,{n:M.ytdTotal,formatter:r=>r.toLocaleString(void 0,{minimumFractionDigits:2,maximumFractionDigits:2})})]})})]})]})]})}));ke.displayName="ListOverviewActionsSection";export{ke as default};
